function e(){import.meta.url,import("_").catch((()=>1))}import"./modulepreload-polyfill.m2ucn7sk4abee2a4.js";/* empty css                                        */import{W as t,n,u as i,e as o,w as a,j as r,o as s,M as c,s as l,K as d,P as u,m as p,a as m,b as h,S as _,c as f,d as g,B as w,L as y,A as v,f as b,C as k,I as x,g as S,h as I,G as C,R as T,i as A,p as E,k as P,l as R,q as D,r as j,V as O,t as B,v as L,x as N,y as M,z as q,D as W,E as z,F,H as U,J as H,N as V,O as K,Q as $,T as J,U as G,X as Y,Y as X,Z as Q,_ as Z,$ as ee,a0 as te,a1 as ne,a2 as ie,a3 as oe,a4 as ae,a5 as re,a6 as se}from"./index.m2ucn7sk6cc59886.js";import{t as ce,s as le}from"./topbar.m2ucn7ska6515576.js";import de from"./ext_loading.m2ucn7sk2423f322.js";import{j as ue,a as pe,c as me,D as he,U as _e,b as fe,d as ge,e as we,l as ye,g as ve}from"./jsmonitor_report.m2ucn7sk10756c54.js";import{C as be}from"./class.m2ucn7skd1a660bd.js";import{m as ke,J as xe}from"./core.m2ucn7sk16cdde04.js";import{p as Se,A as Ie,g as Ce,I as Te,V as Ae,w as Ee}from"./page_utils.m2ucn7skf8d01368.js";import{e as Pe,p as Re}from"./page_cls_ctrl.m2ucn7skbbe1df6f.js";import{D as De}from"./event.m2ucn7sk1a220d6b.js";import{T as je}from"./tmpl.m2ucn7sk1af565c1.js";import{u as Oe}from"./comm_utils.m2ucn7sk138ea73c.js";import{P as Be,c as Le,r as Ne,a as Me,V as qe,q as We,k as ze}from"./voice_component.m2ucn7sk54d8fe24.js";import{d as Fe,c as Ue,g as He}from"./_commonjsHelpers.m2ucn7skfc84763d.js";import{p as Ve,o as Ke,a as $e}from"./page_utils.m2ucn7sk1ff5c66e.js";import{A as Je}from"./appmsgext.m2ucn7skf48e4ec6.js";import{R as Ge,i as Ye}from"./vote.m2ucn7sk833f88a0.js";import{u as Xe,r as Qe,a as Ze,c as et,g as tt,b as nt,f as it,A as ot,e as at,d as rt}from"./utils.m2ucn7skc444d369.js";import{g as st,i as lt}from"./index.m2ucn7sk949de268.js";import{b as dt,s as ut}from"./set_article_read.m2ucn7sk922a9192.js";import{n as pt}from"./_plugin-vue2_normalizer.m2ucn7skfc2fb13f.js";import{m as mt}from"./underline_action.m2ucn7sk09c5da42.js";import{i as ht,a as _t,g as ft,b as gt,s as wt,c as yt,d as vt,f as bt}from"./advance.m2ucn7sk36025467.js";import{s as kt,a as xt}from"./private_share.m2ucn7sk6e91ca91.js";import{A as St}from"./a_config.m2ucn7sk96e976e5.js";import{L as It}from"./like_and_share.m2ucn7sk460a186f.js";import{F as Ct,V as Tt,a as At,b as Et,T as Pt,P as Rt,c as Dt,d as jt,e as Ot}from"./cover_next.m2ucn7sk4056627e.js";import{g as Bt}from"./font_size_utils.m2ucn7skc1a07277.js";import{I as Lt}from"./interaction.m2ucn7skc4bd1fa5.js";import{B as Nt,V as Mt}from"./background_color.m2ucn7sk75c2900b.js";import{i as qt}from"./article_bottom_bar.m2ucn7ske7261fcc.js";import{i as Wt,h as zt}from"./mobile_click.m2ucn7sk56339580.js";import{n as Ft}from"./_plugin-vue2_normalizer-9c6b8b3d.m2ucn7skf46dd4c3.js";import"./wxgspeedsdk.m2ucn7skf8eb5e85.js";import Ut from"./set_star.m2ucn7ske1c6fb45.js";import{D as Ht,o as Vt}from"./img_onload_handler.m2ucn7ske9830634.js";import{r as Kt,i as $t}from"./channels.m2ucn7skf0400930.js";import{g as Jt}from"./get_word_cnt.m2ucn7sk1a70c97b.js";import{s as Gt,r as Yt,h as Xt,g as Qt,p as Zt,m as en}from"./channel_product_utils.m2ucn7skae93272f.js";import{L as tn}from"./storage.m2ucn7sk52356a02.js";import"./intersection-observer.m2ucn7ske16580c9.js";import{_ as nn}from"./teleport.esm.m2ucn7skd60569be.js";import"./set_custom_ele.m2ucn7sk0a6c1468.js";import"./modal.m2ucn7skd01ea73f.js";import{getImmersiveMode as on}from"./set_fullscreen_webview.m2ucn7skfa4667e4.js";import"./get_page_read_pos.m2ucn7sk86ec464e.js";import"./body_first_observer.m2ucn7ska7d0eac4.js";import"./moment.m2ucn7sk07db360f.js";import"./rec_report_key.m2ucn7sk52a5df8a.js";import"./localstorage.m2ucn7sk679bf142.js";import"./i18n.m2ucn7skde033f12.js";import"./loadscript.m2ucn7sk2014a786.js";import"./bind_element.m2ucn7sk9d7c330d.js";import"./bind_element.m2ucn7skde5b25c1.js";import"./bind_element.m2ucn7sk0a6ac0e3.js";const an=[];function rn(){try{!function(){window.location.href.indexOf("clearStorage=1")>=0&&(localStorage.removeItem("max-age-storage-test"),console.log("clear localStorage"));var e=window.user_uin||0;if(0!==e&&Math.floor(e/100)%1e3<1&&(pe({type:"GET",url:"/mp/reportcache?type=1&random="+Math.random()}),(new Image).src="/mp/reportcache?type=2&uin="+uin,localStorage&&null==localStorage.getItem("max-age-storage-test"))){console.log("localStorage empty");try{localStorage.setItem("max-age-storage-test",!0),console.log("localStorage set success")}catch(t){}pe({type:"GET",url:"/mp/reportcache?type=3&random="+Math.random()})}}(),"undefined"==typeof getComputedStyle&&document.body.currentStyle&&(window.getComputedStyle=function(e){return e.currentStyle}),function(){let e=window.user_uin||0;if(!(0!==e&&Math.floor(e/100)%1e3<10))return;let t=document.getElementsByTagName("img"),n=t.length,i=document.getElementById("img-content"),o=i.offsetWidth,a=0,r=0,s=getComputedStyle(i);a=parseInt(s.paddingLeft)+parseInt(s.paddingRight),o-=a,o||(o=window.innerWidth-30);for(let c=0;c<n;++c){if(!t[c].getAttribute("data-src"))continue;let e=1*t[c].getAttribute("data-w")||o,n=1*t[c].getAttribute("data-ratio");n&&n>0&&e>o&&r++}r>0&&an.push({idkey:28307,order:22,num:r})}(),function(){for(let e=0,t=an.length;e<t;++e){let t=an[e];ue.setSum(t.idkey,t.order,t.num)}}()}catch(e){console.error(e)}}let cn=!1;const ln=navigator.userAgent.match(/MicroMessenger\/(\d+)\.(\d+)\.(\d+)/);if(ln){const e=Number(ln[1]),t=Number(ln[2]),n=Number(ln[3]);(e>6||6===e&&t>5||6===e&&5===t&&n>=3)&&(cn=!0)}const dn={tagName:"mp-wxaproduct",isWechat:(ke.isAndroid||ke.isIOS)&&ke.isWechat&&!ke.isWxWork,isPcWechat:ke.isWindowsWechat||ke.isMacWechat,screen_height:Oe.getInnerHeight(),canJumpOnTap:cn,commonReportData:{},minishopDom:[],appmsgType:1*window.appmsg_type||9},un=(e={})=>{const n=e.dom,i=e.minishopInfo;De.on(n,"tap",(function(e){e.stopPropagation(),e.preventDefault(),me.report(22042,Object.assign({},dn.commonReportData,{ActionType:2,toWxaAppId:i.appid,CardType:"large"===i.cardtype?1:0,ProductId:i.productId,isMassSend:dn.appmsgType})),((e={})=>{dn.isWechat||dn.isPcWechat?dn.canJumpOnTap?t.jumpUrl({options:{userName:e.username,scene:1058,sceneNote:encodeURIComponent(location.href),relativeURL:e.path},beforeJumpBackupPage:function(){},onJsapiCallback:function(e){"openWeApp:ok"===e.err_msg||console.error(e.err_msg)}}):console.log("cant jumpOnTap"):new Be({msg:"请使用微信打开。"})})(i)}),!0),De.on(n,"click",(e=>{e.preventDefault(),e.stopPropagation()}),!0)},pn=()=>{for(let e=0;e<dn.minishopDom.length;e++){const t=dn.minishopDom[e];if(1*t.getAttribute("data-hasreport")!=1){const e=document.documentElement.scrollTop||document.body.scrollTop,n=t.getAttribute("data-wxaproduct-productid")||"0",i=t.getAttribute("data-wxaproduct-appid")||"",o=t.getAttribute("data-wxaproduct-cardtype")||"mini";t.clientHeight+t.offsetTop>=e+t.clientHeight/2&&t.clientHeight+t.offsetTop<=e+t.clientHeight/2+dn.screen_height&&(t.setAttribute("data-hasreport",1),me.report(22042,Object.assign({},dn.commonReportData,{ActionType:1,toWxaAppId:i,CardType:"large"===o?1:0,ProductId:n,isMassSend:dn.appmsgType})))}}};De.on(window,"scroll",pn);const mn=(e={})=>{if(e.node&&e.data&&e.data.headimg){const t=function(e){const t=e.node,n=e.data;return function(){const e=document.createElement("div");e.innerHTML=je.tmpl('<# if(cardtype === \'mini\') {#>\n<div role="button" class="appmsg_card_context wx_tap_card minishop_card minishop_card_small js_wx_tap_highlight" data-wxaproduct-productid="<#=productId#>" data-wxaproduct-appid="<#=appid#>" data-wxaproduct-cardtype="<#=cardtype#>">\n  <div class="minishop_card_hd">\n    <i aria-label="商品，" class="minishop_card_thumb" style="background-image:url(<#=headimg#>);"></i>\n  </div>\n  <div class="minishop_card_bd">\n    <div class="minishop_main_context">\n      <strong class="minishop_card_title"><#=title#></strong>\n      <# if(avatar && nickname) { #>\n      <div class="minishop_card_profile weui-flex">\n        <img class="minishop_card_profile_avatar" src="<#=avatar#>" alt="">\n        <strong class="minishop_card_profile_nickname"><#=nickname#></strong>\n      </div>\n      <# } #>\n    </div>\n    <div class="minishop_extra_context weui-flex">\n      <em class="minishop_card_price"><#=price#></em>\n      <button class="weui-btn weui-btn_xmini minishop_card_buy_btn" type="button"><i class="icon_minishop_card_buy"></i>Purchase</button>\n    </div>\n  </div>\n</div>\n<#} else { #>\n<div role="button" class="appmsg_card_context wx_tap_card minishop_card minishop_card_large js_wx_tap_highlight" data-wxaproduct-productid="<#=productId#>" data-wxaproduct-appid="<#=appid#>" data-wxaproduct-cardtype="<#=cardtype#>">\n  <div class="minishop_card_hd">\n    <i aria-label="商品，" class="minishop_card_thumb" style="background-image:url(<#=headimg#>);"></i>\n  </div>\n  <div class="minishop_card_bd weui-flex__item">\n    <div class="minishop_main_context">\n      <strong class="minishop_card_title"><#=title#></strong>\n      <# if(avatar && nickname) { #>\n      <div class="minishop_card_profile weui-flex">\n        <img class="minishop_card_profile_avatar" src="<#=avatar#>" alt="">\n        <strong class="minishop_card_profile_nickname"><#=nickname#></strong>\n      </div>\n      <# } #>\n    </div>\n    <div class="minishop_extra_context weui-flex">\n      <em class="minishop_card_price"><#=price#></em>\n      <button class="weui-btn weui-btn_xmini minishop_card_buy_btn" type="button"><i class="icon_minishop_card_buy"></i>Purchase</button>\n    </div>\n  </div>\n</div>\n<# } #>',n,!0).replace(/>\s*</g,"><").replace(/^\s+/,"").replace(/\s+$/,"");const i=e.firstChild;t.parentNode.insertBefore(i,t.nextSibling);const o=t.parentNode.querySelector('[data-preloadingid="'+n.productId+'"]');o&&o.parentNode.removeChild(o),un({dom:i,minishopInfo:n}),dn.minishopDom.push(i),pn()}}(e),n=function(){this.onload=null,this.onerror=null,t()},i=new Image;i.onload=n,i.onerror=n,i.src=e.data.headimg}},hn=e=>{pe({url:"/mp/wapwxaproduct?action=batch_get_product&product_ids=".concat(JSON.stringify({list:e})),type:"GET",dataType:"json",success(e){e&&e.base_resp&&1*e.base_resp.ret==0&&"[object Array]"===Object.prototype.toString.call(e.product_list)&&((e=[])=>{const t=document.querySelectorAll(dn.tagName);for(let n=0,i=t.length;n<i;n++){const i=t[n],o=decodeURIComponent(i.getAttribute("data-wxaproduct-productid")||""),a=e.find((e=>e.product_id===o))||{},r={productId:o,title:i.getAttribute("data-wxaproduct-title")||"",price:decodeURIComponent(i.getAttribute("data-wxaproduct-price")||""),headimg:decodeURIComponent(i.getAttribute("data-wxaproduct-headimg")||""),cardtype:decodeURIComponent(i.getAttribute("data-wxaproduct-cardtype")||""),avatar:a.avatar||"",nickname:a.nickname||"",appid:a.appid||decodeURIComponent(i.getAttribute("data-wxaproduct-appid")||""),path:a.path||"",username:a.username||""};mn({data:r,node:i})}})(e.product_list)},error(t){dn.retry?(dn.retry--,hn(e)):console.error(t)}})},_n=(e={})=>{e.minishopCards&&(dn.commonReportData={BizUin:1*Fe(e.biz),MsgId:window.parseInt(e.mid,10)||0,ItemIdx:window.parseInt(e.idx,10)||0,Scene:window.parseInt(e.source,10)||0,SubScene:window.parseInt(e.subscene,10)||0,EnterId:window.parseInt(e.enterid,10)||0},hn(e.minishopCards.list),pn())},fn='<span class="qa__card js_qa_card_inner">\n  <# if (qaDeleted) { #>\n    <span class="qa__card-deleted">讨论内容已被删除</span>\n  <# } else { #>\n    <span>\n      <span class="qa__card-hd">\n        <span class="qa__hd-notice"><#=nickname#> 发起了一个读者讨论</span>\n        <span class="qa__hd-question"><#==title#></span>\n      </span>\n      <# if (!answerCount) { #>\n        <# if (isLogin) { #>\n          \x3c!-- <# if (disableAnswerWord) { #>\n            <span class="qa__list-answer qa__list-answer_desc"><#=disableAnswerWord#></span>\n          <# } else { #>\n            <span class="qa__list-answer js_qa_write_answer">参与讨论</span>\n          <# } #> --\x3e\n          <span class="qa__list-answer qa__list-answer_desc">讨论已结束</span>\n        <# } #>\n      <# } else { #>\n        <span>\n          <span class="qa__list-hd">\n            <span class="qa__list-hd-title js_qa_list_head_title">精选讨论内容</span>\n            \x3c!-- <# if (isLogin) { #>\n              <# if (disableAnswerWord) { #>\n                <span class="qa__list-hd-desc"><#=disableAnswerWord#></span>\n              <# } else { #>\n                <span class="qa__list-hd-action js_qa_write_answer">参与讨论</span>\n              <# } #>\n            <# } #> --\x3e\n          </span>\n          <span class="qa__list js_qa_qna_answer_list"><#==answerListStr#></span>\n          <# if (leftAnswerCnt) { #>\n            <p class="qa__list-more js_more_answer_entry" data-count="<#=answerCount#>"><#=leftAnswerCnt#></p>\n          <# } #>\n        </span>\n      <# } #>\n    </span>\n  <# } #>\n</span>',gn='<div class="qa__list-item js_qa_list_item">\n  \x3c!-- 层主头像 --\x3e\n  <section class="qa__item-avatar">\n    <img src="<#=user_info.headimg#>">\n  </section>\n  <section class="qa__item-bd">\n    <div class="qa__item-info">\n      \x3c!-- 层主昵称 --\x3e\n      <div class="qa__item-nickname">\n        <#=user_info.nickname#>\n      </div>\n      \x3c!-- 点赞 --\x3e\n      <div class="qa__item-action">\n        \x3c!-- span加praised点赞 --\x3e\n        <# if (is_my_answer && canOp) { #>\n          <div class="qa__action js_delete_answer" data-id="<#=answer_id#>"><i class="icon_delete"></i></div>\n        <# } #>\n        \x3c!-- 精选之后的才能点赞 --\x3e\n        <# if (answer_status && isLogin) { #>\n          <div class="qa__action qa__action-praise js_qa_like<# if (my_like_status) { #> praised<# } #>" data-type="1" data-id="<#=answer_id#>">\n            <i class="icon_praise_gray"></i>\n            <span class="js_like_num" data-num="<#=like_num#>">\n              <#=likeNumFormated#>\n            </span>\n          </div>\n        <# } #>\n        <# if (!answer_status) { #>\n          <div class="qa__action qa__action_normal">Not approved</div>\n        <# } #>\n      </div>\n    </div>\n\n    \x3c!-- 回答内容 --\x3e\n    <p class="qa__item-content js_qa_item_content"><#=content#></p>\n    \x3c!-- <# if (is_my_answer && canOp) { #>\n    <div class="qa__action qa__action-reply js_write_reply" data-answerid="<#=answer_id#>" data-answersn="<#=answer_sn#>" <# if (replyListHtml) { #>style="display: none;"<# } #>><span>Reply</span></div>\n    <# } #> --\x3e\n\n    \x3c!-- 回复 --\x3e\n    <section class="qa__reply">\n      <section class="js_qa_reply_list js_qa_reply_list_<#=answer_id#>">\n        <#=replyListHtml#>\n      </section>\n      <# if (replyListHtml && leftReplyCount) { #>\n        <p class="qa__reply-more js_get_more_reply js_get_more_reply_<#=answer_id#>" data-answerid="<#=answer_id#>" data-answersn="<#=answer_sn#>">\n          <#=leftReplyTips#>\n        </p>\n      <# } #>\n      \x3c!-- <# if (is_my_answer && canOp) { #>\n      <div class="qa__action qa__action-reply js_write_reply" data-answerid="<#=answer_id#>" data-answersn="<#=answer_sn#>" <# if (!replyListHtml) { #>style="display: none;"<# } #>><span>Reply</span></div>\n      <# } #> --\x3e\n    </section>\n  </section>\n</div>',wn='<section class="qa__reply-item js_qa_reply_item<# if (is_my_reply) { #> js_qa_my_reply<# } #>">\n  <div class="qa__reply-hd">\n    <div class="qa__reply-nickname">\n      <# if (is_biz_reply) { #>\n        Author\n      <# } else { #>\n        <#=user_info.nickname#>\n      <# } #>\n    </div>\n    <div class="qa__item-action">\n      <# if (is_my_reply && canOp) { #>\n        <div class="qa__action js_delete_reply" data-id="<#=reply_id#>"><i class="icon_delete"></i></div>\n      <# } #>\n      \x3c!-- 精选之后的才能点赞 --\x3e\n      <# if (replyStatus && isLogin) { #>\n        <div class="qa__action qa__action-praise js_qa_like<# if (my_like_status) { #> praised<# } #>" data-type="2" data-id="<#=reply_id#>">\n          <i class="icon_praise_gray"></i>\n          <span class="js_like_num" data-num="<#=like_num#>">\n            <#=likeNumFormated#>\n          </span>\n        </div>\n      <# } #>\n      <# if (!replyStatus) { #>\n        <div class="qa__action qa__action_normal">Not approved</div>\n      <# } #>\n    </div>\n  </div>\n  <p class="qa__reply-content js_qa_reply_content"><#=content#></p>\n</section>',yn='<div class="qa__modal-reply">\n  <div class="qa__modal-reply-msg js_reply_top_content"></div>\n  <div class="frm_textarea_box_wrp">\n    <span class="frm_textarea_box" style="position: relative; display: block;">\n      <div style="position: relative; height: 9.6em; overflow: hidden; font-size: 17px;">\n        <textarea class="frm_textarea js_qa_input" placeholder="内容被公众号精选后，将对所有人可见。" style="height: 9.6em; width: 100%; border: none; outline: none;"></textarea>\n      </div>\n      <div class="emotion_tool">\n        <span class="emotion_switch" style="display:none;"></span>\n        <span id="js_qa_emotion_switch" class="pic_emotion_switch_wrp">\n          <img class="pic_default" src="<#=window.icon_emotion_switch#>" alt="">\n          <img class="pic_active" src="<#=window.icon_emotion_switch_active#>" alt="">\n          <img class="pic_default_primary" src="<#=window.icon_emotion_switch_primary#>" alt="">\n          <img class="pic_active_primary" src="<#=window.icon_emotion_switch_active_primary#>" alt="">\n        </span>\n      </div>\n    </span>\n  </div>\n  <div class="emotion_panel" id="js_qa_emotion_panel">\n    <span class="emotion_panel_arrow_wrp" id="js_qa_emotion_panel_arrow_wrp">\n      <i class="emotion_panel_arrow arrow_out"></i>\n      <i class="emotion_panel_arrow arrow_in"></i>\n    </span>\n    <div class="emotion_list_wrp" id="js_qa_emotion_slide_wrapper"></div>\n    <ul class="emotion_navs" id="js_qa_emotion_navbar"></ul>\n  </div>\n</div>\n<div class="qa__list-wrp">\n  <div class="qa__list-hd js_qa_write_head" style="display: none;">\n    <span class="qa__list-hd-title">我的讨论内容</span>\n  </div>\n  <div class="qa__list js_qa_qna_answer_list"></div>\n</div>\n\n<div class="js_loading_toast" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class="weui-loading weui-icon_toast"></i>\n    <p class="weui-toast__content js_loading_content">Loading...</p>\n  </div>\n</div>\n\n<div class="js_sended_toast" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class="weui-icon-success-no-circle weui-icon_toast"></i>\n    <p class="weui-toast__content" id="js_toast_msg">Posted</p>\n  </div>\n</div>\n\n<div class="qa__toast-alert js_alert_toast" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class=" qa__icon-alert"></i>\n    <p class="weui-toast__content js_alert_toast_word"></p>\n  </div>\n</div>',vn="weui-btn_disabled",bn="page_no_scroll",kn="".concat(screen.height/4*3,"px"),xn={top:he.os.pc?"20%":"".concat(screen.height/4-(screen.height-window.innerHeight),"px"),btnText:"Submit",hasHeader:!0,clickMask2Hide:!0,animationType:"bottom",scroll2Hide:!0,sideslip2Hide:!0};function Sn(e,t,n,i){n=i?"".concat(n,"px"):n,e.style[t]=n}class In{constructor(e,t={}){t=Object.assign({},xn,t);const n=document.createElement("div");n.innerHTML=je.tmpl('<div class="wx_bottom_modal_wrp <#=extClass#>">\n  <div\n    class="weui-half-screen-dialog wx_bottom_modal js_bottom_modal_content"\n    role="dialog"\n    aria-modal="true"\n    aria-hidden="true"\n    tabindex="0"\n    <# if (!autoHeight) { #>\n      style="max-height: none;"\n    <# } else { #>\n      style="max-height: <#=maxHeight#>;"\n    <# } #>\n  >\n    <# if (hasHeader) { #>\n      <div class="weui-half-screen-dialog__hd__wrp">\n        <div class="weui-half-screen-dialog__hd js_bottom_modal_hd">\n          <div class="weui-half-screen-dialog__hd__side">\n            <button class="weui-btn_icon js_close_bottom_modal weui-wa-hotarea">Close<i class="weui-icon-half-screen-close"></i></button>\n          </div>\n\n          <div class="weui-half-screen-dialog__hd__main">\n            <strong class="weui-half-screen-dialog__title js_bottom_modal_title">Title</strong>\n          </div>\n\n          <div class="weui-half-screen-dialog__hd__side">\n            <# if (hasBtn) { #>\n              <# if (btnSlot) { #>\n                <div role="button" class="js_submit_bottom_modal weui-wa-hotarea">\n                  <#==btnSlot#>\n                </div>\n              <# } else { #>\n                <button class="weui-btn weui-btn_primary weui-btn_xmini js_submit_bottom_modal weui-wa-hotarea"><#=btnText#></button>\n              <# } #>\n            <# } #>\n            <button class="weui-btn_icon" style="display:none;">更多<i class="weui-icon-more"></i></button>\n          </div>\n        </div>\n      </div>\n    <# } #>\n    <div class="weui-half-screen-dialog__bd js_bottom_modal_bd">\n      <div role="alert" class="wx_bottom_modal_msg_wrp js_modal_loading" style="display: none;">\n        <div class="wx_bottom_modal_msg">\n          <i class="weui-loading" role="img" aria-label="Loading..."></i>\n        </div>\n      </div>\n      \x3c!-- 上下拉加载loading --\x3e\n      <div role="alert" class="weui-loadmore js_pull_loading" style="display: none;">\n        <i class="weui-loading"></i>\n        <span class="weui-loadmore__tips">Loading...</span>\n      </div>\n\n      \x3c!-- 加载完成的dom，插到js_bottom_modal_bd下 --\x3e\n      <div role="option" class="weui-loadmore weui-loadmore_line weui-loadmore_dot js_modal_end_line" style="display: none;">\n        <div class="weui-hidden_abs">已无更多数据</div>\n        <span class="weui-loadmore__tips"></span>\n      </div>\n    </div>\n    <# if (hasFooter) { #>\n      <div class="weui-half-screen-dialog__ft js_bottom_modal_ft"></div>\n    <# } #>\n  </div>\n  <# if (hasMask) { #>\n    \x3c!-- 透明mask，用于防止点透 --\x3e\n    <div class="wx_bottom_modal_mask_fixed js_bottom_modal_mask_not_click"></div>\n\n    \x3c!-- 有底色的mask --\x3e\n    <div class="weui-mask wx_bottom_modal_mask js_bottom_modal_mask"></div>\n  <# } #>\n</div>',{hasBtn:t.hasBtn,btnText:t.btnText,extClass:t.extClass||"",hasMask:!t.removeMask,isTopic:!!t.isTopic,hasHeader:t.hasHeader,hasFooter:!!t.footerEl,btnSlot:t.btnSlot,autoHeight:t.autoHeight,maxHeight:kn});const i=n.firstChild;this.scrollLock=!1,this.curScrollTop=0,this.touches={startX:0,startY:0,curX:0,curY:0,isScreenLeft:!1,direction:"",times:0},this.opt=t,this.rootEle=i,this.contentEle=e,this.contentAreaWrp=i.getElementsByClassName("js_bottom_modal_bd")[0],this.contentAreaWrp.appendChild(e),this.contentArea=i.getElementsByClassName("js_bottom_modal_content")[0],this.loading=this.rootEle.getElementsByClassName("js_modal_loading")[0],this.pullLoading=this.rootEle.getElementsByClassName("js_pull_loading")[0],this.endLine=this.rootEle.getElementsByClassName("js_modal_end_line")[0],this.enableGesture=!1,this.triggerEl=null,this.isAutoFocus=!0,t.removeMask||(this.maskEle=i.getElementsByClassName("js_bottom_modal_mask")[0],this.maskNotClick=i.getElementsByClassName("js_bottom_modal_mask_not_click")[0],t.transparentMask&&Sn(this.maskEle,"opacity",0)),t.hasHeader&&(this.headAreaWrp=i.getElementsByClassName("js_bottom_modal_hd")[0],this.submitBtn=this.headAreaWrp.getElementsByClassName("js_submit_bottom_modal")[0],this.closeBtn=this.headAreaWrp.getElementsByClassName("js_close_bottom_modal")[0],this.setTitle(t.title)),t.footerEl&&(this.footAreaWrp=i.querySelector(".js_bottom_modal_ft"),this.footAreaWrp.appendChild(t.footerEl)),"right"===t.animationType&&this.rootEle.classList.add("wx_bottom_modal_right"),document.body.appendChild(i),t.cb&&t.cb(),this.bindEvent()}bindEvent(){this.maskEle&&(this.opt.clickMask2Hide&&De.tap(this.maskEle,(()=>{this.hide()})),De.on(this.contentArea,"transitionend",(e=>{e.target!==this.contentArea||"transform"!==e.propertyName&&"-ms-transform"!==e.propertyName||(""!==this.contentArea.style.transform?this.contentArea.style.removeProperty("transform"):this.getShowStatus()?"function"==typeof this.opt.onShowAfterAnimation&&this.opt.onShowAfterAnimation():(Sn(this.maskNotClick,"visibility","hidden"),!this.opt.autoHeight&&Sn(this.contentArea,"top",this.opt.top)))})),De.tap(this.maskNotClick,(()=>setTimeout((()=>{this.hide(),Sn(this.maskNotClick,"visibility","hidden"),!this.opt.autoHeight&&Sn(this.contentArea,"top",this.opt.top)}),300))),De.on(this.maskEle,"touchmove",(e=>{e.preventDefault()}))),this.headAreaWrp&&(De.on(this.headAreaWrp,"touchstart",(e=>this.onTouchStart(e))),De.on(this.headAreaWrp,"touchmove",(e=>{e.preventDefault();const t=e.changedTouches[0];this.getTouchDirection(t)&&this.moveByDirection(t)})),De.on(this.headAreaWrp,"touchend",(e=>this.onTouchEnd(e)))),this.footAreaWrp&&(De.on(this.footAreaWrp,"touchstart",(e=>this.onTouchStart(e))),De.on(this.footAreaWrp,"touchmove",(e=>{e.preventDefault();const t=e.changedTouches[0];this.getTouchDirection(t)&&this.moveByDirection(t)})),De.on(this.footAreaWrp,"touchend",(e=>this.onTouchEnd(e)))),this.closeBtn&&De.on(this.closeBtn,"click",(()=>{this.hide()})),this.submitBtn&&De.on(this.submitBtn,"click",(()=>{be.hasClass(this.submitBtn,vn)||this.opt.btnClickCb&&this.opt.btnClickCb()})),De.on(this.contentAreaWrp,"scroll",(()=>{this.checkReachBoundary(),this.contentAreaWrp.scrollTop>0?be.addClass(this.contentArea,"weui-half-screen-dialog_headline"):be.removeClass(this.contentArea,"weui-half-screen-dialog_headline")})),this.headAreaWrp&&De.tap(this.headAreaWrp.getElementsByClassName("js_bottom_modal_title")[0],(()=>{this.opt.titleClickCb&&this.opt.titleClickCb()})),De.on(this.contentAreaWrp,"touchstart",(e=>this.onTouchStart(e))),De.on(this.contentAreaWrp,"touchmove",(e=>{const t=e.changedTouches[0];if(this.getTouchDirection(t)){if("Y"===this.touches.direction){const i=this.contentAreaWrp,o=t.pageY,a=o-this.touches.startY,r=i.scrollTop<=0&&a>0,s=(n=i,Math.ceil(n.scrollTop+n.offsetHeight)>=n.scrollHeight&&a<0);r||s?(r&&!this.opt.onPullDownLoad&&this.move(o),e.preventDefault()):this.resetMovement(),this.touches.curY=o}else e.preventDefault(),this.moveByDirection(t)}var n})),De.on(this.contentAreaWrp,"touchend",(e=>this.onTouchEnd(e))),De.on(window,"unload",(()=>{this.opt.removeMask||n.hide()}))}checkReachBoundary(e=!0,t=!0){this.scrollLock&&0!==this.contentAreaWrp.scrollTop||(this.scrollLock=!0,setTimeout((()=>{this.scrollLock=!1}),50),e&&!this.pullingDownLock&&this.contentAreaWrp.scrollTop<=0&&(this.opt.onPullDownLoad&&this.opt.onPullDownLoad(),this.pullingDownLock=!0),setTimeout((()=>{t&&!this.pullingUpLock&&this.contentAreaWrp.scrollTop+this.contentAreaWrp.offsetHeight+100>this.contentEle.offsetHeight&&(this.opt.onPullUpLoad&&this.opt.onPullUpLoad(),this.pullingUpLock=!0)}),100),this.opt.onScroll&&this.opt.onScroll(this.contentAreaWrp.scrollTop>this.curScrollTop?"up":"down"),this.curScrollTop=this.contentAreaWrp.scrollTop)}onTouchStart(e){const t=e.touches[0];this.touches={startX:t.pageX,startY:t.pageY,curX:t.pageX,curY:t.pageY,isScreenLeft:this.enableGesture&&t.pageX<=30,direction:"",times:0},this.contentArea.style.transition="none"}onTouchEnd(e){const t=this.touches.direction,n="X"===t?100:this.contentArea.offsetHeight/4,i=e.changedTouches[0]["page".concat(t)]-this.touches["start".concat(t)],o=this.contentArea.dataset;this.contentArea.style.removeProperty("transition"),o.distance&&(i>n?this.hide():this.contentArea.style.transform="translateY(0)",delete o.distance)}getTouchDirection(e){if(this.touches.direction)return!0;if(!this.touches.isScreenLeft)return this.touches.direction="Y",!0;this.touches.times++;const t=Math.abs(e.pageX-this.touches.startX),n=Math.abs(e.pageY-this.touches.startY);return this.touches.times>=3?(this.touches.direction=t>=n?"X":"Y",!0):t>=5&&t>=n?(this.touches.direction="X",!0):n>=5&&(this.touches.direction="Y",!0)}moveByDirection(e){const t=this.touches.direction,n=e["page".concat(t)];n-this.touches["start".concat(t)]>0?this.move(n):this.resetMovement(),this.touches["cur".concat(t)]=n}move(e){if(this.opt.sideslip2Hide&&"X"===this.touches.direction||this.opt.scroll2Hide&&"Y"===this.touches.direction){const t=this.contentArea.dataset;t.distance=1*(t.distance||0)+e-this.touches["cur".concat(this.touches.direction)],this.contentArea.style.transform="translateY(".concat(t.distance,"px)")}}resetMovement(){delete this.contentArea.dataset.distance,this.contentArea.style.removeProperty("transform")}show(e,t,o,a=!0){be.addClass(document.body,bn),this.triggerEl=o||window.event&&window.event.target,this.isAutoFocus=a,this.getShowStatus()||(e||this.opt.autoHeight||(Sn(this.contentArea,"top",this.opt.top),console.log(this.contentArea.offsetHeight)),Sn(this.contentArea,"visibility","visible"),be.addClass(this.rootEle,"wx_bottom_modal_show"),this.setAriaHidden(!1),this.contentArea.focus(),this.maskEle&&this.opt.clickMask2Hide&&Sn(this.maskNotClick,"visibility","visible"),this.opt.removeMask||n.show({alpha:this.opt.transparentMask?0:.6,callback:e=>{e&&"function"==typeof this.opt.onShowNavShadow&&this.opt.onShowNavShadow()},onClick:()=>{this.hide()}}),this.opt.sideslip2Hide&&(he.os.ios?xe.invoke("handleDeviceInfo",{action:"disableInteractivePop",disable:!0},(e=>{/:ok$/.test(e.err_msg)&&(this.enableGesture=!0)})):i.disable({onGoBack:()=>{this.hide()},onDisable:()=>{this.enableGesture=!0},onEnable:()=>{this.enableGesture=!1}})),e&&(be.addClass(this.rootEle,"wx_bottom_modal_form"),Sn(this.contentArea,"top","25px")),setTimeout((()=>{e||"right"===this.opt.animationType&&(Sn(this.contentArea,"-ms-transform","translateX(0)"),Sn(this.contentArea,"transform","translateX(0)"))})),e&&(setTimeout((()=>{"bottom"===this.opt.animationType?Sn(this.contentArea,"top","100%"):Sn(this.contentArea,"top",this.opt.top),console.log(this.contentArea.offsetHeight),be.removeClass(this.rootEle,"wx_bottom_modal_form"),setTimeout((()=>{Sn(this.contentArea,"top",this.opt.top),"right"===this.opt.animationType&&(Sn(this.contentArea,"-ms-transform","translateX(0)"),Sn(this.contentArea,"transform","translateX(0)"))}))}),50),he.os.ios?t.focus():(this.tmpInputEle||(this.tmpInputEle=t.cloneNode(!0)),this.tmpInputEle.style.opacity=0,this.tmpInputEle.style.position="fixed",this.tmpInputEle.style.top=0,this.tmpInputEle.style.zIndex="-1",document.body.appendChild(this.tmpInputEle),setTimeout((()=>{t.focus(),this.opt.makeInputEleBigger&&this.opt.makeInputEleBigger(),document.body.removeChild(this.tmpInputEle)}),300),this.tmpInputEle.focus()),he.os.ios&&!this.hasBindInputEvent&&this.opt.makeFakeInputEle&&this.opt.removeInputEle&&(this.hasBindInputEvent=!0,De.on(t,"focus",(()=>{setTimeout((()=>{t.style.opacity=1,this.opt.removeInputEle()}),50)})),De.on(t,"blur",(()=>{this.opt.makeFakeInputEle(),t.style.opacity=0})))),this.opt.onShow&&this.opt.onShow())}hide(e){be.removeClass(document.body,bn),e&&Sn(this.maskNotClick,"visibility","hidden"),this.getShowStatus()&&(this.contentArea.style.removeProperty("-ms-transform"),this.contentArea.style.removeProperty("transform"),be.removeClass(this.rootEle,"wx_bottom_modal_show"),this.setAriaHidden(!0),this.isAutoFocus&&function(e){if(!(e&&e instanceof HTMLElement))return!1;const t=window.getComputedStyle(e);return 0!==t.width&&0!==t.height&&0!==t.opacity&&"none"!==t.display&&"hidden"!==t.visibility&&null!==e.offsetParent}(this.triggerEl)&&(this.triggerEl.setAttribute("tabindex","0"),this.triggerEl.focus()),this.opt.removeMask||n.hide(),this.opt.sideslip2Hide&&(he.os.ios?xe.invoke("handleDeviceInfo",{action:"disableInteractivePop",disable:!1},(e=>{/:ok$/.test(e.err_msg)&&(this.enableGesture=!1)})):i.enable({onEnable:()=>{this.enableGesture=!1}})),this.opt.onHide&&this.opt.onHide())}disableBtn(){this.submitBtn&&be.addClass(this.submitBtn,vn)}enableBtn(){this.submitBtn&&be.removeClass(this.submitBtn,vn)}finishPullUpLoad(){this.pullingUpLock=!1}finishPullDownLoad(){this.pullingDownLock=!1}setTitle(e){this.headAreaWrp&&("string"==typeof e?this.headAreaWrp.getElementsByClassName("js_bottom_modal_title")[0].innerHTML=e:"object"==typeof e&&e.innerHTML&&(this.headAreaWrp.getElementsByClassName("js_bottom_modal_title")[0].innerHTML=e.innerHTML))}scrollTo(...e){this.contentAreaWrp.scrollTo(...e)}getRootEle(){return this.rootEle}getBdEle(){return this.contentAreaWrp}getScrollEle(){return this.contentAreaWrp}setCloseBtnStyle(e){if(this.closeBtn){const t=this.closeBtn.getElementsByTagName("i")[0],n="weui-icon-close-thin",i="weui-icon-back-arrow-thin";"back"===e?(be.removeClass(t,n),be.addClass(t,i)):(be.removeClass(t,i),be.addClass(t,n))}}getShowStatus(){return be.hasClass(this.rootEle,"wx_bottom_modal_show")}showLoading(){Sn(this.loading,"display","block")}hideLoading(){Sn(this.loading,"display","none")}showPullUpLoading(){this.contentAreaWrp.appendChild(this.pullLoading),Sn(this.pullLoading,"display","block")}hidePullUpLoading(){Sn(this.pullLoading,"display","none")}showPullDownLoading(){this.contentAreaWrp.insertBefore(this.pullLoading,this.contentAreaWrp.firstChild),Sn(this.pullLoading,"display","block")}hidePullDownLoading(){Sn(this.pullLoading,"display","none")}showEndLine(){this.contentAreaWrp.appendChild(this.endLine),Sn(this.endLine,"display","block")}setAriaHidden(e){this.contentArea.setAttribute("aria-hidden",e.toString())}disablePullDownLoad(){this.opt.onPullDownLoad=null}}function Cn(e,t,n=0){return e.getElementsByClassName(t)[n]}const Tn=document.getElementsByTagName("mp-qa")[0];let An,En,Pn,Rn,Dn,jn;const On={};let Bn,Ln,Nn,Mn,qn=0,Wn=0,zn=0,Fn="";const Un=10,Hn="answerList",Vn="myAnswerList",Kn="praised",$n="modalWriteAnswerClass",Jn="25px",Gn={__biz:Tn&&Tn.dataset.bizuin,question_id:Tn&&Tn.dataset.id,qna_sn:Tn&&function(e){let t;if(window.qnaCardData)try{t=JSON.parse(window.qnaCardData);const n=t.list;if(n&&n.length)for(let t=0;t<n.length;t++)if(e===n[t].question_id)return n[t].qna_sn}catch(n){console.error(n)}return""}(Tn.dataset.id)},Yn={};function Xn(e){e&&(e.style.display="none")}function Qn(e){e&&(e.style.display="block")}function Zn(e,t){a.jsmonitor({id:223326,key:e,value:t})}function ei(){window.weui.topTips("System error. Try again later")}function ti(e={}){me.report(20883,Object.assign({Device:he.os.ios?1:he.os.android?2:-1,MsgId:1*Gn.mid,ItemIdx:1*Gn.idx,BizUin:On.biz,ItemShowType:1*On.itemShowType,SessionId:On.sessionId,EnterId:1*On.enterId,Scene:1*On.scene,SubScene:1*On.subScene,QaId:Tn.dataset.id},e))}function ni(e,t,n){const i={replyListHtml:"",replyList:document.createDocumentFragment()};return e&&e.reply_list&&e.reply_list.length&&(i.leftReplyCount=e.left_reply_cnt,i.leftReplyTips="余下#value#条回复".replace("#value#",e.left_reply_cnt),e.reply_list.forEach((e=>{e.canOp=n,e.content=e.content.htmlEncode(),e.content=o.encode(e.content),e.likeNumFormated=Ve.formatReadNum(e.like_num),e.replyStatus=void 0===e.reply_status?1:e.reply_status,e.isLogin=An;const t=document.createElement("div");t.innerHTML=je.tmpl(wn,e,!1),i.replyListHtml+=t.innerHTML,i.replyList.appendChild(t.firstChild)}))),i}function ii(e,t,n=""){const i={answerListHtml:"",fragment:document.createDocumentFragment()};return e.forEach((e=>{e.likeNumFormated=Ve.formatReadNum(e.like_num),e.canOp=t,e.answer_sn=e.answer_sn||"",e.content=e.content.htmlEncode(),e.oriContent=e.content,e.content=o.encode(e.content),e.isLogin=An;const n=ni(e.reply_info,e.answer_id,t);Object.assign(e,n);const a=document.createElement("div");a.innerHTML=je.tmpl(gn,e,!1),i.answerListHtml+=a.innerHTML,i.fragment.appendChild(a.firstChild)})),n===Vn?Wn+=Un:n===Hn&&(qn+=Un),i}function oi(e={}){const t=Object.assign({action:e.action,limit:Un,offset:e.offset},Gn);pe({url:_e.join("/mp/qna",t),dataType:"json",success(t){let n;t&&(n=t.qna_info?t.qna_info.answer_info:t.answer_info,e.successCb(n,t))},complete(){e.complete&&e.complete()}})}function ai(e,t){let n=0;for(;e.offsetParent&&e!==t;)n+=e.offsetTop,e=e.offsetParent;return n}function ri(e,t,n){const i=e.dataset.answerid,o=n?ai(e,Pn.getScrollEle()):0;pe({url:_e.join("/mp/qna",Object.assign({action:"get_more_reply",answer_id:i,answer_sn:e.dataset.answersn,limit:10},Gn)),dataType:"json",success(t){if(t&&t.reply_info&&t.reply_info.reply_list&&t.reply_info.reply_list.length){const i=ni(t.reply_info,0,!0);i.replyListHtml?(Cn(e.parentNode,"js_qa_reply_list").appendChild(i.replyList),i.leftReplyCount?e.innerHTML=i.leftReplyTips:Xn(e),n&&Pn.scrollTo(0,o-48)):Xn(e)}}})}function si(e){const t=Cn(Rn,"js_get_more_reply_".concat(e));t&&ri(t,0,!0)}function ci(){return Cn(jn,"js_qa_input")}function li(){const e=ci();return(e.value||e.innerHTML).trim()}function di(){li()?Dn.enableBtn():Dn.disableBtn()}function ui(e={}){oi({action:e.action,offset:e.offset,successCb(t,n){if(t&&t.answer_list&&t.answer_list.length){let n,i;"get_my_answer"===e.action?(n=Vn,i=jn,Qn(Cn(jn,"js_qa_write_head"))):(n=Hn,i=Rn);Cn(i,"js_qa_qna_answer_list").appendChild(ii(t.answer_list,!0,n).fragment)}e.cb&&e.cb(t,n)}})}function pi(){if(!jn)return;const e="回复: #value#".replace("#value#",o.encode(Fn)),t=Cn(jn,"js_reply_top_content");Bn?(t.innerHTML=e,Qn(t)):Xn(t)}function mi(e){Cn(jn,"js_alert_toast_word").innerHTML=e,Qn(Cn(jn,"js_alert_toast")),setTimeout((()=>{Xn(Cn(jn,"js_alert_toast"))}),800)}function hi(){let e=0;const t=Rn.getElementsByClassName("js_qa_list_item");for(let n=0;n<t.length&&t[n].getBoundingClientRect().y<Oe.getInnerHeight();n++)e++;e>zn&&(zn=e)}function _i(e,t){if(Pn)return Pn.show(),void(e&&t&&si(t));let n;Rn=Tn.firstChild.cloneNode(!0);const i=Cn(Rn,"qa__list-more"),o=Cn(Rn,"js_qa_write_answer");i&&Xn(i),o&&be.addClass(o,$n),Cn(Rn,"js_qa_qna_answer_list").innerHTML="",Pn=new In(Rn,{title:"读者讨论",extClass:"qa__card",onPullUpLoad(){n>0&&(Pn.showPullUpLoading(),ui({action:"get_more_answer",offset:qn,cb(e,t){Pn.hidePullUpLoading(),e.left_answer_cnt||0!==t.base_resp.ret?Pn.finishPullUpLoad():Pn.showEndLine()}}))},cb(){ui({action:"get_more_answer",offset:qn,cb(i){if(e&&t)si(t);else{const e=En.dataset.count,t=ai(Cn(Rn,"js_qa_list_item",e),Pn.getScrollEle());Pn.scrollTo(0,t-96)}n=i.left_answer_cnt,n||Pn.showEndLine()}})},onScroll(){hi()},onHide(){hi(),ti({EventType:3,Exposure:zn}),zn=0}}),Pn.show(),De.on(Rn,"tap",".js_get_more_reply",(e=>{ri(e.delegatedTarget)}))}function fi(e){let t;const n=Bn?"Reply":"参与讨论";if(Dn)return pi(),Dn.setTitle(n),e?Dn.setCloseBtnStyle("back"):Dn.setCloseBtnStyle("close"),void Dn.show(!0,ci());jn=document.createElement("div"),jn.innerHTML=je.tmpl(yn,{}),Dn=new In(jn,{title:n,top:Jn,extClass:"qa__card qa__card_write",hasBtn:!0,disableTransition:!0,onPullUpLoad(){t>0&&(Dn.showPullUpLoading(),ui({action:"get_my_answer",offset:Wn,cb(e,t){Dn.hidePullUpLoading(),e.left_answer_cnt||0!==t.base_resp.ret?Dn.finishPullUpLoad():Dn.showEndLine()}}))},onHide(){ci().blur()},onScroll(e){"up"===e&&ci().blur()},cb(){ui({action:"get_my_answer",offset:Wn,cb(e){t=e.left_answer_cnt,t||Dn.showEndLine()}})},btnClickCb(){Dn.disableBtn();const e=Bn?"add_reply":"add_answer";Qn(Cn(jn,"js_loading_toast")),pe({url:"/mp/qna?action=".concat(e),type:"POST",dataType:"json",data:Object.assign({answer_id:Nn,answer_sn:Mn,content:li(),my_reply_cnt:Ln+1,ignore_tips:1},Gn),success(e){if(e&&e.base_resp&&0===e.base_resp.ret){if(Qn(Cn(jn,"js_sended_toast")),setTimeout((()=>{Xn(Cn(jn,"js_sended_toast"))}),800),ci().value="",Dn.disableBtn(),Bn&&e.reply_info&&e.reply_info.reply_list){const t=ni(e.reply_info,0,!0).replyList,n=Cn(jn,"js_qa_reply_list_".concat(Nn));n.appendChild(t.cloneNode(!0)),Qn(Cn(n.parentNode,"js_write_reply")),Xn(Cn(n.parentNode.parentNode,"js_write_reply"))}else if(!Bn&&e.answer_info&&e.answer_info.answer_list){const t=Cn(jn,"js_qa_qna_answer_list");t.insertBefore(ii(e.answer_info.answer_list,!0).fragment,t.firstChild),Qn(Cn(jn,"js_qa_write_head"))}}else Dn.enableBtn(),168003===e.base_resp.ret||168007===e.base_resp.ret?mi("内容涉嫌违反平台协议或法规政策"):168004===e.base_resp.ret?mi("关注该公众号才能参与讨论"):168005===e.base_resp.ret?mi("关注该公众号3天及以上才能参与讨论"):168008===e.base_resp.ret||168009===e.base_resp.ret?mi("字数不能多于"+(Bn?140:600)):ei()},error(){ei(),Dn.enableBtn()},complete(){Xn(Cn(jn,"js_loading_toast")),ci().blur()}})},makeFakeInputEle(){const e=ci(),t=e.cloneNode();t.id="tmp_input",t.style.top=0,t.style.position="absolute",e.parentNode.insertBefore(t,e),t.value=e.value,t.scrollTop=e.scrollTop},removeInputEle(){const e=document.getElementById("tmp_input");e&&e.parentNode.removeChild(e)},makeInputEleBigger(){const e=ci(),t="1000px";e.style.borderTop="solid ".concat(t," transparent"),e.style.position="relative",e.style.top="-".concat(t)}}),pi(),Dn.disableBtn(),e?Dn.setCloseBtnStyle("back"):Dn.setCloseBtnStyle("close"),Dn.show(!0,ci()),function(){const e=ci();De.on(jn,"tap",".js_get_more_reply",(e=>{ri(e.delegatedTarget)})),De.on(e,"input",di),De.on(e,"tap",(()=>{Dn.scrollTo(0,0)}))}(),new o.Emotion({emotionPanel:r("#js_qa_emotion_panel"),inputArea:r(ci()),emotionPanelArrowWrp:r("#js_qa_emotion_panel_arrow_wrp"),emotionSwitcher:r("#js_qa_emotion_switch"),emotionSlideWrapper:r("#js_qa_emotion_slide_wrapper"),emotionNavBar:r("#js_qa_emotion_navbar"),inputEmotion(){di()}})}const gi={renderQaCard:function(e={}){Tn&&(Gn.mid=e.mid,Gn.idx=e.idx,On.userUin=e.userUin,On.biz=e.biz,On.itemShowType=e.itemShowType,On.enterId=e.enterId,On.scene=e.scene,On.subScene=e.subScene,On.sessionId=e.sessionId,An=e.isLogin,oi({action:"get_qna_info",successCb(e,t){let n,i,a,r;const c=t.base_resp.ret,l=168001===c,d=t.qna_info&&t.qna_info.question_info;l?Tn.innerHTML=je.tmpl(fn,{qaDeleted:l}):0===c&&("1"===_e.getQuery("js_my_answer")&&(fi(),Zn(4)),e&&e.answer_list&&e.answer_list.length&&(a=ii(e.answer_list,!1).answerListHtml,i=e.answer_list.length,e.left_answer_cnt&&(n="余下#value#条讨论内容".replace("#value#",e.left_answer_cnt))),1===d.can_answer_type&&0===t.qna_info.is_fans?r="作者已设置关注后才可参与讨论":2===d.can_answer_type&&0===t.qna_info.is_fans_days&&(r="作者已设置关注7天后才可参与讨论"),Tn.innerHTML=je.tmpl(fn,{qaDeleted:l,answerCount:i,leftAnswerCnt:n,answerListStr:a,disableAnswerWord:r,title:o.encode(d.question_title.htmlEncode()),nickname:d.biz_info.nickname,isLogin:An}),En=Cn(Tn,"js_more_answer_entry"),function(){let e;function t(){if(e)return;const t=Tn.firstChild,n=s.getOffset(t).offsetTop,i=Oe.getScrollTop();i+Oe.getInnerHeight()>=n&&i<=n+t.offsetHeight&&(ti({EventType:1}),Zn("0"),e=!0)}De.on(Tn,"tap",".js_get_more_reply",(e=>{const t=e.delegatedTarget.dataset.answerid;Yn[t]?_i():(_i(!0,t),Yn[t]=!0)})),De.on(document.body,"click",".js_qa_write_answer",(e=>{Bn=!1,fi(be.hasClass(e.delegatedTarget,$n)),Zn(2)})),De.on(document.body,"click",".js_write_reply",(e=>{const t=e.delegatedTarget,n=t.parentNode.parentNode;if(Nn=t.dataset.answerid,Mn=t.dataset.answersn,n){const e=n.getElementsByClassName("js_qa_reply_content");Ln=n.getElementsByClassName("js_qa_my_reply").length,Fn=e.length?e[e.length-1].innerHTML:Cn(n,"js_qa_item_content").innerHTML}Bn=Nn,Bn&&(fi(!0),Zn(3))})),De.on(En,"click",(()=>{_i(),ti({EventType:2}),Zn(1)})),De.on(document.body,"tap",".js_qa_like",(e=>{const t=e.delegatedTarget,n=be.hasClass(t,Kn);be.toggleClass(t,Kn);const i=Cn(t,"js_like_num");let o=(parseInt(i.dataset.num,10)||0)+(n?-1:1);o=o>=0?o:0,i.innerHTML=Ve.formatReadNum(o),i.dataset.num=o,Zn("2"===t.dataset.type?6:5),pe({url:"/mp/qna?action=like",type:"POST",data:Object.assign({like_type:t.dataset.type,op:n?2:1,answer_id:t.dataset.id,reply_id:t.dataset.id},Gn)})})),De.on(document.body,"tap",".js_delete_answer",(e=>{const t=e.delegatedTarget;Zn(7),setTimeout((()=>{window.weui.confirm("确定删除讨论内容吗？",{buttons:[{label:"Cancel",type:"default"},{label:"Delete",type:"primary",onClick(){pe({url:"/mp/qna?action=del_answer",type:"POST",dataType:"json",data:Object.assign({answer_id:t.dataset.id},Gn),success(e){if(e&&e.base_resp&&0===e.base_resp.ret){const e=t.parentNode.parentNode.parentNode.parentNode;e&&be.hasClass(e,"js_qa_list_item")&&e.parentNode.removeChild(e)}else ei()}})}}]})}),50)})),De.on(document.body,"tap",".js_delete_reply",(e=>{const t=e.delegatedTarget;Zn(8),setTimeout((()=>{window.weui.confirm("Delete this reply?",{buttons:[{label:"Cancel",type:"default"},{label:"Delete",type:"primary",onClick(){pe({url:"/mp/qna?action=del_reply",type:"POST",dataType:"json",data:Object.assign({reply_id:t.dataset.id},Gn),success(e){if(e&&e.base_resp&&0===e.base_resp.ret){const e=t.parentNode.parentNode.parentNode;if(e&&be.hasClass(e,"js_qa_reply_item")){const t=e.parentNode;t.removeChild(e),t.children.length||(Xn(t.parentNode),Xn(Cn(t.parentNode,"js_write_reply")),Qn(Cn(t.parentNode.parentNode,"js_write_reply")))}}else ei()}})}}]})}),50)})),Oe.bindDebounceScrollEvent(t),t()}())}}))}},wi=function(e,t){let n=!1,i=e;if(e===t)n=!0;else for(;i.parentNode&&(i=i.parentNode,1!==i.nodeType||"body"!==i.tagName.toLowerCase());)if(i===t){n=!0;break}return n},yi=function(e){this.biz=e.biz,this.logid=e.logid,this.baseData=e.baseData,this.isPaySubscribe=e.isPaySubscribe,this.container=e.container,this.totalLength=this.container.innerText.length,this.initEvent()};yi.prototype.initEvent=function(){De.on(document,"copy",(()=>{const e=[].concat(this.baseData),t=this.getContentData().trim();t.length&&(e.push(this.totalLength),e.push(""),e.push(t.length),e.push(this.isPaySubscribe),this.report(e.join(",")))}))},yi.prototype.getContentData=function(){const e=document.getSelection(),t=this.container;let n="";if(e&&e.rangeCount){const i=e.getRangeAt(0);if(!i.collapsed){const o=i.startContainer,a=i.startOffset,r=i.endContainer,s=i.endOffset,c=wi(o,t),l=wi(r,t);if(c&&l)n=i.toString();else if(c||l){const e=document.createRange();e.setStart(o,a),e.setEnd(r,s),!l&&e.setEndAfter(t),!c&&e.setStartBefore(t),n=e.toString()}else if(e.containsNode&&e.containsNode(t,!0)){const e=document.createRange();e.setEndAfter(t),e.setStartBefore(t),n=e.toString()}}}return n},yi.prototype.report=function(e){const t=this.biz,n=this.logid;pe({url:"/mp/webcommreport?action=report&report_useruin=1&__biz="+t,type:"POST",data:{logid:n,buffer:e},async:!1,timeout:2e3})};let vi=null;if(window.parent!==window){let e=function(e){let t;console.log("[IFRAME RECEIVE MESSAGE]: ",e),e.origin?t=e.origin:e.originalEvent&&(t=e.originalEvent.origin),/^http(s)?\:\/\/finance\.qq\.com$/.test(t)&&/^http(s)?\:\/\/gu\.qq\.com$/.test(t)&&/^http(s)?\:\/\/wzq\.tenpay\.com$/.test(t)&&e.source&&(e.data,document.getElementsByTagName("body")[0],document.getElementById("activity-name"),document.getElementById("meta_content"),document.getElementById("page-content"))};document.getElementsByTagName("html")[0].style.width="1px",document.getElementsByTagName("html")[0].style.minWidth="100%",document.getElementById("js_content"),document.getElementById("img-content");let t=document.getElementById("page-content");document.getElementsByClassName("rich_media_area_extra")[0].style.display="none",vi=function(e){if(!t)return;console.info("postPageHeightMessage");let n=getComputedStyle(t);["http://finance.qq.com","http://gu.qq.com","https://gu.qq.com","https://wzq.tenpay.com","https://www.tentrees.cn/","https://sticker.weixin.qq.com"].forEach((t=>{window.parent.postMessage({name:e,data:parseFloat(n.height)},t)}))},vi("pageHeight"),window.addEventListener("message",e,!1)}const bi=vi,ki={copyright_top:0};function xi(e){let t=["/mp/copyrightreport?action=report&biz=",biz,"&scene=",e.scene,"&user_uin=",user_uin,"&uin=",uin,"&key=",key,"&pass_ticket=",pass_ticket,"&mid=",window.mid,"&idx=",window.idx,"&source_biz=",window.source_biz,"&source_mid=",window.source_mid,"&source_idx=",window.source_idx,"&card_version=2","&show_appmsg_scene=",window.source,"&session_id=",window.sessionid,"&has_recommend_msg=",window.hasRecommendMsg,"&reprint_type=",window.reprint_type,"&t=",Math.random()].join("");window.isSg&&(t+="&from=sougou"),(new Image).src=t.substr(0,1024)}function Si(){(window.pageYOffset||document.documentElement.scrollTop)+Oe.getInnerHeight()>ki.copyright_top&&(xi({scene:"1",card_pos:"0"}),De.off(window,"scroll",Si),Si=ki.copyright_top=null)}function Ii(e){return document.getElementById(e)}const Ci={card_click_report:xi,card_pv_report:function(){if("2"==__appmsgCgiData.copyright_stat){let e=Ii("copyright_info"),t=Ii("js_article");for(;e&&t!==e;)ki.copyright_top+=e.offsetTop,e=e.offsetParent;De.on(window,"scroll",Si),Si()}}},Ti={oldTagName:"redpacketcover",tagName:"mp-common-redpacket",isWechat:ke.isOnlyWechat,domMap:{},dataMap:{},startTime:window.page_begintime||0,screen_height:Oe.getInnerHeight(),screen_num:0,pvData:[],request_id:encodeURIComponent(window.biz+";"+window.mid+";"+window.idx+";"+window.page_begintime||0),hasBindVisibility:!1,hasBindScroll:!1,needReportNum:0,reportedNum:0},Ai=Object.prototype.hasOwnProperty,Ei=(e={})=>{const t=window.pageYOffset||document.documentElement.scrollTop,n=(window.logs.read_height||t)+Ti.screen_height,i={BizUin:window.biz,MsgId:1*window.mid,Idx:1*window.idx,CoverUri:e.coverUri,Scene:1*window.source,Subscene:1*window.subscene,CoverStatus:1*e.coverStatus,EventType:1*e.eventType,EventScreenNum:Math.ceil(n/Ti.screen_height)||1,ScreenNum:Ti.screen_num,StartTimeMs:Ti.startTime};me.report(19119,i)};let Pi=()=>{const e=(window.pageYOffset||document.documentElement.scrollTop)+Ti.screen_height;for(let t=0;t<Ti.pvData.length;t++){const n=Ti.pvData[t];e>=n.start&&e<=n.end&&(Ti.reportedNum++,Ti.dataMap&&Ti.dataMap[n.coverUri]&&(Ti.dataMap[n.coverUri].reported=!0),Ei({eventType:2,coverUri:n.coverUri,coverStatus:Ti.dataMap[n.coverUri].status}),Ti.pvData.splice(t,1),t--)}Ti.reportedNum>=Ti.needReportNum&&(De.off(window,"scroll",Pi),Ti.pvData=[],Pi=null)};const Ri=(e={})=>{if(!Ti.isWechat)return;Ti.scroll_height=document.body.scrollHeight||document.body.offsetHeight,Ti.screen_num=Math.ceil(Ti.scroll_height/Ti.screen_height);const t=e.node;if(Ti.dataMap[e.coveruri]&&1*Ti.dataMap[e.coveruri].status!=-1&&!Ti.dataMap[e.coveruri].reported){const n=t.getBoundingClientRect();Ti.pvData.push({start:n.top+n.height/2,end:n.top+n.height/2+Ti.screen_height,coverUri:e.coveruri})}Ti.pvData.length>0&&(!Ti.hasBindScroll&&Pi&&(Ti.hasBindScroll=!0,De.on(window,"scroll",Pi)),Pi())};let Di=null;Di=(e={})=>{if(!e.node||!e.data||!e.data.coveruri)return;const{data:t={},node:n=null,isUpdate:i}=e;for(const o in t)Ai.call(t,o)&&n.setAttribute("data-".concat(o),encodeURIComponent(t[o]));if(n.classList.add("js_wx_tap_highlight"),!i&&t.receiveimg){const e=n.parentNode.querySelector('[data-preloadingid="'+t.coveruri+'"]');e&&e.parentNode.removeChild(e),Ti.domMap[t.coveruri]=n,((e={})=>{Ti.dataMap[e.coveruri]&&De.on(e.dom,"click",(function(){if(window.is_temp_url)new Be({msg:"预览时不支持领取红包封面"});else if(!Ti.isWechat||ke.isNewMpApp)new Be({msg:"请在微信客户端打开"});else{const t=e.dom.getAttribute("data-coveruri")||"",n=t&&Ti.dataMap[t]?Ti.dataMap[t].redirect_url:"";n&&(Ei({eventType:1,coverUri:t,coverStatus:Ti.dataMap[t].status}),xe.invoke("openUrlWithExtraWebview",{url:n,openType:1},(function(e){-1===e.err_msg.indexOf("ok")&&(location.href=n)})))}})),!Ti.hasBindVisibility&&Ti.isWechat&&(Ti.hasBindVisibility=!0,Oe.listenStateChange({cb:function(e){"onResume"!==e.state_change&&"onResume"!==e.state||pe({type:"GET",dataType:"json",url:"/mp/wapredpacketcover?action=get_red_packet_cover_data&__biz="+window.biz+"&mid="+window.mid+"&idx="+window.idx+"&sn="+window.sn+"&send_time="+window.send_time,timeout:1e4,success:e=>{if(e&&e.base_resp&&1*e.base_resp.ret==0&&e.red_packet_cover_data&&e.red_packet_cover_data.cover_uri_data&&e.red_packet_cover_data.cover_uri_data.length>0){const t=e.red_packet_cover_data.cover_uri_data;for(let e=0,n=t.length;e<n;e++){const n=t[e],i=Ti.domMap[n.cover_uri],o=Ti.dataMap[n.cover_uri];if(o&&i){const e=1*o.status,t=1*n.status;-1!==t&&e!==t&&(o.status=t,Di({data:o,node:i,isUpdate:!0}))}}}}})}}))})({dom:n,coveruri:t.coveruri}),Ri({node:n,coveruri:t.coveruri})}};const ji=e=>{const t={receive_image:"receiveimg",cover_uri:"coveruri",is_synthetic:"synthetic"};for(const n in t)Ai.call(t,n)&&(e[t[n]]=e[n],delete e[n])},Oi={init:()=>{const e=document.querySelectorAll(Ti.tagName);if(window.__appmsgCgiData&&1*window.__appmsgCgiData.has_red_packet_cover==1){if(!Ti.isWechat)for(let t=0,n=e.length;t<n;t++){const n=e[t],i=n.getAttribute("data-coveruri")||"";let o=decodeURIComponent(i),a=decodeURIComponent(n.getAttribute("data-receiveimg")||"");const r=decodeURIComponent(n.getAttribute("data-synthetic")||"");if(o=o.replace("http:","https:"),a=a.replace("http:","https:"),o&&a&&/^http(s)?:\/\/mmcomm\.qpic\.cn([\/?].*)*$/i.test(a)){const e={coveruri:o,status:0,name:"",redirect_url:"",receiveimg:a,synthetic:r};Ti.dataMap[o]=e,Di({data:e,node:n,isUpdate:!1})}}}else e.length>0&&window.__addIdKeyReport&&window.__addIdKeyReport("27613","51",1)},render:(e={})=>{if(!e.list||0===e.list.length)return;for(let o=0,a=e.list.length;o<a;o++){const t=e.list[o];ji(t),Ti.dataMap[t.coveruri]=t}const t=document.querySelectorAll(Ti.oldTagName),n=["coveruri","bizuin","receiveimg","name","synthetic","pluginname","orderid","w","ratio"];for(const o of t){const e=document.createElement(Ti.tagName);o.parentNode.appendChild(e),o.parentNode.removeChild(o);for(const t of n){const n="data-".concat(t);e.setAttribute(n,o.getAttribute(n))}}const i=document.querySelectorAll(Ti.tagName);e.list.length!==i.length&&window.__addIdKeyReport&&window.__addIdKeyReport("27613","51",1),Ti.needReportNum=i.length;for(let o=0,a=i.length;o<a;o++){const e=i[o],t=e.getAttribute("data-coveruri")||"",n=decodeURIComponent(t),a=Ti.dataMap[n];if(a&&1*a.status!=-1){if(a.redirect_url){let e=a.redirect_url.html(!1);e=_e.addParam(e,"request_id",Ti.request_id,!0);const t=_e.parseUrl(e);t.hash?-1===t.hash.indexOf("wechat_redirect")&&(e+="&wechat_redirect"):e+="#wechat_redirect",a.redirect_url=e}a.synthetic_widget_url?(a.synthetic=1,a.receiveimg=a.synthetic_widget_url):a.synthetic=0,Di({data:a,node:e,isUpdate:!1})}}}},Bi=document.getElementById("js_tags_preview_toast");let Li=null;const Ni={init(e){if(1===window.reprint_style||2===window.reprint_style||3===window.reprint_style||1*e.dataset.len==0)return;const t=e=>{if(window.is_temp_url)Bi&&(Bi.style.display="",Li&&clearTimeout(Li),Li=setTimeout((()=>{Bi.style.display="none",Li=null}),3e3));else{const t={};let n=e.url;t.scene=window.source,t.subscene=window.subscene,t.sessionid=window.sessionid,t.enterid=window.enterid;let i=0;window.isPayTopic&&(i=0===window.isPaid?1:2),Le({eventType:2,albumId:e.album_id,albumType:0,tagSrc:e.tag_source,canPaid:window.isPayTopic,price:window.isPayTopic?window.payTopicPrice:0,ifPaid:i}),Se.goUrl(n,Object.assign({},t,{scene:173,from_msgid:window.mid,from_itemidx:window.idx,count:3,nolastread:1}))}};if(be.hasClass(e,"js_single")){const n=e.querySelector(".js_tag").dataset;De.on(e,"click",(()=>t(n)))}else De.on(e,"click",(n=>{let i=n.target;i&&i!==e&&!be.hasClass(i,"js_tag")&&(i=i.parentNode),i&&be.hasClass(i,"js_tag")&&t(i.dataset)}));const n=t=>{const i=Oe.getInnerHeight()+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);e.offsetTop<i?("function"!=typeof t&&De.off(window,"scroll",n),Array.prototype.forEach.call(e.getElementsByClassName("js_tag"),(e=>{const t=e.dataset;let n=0;window.isPayTopic&&(n=0===window.isPaid?1:2),Le({eventType:1,albumId:t.album_id,albumType:0,tagSrc:t.tag_source,canPaid:window.isPayTopic,price:window.isPayTopic?window.payTopicPrice:0,ifPaid:n})}))):"function"==typeof t&&t()};n((()=>{De.on(window,"scroll",n)}))}};const Mi=pt({name:"mp-album",filters:{htmlDecode:e=>"".concat(e).html(!1)},props:{albumTags:{type:Array,default:()=>[]}},computed:{showAlbum(){return this.albumTags.length>0}},mounted(){Ni.init(this.$refs.albumArea)}},(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.showAlbum,expression:"showAlbum"}],ref:"albumArea",staticClass:"article-tag__list",attrs:{"data-len":e.albumTags.length}},[t("div",{staticClass:"article-tags"},e._l(e.albumTags,(function(n,i){return t("div",{key:i,staticClass:"article-tag__item-wrp js_tag weui-wa-hotarea js_wx_tap_highlight wx_tap_link",attrs:{"data-url":n.link.htmlDecode()||"/mp/publictag?action=get&tag_id=".concat(n.tagId,"&start=0"),"data-tag_id":n.tagId,"data-album_id":n.albumId,"data-tag_source":n.tagSource,role:"link",tabindex:"0"}},[t("span",{staticClass:"article-tag__item"},[t("i",{staticClass:"weui-icon-album"}),e._v(e._s(e._f("htmlDecode")(n.title)))]),n.size>0?t("span",{staticClass:"article-tag__item-num"},[t("span",{attrs:{id:""}},[e._v(e._s(n.size))])]):e._e()])})),0)])}),[],!1,null,null,null,null).exports,qi=[2390745668,3099420829,3872121626,3203738065,3072206507,3566970574,3002803029,3099387730,3559965496,3525314097,2390323860,3084276724,3289028514,3003793452,3003972371,2398512110,3071748654,3233018348,3095049467,3076061592,3273032305,3264278949,3086344434,3014829842,3294546013,2058310401,2397841479,2397640820,3282179238,3072107639,3521076442,3554888231,2397274880,2394106525,3077726226,2103095721,3593723769,2395186785,2393698643,3944000110,2397445840,2394144447,3082139483,3070806332,3016714421,3006879186,3213574124,3221398587,3078448935,3591999034,3551390431];mt(window.user_uin);const Wi=["testrd","otherrd"];let zi=0;try{zi=1*window.atob(window.biz)}catch(su){}let Fi={report_action:2,share_type:5};function Ui(e,t,n){let i="",o="";try{""!=tid&&(o="tid="+tid+"&aid=54");let a=e.split("?")[1]||"";if(a=a.split("#")[0],""==a);else{let r=[a,"mpshare=1","scene="+t,"srcid="+srcid,"sharer_shareinfo="+n],s=_e.getQuery("sharer_shareinfo_first")||_e.getQuery("sharer_shareinfo");if(s?r.push("sharer_shareinfo_first="+s):r.push("sharer_shareinfo_first="+n),""!=o&&r.push(o),a=r.join("&"),2===t&&qi&&qi.indexOf(zi)>-1){let t=Math.floor(Math.random()*Wi.length),n=Wi[t];i=e.split("?")[0]+"?"+a+"&testtype=".concat(n)+"#"+(e.split("#")[1]||"")}else i=e.split("?")[0]+"?"+a+"#"+(e.split("#")[1]||"")}}catch(su){i=""}return i||(i=location.href+"#wechat_redirect",ue.setLogs({id:28307,key:47,value:1,log:"[share_link]["+encodeURIComponent(location.href)+"]["+encodeURIComponent(e)+"]["+encodeURIComponent(msg_link)+"]"})),i}xe.call("hideToolbar"),xe.call("showOptionMenu");let Hi=msg_title.htmlDecode(),Vi="",Ki=cdn_url_1_1||msg_cdn_url||ori_head_img_url||round_head_img,$i=Ki,Ji=msg_link.htmlDecode(),Gi=msg_desc.htmlDecode();function Yi(e,t,n,i,o=0){Ie.shareReport({link:e,action_type:n,sharer_shareinfo:i,share_source:window.customShareSource||(0===o?1:2)})}function Xi(e,t){return e.isCDN()&&(e=_e.addWxfrom(e,t)),e}Gi=Gi||" ",Gi=Gi.replace(/<br\/>/g,"\n"),idx>1&&document.getElementById("js_content")&&ct<1446652800&&(Gi=document.getElementById("js_content").innerHTML.replace(/<\/?[^>]*\/?>/g,"").htmlDecode().replace(/^(\s*)|(\s*)$/g,"").substr(0,54)),window.isPayTopic&&(Gi="收录于付费合集"+window.payTopicTitle||""),Ki=Ki.compressCDNImgSize(),$i=$i.compressCDNImgSize(),malicious_title_reason_id&&(Hi=c.maliciousTitleMap[malicious_content_type][malicious_title_reason_id]||Hi,Gi=c.maliciousDescMap[malicious_content_type][malicious_title_reason_id]||Gi,1!=malicious_content_type&&(Ki="https://mmbiz.qlogo.cn/mmbiz_png/cVgP5bCElFiayFgbgEB9iaDt7hLicfz9RrXGM0LpaQ0TUic2gP7lbbqU3jCD8ibonicgIa3p99yjx1f1P26HChraeRUg/0?wx_fmt=png")),("1"==is_limit_user||window.cps_article_data)&&xe.call("hideOptionMenu"),window.is_temp_url&&xe.invoke("hideMenuItems",{menuList:["menuItem:share:timeline","menuItem:share:qq","menuItem:share:weiboApp","menuItem:share:facebook","menuItem:share:qzone","menuitem:share:weibo","menuItem:share:WeiboApp","menuItem:share:QZone","menuitem:facebook","menuItem:copyUrl","menuItem:share:email","menuitem:copy_url","menuitem:share:haokan"]},(function(e){}));let Qi="https://res.wx.qq.com/op_res/Fwh9olR917lxUMxpJVM5sCCyrQOJSm68IEt-HfL7vpc5-_etzmyuLg1kPdU6RNRX";function Zi(){let e=mt(window.user_uin+"_"+Date.now());if(window.is_wash)return{img_url:Qi,img_width:"640",img_height:"640",link:Ui(Ji,2,e),desc:"",title:"Article constitutes content laundering. You can read the content of the original author below."};{let t=Ki;ke.isIOS||(t=Xi(Ki,"2"));let n={img_url:t,img_width:"640",img_height:"640",link:Ji,desc:Gi,title:Hi};if(window.customShareInfo&&"object"==typeof window.customShareInfo&&Object.assign(n,window.customShareInfo),"string"==typeof n.forbid_msg){let e=n.forbid_msg.replace("#op#","Share");return void(window.weui||window).alert(e)}return n.link=Ui(n.link,2,e),n}}function eo(){const e=function(){let e=mt(window.user_uin+"_"+Date.now());if(window.is_wash)return{img_url:Qi,img_width:"640",img_height:"640",link:Ui(Ji,type,e),desc:"You can read the content of the original author below.",title:"Article constitutes content laundering."};{let t=1,n=Xi(Ki,"1");1==malicious_content_type&&(n="https://mmbiz.qlogo.cn/mmbiz_png/cVgP5bCElFiayFgbgEB9iaDt7hLicfz9RrXGM0LpaQ0TUic2gP7lbbqU3jCD8ibonicgIa3p99yjx1f1P26HChraeRUg/0?wx_fmt=png");let i={appid:Vi,img_url:n,img_width:"640",img_height:"640",link:Ji,desc:Gi,title:Hi};if(window.customShareInfo&&"object"==typeof window.customShareInfo&&Object.assign(i,window.customShareInfo),"string"==typeof i.forbid_msg){let e=i.forbid_msg.replace("#op#","Share");return void(window.weui||window).alert(e)}return i.link=Ui(i.link,t,e),i}}();e&&xe.invoke("shareCustomContent",{friend:e,timeline:Zi()},(t=>{console.info("shareCustomContent res",t);let n=mt(window.user_uin+"_"+Date.now());Yi(Ji,0,1,n,2),l.commit("mp-related-article/setSources","share"),e.vid&&(Fi=Object.assign(Fi,{vid:e.vid,share_type:2}),d.reportKanData(Fi))}))}xe.on("menu:share:appmessage",(function(e){let t=mt(window.user_uin+"_"+Date.now());if(window.is_wash)kt({img_url:Qi,img_width:"640",img_height:"640",link:Ui(Ji,type,t),desc:"You can read the content of the original author below.",title:"Article constitutes content laundering."},(function(n){Yi(Ji,fakeid,type,t,e.shareScene)}));else{let n=1,i=Xi(Ki,"1");if(e&&"favorite"==e.scene&&(n=24,i=Xi(Ki,"4"),l.commit("mp-related-article/setSources",["favorite"]),ke.isWindowsWechat&&"207"===_e.getQuery("subscene"))){const e=ke.getWindows();if(e&&parseInt(e,16)>=parseInt("0x63090500",16)&&parseInt(e,16)<=parseInt("0x630905FF",16))return void xe.invoke("handleMPPageAction",{action:"doFavorite"},(function(e){e.err_msg&&e.err_msg.indexOf("ok")>0?weui.toast("已收藏"):weui.toast("收藏失败")}))}1==malicious_content_type&&(i="https://mmbiz.qlogo.cn/mmbiz_png/cVgP5bCElFiayFgbgEB9iaDt7hLicfz9RrXGM0LpaQ0TUic2gP7lbbqU3jCD8ibonicgIa3p99yjx1f1P26HChraeRUg/0?wx_fmt=png");let o={appid:Vi,img_url:i,img_width:"640",img_height:"640",link:Ji,desc:Gi,title:Hi};if(window.customShareInfo&&"object"==typeof window.customShareInfo&&Object.assign(o,window.customShareInfo),"string"==typeof o.forbid_msg){let t=o.forbid_msg.replace("#op#","favorite"===e.scene?"Favorite":"Share");return void(window.weui||window).alert(t)}o.link=Ui(o.link,n,t),kt(o,(function(e){Yi(Ji,fakeid,n,t,0),l.commit("mp-related-article/setSources",[24===n?"favorite":"share"]),o.vid&&(Fi=Object.assign(Fi,{vid:o.vid,share_type:2}),d.reportKanData(Fi))}))}})),xe.on("menu:share:timeline",(function(e){let t=mt(window.user_uin+"_"+Date.now());if(window.is_wash)xt({img_url:Qi,img_width:"640",img_height:"640",link:Ui(Ji,2,t),desc:"",title:"Article constitutes content laundering. You can read the content of the original author below."},(function(n){Yi(Ji,fakeid,2,t,e.shareScene)}));else{let n=Ki;ke.isIOS||(n=Xi(Ki,"2"));let i={img_url:n,img_width:"640",img_height:"640",link:Ji,desc:Gi,title:Hi};if(window.customShareInfo&&"object"==typeof window.customShareInfo&&Object.assign(i,window.customShareInfo),"string"==typeof i.forbid_msg){let e=i.forbid_msg.replace("#op#","Share");return void(window.weui||window).alert(e)}i.link=Ui(i.link,2,t),xt(i,(function(n){Yi(Ji,fakeid,2,t,e.shareScene),l.commit("mp-related-article/setSources",["share"]),i.vid&&(Fi=Object.assign(Fi,{vid:i.vid,share_type:1}),d.reportKanData(Fi))}))}})),xe.on("menu:share:weiboApp",(function(e){let t=mt(window.user_uin+"_"+Date.now());xe.invoke("shareWeiboApp",{img_url:Ki,link:Ui(Ji,3,t),title:Hi},(function(e){Yi(Ji,fakeid,3,t)}))})),xe.on("menu:share:facebook",(function(e){let t=mt(window.user_uin+"_"+Date.now());Yi(Ji,fakeid,7,t),xe.invoke("shareFB",{img_url:$i,img_width:"640",img_height:"640",link:Ui(Ji,43,t),desc:Gi,title:Hi},(function(e){}))})),xe.on("menu:share:QZone",(function(e){let t=Xi(Ki,"6"),n=mt(window.user_uin+"_"+Date.now());Yi(Ji,fakeid,5,n),xe.invoke("shareQZone",{img_url:t,img_width:"640",img_height:"640",link:Ui(Ji,22,n),desc:Gi,title:Hi},(function(e){}))})),xe.on("menu:share:qq",(function(e){let t=Xi(Ki,"7"),n=mt(window.user_uin+"_"+Date.now());Yi(Ji,fakeid,5,n),xe.invoke("shareQQ",{img_url:t,img_width:"640",img_height:"640",link:Ui(Ji,23,n),desc:Gi,title:Hi},(function(e){}))})),xe.on("menu:share:email",(function(e){let t=mt(window.user_uin+"_"+Date.now());Yi(Ji,fakeid,5,t),xe.invoke("sendEmail",{content:Ui(Ji,5,t),title:Hi},(function(e){}))})),xe.on("sys:record",(function(e){xe.invoke("recordHistory",{link:Ji,title:Hi,source:nickname,img_url:Ki},(function(e){}))}));const to={itemClassName:"album_read_directory_item",albumId:window.appmsg_album_info.id,pageCount:10,isPC:ke.isWindows||ke.isMac&&!ke.isIOS,isInsertBlock:!1};let no;const io="&cur_album_id=".concat(to.albumId),oo=document.createElement("div");function ao(){const e=document.createElement("div"),t=document.createElement("span");return t.setAttribute("role","option"),t.innerHTML='<span aria-label="合集：">#</span>'.concat(window.appmsg_album_info.title),e.appendChild(t),e.innerHTML}function ro(){const e=document.createElement("div");e.style.position="relative",e.style.cursor="pointer",e.setAttribute("role","listbox");let t,n,i,o,a,r=[],s=!0,c=!0,l=1;function d(e,r=!1,s=!0){const c=document.createDocumentFragment();if(n)if(r){l=1;for(let t=0;t<e.length;t++)if(e[t].msgid.toString()===window.appmsgid.toString()&&e[t].itemidx.toString()===window.idx.toString()){l=t;break}e.forEach(((e,n)=>{e.index=i?t-(n-l):t+(n-l)}))}else s?e.forEach(((e,t)=>{e.index=i?a.index-t-1:a.index+t+1})):e.forEach(((t,n)=>{t.index=i?o.index+(e.length-n):o.index-(e.length-n)}));return e.forEach((e=>{const t=document.createElement("div");if(be.addClass(t,to.itemClassName),e.msgid.toString()===window.mid.toString()&&e.itemidx.toString()===window.idx.toString()?be.addClass(t,"album_read_directory_current"):1===e.user_read_status&&(be.addClass(t,"album_read_directory_disabled"),be.addClass(t,"js_wx_tap_highlight"),be.addClass(t,"wx_tap_cell")),n){const n=document.createElement("span");n.className="album_read_directory_item_index",n.innerText="".concat(e.index,"."),t.appendChild(n)}const i=document.createElement("span");i.className="album_read_directory_title_wrp";const o=document.createElement("span");o.className="album_read_directory_title_wrp",o.innerText=e.title,i.appendChild(o),t.setAttribute("data-url",e.url),t.setAttribute("role","option");const a=document.createElement("span");if(e.is_paid){const e="Paid";be.addClass(a,"wx_icon_pay_tag"),be.addClass(a,"wx_icon_pay_tag_paid"),a.innerText=e,i.appendChild(a)}else if(e.is_pay_subscribe){const e="Pay";be.addClass(a,"wx_icon_pay_tag"),a.innerText=e,i.appendChild(a)}t.appendChild(i),c.appendChild(t)})),c}function u(e){1*e.reverse_continue_flag||(s=!1,no.disablePullDownLoad()),1*e.continue_flag||(c=!1)}const p={extClass:"album_read_directory weui-half-screen-dialog_fold",hasBtn:!0,btnSlot:'<div id="js_topic_detail" class="weui-btn__word-wrp">\n                  <span class="weui-btn__word">Details</span>\n                  <i class="weui_right_arrow"></i>\n                </div>',title:ao(),btnClickCb(){Ne({ActionType:6}),Me(15),function(){const e=window.appmsg_album_info;if(e.link){const t=e.link.replace("#wechat_redirect","&subscene=159&subscene=".concat(window.source,"&scenenote=").concat(encodeURIComponent(window.location.href),"&nolastread=1#wechat_redirect"));Ke.openUrlWithExtraWebview(t.htmlDecode())}}()},cb(){var r;r=r=>{no.hideLoading(),i=r.base_info.is_reverse,t=r.base_info.cur_article_num,n=r.base_info.is_numbered,e.appendChild(d(r.article_list,!0)),o=r.article_list[0],a=r.article_list[r.article_list.length-1],u(r),c||no.showEndLine(),s&&(e.firstChild.parentNode.insertBefore(oo,e.firstChild),to.isInsertBlock=!0,no.scrollTo(0,e.firstChild.offsetTop+1));const p=e.childNodes[l];setTimeout((()=>{p.offsetTop+p.clientHeight>no.contentAreaWrp.clientHeight&&no.scrollTo(0,e.offsetHeight)}),200)},pe({type:"GET",url:"/mp/appmsgalbum?action=paging&__biz=".concat(window.biz,"&album_id=").concat(to.albumId,"&cur_msgid=").concat(window.appmsgid,"&cur_itemidx=").concat(window.idx,"&count=").concat(to.pageCount),timeout:5e3,dataType:"json",success:function(e){e.base_resp&&0===e.base_resp.ret&&r(e.getalbum_resp)},error(){console.log("[error]")}})},onShow(){Ne({ActionType:4}),Me(14)},onPullUpLoad(){c&&(no.showPullUpLoading(),pe({type:"GET",url:"/mp/appmsgalbum?action=paging&__biz=".concat(window.biz,"&album_id=").concat(to.albumId,"&begin_msgid=").concat(a.msgid,"&begin_itemidx=").concat(a.itemidx,"&count=").concat(to.pageCount),timeout:5e3,dataType:"json",success:function(t){no.hidePullUpLoading();if(0===(t.base_resp&&1*t.base_resp.ret)){const n=t.getalbum_resp.article_list;u(t.getalbum_resp),e.appendChild(d(n,!1,!0)),r=r.concat(n),no.finishPullUpLoad(),a=r[r.length-1],1*t.getalbum_resp.continue_flag||no.showEndLine()}},error:function(){}}))},onPullDownLoad(){s&&(to.isInsertBlock&&(oo.parentNode.removeChild(oo),to.isInsertBlock=!1),no.showPullDownLoading(),pe({type:"GET",url:"/mp/appmsgalbum?action=paging&__biz=".concat(window.biz,"&album_id=").concat(to.albumId,"&begin_msgid=").concat(o.msgid,"&begin_itemidx=").concat(o.itemidx,"&count=").concat(to.pageCount,"&isbackward=1"),timeout:5e3,dataType:"json",success:function(t){no.hidePullDownLoading();if(0===(t.base_resp&&1*t.base_resp.ret)){const n=t.getalbum_resp.article_list,i=t.getalbum_resp.continue_flag;t.getalbum_resp.continue_flag=t.getalbum_resp.reverse_continue_flag,t.getalbum_resp.reverse_continue_flag=i,u(t.getalbum_resp);const a=d(n,!1,!1),s=e.firstChild;e.insertBefore(a,s),r=n.concat(r),no.scrollTo(0,s.offsetTop-62),setTimeout((()=>{no.finishPullDownLoad()}),500),o=r[0]}},error:function(){}}))}};var m;window.appmsg_album_info.size<=4&&(p.top="".concat(screen.height/2-(screen.height-window.innerHeight),"px")),no=new In(e,p),no.showLoading(),!to.isPC&&no.show(),(m=e)&&De.on(m,"click",".".concat(to.itemClassName),(e=>{const t=e.delegatedTarget;if(be.hasClass(t,"album_read_directory_current"))return;let n;n=t.dataset.url.includes("#")?t.dataset.url.replace("#","".concat(io,"&scene=190#")):t.dataset.url+"".concat(io,"&scene=190"),Ne({ActionType:5,Url:n}),Se.jumpUrl(n,!0,{useFastLoad:!0}),be.addClass(t,"album_read_directory_disabled")}))}oo.style.height="1px";const so=pt({name:"mp-keep-read",components:{[u.name]:u},data:()=>({isPC:ke.isWindows||ke.isMac&&!ke.isIOS}),computed:{...p({appmsgAlbumInfo:e=>e.cgiData.appmsg_album_info,appmsgAlbumExtInfo:e=>{var t,n;return(null==(t=e.extRes)?void 0:t.appmsg_album_extinfo)||(null==(n=e.cgiData)?void 0:n.appmsg_atricle_album_info)}}),showCard(){return this.appmsgAlbumExtInfo&&(this.appmsgAlbumExtInfo.pre_article_link||this.appmsgAlbumExtInfo.next_article_link)}},watch:{appmsgAlbumExtInfo:{handler(){this.showCard&&this.$nextTick((()=>{this.initExposeReport()}))},immediate:!0}},methods:{onShow(){!he.os.pc&&document.body.classList.add("page_no_scroll")},onHide(){!he.os.pc&&document.body.classList.remove("page_no_scroll")},showBottomModal(){no?!this.isPC&&no.show():ro(),this.isPC&&(this.$refs.albumKeepRead.style.overflow="visible",no.contentAreaWrp.style.height="355px",no.endLine.childNodes[3].style.background="var(--weui-BG-5)",this.$refs.pcPopoverContent.appendChild(no.contentAreaWrp))},jumpPrev(){let e;Ne({ActionType:2,SubActionType:1}),Me(12),e=this.appmsgAlbumExtInfo.pre_article_link.includes("#")?this.appmsgAlbumExtInfo.pre_article_link.replace("#","".concat(io,"&scene=189#")):this.appmsgAlbumExtInfo.pre_article_link+"".concat(io,"&scene=189"),location.href=e.replace(/&amp;/g,"&")},jumpNext(){let e;Ne({ActionType:2,SubActionType:2}),Me(13),e=this.appmsgAlbumExtInfo.next_article_link.includes("#")?this.appmsgAlbumExtInfo.next_article_link.replace("#","".concat(io,"&scene=189#")):this.appmsgAlbumExtInfo.next_article_link+"".concat(io,"&scene=189"),location.href=e.replace(/&amp;/g,"&")},gotoAlbumInfo(){if(Ne({ActionType:6}),Me(15),this.appmsgAlbumInfo.link){const e=this.appmsgAlbumInfo.link.replace("#wechat_redirect","&subscene=159&subscene=".concat(window.source,"&scenenote=").concat(encodeURIComponent(window.location.href),"&nolastread=1#wechat_redirect"));Ke.openUrlWithExtraWebview(e.htmlDecode())}},initExposeReport(){let e;const{albumKeepRead:t}=this.$refs,n=t&&t.offsetHeight/2||0;function i(){if(e)return;const i=s.getOffset(t).offsetTop||0,o=Oe.getScrollTop();o+Oe.getInnerHeight()>=i+n&&o<=i+n&&(Ne({ActionType:1}),Me(11),e=!0)}Oe.bindDebounceScrollEvent(i),i()}}},(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.showCard,expression:"showCard"}],ref:"albumKeepRead",staticClass:"appmsg_card_context album_read_card"},[e.showCard?[t("div",{staticClass:"album_read_hd weui-flex",attrs:{role:"button"},on:{click:function(t){return t.stopPropagation(),e.showBottomModal.apply(null,arguments)}}},[e.isPC?t("mp-popover",{attrs:{"wrp-class":"popover-wrp-class","ext-class":"popover-ext-class"},on:{show:e.onShow,hide:e.onHide}},[t("div",{staticClass:"album_read_source",attrs:{slot:"target"},slot:"target"},[t("span",{staticClass:"wx_tap_link js_album_directory__name"},[e._v(e._s(e.appmsgAlbumInfo.title.htmlDecode())+" · 目录")]),t("i",{staticClass:"weui-icon-read"})]),t("div",{staticClass:"album_name_title",attrs:{slot:"title"},on:{click:function(t){return t.stopPropagation(),e.gotoAlbumInfo.apply(null,arguments)}},slot:"title"},[e._v("#"+e._s(e.appmsgAlbumInfo.title.htmlDecode()))]),t("div",{ref:"pcPopoverContent"})]):t("div",{staticClass:"album_read_source"},[t("span",{staticClass:"wx_tap_link js_album_directory__name"},[e._v(e._s(e.appmsgAlbumInfo.title.htmlDecode())+" · 目录")]),t("i",{staticClass:"weui-icon-read"})])],1),t("div",{staticClass:"album_read_bd weui-flex"},[e.appmsgAlbumExtInfo.pre_article_link?t("span",{staticClass:"album_read_nav_item album_read_nav_prev weui-flex__item wx_tap_link js_wx_tap_highlight",attrs:{role:"button"},on:{click:e.jumpPrev}},[t("span",{staticClass:"album_read_nav_inner"},[t("span",{staticClass:"album_read_nav_btn"},[e._v("上一篇")]),t("span",{staticClass:"album_read_nav_title"},[t("span",{staticClass:"album_read_nav_title_inner"},[e._v(e._s(e.appmsgAlbumExtInfo.pre_article_title.htmlDecode()||""))])])])]):e._e(),e.appmsgAlbumExtInfo.next_article_link?t("span",{staticClass:"album_read_nav_item album_read_nav_next weui-flex__item wx_tap_link js_wx_tap_highlight",attrs:{role:"button"},on:{click:e.jumpNext}},[t("span",{staticClass:"album_read_nav_inner"},[t("span",{staticClass:"album_read_nav_btn"},[e._v("下一篇")]),t("span",{staticClass:"album_read_nav_title"},[t("span",{staticClass:"album_read_nav_title_inner"},[e._v(e._s(e.appmsgAlbumExtInfo.next_article_title.htmlDecode()||""))])])])]):e._e()])]:e._e()],2)}),[],!1,null,null,null,null).exports;const co=pt({name:"mp-pay-wall",filters:{formatNum:e=>e>=1e4?"en"===window.LANG?"10k+":"1万+":e},data:()=>({perLine:m.getCountPerLine()}),computed:{...p(["cgiData","extRes"]),...p("mp-pay-read",["paySubscribeInfo"]),total(){return 3*this.perLine},wrapWidth(){return 40*this.perLine-8},avatarList(){var e,t,n,i;return this.paySubscribeInfo?this.cgiData.isPaid&&!this.cgiData.payFreeGift?[null==(e=this.paySubscribeInfo)?void 0:e.my_head_img_info,...((null==(t=this.paySubscribeInfo)?void 0:t.pay_head_img_infos)||[]).slice(0,this.total-1)]:(null==(i=null==(n=this.paySubscribeInfo)?void 0:n.pay_head_img_infos)?void 0:i.slice(0,this.total))||[]:[]}},methods:{onPayNumClick(){m.goUrl("/mp/paysub?action=evaluate_show_page&__biz=".concat(this.cgiData.biz,"&product_type=").concat(this.cgiData.productPayPackage.product_type,"&product_id=").concat(this.cgiData.productPayPackage.product_id,"&sn=").concat(this.cgiData.sn,"&link=").concat(encodeURIComponent(this.cgiData.msg_link),"&from_scene=").concat(this.cgiData.source,"&from_subscene=").concat(this.cgiData.subscene,"&is_fans=").concat(this.cgiData.isFans))},onRewardNumClick(){const e=(Math.ceil((Oe.getInnerHeight()-188)/42)+1)*Math.floor((innerWidth-15)/42);m.goUrl("/mp/reward?act=getrewardheads&__biz=".concat(this.cgiData.biz,"&appmsgid=").concat(this.cgiData.mid,"&idx=").concat(this.cgiData.idx,"&sn=").concat(this.cgiData.sn,"&offset=0&count=").concat(e,"&source=1"))}}},(function(){var e=this,t=e._self._c;return e.paySubscribeInfo&&e.paySubscribeInfo.pay_cnt?t("div",{staticClass:"pay__detail-wrp pay__detail-wrp_inner pay__detail-wrp_v2",attrs:{id:"js_pay_wall_wrap"}},[t("div",{staticClass:"pay__detail"},[t("div",{staticClass:"pay__detail-content"},[t("div",{staticClass:"pay__detail-summary",on:{click:e.onPayNumClick}},[t("span",[e._v(e._s(e._f("formatNum")(e.paySubscribeInfo&&e.paySubscribeInfo.pay_cnt))+" 人付费")]),e.extRes.reward_total_count?t("span",[e._v("，"+e._s(e._f("formatNum")(e.extRes.reward_total_count))+" 人喜欢")]):e._e(),t("i",{staticClass:"weui-icon-arrow reward_area_arrow"})]),t("div",{staticClass:"pay__detail-wall-wrp",style:{width:"".concat(e.wrapWidth,"px")}},[t("div",{staticClass:"pay__detail-wall",attrs:{id:"js_pay_wall"}},e._l(e.avatarList,(function(n){return t("div",{key:n.head_img_url,class:"pay__avatar-wrp ".concat(n.hide_status>0?"pay__avatar-mask":"")},[t("img",{attrs:{alt:"",src:n.head_img_url}}),n.reward_status?t("div",{staticClass:"pay__tag-reward js_reward"}):e._e()])})),0)])])])]):e._e()}),[],!1,null,null,null,null).exports;const lo=pt({name:"mp-pay-btn",props:{buttonText:{type:String,default:"微信豆兑换"}},computed:{...p(["cgiData"]),...p("mp-pay-read",["loading","isInMiniProgram"])},methods:{...h("mp-pay-read",["payFunc"])}},(function(){var e=this,t=e._self._c;return t("button",{ref:"payPanelBtn",staticClass:"js_pay_btn js_article_bottom weui-btn weui-btn_loading",class:{btn_disabled:e.isInMiniProgram},on:{click:e.payFunc}},[e.loading?t("div",{staticClass:"js_button_loading"},[e._m(0),e._v(" Loading... ")]):t("div",[t("i",{staticClass:"pay__icon-wecoin"}),t("span",{staticClass:"price js_pay_fee",attrs:{id:"js_pay_fee_normal"}},[e._v(e._s(e.cgiData.wecoin_amount))]),e._v(" "+e._s(e.buttonText)+" ")])])}),[function(){var e=this._self._c;return e("span",{staticClass:"weui-primary-loading weui-primary-loading_transparent"},[e("i",{staticClass:"weui-primary-loading__dot"})])}],!1,null,null,null,null).exports,uo=8+window.parseInt(window.getComputedStyle(document.documentElement).getPropertyValue("--sab"));let po=0,mo=0,ho=!1,_o=0;const fo=window.scrollY,go=window.innerHeight/3;const wo=pt({name:"mp-pay-gift",data:()=>({giftBarTitleText:"可赠送给一位朋友免费阅读"}),computed:{...p(["cgiData"]),...p("mp-pay-read",["paySubscribeInfo"])},mounted(){const e=window.localStorage.getItem("paySuc"),t=this.$refs.giftBar.getBoundingClientRect().top;"1"===e&&t>window.innerHeight?(window.localStorage.setItem("paySuc","0"),this.$refs.giftBar.className="pay__gift-send show",this.giftBarTitleText="已兑换，可赠送给一位朋友",m.reportSend(2),De.on(window,"scroll",this.scrollHandler),De.on(this.$refs.giftBar,"touchstart",this.touchStartHandler),De.on(this.$refs.giftBar,"touchmove",this.touchMoveHandler),De.on(this.$refs.giftBar,"touchend",this.touchEndHandler)):!be.hasClass(this.$refs.giftBar,"show")&&t<=window.innerHeight&&(this.$refs.giftBar.className="pay__gift-send pay__gift-send_static",m.reportSend(4))},beforeDestroy(){De.off(window,"scroll",this.scrollHandler)},methods:{present(){if(he.os.iphone||he.os.ipad||he.os.android){let e=this.paySubscribeInfo.gift_url.html(),t="";const n=e.indexOf("#");-1!==n&&(t=e.substring(n),e=e.substring(0,n)),be.hasClass(this.$refs.giftBar,"pay__gift-send_static")?m.reportSend(5):m.reportSend(3),m.goUrl("".concat(e,"&sessionid=").concat(this.cgiData.sessionid,"&enterid=").concat(this.cgiData.enterid,"&scene=").concat(this.cgiData.source,"&subscene=").concat(this.cgiData.subscene,"&biz=").concat(this.cgiData.biz,"&mid=").concat(this.cgiData.mid,"&idx=").concat(this.cgiData.idx).concat(t))}else window.weui.alert("请使用移动端微信打开")},touchStartHandler(e){be.hasClass(this.$refs.giftBar,"show")&&(ho=!0,_o=e.touches[0].clientY,po=mo)},touchMoveHandler(e){e.preventDefault();const t=e.touches[0].clientY-_o;be.hasClass(this.$refs.giftBar,"show")&&ho&&(t+po>=0&&t+po<=uo?(this.$refs.giftBar.style.transform="translate3d(0, ".concat(t+po,"px, 0)"),mo=t+po):t+po>uo?(this.$refs.giftBar.style.transform="translate3d(0, ".concat(uo,"px, 0)"),mo=uo):t+po<0&&(this.$refs.giftBar.style.transform="translate3d(0, 0, 0)",mo=0))},touchEndHandler(){ho=!1,be.hasClass(this.$refs.giftBar,"show")&&mo===uo&&(this.$refs.giftBar.className="pay__gift-send",De.off(this.$refs.giftBar,"touchstart",this.touchStartHandler),De.off(this.$refs.giftBar,"touchmove",this.touchMoveHandler),De.off(this.$refs.giftBar,"touchend",this.touchEndHandler))},scrollHandler(){const e=document.getElementById("js_pay_wall_wrap").getBoundingClientRect();e.top+e.height-48<=window.innerHeight?(this.giftBarTitleText="可赠送给一位朋友免费阅读",this.$refs.giftBar.className="pay__gift-send pay__gift-send_static",this.$refs.giftBar.style.transform="translate3d(0, 0, 0)",De.off(this.$refs.giftBar,"touchstart",this.touchStartHandler),De.off(this.$refs.giftBar,"touchmove",this.touchMoveHandler),De.off(this.$refs.giftBar,"touchend",this.touchEndHandler),De.off(window,"scroll",this.scrollHandler),m.reportSend(4)):window.scrollY-fo>go&&(this.$refs.giftBar.className="pay__gift-send")}}},(function(){var e=this,t=e._self._c;return t("div",{ref:"giftBar",staticClass:"pay__gift-send_static pay__gift-send",attrs:{id:"js_pay_gift_bar"}},[t("div",{staticClass:"pay__gift-send-content"},[t("div",{staticClass:"pay__gift-send-title",attrs:{id:"js_pay_gift_bar_title"}},[e._v(" "+e._s(e.giftBarTitleText)+" ")])]),t("div",{staticClass:"pay__gift-send-btn",attrs:{id:"js_send_pay_gift"},on:{click:e.present}},[e._v("去赠送")])])}),[],!1,null,null,null,null).exports;const yo=pt({name:"mp-pay-read-qrcode",computed:{src(){if(ke.isWindows||ke.isMac&&!ke.isIOS){return"/mp/paysubqrcode?action=get_article_qrcode&__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&sn=").concat(window.sn,"#wechat_redirect")}return""}}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"pay__notice-qrcode js_pay_qrcode_wrap js_pay_fee_display"},[t("div",{staticClass:"pay__qrcode-wrp"},[t("img",{staticClass:"js_pay_qrcode",attrs:{src:e.src}})]),t("div",{staticClass:"pay__qrcode-title"},[e._v("微信扫一扫付费阅读本文")])])}),[],!1,null,null,null,null).exports;const vo=pt({name:"mp-pay-read-bottom",components:{[yo.name]:yo,[lo.name]:lo,[_.name]:_},props:{payTopicNoticeText:{type:String,default:""},visible:{type:Boolean}},data:()=>({addLargeFontStyle:!1,bottomHeight:0,showBottomBar:!!window.is_login}),computed:{...p(["cgiData"]),...p("mp-pay-read",["wecoinText","loading","payReadBottomVisible"]),...p("mp-stream",["articleFoldStatus"]),...f("mp-pay-read",["topicLink"]),...f("mp-stream",["hasInteractData","recommendShow","recommendGray","recommendFriendNum","friendSeenInfo","showFriendSeen","hasRecommended"]),payBtnText(){return this.showBottomBar?"读全文":"微信豆兑换"},streamFriendsShow(){return!!(0!==this.showFriendSeen&&this.recommendShow&&1!==this.recommendGray&&this.recommendFriendNum>0)}},watch:{articleFoldStatus(e){!e&&this.showBottomBar&&this.$nextTick((()=>{this.judgeHeight("100")}))},hasInteractData(){this.$nextTick((()=>{this.judgeHeight("100")}))}},created(){this.unwatchVisible=this.$watch("visible",(e=>{var t,n,i;if(e){const e=null==(n=null==(t=this.$refs.button)?void 0:t.$el)?void 0:n.getBoundingClientRect().height,o=null==(i=this.$refs.content)?void 0:i.getBoundingClientRect().height;this.addLargeFontStyle=o/e>108/52,this.unwatchVisible()}}))},mounted(){this.showBottomBar&&(xe.on("menu:setfont",(e=>{this.judgeHeight(e.fontScale)})),this.$nextTick((()=>{this.judgeHeight("100")})))},methods:{...g("mp-stream",["setStreamFriendsListStatus"]),...h("mp-pay-read",["payFunc","goBuyTopic"]),getBottomBarHeight(){const e=document.getElementById("js_article_bottom_bar");return e?Math.floor(null==e?void 0:e.getBoundingClientRect().height):0},judgeHeight(e="100"){setTimeout((()=>{var t,n,i;let o=!1;if("100"===e){const e=null==(n=null==(t=this.$refs.button)?void 0:t.$el)?void 0:n.getBoundingClientRect().height;o=(null==(i=this.$refs.content)?void 0:i.getBoundingClientRect().height)/e>.7}this.addLargeFontStyle=1*e>=140||o,this.bottomHeight=this.getBottomBarHeight()}),100)},streamFriendsClick(){this.setStreamFriendsListStatus(!0)}}},(function(){var e=this,t=e._self._c;return 1!==e.cgiData.isPayTopic?t("div",{staticClass:"pay pay__notice",class:{pay__notice_largeFont:e.addLargeFontStyle,"pay__notice_new pay_new":e.showBottomBar,pay__notice_hiden:e.articleFoldStatus},style:{bottom:e.bottomHeight+"px"},attrs:{id:"js_pay_panel_bottom"}},[t("div",{staticClass:"pay__notice-intro"},[e.streamFriendsShow?t("mp-stream-friends",{attrs:{isPayArticle:!0,showFriendSeen:e.showFriendSeen,likeTipsInfo:e.friendSeenInfo,recommendFriendNum:e.recommendFriendNum,isRecommended:e.hasRecommended,payReadBottomVisible:e.payReadBottomVisible},on:{"stream-friends-click":e.streamFriendsClick}}):t("div",{ref:"content",staticClass:"pay__intro-content"},[t("p",{staticClass:"pay__notice-title"},[e._v(" 可试读"+e._s(e.cgiData.preview_percent)+"% ")]),t("div",{staticClass:"pay__notice-desc",attrs:{id:"js_pay_panel_bottom_wecoin_tips"}},[e._v(" "+e._s(e.wecoinText)+" ")])]),t("div",{staticClass:"pay__notice-btn-wrp"},[t("mp-pay-btn",{ref:"button",attrs:{"button-text":e.payBtnText}}),t("mp-pay-read-qrcode")],1)],1)]):t("div",{staticClass:"pay pay__notice pay__topic-notice",class:{"pay_new pay__notice_new":e.showBottomBar,pay__notice_hiden:e.articleFoldStatus},style:{bottom:e.bottomHeight+"px"},attrs:{id:"js_pay_topic_panel_bottom"}},[t("div",{staticClass:"pay__notice-intro"},[e.streamFriendsShow?t("mp-stream-friends",{attrs:{isPayArticle:!0,showFriendSeen:e.showFriendSeen,likeTipsInfo:e.friendSeenInfo,recommendFriendNum:e.recommendFriendNum,isRecommended:e.hasRecommended,payReadBottomVisible:e.payReadBottomVisible},on:{"stream-friends-click":e.streamFriendsClick}}):t("div",{staticClass:"pay__intro-content"},[t("div",{staticClass:"pay__notice-desc"},[e._v(" "+e._s(e.payTopicNoticeText)+" ")]),e.showBottomBar?e._e():t("p",{staticClass:"pay__notice-title"},[e._v(e._s(e.cgiData.payTopicTitle))])]),t("div",{staticClass:"pay__notice-btn-wrp"},[t("button",{staticClass:"js_pay_topic_btn weui-btn",class:{btn_disabled:e.cgiData.payTopicRemoveFlag>0},attrs:{"data-url":e.topicLink},on:{click:e.goBuyTopic}},[e._v(" 合集详情 ")]),t("mp-pay-read-qrcode")],1)],1)])}),[],!1,null,null,null,null).exports;const bo=pt({name:"mp-buy-wecoin-btn",computed:{...p("mp-pay-read",["wecoinRemain"])}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"pay__wecoin-entry"},[t("i",{staticClass:"pay__icon-wecoin"}),t("span",{staticClass:"price",attrs:{id:"js_wecoin_remain"}},[e._v(e._s(e.wecoinRemain))])])}),[],!1,null,null,null,null).exports;const ko=pt({name:"mp-pay-edu-tips",components:{[w.name]:w},computed:{...p(["cgiData"]),...p("mp-pay-read",["payEduTips"]),top:()=>window.innerHeight-467},methods:{...g("mp-pay-read",["setWecoinRemain","setPayLock","setPayEduTips"]),hideEduTipsCb(){this.$refs.bottomModal.hide(),y.show(),xe.invoke("getWCCoinBalance",{},(e=>{y.hide(),e&&e.err_msg&&e.err_msg.indexOf("ok")>-1?(this.setWecoinRemain(e.balance),this.$emit("show-confirm")):this.setPayLock(!1)})),this.setPayEduTips({...this.payEduTips,firstWecoinRecharge:0})},show(){this.$refs.bottomModal.show()}}},(function(){var e=this,t=e._self._c;return t("mp-bottom-modal",{ref:"bottomModal",attrs:{"ext-class":"pay__edu-modal","has-header":!1,top:"".concat(e.top,"px")},on:{hide:e.hideEduTipsCb},scopedSlots:e._u([{key:"footer",fn:function(){return[t("a",{staticClass:"weui-btn weui-btn_default",on:{click:e.hideEduTipsCb}},[e._v("OK")])]},proxy:!0}])},[t("div",{staticClass:"pay__wecoin-edu-profile"},[t("div",{staticClass:"pay__wecoin-edu-title"},[e._v(" 可在「我>个人信息>微信豆」页面，查看微信豆消费明细。 ")]),t("div",{staticClass:"pay__wecoin-edu-pic"},[t("div",{staticClass:"pay__wecoin-edu-avatar"},[t("img",{attrs:{src:e.payEduTips&&e.payEduTips.userImgUrl}})]),t("div",{staticClass:"pay__wecoin-edu-nic"},[e._v(" "+e._s(e.payEduTips&&e.payEduTips.userNickname)+" ")])])])])}),[],!1,null,null,null,null).exports;const xo=pt({name:"mp-pay-confirm",components:{[w.name]:w,[ko.name]:ko,[bo.name]:bo},props:{title:{type:String,default:""}},data:()=>({agreeStat:!1}),computed:{...p(["cgiData"]),...p("mp-pay-read",["wecoinRemain","payEduTips","encodeRespBuff"]),needTopup(){return this.wecoinRemain<this.cgiData.wecoin_amount},btnDisabled(){return this.needTopup&&!1===this.agreeStat},wecoinTitle(){return this.needTopup?"微信豆不足，兑换全文还需":"兑换全文"},wecoinPrice(){return this.needTopup?this.cgiData.wecoin_amount-this.wecoinRemain:this.cgiData.wecoin_amount},wecoinTips(){return"售价 ".concat(this.wecoinPrice/10,"元")}},methods:{...g("mp-pay-read",["setPayLock","setWecoinRemain"]),...h("mp-pay-read",["paySuc","pollCheck"]),onLinkClick(e){e&&e.preventDefault(),Xe.reportPayAppmsg(17),xe.invoke("openUrlWithExtraWebview",{url:"https://kf.qq.com/touch/product/WXDB_app.html",openType:1})},onTermClick(e){"A"===e.target.tagName&&xe.invoke("openUrlWithExtraWebview",{url:this.cgiData.paySubscribeInfo.agreement_url.htmlDecode(),openType:1})},onTermCheckboxToggle(e){const{footerBtn:t}=this.$refs;e.target.checked?t.removeAttribute("disabled"):t.setAttribute("disabled","disabled")},show(){this.$refs.bottomModal.show()},hide(){this.$refs.bottomModal.hide()},onFooterBtnClick(){if(this.$refs.footerBtn.getAttribute("disabled"))return;const{wecoin_amount:e}=this.cgiData;fe.log("[Appmsg] pay process 5 wecoinAmountRemain=".concat(this.wecoinRemain," wecoin_amount=").concat(e)),this.needTopup?(this.hide(),setTimeout((()=>{Xe.reportPayAppmsg(19),fe.log("[Appmsg] pay process 6.1 buyWCCoin");const e=e=>{y.hide(),e&&e.err_msg&&e.err_msg.indexOf("ok")>-1&&(this.setWecoinRemain(e.balance),this.needTopup?this.show():this.consumeWCCoin())},t={businessId:2,scene:4,panelShowType:"present",diffWecoinCount:this.cgiData.wecoin_amount>this.wecoinRemain?this.cgiData.wecoin_amount-this.wecoinRemain:0};ke.isAndroid&&ke.gtVersion("8.0.18",!0)&&(t.mode=2,t.agreementVersion=this.cgiData.paySubscribeInfo.agreement_version,t.customCount=this.cgiData.wecoin_amount-this.wecoinRemain,t.productId=this.cgiData.paySubscribeInfo.recharge_product_id),xe.invoke("buyWCCoin",t,(t=>{console.log(t),t&&t.err_msg&&(t.err_msg.indexOf("ok")>-1?ke.isIOS&&ke.ltVersion("8.0.17")||ke.isAndroid&&ke.ltVersion("8.0.17")?this.payEduTips.firstWecoinRecharge?this.$refs.eduTipsModal.show():(y.show(),xe.invoke("getWCCoinBalance",{},e)):xe.invoke("showWCCoinFirstBuyCoinTips",{alwaysDarkMode:!1},(()=>{y.show(),xe.invoke("getWCCoinBalance",{},e)})):t.err_msg.indexOf("cancel")>-1&&this.show())}))}),250)):(this.hide(),this.consumeWCCoin())},consumeWCCoin(){const{encodeRespBuff:e}=this;fe.log("[Appmsg] pay process 3 can_use_wecoin=".concat(this.cgiData.can_use_wecoin)),fe.log("[Appmsg] pay process 4 on payBtn tap"),y.show();const t=Math.round(new Date/1e3);xe.invoke("consumeWCCoin",{buff:e,businessId:2},(n=>{console.log("consumeWCCoin res",n),this.setPayLock(!1),n&&n.err_msg&&n.err_msg.indexOf("ok")>-1?(Xe.reportPay(t,1,e),this.pollCheck()):n&&n.err_msg&&n.err_msg.indexOf("fail")>-1&&(Xe.reportPay(t,3,e,n.err_msg,n.err_code,n.err_domain),window.weui.alert("兑换失败，请稍后再试"))}))},buyWecoin(){this.hide();const e=e=>{y.hide(),e&&e.err_msg&&e.err_msg.indexOf("ok")>-1&&(this.setWecoinRemain(e.balance),this.show())};setTimeout((()=>{Xe.reportPayAppmsg(14);const t=this.needTopup?this.cgiData.wecoin_amount-this.wecoinRemain:0;xe.invoke("buyWCCoin",{businessId:2,scene:3,panelShowType:"present",diffWecoinCount:t},(t=>{console.log(t),t&&t.err_msg&&(t.err_msg.indexOf("ok")>-1?ke.isIOS&&ke.ltVersion("8.0.17")||ke.isAndroid&&ke.ltVersion("8.0.17")?this.payEduTips.firstWecoinRecharge?this.$refs.eduTipsModal.show():(y.show(),xe.invoke("getWCCoinBalance",{},e)):xe.invoke("showWCCoinFirstBuyCoinTips",{alwaysDarkMode:!1},(()=>{y.show(),xe.invoke("getWCCoinBalance",{},e)})):t.err_msg.indexOf("cancel")>-1&&this.show())}))}),250)}}},(function(){var e=this,t=e._self._c;return t("div",[t("mp-bottom-modal",{ref:"bottomModal",attrs:{"ext-class":"pay__bottom-modal","has-btn":"","auto-height":""},on:{submit:e.buyWecoin,hide:function(t){return e.setPayLock(!1)}},scopedSlots:e._u([{key:"btn",fn:function(){return[t("mp-buy-wecoin-btn")]},proxy:!0},{key:"footer",fn:function(){return[t("div",[e.needTopup?t("div",{ref:"footerTerm",staticClass:"pay__wecoin-term weui-cells_checkbox",attrs:{id:"js_wecoin_term"},on:{click:e.onTermClick}},[t("label",{attrs:{for:"js_wecoin_term_check"}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.agreeStat,expression:"agreeStat"}],ref:"wecoinCheck",staticClass:"weui-check",attrs:{id:"js_wecoin_term_check",type:"checkbox"},domProps:{checked:Array.isArray(e.agreeStat)?e._i(e.agreeStat,null)>-1:e.agreeStat},on:{change:function(t){var n=e.agreeStat,i=t.target,o=!!i.checked;if(Array.isArray(n)){var a=e._i(n,null);i.checked?a<0&&(e.agreeStat=n.concat([null])):a>-1&&(e.agreeStat=n.slice(0,a).concat(n.slice(a+1)))}else e.agreeStat=o}}}),t("i",{staticClass:"weui-icon-checked"}),e._v("同意"),t("a",{attrs:{href:"javascript:;"}},[e._v("《微信豆充值协议》")])])]):e._e(),t("div",{staticClass:"weui-half-screen-dialog__btn-area"},[t("a",{ref:"footerBtn",staticClass:"weui-btn weui-btn_primary",attrs:{disabled:e.btnDisabled},on:{click:e.onFooterBtnClick}},[e._v(e._s(e.needTopup?"去充值":"兑换"))])]),t("div",{staticClass:"weui-half-screen-dialog__attachment-wrp",on:{click:e.onLinkClick}},[t("a",{staticClass:"weui-half-screen-dialog__attachment-link",attrs:{href:"javascript:;"}},[e._v("常见问题")])])])]},proxy:!0}])},[t("div",{staticClass:"pay__wecoin"},[t("div",{staticClass:"pay__wecoin-title",staticStyle:{"font-weight":"normal"},attrs:{id:"js_wecoin_title"}},[e._v(" "+e._s(e.wecoinTitle)+" ")]),t("div",{staticClass:"pay__wecoin-content pay__wecoin-content-price"},[t("i",{staticClass:"pay__icon-wecoin"}),t("span",{staticClass:"price",attrs:{id:"js_wecoin_price"}},[e._v(e._s(e.wecoinPrice))])]),t("div",{ref:"wecoinTipsDom",staticClass:"pay__wecoin-tips",attrs:{id:"js_wecoin_tips"}},[e._v(" "+e._s(e.wecoinTips)+" ")])])]),t("mp-pay-edu-tips",{ref:"eduTipsModal",on:{"show-confirm":function(t){return e.$refs.bottomModal.show()}}})],1)}),[],!1,null,null,null,null).exports;const So=pt({name:"mp-wecoin-tips",components:{[w.name]:w},computed:{...p("mp-pay-read",["wecoinText"]),top:()=>innerHeight-375},methods:{onQuestionClick(e){e&&e.preventDefault(),Xe.reportPayAppmsg(17),xe.invoke("openUrlWithExtraWebview",{url:"https://kf.qq.com/touch/product/WXDB_app.html",openType:1}),this.$refs.bottomModal.hide()},show(){this.$refs.bottomModal.show()}}},(function(){var e=this,t=e._self._c;return t("mp-bottom-modal",{ref:"bottomModal",attrs:{"ext-class":"pay__wecoin-edu-modal",top:"".concat(e.top,"px")},scopedSlots:e._u([{key:"footer",fn:function(){return[t("a",{staticClass:"pay__wecoin-edu-link",on:{click:e.onQuestionClick}},[e._v("常见问题")])]},proxy:!0}])},[t("div",{staticClass:"pay__wecoin-edu"},[t("div",{staticClass:"pay__wecoin-title"},[t("div",{staticClass:"pay__icon-wecoin"}),t("div",[e._v("付费内容需用微信豆兑换")])]),t("div",{staticClass:"pay__wecoin-edu-desc"},[e._v(" 微信豆是用于兑换微信内虚拟物品和服务的道具。 "),t("span",[e._v(e._s(e.wecoinText))]),e._v(" 微信豆还可用于兑换直播间的虚拟礼物等。 ")])])])}),[],!1,null,null,null,null).exports;const Io=pt({name:"mp-pay-read",components:{[co.name]:co,[vo.name]:vo,[yo.name]:yo,[xo.name]:xo,[lo.name]:lo,[So.name]:So,[wo.name]:wo},data:()=>({iapPriceInfo:null,showBottomBar:!!window.is_login}),computed:{...p(["cgiData","extRes"]),...p("mp-pay-read",["wecoinText","payLock","wecoinRemain","loading","isInMiniProgram","paySubscribeInfo","payReadBottomVisible"]),...f("mp-pay-read",["isPaidLSKey","topicLink"]),contentTextLen(){var e;return 1*(null==(e=this.cgiData.payforread_info)?void 0:e.content_plain_text_len)},canGift(){return!!this.paySubscribeInfo&&this.cgiData.payGiftsCount-this.paySubscribeInfo.gifted_count>0},payFee(){var e;return(1*(null==(e=this.cgiData.payforread_info)?void 0:e.fee)/100).toFixed(2)},isPaid(){return this.cgiData.isPaid},previewPercent(){return this.cgiData.preview_percent},payTopicNoticeText(){return 0===this.previewPercent?"兑换合集后可阅读全文":"兑换合集后可阅读剩余".concat(100-this.previewPercent,"%")},payTopicFreqText(){const e=this.cgiData.payTopicCount,t=this.cgiData.payTopicTotalCount;return e<t?"已发表".concat(e,"个")+" "+"计划发表".concat(t,"个"):"已完结 共".concat(e,"个")},payTopicList(){return this.cgiData.payTopicArticleTitles?this.cgiData.payTopicArticleTitles.slice(0,4):[]},previewTipsText:()=>/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)?"付费后可赠送给一位朋友免费阅读 (1元 = 7微信豆)":"付费后可赠送给一位朋友免费阅读 (1元 = 10微信豆)",tempkey(){return this.cgiData.tempkey},payFeeNormalText(){const{wecoin_amount:e,fee:t}=this.cgiData;return e>0?e:t/10},payBtnText(){return this.showBottomBar?"读全文":"微信豆兑换"}},watch:{extRes(e){e.pay_subscribe_info&&(this.setPayEduTips({firstWecoinRecharge:1*e.pay_subscribe_info.first_wecoin_recharge,userImgUrl:e.pay_subscribe_info.user_img_url,userNickname:e.pay_subscribe_info.user_nick_name}),this.setPayGlobal({enable_custom_recharge:e.pay_subscribe_info.enable_custom_recharge,agreement_url:e.pay_subscribe_info.agreement_url,agreement_version:e.pay_subscribe_info.agreement_version,agreement_status:e.pay_subscribe_info.agreement_status,recharge_product_id:e.pay_subscribe_info.recharge_product_id,price:e.pay_subscribe_info.price}),e.pay_subscribe_info.wecoin_tips&&(ke.isIOS||ke.isAndroid)&&!ke.isWxWork&&this.$refs.wecoinTipsModal.show())},payReadBottomVisible(e){null===e&&this.togglePayPanelBottom()}},created(){this.iapPriceInfo=this.cgiData.iapPriceInfo},mounted(){xe.on("onScreenShot",(()=>{ue.setSum(114217,15,1)})),fe.log("[Appmsg] pay process 1 isPaySubscribe=".concat(this.cgiData.isPaySubscribe)),xe.on("onScreenShot",(()=>{Xe.reportPayAppmsg(6)}));const e=ke.isWindows||ke.isMac&&!ke.isIOS,t=document.getElementById("js_content"),n=e=>{"IMG"===e.target.tagName&&e.preventDefault()};e&&(t.addEventListener("dragstart",n),ke.isWechat||t.addEventListener("contextmenu",n)),fe.log("[Appmsg] pay process 2 isPaid=".concat(this.isPaid)),this.isPaid||this.initPay()},beforeDestroy(){De.off(this.cgiData,"scroll",this.togglePayPanelBottom)},methods:{...g("mp-pay-read",["setPayEduTips","setPayGlobal","setConfirmModal","setPayReadBottomVisible"]),...h("mp-pay-read",["payFunc","goBuyTopic"]),initPay(){const e=document.getElementById("js_pay_panel");ke.isAndroid&&"1"===localStorage.getItem(this.isPaidLSKey)&&Xe.report110809(30),this.cgiData.jump2pay&&De.on(window,"load",(()=>{window.scrollTo(0,e.getBoundingClientRect().top-Oe.getInnerHeight()/3)})),this.setConfirmModal(this.$refs.payConfirm),this.togglePayPanelBottom(),De.on(window,"scroll",this.togglePayPanelBottom)},togglePayPanelBottom(){const e=this.$refs.payReadBottom.$el,t=this.cgiData.isPayTopic?document.getElementById("js_pay_topic_btn"):this.$refs.payBtn.$el,{top:n}=t.getBoundingClientRect(),i=window.getComputedStyle(e);if(n+(40+parseInt(i.paddingTop,10)+parseInt(i.paddingBottom,10))>this.cgiData.innerHeight){if(1*this.cgiData.previewPercent==0)return;if(this.cgiData.isRemovedFromPayTopic&&!this.cgiData.isPaid)return;this.setPayReadBottomVisible(!0)}else this.setPayReadBottomVisible(!1),window.is_finished_preview=1}}},(function(){var e=this,t=e._self._c;return t("div",[e.isPaid?[t("mp-pay-wall"),e.canGift?t("mp-pay-gift"):e._e()]:[e.previewPercent>0?t("div",{staticClass:"pay__mask_static"}):e._e(),t("div",{staticClass:"pay pay__static",class:{pay_new:e.showBottomBar},attrs:{id:"js_pay_panel"}},[1===e.cgiData.isPayTopic&&e.cgiData.payTopicRemoveFlag>0?t("div",{staticClass:"pay__topic-tips"},[e._v(" "+e._s(1===e.cgiData.payTopicRemoveFlag?"此内容已从合集中移除，不支持付费":"付费合集已被作者删除，不支持付费")+" ")]):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:!(1!==e.cgiData.isPayTopic||2===e.cgiData.payTopicRemoveFlag),expression:"!(cgiData.isPayTopic !== 1 || cgiData.payTopicRemoveFlag === 2)"}],staticClass:"pay__topic"},[t("div",{staticClass:"pay__topic-hd"},[e._v(" "+e._s(e.payTopicNoticeText)+" ")]),t("div",{staticClass:"pay__topic-bd"},[t("div",{staticClass:"pay__topic-main"},[t("div",{staticClass:"pay__topic-main-wrp"},[t("div",{staticClass:"pay__topic-title"},[e._v(e._s(e.cgiData.payTopicTitle))]),t("div",{staticClass:"pay__topic-meta"},[t("span",{attrs:{id:"js_pay_topic_freq"}},[e._v(" "+e._s(e.payTopicFreqText)+" ")])])]),t("a",{class:"weui-btn weui-btn_mini ".concat(e.cgiData.payTopicRemoveFlag>0&&!e.isPaid?"weui-btn_disabled":"weui-btn_primary"," weui-wa-hotarea pay__topic-btn"),attrs:{id:"js_pay_topic_btn","data-url":e.topicLink,href:"javascript:;"},on:{click:e.goBuyTopic}},[e._v(" 合集详情 ")])]),t("ul",{staticClass:"pay__topic-list"},e._l(e.payTopicList,(function(n,i){return t("li",{key:n},[e._v(e._s(i+1)+". "+e._s(n))])})),0)])]),t("div",{directives:[{name:"show",rawName:"v-show",value:1!==e.cgiData.isPayTopic,expression:"cgiData.isPayTopic !== 1"}],staticClass:"pay__main"},[e.cgiData.payDesc&&0===e.previewPercent?t("div",{staticClass:"pay__head-notice"},[e._v(" 正文需付费后才可阅读 ")]):e._e(),t("div",{staticClass:"pay__notice-btn-wrp",class:{"pay__notice-btn-lg":e.showBottomBar}},[t("mp-pay-btn",{ref:"payBtn",attrs:{"button-text":e.payBtnText}}),0!==e.cgiData.payGiftsCount?t("div",{staticClass:"pay__preview-tips",attrs:{id:"js_pay_preview_tips"}},[e._v(" "+e._s(e.previewTipsText)+" ")]):t("div",{staticClass:"pay__preview-tips",attrs:{id:"js_pay_wecoin_tips"}},[e._v(" "+e._s(e.wecoinText)+" ")]),e.tempkey?t("div",{staticClass:"pay__preview-tips js_pay_fee_display"},[e._v(" 预览状态下不会扣费 ")]):e._e(),t("mp-pay-read-qrcode")],1)]),t("mp-pay-wall")],1),t("transition",{attrs:{name:"fade"}},[t("mp-pay-read-bottom",{directives:[{name:"show",rawName:"v-show",value:e.payReadBottomVisible,expression:"payReadBottomVisible"}],ref:"payReadBottom",attrs:{visible:e.payReadBottomVisible,"pay-topic-notice-text":e.payTopicNoticeText}})],1),t("mp-pay-confirm",{ref:"payConfirm"})],t("mp-wecoin-tips",{ref:"wecoinTipsModal"})],2)}),[],!1,null,"93f20987",null,null).exports;const Co=pt({name:"mp-sponsor-ad",components:{[v.name]:v},data:()=>({posType:St.AD_POS.POS_SPONSOR}),methods:{handleAdFrameMessage(e){e===St.FRAME_READY&&b.report115849(63)}}},(function(){var e=this;return(0,e._self._c)("mp-ad-frame",{attrs:{"pos-type":e.posType},on:{"ad-frame-message":e.handleAdFrameMessage}})}),[],!1,null,null,null,null).exports,To="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJDQzA1MTVGNkE2MjExRTRBRjEzODVCM0Q0NEVFMjFBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkJDQzA1MTYwNkE2MjExRTRBRjEzODVCM0Q0NEVFMjFBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkNDMDUxNUQ2QTYyMTFFNEFGMTM4NUIzRDQ0RUUyMUEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkNDMDUxNUU2QTYyMTFFNEFGMTM4NUIzRDQ0RUUyMUEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6p+a6fAAAAD0lEQVR42mJ89/Y1QIABAAWXAsgVS/hWAAAAAElFTkSuQmCC",Ao=Ht.attr,Eo=Ht.setProperty;let Po=!1,Ro=!1,Do=!1;const jo={img:function(e,t){const n=this;e.loader.onerror=function(){const t=!!n.onerror&&n.onerror(this.src,this,e.placeholder,e.type);t&&(this.src=t)},e.loader.onload=function(){if(Vt(this,e.placeholder),e.placeholder.getAttribute("data-ratio")&&parseFloat(e.placeholder.getAttribute("data-ratio"),10)!==this.naturalHeight/this.naturalWidth&&(window.__addIdKeyReport&&window.__addIdKeyReport(330742,4),Po||window.__addIdKeyReport&&window.__addIdKeyReport(330742,5),window.create_time&&window.create_time>1682352e3&&(window.__addIdKeyReport&&window.__addIdKeyReport(330742,18),Math.abs(parseFloat(e.placeholder.getAttribute("data-ratio"),10)-this.naturalHeight/this.naturalWidth)*e.placeholder.getBoundingClientRect().width<=1?window.__addIdKeyReport&&window.__addIdKeyReport(330742,6):(!Do&&window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&Math.random()<.1&&window.WX_BJ_REPORT.BadJs.report("wrong img ratio page",location.href),!Do&&window.__addIdKeyReport&&window.__addIdKeyReport(330742,19),Do=!0)),Po=!0),parseFloat(e.placeholder.getAttribute("data-ratio"),10)||window.__addIdKeyReport&&window.__addIdKeyReport(330742,8),e.placeholder.getBoundingClientRect().width||window.__addIdKeyReport&&(ke.isIOS&&window.__addIdKeyReport(330742,12),ke.isAndroid&&window.__addIdKeyReport(330742,13),ke.isWindows&&window.__addIdKeyReport(330742,14),ke.isMac&&window.__addIdKeyReport(330742,15)),parseFloat(e.placeholder.getAttribute("data-ratio"),10)!==this.naturalHeight/this.naturalWidth){const t=e.placeholder.getBoundingClientRect().bottom;t<window.innerHeight&&(ke.isIOS||t>0&&ke.isAndroid)&&(window.__addIdKeyReport&&window.__addIdKeyReport(330742,9),!Ro&&window.__addIdKeyReport&&window.__addIdKeyReport(330742,10),Ro=!0)}e.placeholder=this,n.onload&&n.onload(this.src,this,e.type),this.onload=null},Ao(e.loader,"src",t),e.show=!0},bg:function(e,t){const n=this,i=t=>{const i='url("data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==")',o=e.placeholder.style.backgroundImage.replace(i,'url("'.concat(t,'")'));"string"==typeof e.placeholder.dataset.style&&(e.placeholder.dataset.style=e.placeholder.dataset.style.replace(i,'url("'.concat(t,'")'))),e.placeholder.style.backgroundImage=o,e.placeholder.classList.remove("wx_imgbc_placeholder"),window.Darkmode.updateStyle(e.placeholder,{"background-image":o}),n.onload&&n.onload(t,e.placeholder,e.type),e.loader.onload=null};e.loader.onerror=function(){const t=!!n.onerror&&n.onerror(this.src,this,e.placeholder,e.type);t?this.src=t:i(e.src)},e.loader.onload=function(){i(this.src)},Ao(e.loader,"src",t),e.show=!0}};function Oo(){const e=Date.now(),t=window.pageYOffset||document.documentElement.scrollTop,n=new IntersectionObserver((i=>{const o=[];i.forEach((e=>{const{target:t,isIntersecting:i}=e;if(i){const e=this.images.find((e=>e.placeholder===t));if(e){const{type:i}=e;let a=e.src;const r=1*e.placeholder.dataset.secLoadStatus;if(!a||1===r)return;if(e.show||2!==r||(e.show=!0,o.push(a)),ke.isWp&&"img"===e.type&&1*e.placeholder.width>window.sw&&(e.placeholder.width=this.sw),e.show)return void n.unobserve(t);this.changeSrc&&(a=this.changeSrc(a,e.loader,e.placeholder,e.type)),"function"==typeof jo[i]&&jo[i].call(this,e,a),o.push(a),n.unobserve(t)}}})),o.length>0&&this.detect&&this.detect({time:e,scrollTop:t,loadList:o})}));this.images.forEach((e=>n.observe(e.placeholder)))}function Bo(e){const t=this.images;if(!t||t.length<=0)return!1;const n=window.pageYOffset||document.documentElement.scrollTop,i=window.innerHeight||document.documentElement.clientHeight;let o=this.offset||60,a=0;if("wifi"===window.networkType){const e={bottom:1,top:1};let t;t=window.svr_time?new Date(1e3*window.svr_time):new Date;const n=t.getHours();n>=20&&n<23&&(e.bottom=.5,e.top=0),o=Math.max(e.bottom*i,o),a=Math.max(e.top*i,a)}const r=Date.now(),s=[],c=this.sw,l=this;for(let d=0,u=t.length;d<u;d++){const n=t[d];let r=n.src;const u=1*n.placeholder.dataset.secLoadStatus;if(!r||1===u)continue;if(n.show||2!==u||(n.show=!0,s.push(r)),ke.isWp&&"img"===n.type&&1*n.placeholder.width>c&&(n.placeholder.width=c),n.show)continue;const p=l.getImgRect&&l.getImgRect(n.placeholder)||n.placeholder.getBoundingClientRect();let m=a,h=o;(r.match(/\:\/\/[^\/]+\/mmbiz\//)&&r.indexOf("wx_fmt=gif")>-1||r.match(/\:\/\/[^\/]+\/mmbiz_gif\//))&&(m=0,h=60),(p.top<=0&&p.top+p.height+m>=0||p.top>0&&p.top<i+h||1===e||2===e&&"img"===n.type||3===e&&"bg"===n.type)&&(l.inImgRead&&(p.top<=0&&p.top+p.height>=0||p.top>0&&p.top<i)&&l.inImgRead(r,window.networkType),l.changeSrc&&(r=l.changeSrc(r,n.loader,n.placeholder,n.type)),"function"==typeof jo[n.type]&&jo[n.type].call(this,n,r),s.push(r))}s.length>0&&this.detect&&this.detect({time:r,loadList:s,scrollTop:n})}function Lo(){const e=document.getElementsByTagName("img"),t=document.querySelectorAll("[data-lazy-bgimg]"),n=[],i=this.container,o=this.attrKey||"data-src",a=i.offsetWidth;let r=0;const s=this.imgOccupied||!1,c=this.crossOrigin||!1;i.currentStyle?r=i.currentStyle.width:"undefined"!=typeof getComputedStyle&&(r=getComputedStyle(i).width),this.sw=1*r.replace("px","");for(let d=0,u=e.length;d<u;d++){const t=e.item(d),i=Ao(t,o);if(!i)continue;const r=Ao(t,"src");if(r&&r.indexOf("data:image/svg+xml")<0&&!t.dataset.secLoadStatus)continue;let l=100;if(t.dataset&&t.dataset.ratio){const e=1*t.dataset.ratio;let n=1*t.dataset.w||a;"number"==typeof e&&e>0&&(n=n<=a?n:a,l=n*e,s||(t.style.width&&t.setAttribute("_width",t.style.width),Eo(t,"width",n+"px","important"),Eo(t,"visibility","visible","important"),t.setAttribute("src",To)))}s||Eo(t,"height",l+"px","important"),c&&-1===i.indexOf("mmsns.qpic.cn")&&!(i.match(/\:\/\/[^\/]+\/mmbiz\//)&&i.indexOf("wx_fmt=gif")>-1||i.match(/\:\/\/[^\/]+\/mmbiz_gif\//))&&(t.crossOrigin="anonymous"),t.alt="Image",n.push({type:"img",placeholder:t,loader:t.cloneNode(),src:i,height:l,show:!1})}for(let d=0,u=t.length;d<u;d++){const e=t.item(d),i=Ao(e,"data-lazy-bgimg");if(!i)continue;const o=e.style.backgroundImage;o&&o.indexOf("data:image/gif;base64")<0&&!e.dataset.secLoadStatus||n.push({type:"bg",placeholder:e,loader:new Image,src:i,show:!1})}window.__lazyload_detected=!0,this.images=n,window.IntersectionObserver&&Oo.call(this);const l=i.querySelector('animate[attributeName="y"]')||i.querySelector('animateTransform[attributeName="transform"]')||i.querySelector("animateMotion");Bo.call(this,l?3:0)}function No(){this.throttle||(this.throttle=!0,setTimeout((()=>{Bo.call(this),this.throttle=!1}),500))}function Mo(e){setTimeout((()=>Lo.call(e)),0),De.on(window,"scroll",(()=>No.call(e))),De.on(document,"touchmove",(()=>No.call(e))),xe.invoke("getUserConfig",{},(t=>{t.isAccessibilityMode?(window.localStorage.setItem("isMpUserAccessibility","1"),Bo.call(e,1)):window.localStorage.removeItem("isMpUserAccessibility")})),ke.isIOS&&ke.getInner()>="18001B00"&&xe.on("onScreenShot",(()=>{Bo.call(e,1)}))}const qo=pt({name:"mp-added-info",components:{[k.name]:k,[w.name]:w,Intersect:x},data:()=>({list:[],total:0,overviewCount:0,notHideDialogWhenPageHide:!1,bottomWriteHeight:0}),computed:{...p(["cgiData"]),...p("mp-comment",["commentStatus","notHideReplayDialogWhenPageHide"]),...f("mp-comment",["commentEnabled"]),overviewList(){return this.list.slice(0,this.overviewCount)},intersectMarin(){return this.bottomWriteHeight?"0px 0px -".concat(this.bottomWriteHeight,"px 0px"):"0px"}},watch:{commentStatus(e){if(!(this.overviewCount>0))switch(e){case 1:this.overviewCount=1;break;case 0:this.overviewCount=3;break;case-1:!this.commentEnabled&&(this.overviewCount=3)}}},created(){this.hideAfterAnimationCB=null,"0"===this.cgiData.extra_comment_id||he.os.pc||(new S({comment_id:this.cgiData.extra_comment_id,appmsgid:this.cgiData.appmsgid,idx:this.cgiData.idx,item_show_type:this.cgiData.item_show_type||0,biz:this.cgiData.biz}),this.getData(),ke.isIOS&&document.addEventListener("visibilitychange",this.onVisibilitychange))},mounted(){this.$nextTick((()=>{const e=document.getElementById("js_article_bottom_bar");e&&(this.bottomWriteHeight=e.offsetHeight)}))},beforeDestroy(){"0"===this.cgiData.extra_comment_id||he.os.pc||ke.isIOS&&document.removeEventListener("visibilitychange",this.onVisibilitychange)},methods:{...g("mp-comment",["setNotHideReplayDialogWhenPageHide"]),report33250(e){me.report(33250,{BizUin:window.biz||"",AppMsgId:window.parseInt(window.mid,10)||0,AppMsgItemIdx:window.parseInt(window.idx,10)||0,Scene:1*window.source||0,EnterId:window.parseInt(window.enterid,10)||0,ExtraCommentId64Bit:this.cgiData.extra_comment_id,opType:e})},expose(){this.report33250(this.total>this.overviewCount?0:1)},showDialog(){this.report33250(2),this.$refs.dialog.show()},goEditPage(){this.report33250(3),$e("/publicpoc/article_extra_msg?action=getappmsginfo&url=".concat(encodeURIComponent(window.location.href)))},getData(){pe({url:_e.join("/mp/appmsg_comment",{action:"getextracomment",appmsgid:this.cgiData.appmsgid,idx:this.cgiData.idx,comment_id:this.cgiData.extra_comment_id,offset:0,limit:100},!0),dataType:"json",success:e=>{e.base_resp&&0===e.base_resp.ret&&(this.list=e.extra_comment,this.total=e.total_cnt)}})},remove(e){let t=-1;this.list.some(((n,i)=>{if(n.content_id===e)return t=i,!0}))&&(this.list.splice(t,1),!this.list.length&&this.$refs.dialog.getShowStatus()?(this.hideAfterAnimationCB=()=>{this.total=0},this.$refs.dialog.hide()):this.total--)},exposeCommentItem(e){var t;I({content_id:e.content_id||"",is_elected_comment:e.is_elected||0,is_friend_comment:1*e.friend,scene:1,identity_type:e.identity_type,identity_name:e.identity_name,is_from_me:1*e.is_from_me,is_from:e.is_from||0,like_num:e.like_num||0,reply_list:(null==(t=e.reply_new)?void 0:t.reply_list)||[]})},onHideAfterAnimation(){"function"==typeof this.hideAfterAnimationCB&&(this.hideAfterAnimationCB(),this.hideAfterAnimationCB=null)},onVisibilitychange(){this.$refs.dialog&&this.$refs.dialog.getShowStatus()&&("hidden"===document.visibilityState?!this.notHideDialogWhenPageHide&&!this.notHideReplayDialogWhenPageHide&&this.$refs.dialog.hide():(this.notHideDialogWhenPageHide||this.notHideReplayDialogWhenPageHide)&&(n.show({alpha:.6,mode:"replace",onClick:()=>{this.$refs.dialog.hide()}}),this.notHideDialogWhenPageHide=!1,this.setNotHideReplayDialogWhenPageHide(!1)))}}},(function(){var e=this,t=e._self._c;return e.total?t("div",{staticClass:"wx_added_info_container"},[t("div",{staticClass:"appmsg_card_context wx_added_info_card"},[t("intersect",{attrs:{threshold:[1],"root-margin":e.intersectMarin},on:{"~enter":function(t){return e.expose.apply(null,arguments)}}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.overviewList.length,expression:"overviewList.length"}]},[t("div",{staticClass:"wx_added_info_card_bd"},[t("div",{staticClass:"wx_added_info_card_title"},[e._v("此内容有以下补充信息")]),t("mp-comment-list",{attrs:{folder:"",type:"addedInfo","comment-id":e.cgiData.extra_comment_id,list:e.overviewList,"bottom-write-height":e.bottomWriteHeight},on:{remove:e.remove,"expose-item":e.exposeCommentItem}})],1),t("div",{staticClass:"js_wx_tap_highlight wx_tap_cell wx_added_info_card_ft",on:{click:e.showDialog}},[t("div",{staticClass:"wx_added_info_card_ft_title"},[e._v("All")]),t("div",{staticClass:"wx_added_info_card_ft_tips"},[e._v(e._s(e.total)+"条")])])])]),t("mp-bottom-modal",{ref:"dialog",attrs:{"ext-class":"discuss_more_dialog_wrp weui-half-screen-dialog_wrp added_info_dialog","has-btn":"","close-btn-type":"fold","hide-when-scroll-down":"","hide-when-sideslip":""},on:{submit:e.goEditPage,"hide-after-animation":e.onHideAfterAnimation},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("补充信息")]},proxy:!0},{key:"btn",fn:function(){return[t("a",{staticClass:"weui-link",attrs:{href:"javascript:;"}},[e._v("去补充")])]},proxy:!0}],null,!1,2038421654)},[t("div",{staticClass:"discuss_more_dialog_content"},[t("mp-comment-list",{attrs:{type:"addedInfo","comment-id":e.cgiData.extra_comment_id,list:e.list},on:{"go-resource":function(t){e.notHideDialogWhenPageHide=!0},remove:e.remove,"expose-item":e.exposeCommentItem}}),t("div",{staticClass:"weui-loadmore weui-loadmore_default weui-loadmore_line weui-loadmore_dot"},[t("span",{staticClass:"weui-loadmore__tips",staticStyle:{"background-color":"transparent"}})])],1)])],1)]):e._e()}),[],!1,null,null,null,null).exports;let Wo={canJumpOnTap:!1,isNonWechat:!1,data:null,appidInfoResp:null,appidInfoCatchErr:null,appInfoSucQueue:[],appInfoErrQueue:[],appidSnInfo:[],appidSnDict:{},getInfoState:0};const zo="@app";function Fo(e){return e.indexOf(zo)>-1?e:"".concat(e).concat(zo)}function Uo(){if(1==Wo.getInfoState||2==Wo.getInfoState)for(let e=0,t=Wo.appInfoErrQueue.length;e<t;e++){let t=Wo.appInfoErrQueue[e];"function"==typeof t&&t({code:Wo.getInfoState})}else if(3==Wo.getInfoState)for(let e=0,t=Wo.appInfoErrQueue.length;e<t;e++){let t=Wo.appInfoErrQueue[e];"function"==typeof t&&t({code:Wo.getInfoState,resp:Wo.appidInfoResp,catchErr:Wo.appidInfoCatchErr})}else if(4==Wo.getInfoState)for(let e=0,t=Wo.appInfoSucQueue.length;e<t;e++){let t=Wo.appInfoSucQueue[e];"function"==typeof t&&t({resp:Wo.appidInfoResp,data:Wo.data})}Wo.appInfoErrQueue=[],Wo.appInfoSucQueue=[]}function Ho(e){if(!e)return"";let t="",n=e.indexOf("?");const i=Wo.data&&Wo.data.pathArgs?Wo.data.pathArgs:"";return t=n>=0?"".concat(e.slice(0,n)+(n>0?".html":"")+e.slice(n),"&").concat(i):e+(""!==e?".html?":"?")+i,t.replace(/&amp;/g,"&")}function Vo(e){location.href="https://mp.weixin.qq.com/mp/waerrpage?type=upgrade&appid=".concat(encodeURIComponent(e),"#wechat_redirect")}function Ko(){setTimeout((()=>{alert("请在微信内打开小程序")}),0)}!function(){let e=navigator.userAgent.match(/MicroMessenger\/(\d+)\.(\d+)\.(\d+)/);if(e){let t=Number(e[1]),n=Number(e[2]),i=Number(e[3]);(t>6||6===t&&n>5||6===t&&5===n&&i>=3)&&(Wo.canJumpOnTap=!0)}else navigator.userAgent.match(/MicroMessenger\//)||navigator.userAgent.match(/wxwork/)||(Wo.isNonWechat=!0);he.os.windows&&window.clientversion?parseInt(window.clientversion,16)>=1661272064&&(Wo.canJumpOnTap=!0):he.os.Mac&&window.clientversion&&parseInt(window.clientversion,16)>=318767104&&(Wo.canJumpOnTap=!0);navigator.userAgent.match(/wxwork/)&&(Wo.canJumpOnTap=!0);!function(){try{Wo.appidSnInfo=JSON.parse(window.weapp_sn_arr_json).weapp_card_list}catch(su){Wo.appidSnInfo=[]}if(!Wo.appidSnInfo||0==Wo.appidSnInfo.length)return Wo.getInfoState=1,void Uo();let e={__biz:window.biz||"",mid:window.mid||"",idx:window.idx||"",uin:window.uin||"",key:window.key||"",pass_ticket:window.pass_ticket||"",weapp_num:Wo.appidSnInfo.length},t={},n={};for(let o=0;o<e.weapp_num;o++){let{appid:i}=Wo.appidSnInfo[o],{sn:a}=Wo.appidSnInfo[o];t[i]?t[i].push(o):(t[i]=[o],e["weapp_appid_".concat(o)]=Wo.appidSnInfo[o].appid,Wo.appidSnDict[i]=a),n[a]?n[a].push(o):(n[a]=[o],e["weapp_sn_".concat(o)]=Wo.appidSnInfo[o].sn)}let i="/mp/appmsg_weapp?action=batch_get_weapp";for(let o in e)i+="&".concat(o,"=").concat(encodeURIComponent(e[o]));pe({url:i,type:"GET",dataType:"json",async:!0,success(e){try{if(console.log("weapp_common success:",e),Wo.appidInfoResp=e,e.base_resp.ret)throw new Error("Fetch weapp info but get ret=".concat(e.base_resp.ret));Wo.data={infoMap:{},appid:e.appid||"",appmsg_compact_url:e.appmsg_compact_url||"",pathArgs:"appid=".concat(encodeURIComponent(e.appid)).concat(e.appmsg_compact_url?"&appmsg_compact_url=".concat(encodeURIComponent(e.appmsg_compact_url)):"")};let t=e.weapp_info;for(let e=0;e<t.length;e++){let n=t[e].weapp_appid;Wo.data.infoMap[n]=t[e]}Wo.getInfoState=4}catch(su){Wo.getInfoState=3,Wo.appidInfoCatchErr=su}Uo()},error(){Wo.getInfoState=2,Uo()}})}()}();const $o={canJumpOnTap:Wo.canJumpOnTap,isNonWechat:Wo.isNonWechat,getAppidInfo:function(e){console.log("getAppidInfo",Wo),1!=Wo.getInfoState&&2!=Wo.getInfoState||"function"!=typeof e.onError?3==Wo.getInfoState&&"function"==typeof e.onError?e.onError({code:Wo.getInfoState,resp:Wo.appidInfoResp,catchErr:Wo.appidInfoCatchErr}):4==Wo.getInfoState&&"function"==typeof e.onSuccess?e.onSuccess({resp:Wo.appidInfoResp,data:Wo.data}):("function"==typeof e.onSuccess&&Wo.appInfoSucQueue.push(e.onSuccess),"function"==typeof e.onError&&Wo.appInfoErrQueue.push(e.onError)):e.onError({code:Wo.getInfoState})},getAppidCode:function(e,t){let n={__biz:window.biz||"",mid:window.mid||"",idx:window.idx||"",weapp_appid:e.appid||"",weapp_sn:Wo.appidSnDict[e.appid]||"",path:e.path||""},i="/mp/appmsg_weapp?action=get_wxa_code";for(let o in n)i+="&".concat(o,"=").concat(encodeURIComponent(n[o]));pe({url:i,type:"GET",dataType:"json",async:!0,success(e){e.base_resp&&0===e.base_resp.ret?t&&t(e.url):t&&t()},error(){t&&t()}})},appidSnInfo:Wo.appidSnInfo,getRelativeURL:Ho,jumpUrl:function(e){let t;if((e=e||{}).options)t=e.options,t.relativeURL&&(t.relativeURL=t.relativeURL.replace(/&amp;/g,"&"),t.relativeURL.indexOf(".html")<0&&(t.relativeURL=Ho(t.relativeURL)));else if(e.appid&&(Wo.data||e.cps_weapp_username)){let n;e.cps_weapp_username?(n={},n.weapp_username=e.cps_weapp_username,n.app_version=e.cps_weapp_version):n=Wo.data.infoMap[e.appid],n&&(e.sceneNote&&(e.sceneNote+=":".concat(window.source_appid)),t={userName:n.weapp_username,scene:e.scene,sceneNote:e.sceneNote,relativeURL:Ho(e.path)},void 0!==n.app_version&&(t.appVersion=n.app_version),e.cps_weapp_username&&(t.relativeURL=function(e){let t="",n=e.indexOf("?");return t=e.slice(0,n)+(n>0?".html":"")+e.slice(n),t}(e.path)))}t&&(e.privateExtraData&&(t.privateExtraData=e.privateExtraData),e.sourceAppId?t.sourceAppId=e.sourceAppId:t.sourceAppId=window.source_appid,t.scene=t.scene||1058,t.appVersion=t.appVersion||1,t.userName=Fo(t.userName),console.log("weapp257",t),Wo.canJumpOnTap?xe.invoke("openWeApp",t,(t=>{"system:function_not_exist"===t.err_msg?Wo.isNonWechat?"function"==typeof e.beforeNonWechatWarn&&!1===e.beforeNonWechatWarn()||Ko():"function"==typeof e.beforeJumpBackupPage&&!1===e.beforeJumpBackupPage()||Vo(e.appid):"function"==typeof e.onJsapiCallback&&e.onJsapiCallback(t)})):Wo.isNonWechat?"function"==typeof e.beforeNonWechatWarn&&!1===e.beforeNonWechatWarn()||Ko():"function"==typeof e.beforeJumpBackupPage&&!1===e.beforeJumpBackupPage()||Vo(e.appid))},preloadMiniProgram:function(e){const t={userNames:[Fo(e)]};xe.invoke("preloadMiniProgramContacts",t),xe.invoke("preloadMiniProgramEnv",t),ue.setSum(114217,2,1)}};const Jo=pt({name:"mp-keyword-ad-card",props:{adInfo:{type:Object,default:()=>({page_resource:{}})}},computed:{showCardTail(){return"kPageTypeH5"!==this.adInfo.page_resource.page_type}},methods:{clickAd(){"kPageTypeWxa"===this.adInfo.page_resource.page_type?$o.jumpUrl({options:{userName:this.adInfo.page_resource.page_wxa_id,relativeURL:this.adInfo.page_resource.page_wxa_data_link}}):"kPageTypeH5"===this.adInfo.page_resource.page_type?Ke.openUrlWithExtraWebview(this.adInfo.page_resource.page_h5_url):"kPageTypeWxaGame"===this.adInfo.page_resource.page_type&&$o.jumpUrl({options:{userName:this.adInfo.page_resource.page_wxa_id,relativeURL:this.adInfo.page_resource.page_wxa_monitor_query_string}}),this.$emit("ad-card-click")}}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"keyword_ad_card",on:{click:e.clickAd}},[t("div",{staticClass:"keyword_ad_card__img",style:{backgroundImage:"url(".concat(e.adInfo.pic_url,")")}}),t("div",{staticClass:"keyword_ad_card__footer"},[t("p",{staticClass:"keyword_ad_card__wording"},[e._v(e._s(e.adInfo.wording))]),t("p",{staticClass:"keyword_ad_card__brand_info"},[t("span",{staticClass:"keyword_ad_card__brand_icon",style:{backgroundImage:"url(".concat(e.adInfo.advertiser_pic_url,")")}}),e._v(e._s(e.adInfo.advertiser_name))])]),e.showCardTail?t("div",{staticClass:"keyword_ad_card__tail"},[e._v("Mini Program")]):e._e(),t("div",{staticClass:"ad_label"},[e._v("Ad")])])}),[],!1,null,"e032cfc1",null,null).exports;const Go=pt({name:"mp-ad-keyword-bottom-modal",components:{[w.name]:w,[Jo.name]:Jo},data:()=>({observer:null}),computed:{...p("mp-adv-keyword",["show","keywordItem","reportData"])},created(){this.$watch("show",(function(e){e&&this.showBottomModal()}))},mounted(){this.observer=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&Qe({eventType:4,keyword:this.keywordItem.keyword,...this.reportData})}))})),this.observer.observe(this.$refs.adCard.$el)},beforeDestroy(){this.observer&&this.observer.disconnect()},methods:{...g("mp-adv-keyword",["setShow"]),showBottomModal(){this.$refs.bottomModal.show(),Qe({eventType:3,keyword:this.keywordItem.keyword,...this.reportData})},onHide(){this.setShow(!1),Qe({eventType:6,keyword:this.keywordItem.keyword,...this.reportData})},goSouyisou(){Qe({eventType:7,keyword:this.keywordItem.keyword,...this.reportData}),xe.invoke("openWXSearchPage",{query:this.keywordItem.keyword})},adCardClick(){Qe({eventType:5,keyword:this.keywordItem.keyword,...this.reportData})}}},(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"adv_keyword_bottom_modal"},[n("mp-bottom-modal",{ref:"bottomModal",attrs:{"hide-when-scroll-down":"","hide-when-sideslip":"","close-btn-type":"fold","ext-class":"ad_keyword_bottom_modal_wrap","content-area-class":"bottom_modal_content_area","content-wrap-class":"bottom_modal_content_wrap","auto-height":!0},on:{hide:t.onHide},scopedSlots:t._u([{key:"footer",fn:function(){return[n("p",{staticClass:"adv_keyword_search",on:{click:t.goSouyisou}},[n("a",{staticClass:"js_wx_tap_highlight wx_tap_link"},[t._v("Search"+t._s("「".concat(t.keywordItem.keyword,"」"))+"网络结果")])])]},proxy:!0}])},[n("h1",{staticClass:"adv_keyword_title"},[t._v(t._s(t.keywordItem.keyword))]),n("p",{staticClass:"adv_keyword_desc"},[t._v(t._s(null==(e=t.keywordItem.brand_info)?void 0:e.show_content))]),n("mp-keyword-ad-card",{ref:"adCard",attrs:{"ad-info":t.keywordItem.brand_info},on:{"ad-card-click":t.adCardClick}})],1)],1)}),[],!1,null,"78f1a879",null,null).exports;const Yo=pt({components:{[Mi.name]:Mi,[qo.name]:qo,[C.name]:C,[T.name]:T,[Io.name]:Io,[so.name]:so,[Co.name]:Co,[It.name]:It,[Go.name]:Go},data:()=>({showBottomBar:!!window.is_login,hasExtLoadDone:!!window.ext_complete_success}),computed:{...p(["cgiData"]),...p({statStyle:e=>{var t;return 3===(null==(t=e.extRes.appmsgstat)?void 0:t.style)?1:0}}),reprintStyle(){return this.cgiData.reprint_style},showReward(){return 0===this.cgiData.is_pay_subscribe||1===this.cgiData.isPaid},isPaySubscribe(){return 1*this.cgiData.is_pay_subscribe==1},albumTags(){return this.cgiData.publicTagInfo},showGongYi(){var e;return!!this.cgiData.is_login&&!!(null==(e=this.cgiData.yqj_info)?void 0:e.yqj_did)}},methods:{onShare(){eo()}},created(){Pe.on("ext-complete-success",(()=>{this.hasExtLoadDone=!0;const e=document.getElementById("js_temp_bottom_area");e&&(e.style.display="none")}))}},(function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"content_bottom_area"}},[e.reprintStyle?e._e():[t("mp-sponsor-ad"),e._v(" "),e.showGongYi?t("mp-gongyi"):e._e()],t("mp-added-info"),e._v(" "),e.reprintStyle||e.showGongYi?e._e():[e.showReward?t("mp-reward",{attrs:{"show-author":""}}):e._e(),e._v(" "),e.isPaySubscribe?t("mp-pay-read"):e._e()],t("mp-album",{attrs:{"album-tags":e.albumTags}}),e._v(" "),t("mp-keep-read"),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.hasExtLoadDone,expression:"hasExtLoadDone"}],staticClass:"rich_media_tool_area"},[t("mp-like-read-area",{attrs:{"stat-style":e.statStyle,"show-bottom-bar":e.showBottomBar},on:{share:e.onShare}})],1),t("mp-ad-keyword-bottom-modal")],2)}),[],!1,null,null,null,null).exports,Xo=window.Vue;const Qo=(Zo=["157","169","262"],1===window.show_related_article||Zo.indexOf(window.source)>-1||Zo.indexOf(window.subscene)>-1);var Zo,ea={exports:{}};const ta=He(ea.exports=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)},t=function(){return(t=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function n(e,t,n){if(n||2===arguments.length)for(var i,o=0,a=t.length;o<a;o++)!i&&o in t||((i=i||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:Ue,o=Object.keys,a=Array.isArray;function r(e,t){return"object"!=typeof t||o(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||i.Promise||(i.Promise=Promise);var s=Object.getPrototypeOf,c={}.hasOwnProperty;function l(e,t){return c.call(e,t)}function d(e,t){"function"==typeof t&&(t=t(s(e))),("undefined"==typeof Reflect?o:Reflect.ownKeys)(t).forEach((function(n){p(e,n,t[n])}))}var u=Object.defineProperty;function p(e,t,n,i){u(e,t,r(n&&l(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},i))}function m(e){return{from:function(t){return e.prototype=Object.create(t.prototype),p(e.prototype,"constructor",e),{extend:d.bind(null,e.prototype)}}}}var h=Object.getOwnPropertyDescriptor,_=[].slice;function f(e,t,n){return _.call(e,t,n)}function g(e,t){return t(e)}function w(e){if(!e)throw new Error("Assertion Failed")}function y(e){i.setImmediate?setImmediate(e):setTimeout(e,0)}function v(e,t){if("string"==typeof t&&l(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],i=0,o=t.length;i<o;++i){var a=v(e,t[i]);n.push(a)}return n}var r=t.indexOf(".");if(-1!==r){var s=e[t.substr(0,r)];return null==s?void 0:v(s,t.substr(r+1))}}function b(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){w("string"!=typeof n&&"length"in n);for(var i=0,o=t.length;i<o;++i)b(e,t[i],n[i])}else{var r,s,c=t.indexOf(".");-1!==c?(r=t.substr(0,c),""===(s=t.substr(c+1))?void 0===n?a(e)&&!isNaN(parseInt(r))?e.splice(r,1):delete e[r]:e[r]=n:b(c=(c=e[r])&&l(e,r)?c:e[r]={},s,n)):void 0===n?a(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function k(e){var t,n={};for(t in e)l(e,t)&&(n[t]=e[t]);return n}var x=[].concat;function S(e){return x.apply([],e)}var I="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(S([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return i[e]})),C=new Set(I.map((function(e){return i[e]}))),T=null;function A(e){return T=new WeakMap,e=function e(t){if(!t||"object"!=typeof t)return t;var n=T.get(t);if(n)return n;if(a(t)){n=[],T.set(t,n);for(var i=0,o=t.length;i<o;++i)n.push(e(t[i]))}else if(C.has(t.constructor))n=t;else{var r,c=s(t);for(r in n=c===Object.prototype?{}:Object.create(c),T.set(t,n),t)l(t,r)&&(n[r]=e(t[r]))}return n}(e),T=null,e}var E={}.toString;function P(e){return E.call(e).slice(8,-1)}var R="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",D="symbol"==typeof R?function(e){var t;return null!=e&&(t=e[R])&&t.apply(e)}:function(){return null};function j(e,t){return 0<=(t=e.indexOf(t))&&e.splice(t,1),0<=t}var O={};function B(e){var t,n,i,o;if(1===arguments.length){if(a(e))return e.slice();if(this===O&&"string"==typeof e)return[e];if(o=D(e)){for(n=[];!(i=o.next()).done;)n.push(i.value);return n}if(null==e)return[e];if("number"!=typeof(t=e.length))return[e];for(n=new Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var L="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},N=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(se=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"]),M={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function q(e,t){this.name=e,this.message=t}function W(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function z(e,t,n,i){this.failures=t,this.failedKeys=i,this.successCount=n,this.message=W(e,t)}function F(e,t){this.name="BulkError",this.failures=Object.keys(t).map((function(e){return t[e]})),this.failuresByPos=t,this.message=W(e,this.failures)}m(q).from(Error).extend({toString:function(){return this.name+": "+this.message}}),m(z).from(q),m(F).from(q);var U=N.reduce((function(e,t){return e[t]=t+"Error",e}),{}),H=q,V=N.reduce((function(e,t){var n=t+"Error";function i(e,i){this.name=n,e?"string"==typeof e?(this.message="".concat(e).concat(i?"\n "+i:""),this.inner=i||null):"object"==typeof e&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=M[t]||n,this.inner=null)}return m(i).from(H),e[t]=i,e}),{});V.Syntax=SyntaxError,V.Type=TypeError,V.Range=RangeError;var K=se.reduce((function(e,t){return e[t+"Error"]=V[t],e}),{}),$=N.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=V[t]),e}),{});function J(){}function G(e){return e}function Y(e,t){return null==e||e===G?t:function(n){return t(e(n))}}function X(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Q(e,t){return e===J?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?X(i,this.onsuccess):i),o&&(this.onerror=this.onerror?X(o,this.onerror):o),void 0!==a?a:n}}function Z(e,t){return e===J?t:function(){e.apply(this,arguments);var n=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?X(n,this.onsuccess):n),i&&(this.onerror=this.onerror?X(i,this.onerror):i)}}function ee(e,t){return e===J?t:function(n){var i=e.apply(this,arguments);r(n,i);var o=this.onsuccess,a=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),o&&(this.onsuccess=this.onsuccess?X(o,this.onsuccess):o),a&&(this.onerror=this.onerror?X(a,this.onerror):a),void 0===i?void 0===n?void 0:n:r(i,n)}}function te(e,t){return e===J?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function ne(e,t){return e===J?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var i=this,o=arguments.length,a=new Array(o);o--;)a[o]=arguments[o];return n.then((function(){return t.apply(i,a)}))}return t.apply(this,arguments)}}$.ModifyError=z,$.DexieError=q,$.BulkError=F;var ie="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function oe(e){ie=e}var ae={},re=100,se=(I="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,s(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,s(t),e]}())[0],ce=(N=I[1],I=I[2],N=N&&N.then,se&&se.constructor),le=!!I,de=function(e,t){we.push([e,t]),pe&&(queueMicrotask(Ae),pe=!1)},ue=!0,pe=!0,me=[],he=[],_e=G,fe={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:J,pgp:!1,env:{},finalize:J},ge=fe,we=[],ye=0,ve=[];function be(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=ge;if("function"!=typeof e){if(e!==ae)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Se(this,this._value))}this._state=null,this._value=null,++t.ref,function e(t,n){try{n((function(n){if(null===t._state){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var i=t._lib&&Ee();n&&"function"==typeof n.then?e(t,(function(e,t){n instanceof be?n._then(e,t):n.then(e,t)})):(t._state=!0,t._value=n,Ie(t)),i&&Pe()}}),Se.bind(null,t))}catch(i){Se(t,i)}}(this,e)}var ke={get:function(){var e=ge,t=Me;function n(n,i){var o=this,a=!e.global&&(e!==ge||t!==Me),r=a&&!Fe(),s=new be((function(t,s){Ce(o,new xe(Ge(n,e,a,r),Ge(i,e,a,r),t,s,e))}));return this._consoleTask&&(s._consoleTask=this._consoleTask),s}return n.prototype=ae,n},set:function(e){p(this,"then",e&&e.prototype===ae?ke:{get:function(){return e},set:ke.set})}};function xe(e,t,n,i,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=i,this.psd=o}function Se(e,t){var n,i;he.push(t),null===e._state&&(n=e._lib&&Ee(),t=_e(t),e._state=!1,e._value=t,i=e,me.some((function(e){return e._value===i._value}))||me.push(i),Ie(e),n&&Pe())}function Ie(e){var t=e._listeners;e._listeners=[];for(var n=0,i=t.length;n<i;++n)Ce(e,t[n]);var o=e._PSD;--o.ref||o.finalize(),0===ye&&(++ye,de((function(){0==--ye&&Re()}),[]))}function Ce(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++ye,de(Te,[n,e,t])}else e._listeners.push(t)}function Te(e,t,n){try{var i,o=t._value;!t._state&&he.length&&(he=[]),i=ie&&t._consoleTask?t._consoleTask.run((function(){return e(o)})):e(o),t._state||-1!==he.indexOf(o)||function(e){for(var t=me.length;t;)if(me[--t]._value===e._value)return me.splice(t,1)}(t),n.resolve(i)}catch(a){n.reject(a)}finally{0==--ye&&Re(),--n.psd.ref||n.psd.finalize()}}function Ae(){Je(fe,(function(){Ee()&&Pe()}))}function Ee(){var e=ue;return pe=ue=!1,e}function Pe(){var e,t,n;do{for(;0<we.length;)for(e=we,we=[],n=e.length,t=0;t<n;++t){var i=e[t];i[0].apply(null,i[1])}}while(0<we.length);pe=ue=!0}function Re(){var e=me;me=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=ve.slice(0),n=t.length;n;)t[--n]()}function De(e){return new be(ae,!1,e)}function je(e,t){var n=ge;return function(){var i=Ee(),o=ge;try{return Ke(n,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{Ke(o,!1),i&&Pe()}}}d(be.prototype,{then:ke,_then:function(e,t){Ce(this,new xe(null,null,e,t,ge))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=e,n=arguments[1];return"function"==typeof t?this.then(null,(function(e){return(e instanceof t?n:De)(e)})):this.then(null,(function(e){return(e&&e.name===t?n:De)(e)}))},finally:function(e){return this.then((function(t){return be.resolve(e()).then((function(){return t}))}),(function(t){return be.resolve(e()).then((function(){return De(t)}))}))},timeout:function(e,t){var n=this;return e<1/0?new be((function(i,o){var a=setTimeout((function(){return o(new V.Timeout(t))}),e);n.then(i,o).finally(clearTimeout.bind(null,a))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&p(be.prototype,Symbol.toStringTag,"Dexie.Promise"),fe.env=$e(),d(be,{all:function(){var e=B.apply(null,arguments).map(He);return new be((function(t,n){0===e.length&&t([]);var i=e.length;e.forEach((function(o,a){return be.resolve(o).then((function(n){e[a]=n,--i||t(e)}),n)}))}))},resolve:function(e){return e instanceof be?e:e&&"function"==typeof e.then?new be((function(t,n){e.then(t,n)})):new be(ae,!0,e)},reject:De,race:function(){var e=B.apply(null,arguments).map(He);return new be((function(t,n){e.map((function(e){return be.resolve(e).then(t,n)}))}))},PSD:{get:function(){return ge},set:function(e){return ge=e}},totalEchoes:{get:function(){return Me}},newPSD:We,usePSD:Je,scheduler:{get:function(){return de},set:function(e){de=e}},rejectionMapper:{get:function(){return _e},set:function(e){_e=e}},follow:function(e,t){return new be((function(n,i){return We((function(t,n){var i=ge;i.unhandleds=[],i.onunhandled=n,i.finalize=X((function(){var e,i=this;e=function(){0===i.unhandleds.length?t():n(i.unhandleds[0])},ve.push((function t(){e(),ve.splice(ve.indexOf(t),1)})),++ye,de((function(){0==--ye&&Re()}),[])}),i.finalize),e()}),t,n,i)}))}}),ce&&(ce.allSettled&&p(be,"allSettled",(function(){var e=B.apply(null,arguments).map(He);return new be((function(t){0===e.length&&t([]);var n=e.length,i=new Array(n);e.forEach((function(e,o){return be.resolve(e).then((function(e){return i[o]={status:"fulfilled",value:e}}),(function(e){return i[o]={status:"rejected",reason:e}})).then((function(){return--n||t(i)}))}))}))})),ce.any&&"undefined"!=typeof AggregateError&&p(be,"any",(function(){var e=B.apply(null,arguments).map(He);return new be((function(t,n){0===e.length&&n(new AggregateError([]));var i=e.length,o=new Array(i);e.forEach((function(e,a){return be.resolve(e).then((function(e){return t(e)}),(function(e){o[a]=e,--i||n(new AggregateError(o))}))}))}))})));var Oe={awaits:0,echoes:0,id:0},Be=0,Le=[],Ne=0,Me=0,qe=0;function We(e,t,n,i){var o=ge,a=Object.create(o);return a.parent=o,a.ref=0,a.global=!1,a.id=++qe,fe.env,a.env=le?{Promise:be,PromiseProp:{value:be,configurable:!0,writable:!0},all:be.all,race:be.race,allSettled:be.allSettled,any:be.any,resolve:be.resolve,reject:be.reject}:{},t&&r(a,t),++o.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()},i=Je(a,e,n,i),0===a.ref&&a.finalize(),i}function ze(){return Oe.id||(Oe.id=++Be),++Oe.awaits,Oe.echoes+=re,Oe.id}function Fe(){return!!Oe.awaits&&(0==--Oe.awaits&&(Oe.id=0),Oe.echoes=Oe.awaits*re,!0)}function He(e){return Oe.echoes&&e&&e.constructor===ce?(ze(),e.then((function(e){return Fe(),e}),(function(e){return Fe(),Xe(e)}))):e}function Ve(){var e=Le[Le.length-1];Le.pop(),Ke(e,!1)}function Ke(e,t){var n,o=ge;(t?!Oe.echoes||Ne++&&e===ge:!Ne||--Ne&&e===ge)||queueMicrotask(t?function(e){++Me,Oe.echoes&&0!=--Oe.echoes||(Oe.echoes=Oe.awaits=Oe.id=0),Le.push(ge),Ke(e,!0)}.bind(null,e):Ve),e!==ge&&(ge=e,o===fe&&(fe.env=$e()),le&&(n=fe.env.Promise,t=e.env,(o.global||e.global)&&(Object.defineProperty(i,"Promise",t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function $e(){var e=i.Promise;return le?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Je(e,t,n,i,o){var a=ge;try{return Ke(e,!0),t(n,i,o)}finally{Ke(a,!1)}}function Ge(e,t,n,i){return"function"!=typeof e?e:function(){var o=ge;n&&ze(),Ke(t,!0);try{return e.apply(this,arguments)}finally{Ke(o,!1),i&&queueMicrotask(Fe)}}}function Ye(e){Promise===ce&&0===Oe.echoes?0===Ne?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+N).indexOf("[native code]")&&(ze=Fe=J);var Xe=be.reject,Qe=String.fromCharCode(65535),Ze="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",et="String expected.",tt=[],nt="__dbnames",it="readonly",ot="readwrite";function at(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var rt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function st(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=A(t))[e],t}}function ct(){throw V.Type()}function lt(e,t){try{var n=dt(e),i=dt(t);if(n!==i)return"Array"===n?1:"Array"===i?-1:"binary"===n?1:"binary"===i?-1:"string"===n?1:"string"===i?-1:"Date"===n?1:"Date"!==i?NaN:-1;switch(n){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(e,t){for(var n=e.length,i=t.length,o=n<i?n:i,a=0;a<o;++a)if(e[a]!==t[a])return e[a]<t[a]?-1:1;return n===i?0:n<i?-1:1}(ut(e),ut(t));case"Array":return function(e,t){for(var n=e.length,i=t.length,o=n<i?n:i,a=0;a<o;++a){var r=lt(e[a],t[a]);if(0!==r)return r}return n===i?0:n<i?-1:1}(e,t)}}catch(o){}return NaN}function dt(e){var t=typeof e;return"object"!=t?t:ArrayBuffer.isView(e)||"ArrayBuffer"===(e=P(e))?"binary":e}function ut(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var pt=(mt.prototype._trans=function(e,t,n){var i=this._tx||ge.trans,o=this.name,a=ie&&"undefined"!=typeof console&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===e?"read":"write"," ").concat(this.name));function r(e,n,i){if(!i.schema[o])throw new V.NotFound("Table "+o+" not part of transaction");return t(i.idbtrans,i)}var s=Ee();try{var c=i&&i.db._novip===this.db._novip?i===ge.trans?i._promise(e,r,n):We((function(){return i._promise(e,r,n)}),{trans:i,transless:ge.transless||ge}):function e(t,n,i,o){if(t.idbdb&&(t._state.openComplete||ge.letThrough||t._vip)){var a=t._createTransaction(n,i,t._dbSchema);try{a.create(),t._state.PR1398_maxLoop=3}catch(r){return r.name===U.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),t.close({disableAutoOpen:!1}),t.open().then((function(){return e(t,n,i,o)}))):Xe(r)}return a._promise(n,(function(e,t){return We((function(){return ge.trans=a,o(e,t,a)}))})).then((function(e){if("readwrite"===n)try{a.idbtrans.commit()}catch(t){}return"readonly"===n?e:a._completion.then((function(){return e}))}))}if(t._state.openComplete)return Xe(new V.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return Xe(new V.DatabaseClosed);t.open().catch(J)}return t._state.dbReadyPromise.then((function(){return e(t,n,i,o)}))}(this.db,e,[this.name],r);return a&&(c._consoleTask=a,c=c.catch((function(e){return console.trace(e),Xe(e)}))),c}finally{s&&Pe()}},mt.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):null==e?Xe(new V.Type("Invalid argument to Table.get()")):this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)},mt.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(a(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=o(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){if(e.compound&&t.every((function(t){return 0<=e.keyPath.indexOf(t)}))){for(var n=0;n<t.length;++n)if(-1===t.indexOf(e.keyPath[n]))return!1;return!0}return!1})).sort((function(e,t){return e.keyPath.length-t.keyPath.length}))[0];if(n&&this.db._maxKey!==Qe){var i=n.keyPath.slice(0,t.length);return this.where(i).equals(i.map((function(t){return e[t]})))}!n&&ie&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var r=this.schema.idxByName,s=this.db._deps.indexedDB;function c(e,t){return 0===s.cmp(e,t)}i=(l=t.reduce((function(t,n){var i=t[0],o=t[1],s=(t=r[n],e[n]);return[i||t,i||!t?at(o,t&&t.multi?function(e){return e=v(e,n),a(e)&&e.some((function(e){return c(s,e)}))}:function(e){return c(s,v(e,n))}):o]}),[null,null]))[0];var l=l[1];return i?this.where(i.name).equals(e[i.keyPath]).filter(l):n?this.filter(l):this.where(t).equals("")},mt.prototype.filter=function(e){return this.toCollection().and(e)},mt.prototype.count=function(e){return this.toCollection().count(e)},mt.prototype.offset=function(e){return this.toCollection().offset(e)},mt.prototype.limit=function(e){return this.toCollection().limit(e)},mt.prototype.each=function(e){return this.toCollection().each(e)},mt.prototype.toArray=function(e){return this.toCollection().toArray(e)},mt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},mt.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,a(e)?"[".concat(e.join("+"),"]"):e))},mt.prototype.reverse=function(){return this.toCollection().reverse()},mt.prototype.mapToClass=function(t){var n,i=this.db,o=this.name;function a(){return null!==n&&n.apply(this,arguments)||this}(this.schema.mappedClass=t).prototype instanceof ct&&(function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}(a,n=t),Object.defineProperty(a.prototype,"db",{get:function(){return i},enumerable:!1,configurable:!0}),a.prototype.table=function(){return o},t=a);for(var r=new Set,c=t.prototype;c;c=s(c))Object.getOwnPropertyNames(c).forEach((function(e){return r.add(e)}));function l(e){if(!e)return e;var n,i=Object.create(t.prototype);for(n in e)if(!r.has(n))try{i[n]=e[n]}catch(o){}return i}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=l,this.hook("reading",l),t},mt.prototype.defineClass=function(){return this.mapToClass((function(e){r(this,e)}))},mt.prototype.add=function(e,t){var n=this,i=this.schema.primKey,o=i.auto,a=i.keyPath,r=e;return a&&o&&(r=st(a)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[r]})})).then((function(e){return e.numFailures?be.reject(e.failures[0]):e.lastResult})).then((function(t){if(a)try{b(e,a,t)}catch(n){}return t}))},mt.prototype.update=function(e,t){return"object"!=typeof e||a(e)?this.where(":id").equals(e).modify(t):void 0===(e=v(e,this.schema.primKey.keyPath))?Xe(new V.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t)},mt.prototype.put=function(e,t){var n=this,i=this.schema.primKey,o=i.auto,a=i.keyPath,r=e;return a&&o&&(r=st(a)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"put",values:[r],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?be.reject(e.failures[0]):e.lastResult})).then((function(t){if(a)try{b(e,a,t)}catch(n){}return t}))},mt.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?be.reject(e.failures[0]):void 0}))},mt.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:rt})})).then((function(e){return e.numFailures?be.reject(e.failures[0]):void 0}))},mt.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},mt.prototype.bulkAdd=function(e,t,n){var i=this,o=Array.isArray(t)?t:void 0,a=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=(s=i.schema.primKey).auto;if((s=s.keyPath)&&o)throw new V.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new V.InvalidArgument("Arguments objects and keys must have the same length");var r=e.length,s=s&&n?e.map(st(s)):e;return i.core.mutate({trans:t,type:"add",keys:o,values:s,wantResults:a}).then((function(e){var t=e.numFailures,n=e.results,o=e.lastResult;if(e=e.failures,0===t)return a?n:o;throw new F("".concat(i.name,".bulkAdd(): ").concat(t," of ").concat(r," operations failed"),e)}))}))},mt.prototype.bulkPut=function(e,t,n){var i=this,o=Array.isArray(t)?t:void 0,a=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=(s=i.schema.primKey).auto;if((s=s.keyPath)&&o)throw new V.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new V.InvalidArgument("Arguments objects and keys must have the same length");var r=e.length,s=s&&n?e.map(st(s)):e;return i.core.mutate({trans:t,type:"put",keys:o,values:s,wantResults:a}).then((function(e){var t=e.numFailures,n=e.results,o=e.lastResult;if(e=e.failures,0===t)return a?n:o;throw new F("".concat(i.name,".bulkPut(): ").concat(t," of ").concat(r," operations failed"),e)}))}))},mt.prototype.bulkUpdate=function(e){var t=this,n=this.core,i=e.map((function(e){return e.key})),o=e.map((function(e){return e.changes})),a=[];return this._trans("readwrite",(function(r){return n.getMany({trans:r,keys:i,cache:"clone"}).then((function(s){var c=[],l=[];e.forEach((function(e,n){var i=e.key,o=e.changes,r=s[n];if(r){for(var d=0,u=Object.keys(o);d<u.length;d++){var p=u[d],m=o[p];if(p===t.schema.primKey.keyPath){if(0!==lt(m,i))throw new V.Constraint("Cannot update primary key in bulkUpdate()")}else b(r,p,m)}a.push(n),c.push(i),l.push(r)}}));var d=c.length;return n.mutate({trans:r,type:"put",keys:c,values:l,updates:{keys:i,changeSpecs:o}}).then((function(e){var n=e.numFailures,i=e.failures;if(0===n)return d;for(var o=0,r=Object.keys(i);o<r.length;o++){var s,c=r[o],l=a[Number(c)];null!=l&&(s=i[c],delete i[c],i[l]=s)}throw new F("".concat(t.name,".bulkUpdate(): ").concat(n," of ").concat(d," operations failed"),i)}))}))}))},mt.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var i=e.numFailures,o=e.lastResult;if(e=e.failures,0===i)return o;throw new F("".concat(t.name,".bulkDelete(): ").concat(i," of ").concat(n," operations failed"),e)}))},mt);function mt(){}function ht(e){function t(t,i){if(i){for(var o=arguments.length,a=new Array(o-1);--o;)a[o-1]=arguments[o];return n[t].subscribe.apply(null,a),e}if("string"==typeof t)return n[t]}var n={};t.addEventType=s;for(var i=1,r=arguments.length;i<r;++i)s(arguments[i]);return t;function s(e,i,r){if("object"!=typeof e){var c;i=i||te;var l={subscribers:[],fire:r=r||J,subscribe:function(e){-1===l.subscribers.indexOf(e)&&(l.subscribers.push(e),l.fire=i(l.fire,e))},unsubscribe:function(e){l.subscribers=l.subscribers.filter((function(t){return t!==e})),l.fire=l.subscribers.reduce(i,r)}};return n[e]=t[e]=l}o(c=e).forEach((function(e){var t=c[e];if(a(t))s(e,c[e][0],c[e][1]);else{if("asap"!==t)throw new V.InvalidArgument("Invalid event config");var n=s(e,G,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];n.subscribers.forEach((function(e){y((function(){e.apply(null,t)}))}))}))}}))}}function _t(e,t){return m(t).from({prototype:e}),t}function ft(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function gt(e,t){e.filter=at(e.filter,t)}function wt(e,t,n){var i=e.replayFilter;e.replayFilter=i?function(){return at(i(),t())}:t,e.justLimit=n&&!i}function yt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new V.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function vt(e,t,n){var i=yt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:i,range:e.range}})}function bt(e,t,n,i){var o=e.replayFilter?at(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},r=function(e,n,i){var r,s;o&&!o(n,i,(function(e){return n.stop(e)}),(function(e){return n.fail(e)}))||("[object ArrayBuffer]"==(s=""+(r=n.primaryKey))&&(s=""+new Uint8Array(r)),l(a,s)||(a[s]=!0,t(e,n,i)))};return Promise.all([e.or._iterate(r,n),kt(vt(e,i,n),e.algorithm,r,!e.keysOnly&&e.valueMapper)])}return kt(vt(e,i,n),at(e.algorithm,o),t,!e.keysOnly&&e.valueMapper)}function kt(e,t,n,i){var o=je(i?function(e,t,o){return n(i(e),t,o)}:n);return e.then((function(e){if(e)return e.start((function(){var n=function(){return e.continue()};t&&!t(e,(function(e){return n=e}),(function(t){e.stop(t),n=J}),(function(t){e.fail(t),n=J}))||o(e.value,e,(function(e){return n=e})),n()}))}))}I=Symbol();var xt=(St.prototype.execute=function(e){var t=null===(t=this.replacePrefix)||void 0===t?void 0:t[0];return t&&"string"==typeof e&&e.startsWith(t)?this.replacePrefix[1]+e.substring(t.length):e},St);function St(e){Object.assign(this,e)}var It=(Ct.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,Xe.bind(null,n.error)):n.table._trans("readonly",e).then(t)},Ct.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Xe.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},Ct.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=at(t.algorithm,e)},Ct.prototype._iterate=function(e,t){return bt(this._ctx,e,t,this._ctx.table.core)},Ct.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&r(n,e),t._ctx=n,t},Ct.prototype.raw=function(){return this._ctx.valueMapper=null,this},Ct.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return bt(t,e,n,t.table.core)}))},Ct.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx,i=n.table.core;if(ft(n,!0))return i.count({trans:e,query:{index:yt(n,i.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}));var o=0;return bt(n,(function(){return++o,!1}),e,i).then((function(){return o}))})).then(e)},Ct.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),i=n[0],o=n.length-1;function a(e,t){return t?a(e[n[t]],t-1):e[i]}var r="next"===this._ctx.dir?1:-1;function s(e,t){return(e=a(e,o))<(t=a(t,o))?-r:t<e?r:0}return this.toArray((function(e){return e.sort(s)})).then(t)},Ct.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if("next"===n.dir&&ft(n,!0)&&0<n.limit){var i=n.valueMapper,o=yt(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:o,range:n.range}}).then((function(e){return e=e.result,i?e.map(i):e}))}var a=[];return bt(n,(function(e){return a.push(e)}),e,n.table.core).then((function(){return a}))}),e)},Ct.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,ft(t)?wt(t,(function(){var t=e;return function(e,n){return 0===t||(1===t?--t:n((function(){e.advance(t),t=0})),!1)}})):wt(t,(function(){var t=e;return function(){return--t<0}}))),this},Ct.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),wt(this._ctx,(function(){var t=e;return function(e,n,i){return--t<=0&&n(i),0<=t}}),!0),this},Ct.prototype.until=function(e,t){return gt(this._ctx,(function(n,i,o){return!e(n.value)||(i(o),t)})),this},Ct.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},Ct.prototype.last=function(e){return this.reverse().first(e)},Ct.prototype.filter=function(e){var t;return gt(this._ctx,(function(t){return e(t.value)})),(t=this._ctx).isMatch=at(t.isMatch,e),this},Ct.prototype.and=function(e){return this.filter(e)},Ct.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},Ct.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Ct.prototype.desc=function(){return this.reverse()},Ct.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},Ct.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},Ct.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},Ct.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},Ct.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&ft(t,!0)&&0<t.limit)return this._read((function(e){var n=yt(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},Ct.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},Ct.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},Ct.prototype.lastKey=function(e){return this.reverse().firstKey(e)},Ct.prototype.distinct=function(){var e;if(!(e=(e=this._ctx).index&&e.table.schema.idxByName[e.index])||!e.multi)return this;var t={};return gt(this._ctx,(function(e){var n=e.primaryKey.toString();return e=l(t,n),t[n]=!0,!e})),this},Ct.prototype.modify=function(e){var t=this,n=this._ctx;return this._write((function(i){var a,r,s;function c(e,t){var n=t.failures;t=t.numFailures,_+=e-t;for(var i=0,a=o(n);i<a.length;i++){var r=a[i];h.push(n[r])}}s="function"==typeof e?e:(a=o(e),r=a.length,function(t){for(var n=!1,i=0;i<r;++i){var o=a[i],s=e[o],c=v(t,o);s instanceof xt?(b(t,o,s.execute(c)),n=!0):c!==s&&(b(t,o,s),n=!0)}return n});var l=n.table.core,d=l.schema.primaryKey,u=d.outbound,p=d.extractKey,m=t.db._options.modifyChunkSize||200,h=[],_=0,f=[];return t.clone().primaryKeys().then((function(t){function o(a){var r=Math.min(m,t.length-a);return l.getMany({trans:i,keys:t.slice(a,a+r),cache:"immutable"}).then((function(d){for(var h=[],_=[],f=u?[]:null,g=[],w=0;w<r;++w){var y=d[w],v={value:A(y),primKey:t[a+w]};!1!==s.call(v,v.value,v)&&(null==v.value?g.push(t[a+w]):u||0===lt(p(y),p(v.value))?(_.push(v.value),u&&f.push(t[a+w])):(g.push(t[a+w]),h.push(v.value)))}var b=ft(n)&&n.limit===1/0&&("function"!=typeof e||e===Tt)&&{index:n.index,range:n.range};return Promise.resolve(0<h.length&&l.mutate({trans:i,type:"add",values:h}).then((function(e){for(var t in e.failures)g.splice(parseInt(t),1);c(h.length,e)}))).then((function(){return(0<_.length||b&&"object"==typeof e)&&l.mutate({trans:i,type:"put",keys:f,values:_,criteria:b,changeSpec:"function"!=typeof e&&e}).then((function(e){return c(_.length,e)}))})).then((function(){return(0<g.length||b&&e===Tt)&&l.mutate({trans:i,type:"delete",keys:g,criteria:b}).then((function(e){return c(g.length,e)}))})).then((function(){return t.length>a+r&&o(a+m)}))}))}return o(0).then((function(){if(0<h.length)throw new z("Error modifying one or more objects",h,_,f);return t.length}))}))}))},Ct.prototype.delete=function(){var e=this._ctx,t=e.range;return ft(e)&&(e.isPrimKey||3===t.type)?this._write((function(n){var i=e.table.core.schema.primaryKey,o=t;return e.table.core.count({trans:n,query:{index:i,range:o}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:o}).then((function(e){var n=e.failures;if(e.lastResult,e.results,e=e.numFailures)throw new z("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-e);return t-e}))}))})):this.modify(Tt)},Ct);function Ct(){}var Tt=function(e,t){return t.value=null};function At(e,t){return e<t?-1:e===t?0:1}function Et(e,t){return t<e?-1:e===t?0:1}function Pt(e,t,n){return(e=e instanceof Bt?new e.Collection(e):e)._ctx.error=new(n||TypeError)(t),e}function Rt(e){return new e.Collection(e,(function(){return Ot("")})).limit(0)}function Dt(e,t,n,i){var o,a,r,s,c,l,d,u=n.length;if(!n.every((function(e){return"string"==typeof e})))return Pt(e,et);function p(e){o="next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()},a="next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()},r="next"===e?At:Et;var t=n.map((function(e){return{lower:a(e),upper:o(e)}})).sort((function(e,t){return r(e.lower,t.lower)}));s=t.map((function(e){return e.upper})),c=t.map((function(e){return e.lower})),d="next"===(l=e)?"":i}p("next"),(e=new e.Collection(e,(function(){return jt(s[0],c[u-1]+i)})))._ondirectionchange=function(e){p(e)};var m=0;return e._addAlgorithm((function(e,n,i){var o=e.key;if("string"!=typeof o)return!1;var p=a(o);if(t(p,c,m))return!0;for(var h=null,_=m;_<u;++_){var f=function(e,t,n,i,o,a){for(var r=Math.min(e.length,i.length),s=-1,c=0;c<r;++c){var l=t[c];if(l!==i[c])return o(e[c],n[c])<0?e.substr(0,c)+n[c]+n.substr(c+1):o(e[c],i[c])<0?e.substr(0,c)+i[c]+n.substr(c+1):0<=s?e.substr(0,s)+t[s]+n.substr(s+1):null;o(e[c],l)<0&&(s=c)}return r<i.length&&"next"===a?e+n.substr(e.length):r<e.length&&"prev"===a?e.substr(0,n.length):s<0?null:e.substr(0,s)+i[s]+n.substr(s+1)}(o,p,s[_],c[_],r,l);null===f&&null===h?m=_+1:(null===h||0<r(h,f))&&(h=f)}return n(null!==h?function(){e.continue(h+d)}:i),!1})),e}function jt(e,t,n,i){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:i}}function Ot(e){return{type:1,lower:e,upper:e}}var Bt=(Object.defineProperty(Lt.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Lt.prototype.between=function(e,t,n,i){n=!1!==n,i=!0===i;try{return 0<this._cmp(e,t)||0===this._cmp(e,t)&&(n||i)&&(!n||!i)?Rt(this):new this.Collection(this,(function(){return jt(e,t,!n,!i)}))}catch(o){return Pt(this,Ze)}},Lt.prototype.equals=function(e){return null==e?Pt(this,Ze):new this.Collection(this,(function(){return Ot(e)}))},Lt.prototype.above=function(e){return null==e?Pt(this,Ze):new this.Collection(this,(function(){return jt(e,void 0,!0)}))},Lt.prototype.aboveOrEqual=function(e){return null==e?Pt(this,Ze):new this.Collection(this,(function(){return jt(e,void 0,!1)}))},Lt.prototype.below=function(e){return null==e?Pt(this,Ze):new this.Collection(this,(function(){return jt(void 0,e,!1,!0)}))},Lt.prototype.belowOrEqual=function(e){return null==e?Pt(this,Ze):new this.Collection(this,(function(){return jt(void 0,e)}))},Lt.prototype.startsWith=function(e){return"string"!=typeof e?Pt(this,et):this.between(e,e+Qe,!0,!0)},Lt.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Dt(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],Qe)},Lt.prototype.equalsIgnoreCase=function(e){return Dt(this,(function(e,t){return e===t[0]}),[e],"")},Lt.prototype.anyOfIgnoreCase=function(){var e=B.apply(O,arguments);return 0===e.length?Rt(this):Dt(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},Lt.prototype.startsWithAnyOfIgnoreCase=function(){var e=B.apply(O,arguments);return 0===e.length?Rt(this):Dt(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,Qe)},Lt.prototype.anyOf=function(){var e=this,t=B.apply(O,arguments),n=this._cmp;try{t.sort(n)}catch(a){return Pt(this,Ze)}if(0===t.length)return Rt(this);var i=new this.Collection(this,(function(){return jt(t[0],t[t.length-1])}));i._ondirectionchange=function(i){n="next"===i?e._ascending:e._descending,t.sort(n)};var o=0;return i._addAlgorithm((function(e,i,a){for(var r=e.key;0<n(r,t[o]);)if(++o===t.length)return i(a),!1;return 0===n(r,t[o])||(i((function(){e.continue(t[o])})),!1)})),i},Lt.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Lt.prototype.noneOf=function(){var e=B.apply(O,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(n){return Pt(this,Ze)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Lt.prototype.inAnyRange=function(e,t){var n=this,i=this._cmp,o=this._ascending,a=this._descending,r=this._min,s=this._max;if(0===e.length)return Rt(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&o(e[0],e[1])<=0})))return Pt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",V.InvalidArgument);var c,l=!t||!1!==t.includeLowers,d=t&&!0===t.includeUppers,u=o;function p(e,t){return u(e[0],t[0])}try{(c=e.reduce((function(e,t){for(var n=0,o=e.length;n<o;++n){var a=e[n];if(i(t[0],a[1])<0&&0<i(t[1],a[0])){a[0]=r(a[0],t[0]),a[1]=s(a[1],t[1]);break}}return n===o&&e.push(t),e}),[])).sort(p)}catch(g){return Pt(this,Ze)}var m=0,h=d?function(e){return 0<o(e,c[m][1])}:function(e){return 0<=o(e,c[m][1])},_=l?function(e){return 0<a(e,c[m][0])}:function(e){return 0<=a(e,c[m][0])},f=h;return(e=new this.Collection(this,(function(){return jt(c[0][0],c[c.length-1][1],!l,!d)})))._ondirectionchange=function(e){u="next"===e?(f=h,o):(f=_,a),c.sort(p)},e._addAlgorithm((function(e,t,i){for(var a,r=e.key;f(r);)if(++m===c.length)return t(i),!1;return!h(a=r)&&!_(a)||(0===n._cmp(r,c[m][1])||0===n._cmp(r,c[m][0])||t((function(){u===o?e.continue(c[m][0]):e.continue(c[m][1])})),!1)})),e},Lt.prototype.startsWithAnyOf=function(){var e=B.apply(O,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?Rt(this):this.inAnyRange(e.map((function(e){return[e,e+Qe]}))):Pt(this,"startsWithAnyOf() only works with strings")},Lt);function Lt(){}function Nt(e){return je((function(t){return Mt(t),e(t.target.error),!1}))}function Mt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var qt="storagemutated",Wt="x-storagemutated-1",zt=ht(null,qt),Ft=(Ut.prototype._lock=function(){return w(!ge.global),++this._reculock,1!==this._reculock||ge.global||(ge.lockOwnerFor=this),this},Ut.prototype._unlock=function(){if(w(!ge.global),0==--this._reculock)for(ge.global||(ge.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Je(e[1],e[0])}catch(t){}}return this},Ut.prototype._locked=function(){return this._reculock&&ge.lockOwnerFor!==this},Ut.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,i=this.db._state.dbOpenError;if(w(!this.idbtrans),!e&&!n)switch(i&&i.name){case"DatabaseClosedError":throw new V.DatabaseClosed(i);case"MissingAPIError":throw new V.MissingAPI(i.message,i);default:throw new V.OpenFailed(i)}if(!this.active)throw new V.TransactionInactive;return w(null===this._completion._state),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=je((function(n){Mt(n),t._reject(e.error)})),e.onabort=je((function(n){Mt(n),t.active&&t._reject(new V.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=je((function(){t.active=!1,t._resolve(),"mutatedParts"in e&&zt.storagemutated.fire(e.mutatedParts)})),this},Ut.prototype._promise=function(e,t,n){var i=this;if("readwrite"===e&&"readwrite"!==this.mode)return Xe(new V.ReadOnly("Transaction is readonly"));if(!this.active)return Xe(new V.TransactionInactive);if(this._locked())return new be((function(o,a){i._blockedFuncs.push([function(){i._promise(e,t,n).then(o,a)},ge])}));if(n)return We((function(){var e=new be((function(e,n){i._lock();var o=t(e,n,i);o&&o.then&&o.then(e,n)}));return e.finally((function(){return i._unlock()})),e._lib=!0,e}));var o=new be((function(e,n){var o=t(e,n,i);o&&o.then&&o.then(e,n)}));return o._lib=!0,o},Ut.prototype._root=function(){return this.parent?this.parent._root():this},Ut.prototype.waitFor=function(e){var t,n=this._root(),i=be.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then((function(){return i})):(n._waitingFor=i,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),function e(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=e)}());var o=n._waitingFor;return new be((function(e,t){i.then((function(t){return n._waitingQueue.push(je(e.bind(null,t)))}),(function(e){return n._waitingQueue.push(je(t.bind(null,e)))})).finally((function(){n._waitingFor===o&&(n._waitingFor=null)}))}))},Ut.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new V.Abort))},Ut.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(l(t,e))return t[e];var n=this.schema[e];if(!n)throw new V.NotFound("Table "+e+" not part of transaction");return(n=new this.db.Table(e,n,this)).core=this.db.core.table(e),t[e]=n},Ut);function Ut(){}function Ht(e,t,n,i,o,a,r){return{name:e,keyPath:t,unique:n,multi:i,auto:o,compound:a,src:(n&&!r?"&":"")+(i?"*":"")+(o?"++":"")+Vt(t)}}function Vt(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Kt(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(i=function(e){return[e.name,e]},n.reduce((function(e,t,n){return(n=i(t,n))&&(e[n[0]]=n[1]),e}),{}))};var i}var $t=function(e){try{return e.only([[]]),$t=function(){return[[]]},[[]]}catch(t){return $t=function(){return Qe},Qe}};function Jt(e){return null==e?function(){}:"string"==typeof e?1===(t=e).split(".").length?function(e){return e[t]}:function(e){return v(e,t)}:function(t){return v(t,e)};var t}function Gt(e){return[].slice.call(e)}var Yt=0;function Xt(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function Qt(e,t,n){function i(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var n=e.lower,i=e.upper,o=e.lowerOpen;return e=e.upperOpen,void 0===n?void 0===i?null:t.upperBound(i,!!e):void 0===i?t.lowerBound(n,!!o):t.bound(n,i,!!o,!!e)}function o(e){var t,n=e.name;return{name:n,schema:e,mutate:function(e){var t=e.trans,o=e.type,a=e.keys,r=e.values,s=e.range;return new Promise((function(e,c){e=je(e);var l=t.objectStore(n),d=null==l.keyPath,u="put"===o||"add"===o;if(!u&&"delete"!==o&&"deleteRange"!==o)throw new Error("Invalid operation type: "+o);var p,m=(a||r||{length:1}).length;if(a&&r&&a.length!==r.length)throw new Error("Given keys array must have same length as given values array.");if(0===m)return e({numFailures:0,failures:{},results:[],lastResult:void 0});function h(e){++g,Mt(e)}var _=[],f=[],g=0;if("deleteRange"===o){if(4===s.type)return e({numFailures:g,failures:f,results:[],lastResult:void 0});3===s.type?_.push(p=l.clear()):_.push(p=l.delete(i(s)))}else{var w=(d=u?d?[r,a]:[r,null]:[a,null])[0],y=d[1];if(u)for(var v=0;v<m;++v)_.push(p=y&&void 0!==y[v]?l[o](w[v],y[v]):l[o](w[v])),p.onerror=h;else for(v=0;v<m;++v)_.push(p=l[o](w[v])),p.onerror=h}function b(t){t=t.target.result,_.forEach((function(e,t){return null!=e.error&&(f[t]=e.error)})),e({numFailures:g,failures:f,results:"delete"===o?a:_.map((function(e){return e.result})),lastResult:t})}p.onerror=function(e){h(e),b(e)},p.onsuccess=b}))},getMany:function(e){var t=e.trans,i=e.keys;return new Promise((function(e,o){e=je(e);for(var a,r=t.objectStore(n),s=i.length,c=new Array(s),l=0,d=0,u=function(t){t=t.target,c[t._pos]=t.result,++d===l&&e(c)},p=Nt(o),m=0;m<s;++m)null!=i[m]&&((a=r.get(i[m]))._pos=m,a.onsuccess=u,a.onerror=p,++l);0===l&&e(c)}))},get:function(e){var t=e.trans,i=e.key;return new Promise((function(e,o){e=je(e);var a=t.objectStore(n).get(i);a.onsuccess=function(t){return e(t.target.result)},a.onerror=Nt(o)}))},query:(t=l,function(e){return new Promise((function(o,a){o=je(o);var r,s,c,l=e.trans,d=e.values,u=e.limit,p=e.query,m=u===1/0?void 0:u,h=p.index;if(p=p.range,l=l.objectStore(n),h=h.isPrimaryKey?l:l.index(h.name),p=i(p),0===u)return o({result:[]});t?((m=d?h.getAll(p,m):h.getAllKeys(p,m)).onsuccess=function(e){return o({result:e.target.result})},m.onerror=Nt(a)):(r=0,s=!d&&"openKeyCursor"in h?h.openKeyCursor(p):h.openCursor(p),c=[],s.onsuccess=function(e){var t=s.result;return t?(c.push(d?t.value:t.primaryKey),++r===u?o({result:c}):void t.continue()):o({result:c})},s.onerror=Nt(a))}))}),openCursor:function(e){var t=e.trans,o=e.values,a=e.query,r=e.reverse,s=e.unique;return new Promise((function(e,c){e=je(e);var l=a.index,d=a.range,u=t.objectStore(n),p=(u=l.isPrimaryKey?u:u.index(l.name),l=r?s?"prevunique":"prev":s?"nextunique":"next",!o&&"openKeyCursor"in u?u.openKeyCursor(i(d),l):u.openCursor(i(d),l));p.onerror=Nt(c),p.onsuccess=je((function(n){var i,o,a,r,s=p.result;s?(s.___id=++Yt,s.done=!1,i=s.continue.bind(s),o=(o=s.continuePrimaryKey)&&o.bind(s),a=s.advance.bind(s),r=function(){throw new Error("Cursor not stopped")},s.trans=t,s.stop=s.continue=s.continuePrimaryKey=s.advance=function(){throw new Error("Cursor not started")},s.fail=je(c),s.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},s.start=function(e){function t(){if(p.result)try{e()}catch(t){s.fail(t)}else s.done=!0,s.start=function(){throw new Error("Cursor behind last entry")},s.stop()}var n=new Promise((function(e,t){e=je(e),p.onerror=Nt(t),s.fail=t,s.stop=function(t){s.stop=s.continue=s.continuePrimaryKey=s.advance=r,e(t)}}));return p.onsuccess=je((function(e){p.onsuccess=t,t()})),s.continue=i,s.continuePrimaryKey=o,s.advance=a,t(),n},e(s)):e(null)}),c)}))},count:function(e){var t=e.query,o=e.trans,a=t.index,r=t.range;return new Promise((function(e,t){var s=o.objectStore(n),c=a.isPrimaryKey?s:s.index(a.name);(c=(s=i(r))?c.count(s):c.count()).onsuccess=je((function(t){return e(t.target.result)})),c.onerror=Nt(t)}))}}}n=(s=n,c=Gt((r=e).objectStoreNames),d={schema:{name:r.name,tables:c.map((function(e){return s.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement,i=a(t),o={};return n={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==t,compound:i,keyPath:t,autoIncrement:n,unique:!0,extractKey:Jt(t)},indexes:Gt(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,i=e.multiEntry;return e=e.keyPath,i={name:t,compound:a(e),keyPath:e,unique:n,multiEntry:i,extractKey:Jt(e)},o[Xt(e)]=i})),getIndexByKeyPath:function(e){return o[Xt(e)]}},o[":id"]=n.primaryKey,null!=t&&(o[Xt(t)]=n.primaryKey),n}))},hasGetAll:0<c.length&&"getAll"in s.objectStore(c[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}).schema;var r,s,c,l=d.hasGetAll,d=n.tables.map(o),u={};return d.forEach((function(e){return u[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!u[e])throw new Error("Table '".concat(e,"' not found"));return u[e]},MIN_KEY:-1/0,MAX_KEY:$t(t),schema:n}}function Zt(e,n,i,o){var a=i.IDBKeyRange;return i.indexedDB,{dbcore:(o=Qt(n,a,o),e.dbcore.reduce((function(e,n){return n=n.create,t(t({},e),n(e))}),o))}}function en(e,t){var n=t.db;t=Zt(e._middlewares,n,e._deps,t),e.core=t.dbcore,e.tables.forEach((function(t){var n=t.name;e.core.schema.tables.some((function(e){return e.name===n}))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function tn(e,t,n,i){n.forEach((function(n){var o=i[n];t.forEach((function(t){var i=function e(t,n){return h(t,n)||(t=s(t))&&e(t,n)}(t,n);(!i||"value"in i&&void 0===i.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?p(t,n,{get:function(){return this.table(n)},set:function(e){u(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,o))}))}))}function nn(e,t){t.forEach((function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]}))}function on(e,t){return e._cfg.version-t._cfg.version}function an(e,t,n,i){var a=e._dbSchema;n.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=Kt("$meta",mn("")[0],[]),e._storeNames.push("$meta"));var r=e._createTransaction("readwrite",e._storeNames,a);r.create(n),r._completion.catch(i);var s=r._reject.bind(r),c=ge.transless||ge;We((function(){return ge.trans=r,ge.transless=c,0!==t?(en(e,n),l=t,((i=r).storeNames.includes("$meta")?i.table("$meta").get("version").then((function(e){return null!=e?e:l})):be.resolve(l)).then((function(t){return a=t,s=r,c=n,l=[],t=(i=e)._versions,d=i._dbSchema=un(0,i.idbdb,c),0!==(t=t.filter((function(e){return e._cfg.version>=a}))).length?(t.forEach((function(e){l.push((function(){var t=d,n=e._cfg.dbschema;pn(i,t,c),pn(i,n,c),d=i._dbSchema=n;var r=sn(t,n);r.add.forEach((function(e){cn(c,e[0],e[1].primKey,e[1].indexes)})),r.change.forEach((function(e){if(e.recreate)throw new V.Upgrade("Not yet support for changing primary key");var t=c.objectStore(e.name);e.add.forEach((function(e){return dn(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),dn(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var l=e._cfg.contentUpgrade;if(l&&e._cfg.version>a){en(i,c),s._memoizedTables={};var u=k(n);r.del.forEach((function(e){u[e]=t[e]})),nn(i,[i.Transaction.prototype]),tn(i,[i.Transaction.prototype],o(u),u),s.schema=u;var p,m=L(l);return m&&ze(),r=be.follow((function(){var e;(p=l(s))&&m&&(e=Fe.bind(null,null),p.then(e,e))})),p&&"function"==typeof p.then?be.resolve(p):r.then((function(){return p}))}})),l.push((function(t){var n,o,a=e._cfg.dbschema;n=a,o=t,[].slice.call(o.db.objectStoreNames).forEach((function(e){return null==n[e]&&o.db.deleteObjectStore(e)})),nn(i,[i.Transaction.prototype]),tn(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),s.schema=i._dbSchema})),l.push((function(t){i.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(i.idbdb.version/10)===e._cfg.version?(i.idbdb.deleteObjectStore("$meta"),delete i._dbSchema.$meta,i._storeNames=i._storeNames.filter((function(e){return"$meta"!==e}))):t.objectStore("$meta").put(e._cfg.version,"version"))}))})),function e(){return l.length?be.resolve(l.shift()(s.idbtrans)).then(e):be.resolve()}().then((function(){ln(d,c)}))):be.resolve();var i,a,s,c,l,d})).catch(s)):(o(a).forEach((function(e){cn(n,e,a[e].primKey,a[e].indexes)})),en(e,n),void be.follow((function(){return e.on.populate.fire(r)})).catch(s));var i,l}))}function rn(e,t){ln(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=un(0,e.idbdb,t);pn(e,e._dbSchema,t);for(var i=0,o=sn(n,e._dbSchema).change;i<o.length;i++){var a=function(e){if(e.change.length||e.recreate)return console.warn("Unable to patch indexes of table ".concat(e.name," because it has changes on the type of index or primary key.")),{value:void 0};var n=t.objectStore(e.name);e.add.forEach((function(t){ie&&console.debug("Dexie upgrade patch: Creating missing index ".concat(e.name,".").concat(t.src)),dn(n,t)}))}(o[i]);if("object"==typeof a)return a.value}}function sn(e,t){var n,i={del:[],add:[],change:[]};for(n in e)t[n]||i.del.push(n);for(n in t){var o=e[n],a=t[n];if(o){var r={name:n,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||o.primKey.auto!==a.primKey.auto)r.recreate=!0,i.change.push(r);else{var s=o.idxByName,c=a.idxByName,l=void 0;for(l in s)c[l]||r.del.push(l);for(l in c){var d=s[l],u=c[l];d?d.src!==u.src&&r.change.push(u):r.add.push(u)}(0<r.del.length||0<r.add.length||0<r.change.length)&&i.change.push(r)}}else i.add.push([n,a])}return i}function cn(e,t,n,i){var o=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return i.forEach((function(e){return dn(o,e)})),o}function ln(e,t){o(e).forEach((function(n){t.db.objectStoreNames.contains(n)||(ie&&console.debug("Dexie: Creating missing table",n),cn(t,n,e[n].primKey,e[n].indexes))}))}function dn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function un(e,t,n){var i={};return f(t.objectStoreNames,0).forEach((function(e){for(var t=n.objectStore(e),o=Ht(Vt(s=t.keyPath),s||"",!0,!1,!!t.autoIncrement,s&&"string"!=typeof s,!0),a=[],r=0;r<t.indexNames.length;++r){var s=(c=t.index(t.indexNames[r])).keyPath,c=Ht(c.name,s,!!c.unique,!!c.multiEntry,!1,s&&"string"!=typeof s,!1);a.push(c)}i[e]=Kt(e,o,a)})),i}function pn(e,t,n){for(var o=n.db.objectStoreNames,a=0;a<o.length;++a){var r=o[a],s=n.objectStore(r);e._hasGetAll="getAll"in s;for(var c=0;c<s.indexNames.length;++c){var l=s.indexNames[c],d=s.index(l).keyPath,u="string"==typeof d?d:"["+f(d).join("+")+"]";!t[r]||(d=t[r].idxByName[u])&&(d.name=l,delete t[r].idxByName[u],t[r].idxByName[l]=d)}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function mn(e){return e.split(",").map((function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),i=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Ht(n,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),a(i),0===t)}))}var hn=(_n.prototype._parseStoresSpec=function(e,t){o(e).forEach((function(n){if(null!==e[n]){var i=mn(e[n]),o=i.shift();if(o.unique=!0,o.multi)throw new V.Schema("Primary key cannot be multi-valued");i.forEach((function(e){if(e.auto)throw new V.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new V.Schema("Index must have a name and cannot be an empty string")})),t[n]=Kt(n,o,i)}}))},_n.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?r(this._cfg.storesSource,e):e,e=t._versions;var n={},i={};return e.forEach((function(e){r(n,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(n,i)})),t._dbSchema=i,nn(t,[t._allTables,t,t.Transaction.prototype]),tn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],o(i),i),t._storeNames=o(i),this},_n.prototype.upgrade=function(e){return this._cfg.contentUpgrade=ne(this._cfg.contentUpgrade||J,e),this},_n);function _n(){}function fn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new ti(nt,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function gn(e){return e&&"function"==typeof e.databases}function wn(e){return We((function(){return ge.letThrough=!0,e()}))}function yn(e){return!("from"in e)}var vn=function(e,t){if(!this){var n=new vn;return e&&"d"in e&&r(n,e),n}r(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function bn(e,t,n){var i=lt(t,n);if(!isNaN(i)){if(0<i)throw RangeError();if(yn(e))return r(e,{from:t,to:n,d:1});var o=e.l;if(i=e.r,lt(n,e.from)<0)return o?bn(o,t,n):e.l={from:t,to:n,d:1,l:null,r:null},In(e);if(0<lt(t,e.to))return i?bn(i,t,n):e.r={from:t,to:n,d:1,l:null,r:null},In(e);lt(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),0<lt(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,o&&!e.l&&kn(e,o),i&&n&&kn(e,i)}}function kn(e,t){yn(t)||function e(t,n){var i=n.from,o=n.to,a=n.l;n=n.r,bn(t,i,o),a&&e(t,a),n&&e(t,n)}(e,t)}function xn(e,t){var n=Sn(t),i=n.next();if(i.done)return!1;for(var o=i.value,a=Sn(e),r=a.next(o.from),s=r.value;!i.done&&!r.done;){if(lt(s.from,o.to)<=0&&0<=lt(s.to,o.from))return!0;lt(o.from,s.from)<0?o=(i=n.next(s.from)).value:s=(r=a.next(o.from)).value}return!1}function Sn(e){var t=yn(e)?null:{s:0,n:e};return{next:function(e){for(var n=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&lt(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||lt(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function In(e){var n,i,o=((null===(n=e.r)||void 0===n?void 0:n.d)||0)-((null===(i=e.l)||void 0===i?void 0:i.d)||0),a=1<o?"r":o<-1?"l":"";a&&(n="r"==a?"l":"r",i=t({},e),o=e[a],e.from=o.from,e.to=o.to,e[a]=o[a],i[a]=o[n],(e[n]=i).d=Cn(i)),e.d=Cn(e)}function Cn(e){var t=e.r;return e=e.l,(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}function Tn(e,t){return o(t).forEach((function(n){e[n]?kn(e[n],t[n]):e[n]=function e(t){var n,i,o={};for(n in t)l(t,n)&&(i=t[n],o[n]=!i||"object"!=typeof i||C.has(i.constructor)?i:e(i));return o}(t[n])})),e}function An(e,t){return e.all||t.all||Object.keys(e).some((function(n){return t[n]&&xn(t[n],e[n])}))}d(vn.prototype,((N={add:function(e){return kn(this,e),this},addKey:function(e){return bn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach((function(e){return bn(t,e,e)})),this}})[R]=function(){return Sn(this)},N));var En={},Pn={},Rn=!1;function Dn(e){Tn(Pn,e),Rn||(Rn=!0,setTimeout((function(){Rn=!1,jn(Pn,!(Pn={}))}),0))}function jn(e,t){void 0===t&&(t=!1);var n=new Set;if(e.all)for(var i=0,o=Object.values(En);i<o.length;i++)On(r=o[i],e,n,t);else for(var a in e){var r,s=/^idb\:\/\/(.*)\/(.*)\//.exec(a);s&&(a=s[1],s=s[2],(r=En["idb://".concat(a,"/").concat(s)])&&On(r,e,n,t))}n.forEach((function(e){return e()}))}function On(e,t,n,i){for(var o=[],a=0,r=Object.entries(e.queries.query);a<r.length;a++){for(var s=r[a],c=s[0],l=[],d=0,u=s[1];d<u.length;d++){var p=u[d];An(t,p.obsSet)?p.subscribers.forEach((function(e){return n.add(e)})):i&&l.push(p)}i&&o.push([c,l])}if(i)for(var m=0,h=o;m<h.length;m++){var _=h[m];c=_[0],l=_[1],e.queries.query[c]=l}}function Bn(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?Xe(t.dbOpenError):e}));t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var i=t.openCanceller,a=Math.round(10*e.verno),r=!1;function s(){if(t.openCanceller!==i)throw new V.DatabaseClosed("db.open() was cancelled")}function c(){return new be((function(i,l){if(s(),!n)throw new V.MissingAPI;var d=e.name,m=t.autoSchema||!a?n.open(d):n.open(d,a);if(!m)throw new V.MissingAPI;m.onerror=Nt(l),m.onblocked=je(e._fireOnBlocked),m.onupgradeneeded=je((function(i){var o;u=m.transaction,t.autoSchema&&!e._options.allowEmptyDB?(m.onerror=Mt,u.abort(),m.result.close(),(o=n.deleteDatabase(d)).onsuccess=o.onerror=je((function(){l(new V.NoSuchDatabase("Database ".concat(d," doesnt exist")))}))):(u.onerror=Nt(l),i=i.oldVersion>Math.pow(2,62)?0:i.oldVersion,p=i<1,e.idbdb=m.result,r&&rn(e,u),an(e,i/10,u,l))}),l),m.onsuccess=je((function(){u=null;var n,s,l,h,_,g=e.idbdb=m.result,w=f(g.objectStoreNames);if(0<w.length)try{var y=g.transaction(1===(h=w).length?h[0]:h,"readonly");if(t.autoSchema)s=g,l=y,(n=e).verno=s.version/10,l=n._dbSchema=un(0,s,l),n._storeNames=f(s.objectStoreNames,0),tn(n,[n._allTables],o(l),l);else if(pn(e,e._dbSchema,y),((_=sn(un(0,(_=e).idbdb,y),_._dbSchema)).add.length||_.change.some((function(e){return e.add.length||e.change.length})))&&!r)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),g.close(),a=g.version+1,r=!0,i(c());en(e,y)}catch(v){}tt.push(e),g.onversionchange=je((function(n){t.vcFired=!0,e.on("versionchange").fire(n)})),g.onclose=je((function(t){e.on("close").fire(t)})),p&&(_=e._deps,y=d,g=_.indexedDB,_=_.IDBKeyRange,gn(g)||y===nt||fn(g,_).put({name:y}).catch(J)),i()}),l)})).catch((function(e){switch(null==e?void 0:e.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),c();break;case"VersionError":if(0<a)return a=0,c()}return be.reject(e)}))}var l,d=t.dbReadyResolve,u=null,p=!1;return be.race([i,("undefined"==typeof navigator?be.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(e){function t(){return indexedDB.databases().finally(e)}l=setInterval(t,100),t()})).finally((function(){return clearInterval(l)})):Promise.resolve()).then(c)]).then((function(){return s(),t.onReadyBeingFired=[],be.resolve(wn((function(){return e.on.ready.fire(e.vip)}))).then((function n(){if(0<t.onReadyBeingFired.length){var i=t.onReadyBeingFired.reduce(ne,J);return t.onReadyBeingFired=[],be.resolve(wn((function(){return i(e.vip)}))).then(n)}}))})).finally((function(){t.openCanceller===i&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)})).catch((function(n){t.dbOpenError=n;try{u&&u.abort()}catch(o){}return i===t.openCanceller&&e._close(),Xe(n)})).finally((function(){t.openComplete=!0,d()})).then((function(){var t;return p&&(t={},e.tables.forEach((function(n){n.schema.indexes.forEach((function(i){i.name&&(t["idb://".concat(e.name,"/").concat(n.name,"/").concat(i.name)]=new vn(-1/0,[[[]]]))})),t["idb://".concat(e.name,"/").concat(n.name,"/")]=t["idb://".concat(e.name,"/").concat(n.name,"/:dels")]=new vn(-1/0,[[[]]])})),zt(qt).fire(t),jn(t,!0)),e}))}function Ln(e){function t(t){return e.next(t)}var n=o(t),i=o((function(t){return e.throw(t)}));function o(e){return function(t){var o=e(t);return t=o.value,o.done?t:t&&"function"==typeof t.then?t.then(n,i):a(t)?Promise.all(t).then(n,i):n(t)}}return o(t)()}function Nn(e,t,n){for(var i=a(e)?e.slice():[e],o=0;o<n;++o)i.push(t);return i}var Mn={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return t(t({},e),{table:function(n){var i=e.table(n),o=i.schema,a={},r=[];function s(e,n,i){var o=Xt(e),c=a[o]=a[o]||[],l=null==e?0:"string"==typeof e?1:e.length,d=0<n;return d=t(t({},i),{name:d?"".concat(o,"(virtual-from:").concat(i.name,")"):i.name,lowLevelIndex:i,isVirtual:d,keyTail:n,keyLength:l,extractKey:Jt(e),unique:!d&&i.unique}),c.push(d),d.isPrimaryKey||r.push(d),1<l&&s(2===l?e[0]:e.slice(0,l-1),n+1,i),c.sort((function(e,t){return e.keyTail-t.keyTail})),d}n=s(o.primaryKey.keyPath,0,o.primaryKey),a[":id"]=[n];for(var c=0,l=o.indexes;c<l.length;c++){var d=l[c];s(d.keyPath,0,d)}function u(n){var i,o=n.query.index;return o.isVirtual?t(t({},n),{query:{index:o.lowLevelIndex,range:(i=n.query.range,o=o.keyTail,{type:1===i.type?2:i.type,lower:Nn(i.lower,i.lowerOpen?e.MAX_KEY:e.MIN_KEY,o),lowerOpen:!0,upper:Nn(i.upper,i.upperOpen?e.MIN_KEY:e.MAX_KEY,o),upperOpen:!0})}}):n}return t(t({},i),{schema:t(t({},o),{primaryKey:n,indexes:r,getIndexByKeyPath:function(e){return(e=a[Xt(e)])&&e[0]}}),count:function(e){return i.count(u(e))},query:function(e){return i.query(u(e))},openCursor:function(t){var n=t.query.index,o=n.keyTail,a=n.isVirtual,r=n.keyLength;return a?i.openCursor(u(t)).then((function(e){return e&&s(e)})):i.openCursor(t);function s(n){return Object.create(n,{continue:{value:function(i){null!=i?n.continue(Nn(i,t.reverse?e.MAX_KEY:e.MIN_KEY,o)):t.unique?n.continue(n.key.slice(0,r).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,o)):n.continue()}},continuePrimaryKey:{value:function(t,i){n.continuePrimaryKey(Nn(t,e.MAX_KEY,o),i)}},primaryKey:{get:function(){return n.primaryKey}},key:{get:function(){var e=n.key;return 1===r?e[0]:e.slice(0,r)}},value:{get:function(){return n.value}}})}}})}})}};function qn(e,t,n,i){return n=n||{},i=i||"",o(e).forEach((function(o){var a,r,s;l(t,o)?(a=e[o],r=t[o],"object"==typeof a&&"object"==typeof r&&a&&r?(s=P(a))!==P(r)?n[i+o]=t[o]:"Object"===s?qn(a,r,n,i+o+"."):a!==r&&(n[i+o]=t[o]):a!==r&&(n[i+o]=t[o])):n[i+o]=void 0})),o(t).forEach((function(o){l(e,o)||(n[i+o]=t[o])})),n}function Wn(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}var zn={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return t(t({},e),{table:function(i){var o=e.table(i),a=o.schema.primaryKey;return t(t({},o),{mutate:function(e){var r=ge.trans,s=r.table(i).hook,c=s.deleting,d=s.creating,u=s.updating;switch(e.type){case"add":if(d.fire===J)break;return r._promise("readwrite",(function(){return p(e)}),!0);case"put":if(d.fire===J&&u.fire===J)break;return r._promise("readwrite",(function(){return p(e)}),!0);case"delete":if(c.fire===J)break;return r._promise("readwrite",(function(){return p(e)}),!0);case"deleteRange":if(c.fire===J)break;return r._promise("readwrite",(function(){return function e(n,i,r){return o.query({trans:n,values:!1,query:{index:a,range:i},limit:r}).then((function(o){var a=o.result;return p({type:"delete",keys:a,trans:n}).then((function(o){return 0<o.numFailures?Promise.reject(o.failures[0]):a.length<r?{failures:[],numFailures:0,lastResult:void 0}:e(n,t(t({},i),{lower:a[a.length-1],lowerOpen:!0}),r)}))}))}(e.trans,e.range,1e4)}),!0)}return o.mutate(e);function p(e){var i,r,s,p=ge.trans,m=e.keys||Wn(a,e);if(!m)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?t(t({},e),{keys:m}):t({},e)).type&&(e.values=n([],e.values,!0)),e.keys&&(e.keys=n([],e.keys,!0)),i=o,s=m,("add"===(r=e).type?Promise.resolve([]):i.getMany({trans:r.trans,keys:s,cache:"immutable"})).then((function(t){var n=m.map((function(n,i){var o,r,s,m=t[i],h={onerror:null,onsuccess:null};return"delete"===e.type?c.fire.call(h,n,m,p):"add"===e.type||void 0===m?(o=d.fire.call(h,n,e.values[i],p),null==n&&null!=o&&(e.keys[i]=n=o,a.outbound||b(e.values[i],a.keyPath,n))):(o=qn(m,e.values[i]),(r=u.fire.call(h,o,n,m,p))&&(s=e.values[i],Object.keys(r).forEach((function(e){l(s,e)?s[e]=r[e]:b(s,e,r[e])})))),h}));return o.mutate(e).then((function(i){for(var o=i.failures,a=i.results,r=i.numFailures,s=(i=i.lastResult,0);s<m.length;++s){var c=(a||m)[s],l=n[s];null==c?l.onerror&&l.onerror(o[s]):l.onsuccess&&l.onsuccess("put"===e.type&&t[s]?e.values[s]:c)}return{failures:o,results:a,numFailures:r,lastResult:i}})).catch((function(e){return n.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}}})}})}};function Fn(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var i=[],o=0,a=0;o<t.keys.length&&a<e.length;++o)0===lt(t.keys[o],e[a])&&(i.push(n?A(t.values[o]):t.values[o]),++a);return i.length===e.length?i:null}catch(r){return null}}var Un={stack:"dbcore",level:-1,create:function(e){return{table:function(n){var i=e.table(n);return t(t({},i),{getMany:function(e){if(!e.cache)return i.getMany(e);var t=Fn(e.keys,e.trans._cache,"clone"===e.cache);return t?be.resolve(t):i.getMany(e).then((function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?A(t):t},t}))},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),i.mutate(e)}})}}}};function Hn(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function Vn(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Kn={stack:"dbcore",level:0,name:"Observability",create:function(e){var n=e.schema.name,i=new vn(e.MIN_KEY,e.MAX_KEY);return t(t({},e),{transaction:function(t,n,i){if(ge.subscr&&"readonly"!==n)throw new V.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(ge.querier));return e.transaction(t,n,i)},table:function(r){var s=e.table(r),c=s.schema,l=c.primaryKey,d=c.indexes,u=l.extractKey,p=l.outbound,m=l.autoIncrement&&d.filter((function(e){return e.compound&&e.keyPath.includes(l.keyPath)})),h=t(t({},s),{mutate:function(e){function t(e){return e="idb://".concat(n,"/").concat(r,"/").concat(e),h[e]||(h[e]=new vn)}var o,d,u,p=e.trans,h=e.mutatedParts||(e.mutatedParts={}),_=t(""),f=t(":dels"),g=e.type,w=(v="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[Wn(l,e).filter((function(e){return e})),e.values]:[])[0],y=v[1],v=e.trans._cache;return a(w)?(_.addKeys(w),(v="delete"===g||w.length===y.length?Fn(w,v):null)||f.addKeys(w),(v||y)&&(o=t,d=v,u=y,c.indexes.forEach((function(e){var t=o(e.name||"");function n(t){return null!=t?e.extractKey(t):null}function i(n){return e.multiEntry&&a(n)?n.forEach((function(e){return t.addKey(e)})):t.addKey(n)}(d||u).forEach((function(e,t){var o=d&&n(d[t]);0!==lt(o,t=u&&n(u[t]))&&(null!=o&&i(o),null!=t&&i(t))}))})))):w?(y={from:w.lower,to:w.upper},f.add(y),_.add(y)):(_.add(i),f.add(i),c.indexes.forEach((function(e){return t(e.name).add(i)}))),s.mutate(e).then((function(n){return!w||"add"!==e.type&&"put"!==e.type||(_.addKeys(n.results),m&&m.forEach((function(i){var o=e.values.map((function(e){return i.extractKey(e)})),a=i.keyPath.findIndex((function(e){return e===l.keyPath}));n.results.forEach((function(e){return o[a]=e})),t(i.name).addKeys(o)}))),p.mutatedParts=Tn(p.mutatedParts||{},h),n}))}}),_={get:function(e){return[l,new vn(e.key)]},getMany:function(e){return[l,(new vn).addKeys(e.keys)]},count:d=function(t){t=(n=t.query).index;var n=n.range;return[t,new vn(null!==(t=n.lower)&&void 0!==t?t:e.MIN_KEY,null!==(n=n.upper)&&void 0!==n?n:e.MAX_KEY)]},query:d,openCursor:d};return o(_).forEach((function(e){h[e]=function(o){var a=!!(h=ge.subscr),c=Hn(ge,s)&&Vn(e,o)?o.obsSet={}:h;if(a){var l=function(e){return e="idb://".concat(n,"/").concat(r,"/").concat(e),c[e]||(c[e]=new vn)},d=l(""),m=l(":dels"),h=(a=(h=_[e](o))[0],h[1]);if(("query"===e&&a.isPrimaryKey&&!o.values?m:l(a.name||"")).add(h),!a.isPrimaryKey){if("count"!==e){var f="query"===e&&p&&o.values&&s.query(t(t({},o),{values:!1}));return s[e].apply(this,arguments).then((function(t){if("query"===e){if(p&&o.values)return f.then((function(e){return e=e.result,d.addKeys(e),t}));var n=o.values?t.result.map(u):t.result;(o.values?d:m).addKeys(n)}else if("openCursor"===e){var i=t,a=o.values;return i&&Object.create(i,{key:{get:function(){return m.addKey(i.primaryKey),i.key}},primaryKey:{get:function(){var e=i.primaryKey;return m.addKey(e),e}},value:{get:function(){return a&&d.addKey(i.primaryKey),i.value}}})}return t}))}m.add(i)}}return s[e].apply(this,arguments)}})),h}})}};function $n(e,n,i){if(0===i.numFailures)return n;if("deleteRange"===n.type)return null;var o=n.keys?n.keys.length:"values"in n&&n.values?n.values.length:1;return i.numFailures===o?null:(n=t({},n),a(n.keys)&&(n.keys=n.keys.filter((function(e,t){return!(t in i.failures)}))),"values"in n&&a(n.values)&&(n.values=n.values.filter((function(e,t){return!(t in i.failures)}))),n)}function Jn(e,t){return n=e,(void 0===(i=t).lower||(i.lowerOpen?0<lt(n,i.lower):0<=lt(n,i.lower)))&&(void 0===t.upper||(t.upperOpen?lt(e,t.upper)<0:lt(e,t.upper)<=0));var n,i}function Gn(e,t,n,i,o,r){if(!n||0===n.length)return e;var s=t.query.index,c=s.multiEntry,l=t.query.range,d=i.schema.primaryKey.extractKey,u=s.extractKey,p=(s.lowLevelIndex||s).extractKey;return(n=n.reduce((function(e,n){var i=e,o="add"===n.type||"put"===n.type?n.values.filter((function(e){return e=u(e),c&&a(e)?e.some((function(e){return Jn(e,l)})):Jn(e,l)})).map((function(e){return e=A(e),r&&Object.freeze(e),e})):[];switch(n.type){case"add":i=e.concat(t.values?o:o.map((function(e){return d(e)})));break;case"put":var s=(new vn).addKeys(n.values.map((function(e){return d(e)})));i=e.filter((function(e){return e=t.values?d(e):e,!xn(new vn(e),s)})).concat(t.values?o:o.map((function(e){return d(e)})));break;case"delete":var p=(new vn).addKeys(n.keys);i=e.filter((function(e){return e=t.values?d(e):e,!xn(new vn(e),p)}));break;case"deleteRange":var m=n.range;i=e.filter((function(e){return!Jn(d(e),m)}))}return i}),e))===e?e:(n.sort((function(e,t){return lt(p(e),p(t))||lt(d(e),d(t))})),t.limit&&t.limit<1/0&&(n.length>t.limit?n.length=t.limit:e.length===t.limit&&n.length<t.limit&&(o.dirty=!0)),r?Object.freeze(n):n)}function Yn(e,t){return 0===lt(e.lower,t.lower)&&0===lt(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Xn(e,t){return function(e,t,n,i){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;if(0===(t=lt(e,t))){if(n&&i)return 0;if(n)return 1;if(i)return-1}return t}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(e,t,n,i){if(void 0===e)return void 0!==t?1:0;if(void 0===t)return-1;if(0===(t=lt(e,t))){if(n&&i)return 0;if(n)return-1;if(i)return 1}return t}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function Qn(e,t,n,i){e.subscribers.add(n),i.addEventListener("abort",(function(){var i,o;e.subscribers.delete(n),0===e.subscribers.size&&(i=e,o=t,setTimeout((function(){0===i.subscribers.size&&j(o,i)}),3e3))}))}var Zn={stack:"dbcore",level:0,name:"Cache",create:function(e){var n=e.schema.name;return t(t({},e),{transaction:function(t,i,o){var a,r,s=e.transaction(t,i,o);return"readwrite"===i&&(r=(a=new AbortController).signal,o=function(o){return function(){if(a.abort(),"readwrite"===i){for(var r=new Set,c=0,l=t;c<l.length;c++){var d=l[c],u=En["idb://".concat(n,"/").concat(d)];if(u){var p=e.table(d),m=u.optimisticOps.filter((function(e){return e.trans===s}));if(s._explicit&&o&&s.mutatedParts)for(var h=0,_=Object.values(u.queries.query);h<_.length;h++)for(var f=0,g=(v=_[h]).slice();f<g.length;f++)An((b=g[f]).obsSet,s.mutatedParts)&&(j(v,b),b.subscribers.forEach((function(e){return r.add(e)})));else if(0<m.length){u.optimisticOps=u.optimisticOps.filter((function(e){return e.trans!==s}));for(var w=0,y=Object.values(u.queries.query);w<y.length;w++)for(var v,b,k,x=0,S=(v=y[w]).slice();x<S.length;x++)null!=(b=S[x]).res&&s.mutatedParts&&(o&&!b.dirty?(k=Object.isFrozen(b.res),k=Gn(b.res,b.req,m,p,b,k),b.dirty?(j(v,b),b.subscribers.forEach((function(e){return r.add(e)}))):k!==b.res&&(b.res=k,b.promise=be.resolve({result:k}))):(b.dirty&&j(v,b),b.subscribers.forEach((function(e){return r.add(e)}))))}}}r.forEach((function(e){return e()}))}}},s.addEventListener("abort",o(!1),{signal:r}),s.addEventListener("error",o(!1),{signal:r}),s.addEventListener("complete",o(!0),{signal:r})),s},table:function(i){var o=e.table(i),a=o.schema.primaryKey;return t(t({},o),{mutate:function(e){var r=ge.trans;if(a.outbound||"disabled"===r.db._options.cache||r.explicit)return o.mutate(e);var s=En["idb://".concat(n,"/").concat(i)];return s?(r=o.mutate(e),"add"!==e.type&&"put"!==e.type||!(50<=e.values.length||Wn(a,e).some((function(e){return null==e})))?(s.optimisticOps.push(e),e.mutatedParts&&Dn(e.mutatedParts),r.then((function(t){0<t.numFailures&&(j(s.optimisticOps,e),(t=$n(0,e,t))&&s.optimisticOps.push(t),e.mutatedParts&&Dn(e.mutatedParts))})),r.catch((function(){j(s.optimisticOps,e),e.mutatedParts&&Dn(e.mutatedParts)}))):r.then((function(n){var i=$n(0,t(t({},e),{values:e.values.map((function(e,i){var o;return b(e=null!==(o=a.keyPath)&&void 0!==o&&o.includes(".")?A(e):t({},e),a.keyPath,n.results[i]),e}))}),n);s.optimisticOps.push(i),queueMicrotask((function(){return e.mutatedParts&&Dn(e.mutatedParts)}))})),r):o.mutate(e)},query:function(e){if(!Hn(ge,o)||!Vn("query",e))return o.query(e);var t="immutable"===(null===(s=ge.trans)||void 0===s?void 0:s.db._options.cache),a=(l=ge).requery,r=l.signal,s=function(e,t,n,i){var o=En["idb://".concat(e,"/").concat(t)];if(!o)return[];if(!(t=o.queries[n]))return[null,!1,o,null];var a=t[(i.query?i.query.index.name:null)||""];if(!a)return[null,!1,o,null];switch(n){case"query":var r=a.find((function(e){return e.req.limit===i.limit&&e.req.values===i.values&&Yn(e.req.query.range,i.query.range)}));return r?[r,!0,o,a]:[a.find((function(e){return("limit"in e.req?e.req.limit:1/0)>=i.limit&&(!i.values||e.req.values)&&Xn(e.req.query.range,i.query.range)})),!1,o,a];case"count":return[r=a.find((function(e){return Yn(e.req.query.range,i.query.range)})),!!r,o,a]}}(n,i,"query",e),c=s[0],l=s[1],d=s[2],u=s[3];return c&&l?c.obsSet=e.obsSet:(l=o.query(e).then((function(e){var n=e.result;if(c&&(c.res=n),t){for(var i=0,o=n.length;i<o;++i)Object.freeze(n[i]);Object.freeze(n)}else e.result=A(n);return e})).catch((function(e){return u&&c&&j(u,c),Promise.reject(e)})),c={obsSet:e.obsSet,promise:l,subscribers:new Set,type:"query",req:e,dirty:!1},u?u.push(c):(u=[c],(d=d||(En["idb://".concat(n,"/").concat(i)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[e.query.index.name||""]=u)),Qn(c,u,a,r),c.promise.then((function(n){return{result:Gn(n.result,e,null==d?void 0:d.optimisticOps,o,c,t)}}))}})}})}};function ei(e,t){return new Proxy(e,{get:function(e,n,i){return"db"===n?t:Reflect.get(e,n,i)}})}var ti=(ni.prototype.version=function(e){if(isNaN(e)||e<.1)throw new V.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new V.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter((function(t){return t._cfg.version===e}))[0];return n||(n=new this.Version(e),t.push(n),t.sort(on),n.stores({}),this._state.autoSchema=!1,n)},ni.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||ge.letThrough||this._vip)?e():new be((function(e,n){if(t._state.openComplete)return n(new V.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void n(new V.DatabaseClosed);t.open().catch(J)}t._state.dbReadyPromise.then(e,n)})).then(e)},ni.prototype.use=function(e){var t=e.stack,n=e.create,i=e.level,o=e.name;return o&&this.unuse({stack:t,name:o}),(e=this._middlewares[t]||(this._middlewares[t]=[])).push({stack:t,create:n,level:null==i?10:i,name:o}),e.sort((function(e,t){return e.level-t.level})),this},ni.prototype.unuse=function(e){var t=e.stack,n=e.name,i=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return i?e.create!==i:!!n&&e.name!==n}))),this},ni.prototype.open=function(){var e=this;return Je(fe,(function(){return Bn(e)}))},ni.prototype._close=function(){var e=this._state,t=tt.indexOf(this);if(0<=t&&tt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(n){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new be((function(t){e.dbReadyResolve=t})),e.openCanceller=new be((function(t,n){e.cancelOpen=n})))},ni.prototype.close=function(e){var t=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen;e=this._state,t?(e.isBeingOpened&&e.cancelOpen(new V.DatabaseClosed),this._close(),e.autoOpen=!1,e.dbOpenError=new V.DatabaseClosed):(this._close(),e.autoOpen=this._options.autoOpen||e.isBeingOpened,e.openComplete=!1,e.dbOpenError=null)},ni.prototype.delete=function(e){var t=this;void 0===e&&(e={disableAutoOpen:!0});var n=0<arguments.length&&"object"!=typeof arguments[0],i=this._state;return new be((function(o,a){function r(){t.close(e);var n=t._deps.indexedDB.deleteDatabase(t.name);n.onsuccess=je((function(){var e,n,i;e=t._deps,n=t.name,i=e.indexedDB,e=e.IDBKeyRange,gn(i)||n===nt||fn(i,e).delete(n).catch(J),o()})),n.onerror=Nt(a),n.onblocked=t._fireOnBlocked}if(n)throw new V.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(r):r()}))},ni.prototype.backendDB=function(){return this.idbdb},ni.prototype.isOpen=function(){return null!==this.idbdb},ni.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},ni.prototype.hasFailed=function(){return null!==this._state.dbOpenError},ni.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(ni.prototype,"tables",{get:function(){var e=this;return o(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!1,configurable:!0}),ni.prototype.transaction=function(){var e=function(e,t,n){var i=arguments.length;if(i<2)throw new V.InvalidArgument("Too few arguments");for(var o=new Array(i-1);--i;)o[i-1]=arguments[i];return n=o.pop(),[e,S(o),n]}.apply(this,arguments);return this._transaction.apply(this,e)},ni.prototype._transaction=function(e,t,n){var i=this,o=ge.trans;o&&o.db===this&&-1===e.indexOf("!")||(o=null);var a,r,s=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(r=t.map((function(e){if("string"!=typeof(e=e instanceof i.Table?e.name:e))throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return e})),"r"==e||e===it)a=it;else{if("rw"!=e&&e!=ot)throw new V.InvalidArgument("Invalid transaction mode: "+e);a=ot}if(o){if(o.mode===it&&a===ot){if(!s)throw new V.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&r.forEach((function(e){if(o&&-1===o.storeNames.indexOf(e)){if(!s)throw new V.SubTransaction("Table "+e+" not included in parent transaction.");o=null}})),s&&o&&!o.active&&(o=null)}}catch(l){return o?o._promise(null,(function(e,t){t(l)})):Xe(l)}var c=function e(t,n,i,o,a){return be.resolve().then((function(){var r=ge.transless||ge,s=t._createTransaction(n,i,t._dbSchema,o);if(s.explicit=!0,r={trans:s,transless:r},o)s.idbtrans=o.idbtrans;else try{s.create(),s.idbtrans._explicit=!0,t._state.PR1398_maxLoop=3}catch(d){return d.name===U.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),t.close({disableAutoOpen:!1}),t.open().then((function(){return e(t,n,i,null,a)}))):Xe(d)}var c,l=L(a);return l&&ze(),r=be.follow((function(){var e;(c=a.call(s,s))&&(l?(e=Fe.bind(null,null),c.then(e,e)):"function"==typeof c.next&&"function"==typeof c.throw&&(c=Ln(c)))}),r),(c&&"function"==typeof c.then?be.resolve(c).then((function(e){return s.active?e:Xe(new V.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):r.then((function(){return c}))).then((function(e){return o&&s._resolve(),s._completion.then((function(){return e}))})).catch((function(e){return s._reject(e),Xe(e)}))}))}.bind(null,this,a,r,o,n);return o?o._promise(a,c,"lock"):ge.trans?Je(ge.transless,(function(){return i._whenReady(c)})):this._whenReady(c)},ni.prototype.table=function(e){if(!l(this._allTables,e))throw new V.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},ni);function ni(e,n){var i=this;this._middlewares={},this.verno=0;var o=ni.dependencies;this._options=n=t({addons:ni.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange,cache:"cloned"},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange},o=n.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,r,s,c,l,d={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:J,dbReadyPromise:null,cancelOpen:J,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:n.autoOpen};d.dbReadyPromise=new be((function(e){d.dbReadyResolve=e})),d.openCanceller=new be((function(e,t){d.cancelOpen=t})),this._state=d,this.name=e,this.on=ht(this,"populate","blocked","versionchange","close",{ready:[ne,J]}),this.on.ready.subscribe=g(this.on.ready.subscribe,(function(e){return function(t,n){ni.vip((function(){var o,a=i._state;a.openComplete?(a.dbOpenError||be.resolve().then(t),n&&e(t)):a.onReadyBeingFired?(a.onReadyBeingFired.push(t),n&&e(t)):(e(t),o=i,n||e((function e(){o.on.ready.unsubscribe(t),o.on.ready.unsubscribe(e)})))}))}})),this.Collection=(a=this,_t(It.prototype,(function(e,t){this.db=a;var n=rt,i=null;if(t)try{n=t()}catch(r){i=r}var o=e._ctx;e=(t=o.table).hook.reading.fire,this._ctx={table:t,index:o.index,isPrimKey:!o.index||t.schema.primKey.keyPath&&o.index===t.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:o.or,valueMapper:e!==G?e:null}}))),this.Table=(r=this,_t(pt.prototype,(function(e,t,n){this.db=r,this._tx=n,this.name=e,this.schema=t,this.hook=r._allTables[e]?r._allTables[e].hook:ht(null,{creating:[Q,J],reading:[Y,G],updating:[ee,J],deleting:[Z,J]})}))),this.Transaction=(s=this,_t(Ft.prototype,(function(e,t,n,i,o){var a=this;this.db=s,this.mode=e,this.storeNames=t,this.schema=n,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=ht(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new be((function(e,t){a._resolve=e,a._reject=t})),this._completion.then((function(){a.active=!1,a.on.complete.fire()}),(function(e){var t=a.active;return a.active=!1,a.on.error.fire(e),a.parent?a.parent._reject(e):t&&a.idbtrans&&a.idbtrans.abort(),Xe(e)}))}))),this.Version=(c=this,_t(hn.prototype,(function(e){this.db=c,this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))),this.WhereClause=(l=this,_t(Bt.prototype,(function(e,t,n){if(this.db=l,this._ctx={table:e,index:":id"===t?null:t,or:n},this._cmp=this._ascending=lt,this._descending=function(e,t){return lt(t,e)},this._max=function(e,t){return 0<lt(e,t)?e:t},this._min=function(e,t){return lt(e,t)<0?e:t},this._IDBKeyRange=l._deps.IDBKeyRange,!this._IDBKeyRange)throw new V.MissingAPI}))),this.on("versionchange",(function(e){0<e.newVersion?console.warn("Another connection wants to upgrade database '".concat(i.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(i.name,"'. Closing db now to resume the delete request.")),i.close({disableAutoOpen:!1})})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('".concat(i.name,"') was blocked")):console.warn("Upgrade '".concat(i.name,"' blocked by other connection holding version ").concat(e.oldVersion/10))})),this._maxKey=$t(n.IDBKeyRange),this._createTransaction=function(e,t,n,o){return new i.Transaction(e,t,n,i._options.chromeTransactionDurability,o)},this._fireOnBlocked=function(e){i.on("blocked").fire(e),tt.filter((function(e){return e.name===i.name&&e!==i&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(Un),this.use(Zn),this.use(Kn),this.use(Mn),this.use(zn);var u=new Proxy(this,{get:function(e,t,n){if("_vip"===t)return!0;if("table"===t)return function(e){return ei(i.table(e),u)};var o=Reflect.get(e,t,n);return o instanceof pt?ei(o,u):"tables"===t?o.map((function(e){return ei(e,u)})):"_createTransaction"===t?function(){return ei(o.apply(this,arguments),u)}:o}});this.vip=u,o.forEach((function(e){return e(i)}))}N="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable";var ii,oi=(ai.prototype.subscribe=function(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})},ai.prototype[N]=function(){return this},ai);function ai(e){this._subscribe=e}try{ii={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch(pi){ii={indexedDB:null,IDBKeyRange:null}}function ri(e){var t,n=!1,i=new oi((function(i){var o,a=L(e),r=!1,s={},c={},d={get closed(){return r},unsubscribe:function(){r||(r=!0,o&&o.abort(),u&&zt.storagemutated.unsubscribe(m))}};i.start&&i.start(d);var u=!1,p=function(){return Ye(h)},m=function(e){Tn(s,e),An(c,s)&&p()},h=function(){var d,h,_;!r&&ii.indexedDB&&(s={},d={},o&&o.abort(),o=new AbortController,_=function(t){var n=Ee();try{a&&ze();var i=We(e,t);return i=a?i.finally(Fe):i}finally{n&&Pe()}}(h={subscr:d,signal:o.signal,requery:p,querier:e,trans:null}),Promise.resolve(_).then((function(e){n=!0,t=e,r||h.signal.aborted||(s={},function(e){for(var t in e)if(l(e,t))return;return 1}(c=d)||u||(zt(qt,m),u=!0),Ye((function(){return!r&&i.next&&i.next(e)})))}),(function(e){n=!1,["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||r||Ye((function(){r||i.error&&i.error(e)}))})))};return setTimeout(p,0),d}));return i.hasValue=function(){return n},i.getValue=function(){return t},i}var si=ti;function ci(e){var t=di;try{di=!0,zt.storagemutated.fire(e),jn(e,!0)}finally{di=t}}d(si,t(t({},$),{delete:function(e){return new si(e,{addons:[]}).delete()},exists:function(e){return new si(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){try{return n=(t=si.dependencies).indexedDB,t=t.IDBKeyRange,(gn(n)?Promise.resolve(n.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return e!==nt}))})):fn(n,t).toCollection().primaryKeys()).then(e)}catch(i){return Xe(new V.MissingAPI)}var t,n},defineClass:function(){return function(e){r(this,e)}},ignoreTransaction:function(e){return ge.trans?Je(ge.transless,e):e()},vip:wn,async:function(e){return function(){try{var t=Ln(e.apply(this,arguments));return t&&"function"==typeof t.then?t:be.resolve(t)}catch(n){return Xe(n)}}},spawn:function(e,t,n){try{var i=Ln(e.apply(n,t||[]));return i&&"function"==typeof i.then?i:be.resolve(i)}catch(o){return Xe(o)}},currentTransaction:{get:function(){return ge.trans||null}},waitFor:function(e,t){return t=be.resolve("function"==typeof e?si.ignoreTransaction(e):e).timeout(t||6e4),ge.trans?ge.trans.waitFor(t):t},Promise:be,debug:{get:function(){return ie},set:function(e){oe(e)}},derive:m,extend:r,props:d,override:g,Events:ht,on:zt,liveQuery:ri,extendObservabilitySet:Tn,getByKeyPath:v,setByKeyPath:b,delByKeyPath:function(e,t){"string"==typeof t?b(e,t,void 0):"length"in t&&[].map.call(t,(function(t){b(e,t,void 0)}))},shallowClone:k,deepClone:A,getObjectDiff:qn,cmp:lt,asap:y,minKey:-1/0,addons:[],connections:tt,errnames:U,dependencies:ii,cache:En,semVer:"4.0.4",version:"4.0.4".split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)}))})),si.maxKey=$t(si.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(zt(qt,(function(e){di||(e=new CustomEvent(Wt,{detail:e}),di=!0,dispatchEvent(e),di=!1)})),addEventListener(Wt,(function(e){e=e.detail,di||ci(e)})));var li,di=!1,ui=function(){};return"undefined"!=typeof BroadcastChannel&&((ui=function(){(li=new BroadcastChannel(Wt)).onmessage=function(e){return e.data&&ci(e.data)}})(),"function"==typeof li.unref&&li.unref(),zt(qt,(function(e){di||li.postMessage(e)}))),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",(function(e){if(!ti.disableBfCache&&e.persisted){ie&&console.debug("Dexie: handling persisted pagehide"),null!=li&&li.close();for(var t=0,n=tt;t<n.length;t++)n[t].close({disableAutoOpen:!1})}})),addEventListener("pageshow",(function(e){!ti.disableBfCache&&e.persisted&&(ie&&console.debug("Dexie: handling persisted pageshow"),ui(),ci({all:new vn(-1/0,[[]])}))}))),be.rejectionMapper=function(e,t){return!e||e instanceof q||e instanceof TypeError||e instanceof SyntaxError||!e.name||!K[e.name]?e:(t=new K[e.name](t||e.message,e),"stack"in e&&p(t,"stack",{get:function(){return this.inner.stack}}),t)},oe(ie),t(ti,Object.freeze({__proto__:null,Dexie:ti,liveQuery:ri,Entity:ct,cmp:lt,PropModSymbol:I,PropModification:xt,replacePrefix:function(e,t){return new xt({replacePrefix:[e,t]})},default:ti,RangeSet:vn,mergeRanges:kn,rangesOverlap:xn}),{default:ti}),ti}()),na=Symbol.for("Dexie"),ia=globalThis[na]||(globalThis[na]=ta);if(ta.semVer!==ia.semVer)throw new Error("Two different versions of Dexie loaded in the same app: ".concat(ta.semVer," and ").concat(ia.semVer));let oa,aa=!1;try{oa=new ia("relatedArticle"),oa.version(1).stores({articles:"triplekey, relatedlist, timestamp, showRecReason"})}catch(cu){ca("initRelatedArticleDB",cu)}async function ra(){await async function(e=sa){try{return window.navigator&&window.navigator.storage&&window.navigator.storage.estimate?window.navigator.storage.estimate().then((({quota:t,usage:n})=>n>=t||n>=e)):!!(window.navigator&&window.navigator.webkitTemporaryStorage&&window.navigator.webkitTemporaryStorage.queryUsageAndQuota)&&new Promise((t=>{window.navigator.webkitTemporaryStorage.queryUsageAndQuota(((n,i)=>{t(n>i||n>=e)}))}))}catch(cu){return ca("getIfCurrentUsageExceed",cu),!1}}()&&await async function(){if(!aa)try{oa.transaction("rw",oa.articles,(async()=>{aa=!0;const e=await oa.articles.count(),t=Math.floor(e/2),n=await oa.articles.orderBy("timestamp").limit(t),i=await n.delete();console.log("clean oldArticles count",i)}))}catch(cu){ca("cleanRelatedArticleList",cu)}finally{aa=!1}}()}const sa=1e8;function ca(e,t){try{let n="indexDBError-".concat(e,"-");t&&t.message?n+=t.message:t&&(n+=JSON.stringify(t)),ue.setLogs({id:110809,key:84,value:1,log:encodeURIComponent(n)}),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("related article err","biz=".concat(window.biz," mid=").concat(window.mid," idx=").concat(window.idx),{mid:"mmbizwap:related_article_db_err",view:"wap_business",_info:{error:t,errorMsg:n}}),console.log(t)}catch(n){console.log(n)}}const la=Oe.getInnerHeight(),da=100*Math.random()<1,ua=[window.biz,window.mid,window.idx].join("_"),pa=he.os.ipad||!ke.isIOS&&!ke.isAndroid;let ma=0;ke.isIOS?ma=1:ke.isAndroid&&(ma=2);const ha=[{name:"内容低质",value:1},{name:"不看此公众号内容",value:2}],_a=(()=>{let e=!1;const t=[],n=i=>{e=!0,pe({url:"/mp/relatedarticle?action=expose",type:"POST",dataType:"json",data:i,complete(){t.length?n(t.shift()):e=!1}})};return i=>{e?t.push(i):n(i)}})(),fa=window.matchMedia("(prefers-color-scheme: dark)"),ga=(e="")=>{if(!e)return"";const t=parseInt("0x".concat(e.slice(1,3)),16),n=parseInt("0x".concat(e.slice(3,5)),16),i=parseInt("0x".concat(e.slice(5,7)),16),o=parseInt("0x".concat(e.slice(7,9)),16);return"rgba(".concat(n,", ").concat(i,", ").concat(o,", ").concat(t/255,")")};const wa=pt({name:"mp-related-article",filters:{getRecTagStyle:(e,t)=>e?{color:ga(t?e.dark_mode_text_color:e.text_color)}:{},dateToString(e){const t=(new Date).getTime()/1e3-e,n=(new Date).getFullYear(),i=new Date(1e3*e);return t<60?"".concat(Math.floor(t),"秒前"):t<3600?"".concat(Math.floor(t/60),"分钟前"):t<86400?"".concat(Math.floor(t/60/60),"小时前"):t<172800?"昨天":t<604800?"".concat(Math.floor(t/24/60/60),"天前"):i.getFullYear()===n?"".concat(i.getMonth()+1,"月").concat(i.getDate(),"日"):"".concat(i.getFullYear(),"年").concat(i.getMonth()+1,"月").concat(i.getDate(),"日")}},components:{Intersect:x},data(){const{cgiData:e}=this.$store.state;return{list:[],reason:[],reportInfo:"",showRecReason:!1,showList:!ke.isMpapp&&1*e.item_show_type==0&&""!==e.item_show_type,unbindTransition:!1,listStyle:{overflow:"hidden",opacity:1,height:0,margin:0},feedbackIdx:-1,feedbackPos:"bottom",feedbackReasonTacitly:{},feedbackReasonKeyword:{},darkModeMatches:fa.matches,relatedArticleListInfo:null,isCreatePlaceholder:!1,hasDataInDB:0}},computed:{...p(["extRes"]),...p("mp-related-article",["notLoad","sources"]),...f("mp-like-and-share",["hasExtAppmsgStat"]),commonReportData(){const{cgiData:e}=this.$store.state;let t=parseInt(window.enterid,10)||0;return!ke.isWp&&-1===navigator.userAgent.indexOf("MicroMessenger")&&document.body.offsetWidth>=1024&&(t=1024,ue.setSum(223326,18,1)),{Bizuin_from:e.biz,Msgid_from:parseInt(e.mid,10)||0,Itemidx_from:parseInt(e.idx,10)||0,Scene:parseInt(e.source,10)||0,Subscene:parseInt(e.subscene,10)||parseInt(e.source,10)||0,Sessionid:e.sessionid||"",Enterid:t,ItemShowType:parseInt(e.item_show_type,10)||0}},type(){return this.sources[0]},isPageInit(){return this.sources[1]},isFromPay(){return"pay"===this.type?1:0},loadType(){switch(this.type){case"default":default:return 0;case"favorite":return 1;case"share":return 2;case"praise":return 3;case"like":return 4;case"pay":return 5;case"reward":return 6;case"favorited":return 7;case"shared":return 8;case"praised":return 9;case"liked":return 10;case"paid":return 11;case"rewarded":return 12;case"recommend":return 13;case"force":return 14;case"subscribe":return 15}},hasFeedbackReason(){return!!(Object.keys(this.feedbackReasonTacitly).length+Object.keys(this.feedbackReasonKeyword).length)},isKuaiXun(){return this.relatedArticleListInfo&&(1===this.relatedArticleListInfo.style||2===this.relatedArticleListInfo.style)},hasExtLoadDone(){var e,t;return 0===(null==(t=null==(e=this.extRes)?void 0:e.base_resp)?void 0:t.ret)},canShowList(){return!!this.showList&&(this.hasExtLoadDone?!this.notLoad&&this.type:!(!this.list||!this.list.length))}},watch:{sources(){this.$nextTick(this.loadData)}},created(){this.hasReported29433=!1,this.exposeHeight=0,this.loadDataFromDB()},mounted(){if(this.itemHeight=parseFloat(window.getComputedStyle(this.$el).getPropertyValue("--RELATE-ITEM-HEIGHT")),this.itemHeightPx=0,da&&window.WX_BJ_REPORT){const{cgiData:e}=this.$store.state;window.WX_BJ_REPORT.BadJs.report("relatedArticleFlag","value:".concat(e.relatedArticleFlag),{mid:"mmbizwap:related_monitor",uin:e.user_uin})}fa.addListener((({matches:e})=>{this.darkModeMatches=!!e})),De.on(window,"scroll",this.loadData),De.on(window,"scroll",this.exposeHandler)},beforeDestroy(){this.destroy()},methods:{preloadMoreKuaixun(){console.log("??????preload"),xe.invoke("onWebPageUrlExposed",{bizType:0,urlList:[{url:this.relatedArticleListInfo.more_url,extInfo:{itemshowType:0,preloadType:0}}]})},async loadData(){if(!this.hasExtLoadDone||!this.canShowList||[0,1].includes(this.hasDataInDB)||this.__lock)return;const e=this.extRes.distance_to_get_related_article_data||-1;e>=0&&Oe.getElementActualTop(this.$refs.jsRelatedArea)-Oe.getScrollTop()-la>la*e||(this.__lock=!0,this.$nextTick((()=>{if(144===this.commonReportData.Scene)return;const{cgiData:e}=this.$store.state;this.isPageInit&&(this.listStyle.transition="none");this.__placeholderTimer=setTimeout((()=>{this.isCreatePlaceholder=!0,ue.setSum(314064,25,1),this.showCard(3)}),500),this.list&&this.list.length||(ue.setSum(110809,81,1),ue.setSum(110809,83,1),pe({url:"/mp/relatedarticle?action=getlist&article_url=".concat(window.encodeURIComponent(location.href),"&__biz=").concat(e.biz,"&mid=").concat(e.mid,"&idx=").concat(e.idx,"&has_related_article_info=").concat(e.hasRelatedArticleInfo,"&is_pay=").concat(this.isFromPay,"&is_from_recommand=").concat(Qo?1:0,"&scene=").concat(this.commonReportData.Scene,"&subscene=").concat(parseInt(e.subscene,10)||0,"&is_open_comment=").concat(this.extRes.comment_enabled).concat("subscribe"===this.type?"&is_from_subscribe=1":""),type:"GET",dataType:"json",success:t=>{if(da&&t&&1*t.empty_scene!=0&&this.isCreatePlaceholder&&window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs.report("empty_scene","empty_scene:".concat(t.empty_scene),{mid:"mmbizwap:related_monitor",uin:e.user_uin}),t&&t.base_resp&&1*t.base_resp.ret==0&&t.list&&t.list.length){const n=t.list.map((e=>(e.url=e.url.replace(/#wechat_redirect$/,"&show_related_article=1&subscene=".concat(this.commonReportData[132===this.commonReportData.Scene?"Subscene":"Scene"],"$&")),e.like_num_wording=e.old_like_num?Se.formatReadNum(e.old_like_num):"",e.read_num_wording=e.read_num?Se.formatReadNum(e.read_num):"",e.pay_cnt_wording=e.pay_cnt?Se.formatReadNum(e.pay_cnt):"",e)));da&&window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs.report("list.length","list.length:".concat(n.length),{mid:"mmbizwap:related_monitor",_info:{relatedArticleFlag:e.relatedArticleFlag,isPc:pa},uin:e.user_uin}),this.list=n,this.$emit("list-data-change",this.list),this.list.forEach((({url:e,ext_info:n})=>{me.report(29139,Object.assign({Bizuin:_e.getQuery("__biz",e),Msgid:parseInt(_e.getQuery("mid",e),10)||0,Itemidx:parseInt(_e.getQuery("idx",e),10)||0,ExtInfo:n,RecInfo:t.report_info},this.commonReportData))})),this.reason=ha,this.reportInfo=t.report_info||"",this.showRecReason=1===t.show_rec_reason;const i={list:n,showRecReason:1===t.show_rec_reason,style:t.style,more_url:t.more_url};!async function(e,t){await ra();try{const n=await oa.articles.add({triplekey:e,relatedlist:t.list,timestamp:Date.now(),showRecReason:t.showRecReason,style:t.style,more_url:t.more_url});n&&(console.log("add success",n),await ra())}catch(cu){ca("addRelatedArticleListToDB",cu)}}(ua,i),this.relatedArticleListInfo=i,this.showRelatedArticles(t.list.length)}else this.clearPlaceholderTimeout((e=>{!e&&this.setLines(0),this.destroy()}))},error:e=>{console.error(e),this.clearPlaceholderTimeout((e=>{!e&&this.setLines(0),this.destroy()}))}}))})))},async loadDataFromDB(){const e=await async function(e){try{const t=await oa.articles.get({triplekey:e});return oa.articles.update(e,{timestamp:Date.now()}),console.log("getRelatedArticleList",t),t?{list:t.relatedlist,showRecReason:t.showRecReason,style:t.style,more_url:t.more_url}:void 0}catch(cu){ca("getRelatedArticleListFromDB",cu)}}(ua);e&&e.list&&e.list.length?(ue.setSum(110809,81,1),ue.setSum(110809,82,1),this.list=e.list,this.showRecReason=e.showRecReason,this.relatedArticleListInfo=e,this.reason=ha,this.hasDataInDB=1,this.getRecReason(),this.showRelatedArticles(this.list.length),this.$emit("list-data-change",this.list)):this.hasDataInDB=2},showRelatedArticles(e){this.clearPlaceholderTimeout((t=>{t?this.showCard(e):this.setLines(e),this.listStyle.opacity=1,this.listStyle.overflow="visible",this.$nextTick((()=>{this.exposeHandler(),window.ipados13_font_scale&&A(this.$refs.jsRelatedArea,window.ipados13_font_scale/100),!this.isPageInit&&Re.setCompRenderInfo({compEle:this.$refs.jsRelatedArea,compType:"mp-related-article",compIdx:1,wrapper:document.querySelector("#page_bottom_area")},this.$refs.jsRelatedArea.offsetHeight+parseInt(getComputedStyle(this.$refs.jsRelatedArea).marginTop,10))}))}))},showCard(e){this.setLines(e),delete this.__placeholderTimer},setLines(e){const t=this.$refs.jsRelatedTitle,n=t?t.getBoundingClientRect().height:34,i=this.$refs.moreNews,o=i?i.offsetHeight:0;let a=0;if(0===e){if(this.isCreatePlaceholder){const e=this.$refs.jsRelatedArea,t=e&&this.isPercentInViewport(e);if(t){let e=0;switch(!0){case t>=1:e=31;break;case t>=.8:e=30;break;case t>=.6:e=29;break;case t>=.4:e=28;break;case t>=.2:e=27;break;default:e=26}ue.setSum(314064,e,1),ue.setSum(314064,32,1)}}this.listStyle.overflow="hidden",this.listStyle.margin="0",this.unbindTransition=!0}else window.is_like_profile_gray,this.listStyle.margin="8px 0 0",a="calc(".concat(e*this.itemHeight,"em + ").concat(n,"px + ").concat(o,"px)");const r={compEle:this.$refs.jsRelatedArea,compType:"mp-related-article",compIdx:1,wrapper:document.querySelector("#page_bottom_area")};this.setLinesTimes=this.setLinesTimes?this.setLinesTimes+1:1,1!==this.setLinesTimes&&(r.subCompType="setLine-".concat(this.setLinesTimes)),this.isPageInit&&Re.renderCompSilentlyPreHandler(r),this.listStyle.height=a,this.isPageInit&&this.$nextTick((()=>{Re.renderCompSilently(r)})),this.isPageInit&&e&&this.transitionEndHandler({propertyName:"height"})},getHeight(e){return this.itemHeightPx||(this.$refs.relatedPlaceholder?this.itemHeightPx=this.$refs.relatedPlaceholder.getBoundingClientRect().height:this.itemHeightPx=Se.qs(".js_related_item",this.$refs.jsRelatedList).getBoundingClientRect().height),e*this.itemHeightPx+Se.qs(".js_related_title",this.$refs.jsRelatedMain).getBoundingClientRect().height},clearPlaceholderTimeout(e){this.__placeholderTimer?(clearTimeout(this.__placeholderTimer),delete this.__placeholderTimer,"function"==typeof e&&e(!0)):"function"==typeof e&&e(!1)},jumpArticle(e){const t=e.currentTarget,{dataset:n}=t,{url:i}=n;ue.setSum(110809,23,1),me.report(18832,Object.assign({LoadType:this.loadType,Actiontype:2,Type:1,Bizuin:_e.getQuery("__biz",i),Msgid:parseInt(_e.getQuery("mid",i),10)||0,Itemidx:parseInt(_e.getQuery("idx",i),10)||0,Sendtimestamp:parseInt(n.time,10)||0,Pos:(1*n.index||0)+1,Recalltype:1*n.recalltype,Isreaded:1*n.isreaded,Mmversion:ma,ExpType:n.exptype,ExtInfo:n.ext_info,RecInfo:n.report_info},this.commonReportData)),ke.isOnlyWechat&&!ke.isMpapp?xe.invoke("openWebViewUseFastLoad",{url:i,item_show_type:n.item_show_type,scene:132,subscene:this.commonReportData[132===this.commonReportData.Scene?"Subscene":"Scene"],openType:0},(e=>{console.log("openWebViewUseFastLoad res: ",e),e&&e.err_msg&&-1===e.err_msg.indexOf("ok")&&$e(i.replace(/#wechat_redirect$/,"&scene=132$&"))})):location.href=i.replace(/#wechat_redirect$/,"&scene=132$&")},goKuaixunFeed(){xe.invoke("openUrlWithExtraWebview",{url:this.relatedArticleListInfo.more_url,openType:1})},exposeHandler(){const{jsRelatedArticleItem:e}=this.$refs;if(!e)return;const{top:t,bottom:n}=this.$refs.jsRelatedArea.getBoundingClientRect();if(!(t>la||n<0)){let i=0;i=t<0?n:n>la?la-t:n-t,this.exposeHeight=Math.max(this.exposeHeight,i);const o=[];for(let t=0;t<e.length;t++){const n=e[t];if(1*n.dataset.hasreport!=1){const e=n.clientHeight/2,i=n.getBoundingClientRect().bottom;i>=e&&i<=e+la&&((e,t)=>{const{dataset:n}=e,{url:i}=n;n.hasreport=1,ue.setSum(110809,21,1);const a={LoadType:this.loadType,Actiontype:1,Type:1,Bizuin:_e.getQuery("__biz",i),Msgid:parseInt(_e.getQuery("mid",i),10)||0,Itemidx:parseInt(_e.getQuery("idx",i),10)||0,Sendtimestamp:parseInt(n.time,10)||0,Pos:t+1,Recalltype:1*n.recalltype,Mmversion:ma,Isreaded:1*n.isreaded,ExpType:n.exptype,ExtInfo:n.ext_info,RecInfo:n.report_info};me.report(18832,Object.assign(a,this.commonReportData)),_a({bizuin:n.bizuin,mid:n.mid,idx:n.idx}),o.push({item_show_type:n.item_show_type,url:i})})(n,t)}}o.length&&xe.invoke("downloadPageDataForFastLoad",{itemList:o},(e=>{console.log("downloadPageDataForFastLoad",e)})),this.report29433()}},transitionEndHandler(e){this.unbindTransition||"height"!==e.propertyName||(this.unbindTransition=!0)},destroy(){this.showList=!1,De.off(window,"scroll",this.loadData),De.off(window,"scroll",this.exposeHandler)},showFeedback(e){const{jsRelatedArticleItem:t}=this.$refs,i=t[e];this.feedbackIdx=e,this.feedbackPos=la-i.getBoundingClientRect().bottom<268?"top":"bottom",this.$nextTick((()=>{this.$refs.feedbackBd[e].focus()})),n.show({alpha:.3,onClick:()=>{this.hideFeedback()}})},hideFeedback(){this.feedbackIdx=-1,this.feedbackPos="bottom",this.feedbackReasonTacitly={},this.feedbackReasonKeyword={},n.hide()},submitFeedback(e){if(this.hasFeedbackReason){const t={tacitly:Object.keys(this.feedbackReasonTacitly).map((e=>1*e)),keyword:Object.keys(this.feedbackReasonKeyword)},{cgiData:n}=this.$store.state,i={biz_from:n.biz,mid_from:n.mid,idx_from:n.idx,recommended_biz:_e.getQuery("__biz",e.url),mid:_e.getQuery("mid",e.url),idx:_e.getQuery("idx",e.url),reason:JSON.stringify(t)};pe({type:"POST",url:"/mp/relatedarticle?action=dislike",dataType:"json",data:i,success:t=>{if(console.log(t),t&&t.base_resp&&0===t.base_resp.ret){this.hideFeedback();const t=this.list.indexOf(e);t>-1&&(this.list.splice(t,1),this.setLines(this.list.length),async function(e,t){try{oa.transaction("rw",oa.articles,(async()=>{await oa.articles.get(e);const n=await oa.articles.update(e,{relatedlist:t.list});console.log("updatedResult",n)}))}catch(cu){ca("updateRelatedArticleList",cu)}}(ua,{list:this.list}))}else window.weui.alert("System error. Try again later")}})}},chooseFeedbackReason(e){const t=e.currentTarget,n=be.hasClass(t,"js_reason")?this.feedbackReasonTacitly:this.feedbackReasonKeyword,{value:i}=t.dataset;n[i]?this.$delete(n,i):this.$set(n,i,1)},report29433(){if(this.hasReported29433)return;this.hasReported29433=!0;const{cgiData:e}=this.$store.state,t={bizuin_from1:e.biz,msgid_from1:parseInt(e.mid,10)||0,Itemidx_from:parseInt(e.idx,10)||0,ItemShowType:parseInt(e.item_show_type,10)||0};me.report(29433,Object.assign({Type:0},t)),me.leaveReport(29433,(()=>Object.assign({Type:1,Pos_Height:Math.round(this.exposeHeight),Is_article_exposed:Array.prototype.some.call(this.$refs.jsRelatedArticleItem,(e=>1*e.dataset.hasreport==1))?1:0},t)))},getRecReason(){if(!this.list||!this.list.length)return;const e=[],t=[];this.list.forEach((n=>{const i={};i.bizuin=n.bizuin,i.mid=n.mid,i.idx=n.idx,e.push(i),t.push([n.bizuin,n.mid,n.idx].join("_"))}));const n=encodeURIComponent(JSON.stringify({appmsg_list:e}));pe({type:"GET",url:"/mp/getrecreason?appmsg_list=".concat(n),dataType:"json",success:e=>{if(e&&e.base_resp&&0===e.base_resp.ret){const n=e.appmsg_list;n&&n.length&&n.forEach((e=>{const n=[e.bizuin,e.mid,e.idx].join("_"),i=t.indexOf(n);if(i>=0&&this.list[i]){const{rec_reason:t}=e;t&&t.wording&&(this.list[i].rec_reason=t)}}))}}})},isPercentInViewport(e){const t=Ve.getId("js_article_bottom_bar"),n=t?t.offsetHeight:0,i=e.getBoundingClientRect(),o=Math.min(i.bottom,E.height-n)-Math.max(i.top,0);return o<=0?0:o/i.height}}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"related_container"},[e.canShowList?t("div",{ref:"jsRelatedArea",staticClass:"relate_mod_transition function_mod js_related_area",style:e.listStyle,on:{transitionend:e.transitionEndHandler}},[t("div",{ref:"jsRelatedMain",staticClass:"function_mod_index js_related_main"},[e.isKuaiXun?t("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title",staticStyle:{display:"flex","justify-content":"space-between"}},[e._v(" 相关快讯 "),1===e.relatedArticleListInfo.style?t("Intersect",{attrs:{threshold:[1]},on:{"~enter":function(t){return e.preloadMoreKuaixun.apply(null,arguments)}}},[t("span",{staticStyle:{color:"#576b95","font-weight":"500"},on:{click:e.goKuaixunFeed}},[e._v("更多")])]):e._e()],1):"share"===e.type||"shared"===e.type?t("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v(" People who shared this content also liked ")]):"favorite"===e.type||"favorited"===e.type?t("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v(" People who favorited this content also liked ")]):"subscribe"===e.type?t("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v(" 关注此账号的人还喜欢 ")]):t("div",{ref:"jsRelatedTitle",staticClass:"function_hd js_related_title"},[e._v(" People who liked this content also liked ")]),t("div",{staticClass:"function_bd"},[e.list.length?t("div",{ref:"jsRelatedList",staticClass:"relate_article_index_list relate_article_list js_related_list",staticStyle:{height:"auto"}},[e._l(e.list,(function(n,i){return t("div",{key:i,ref:"jsRelatedArticleItem",refInFor:!0,staticClass:"weui-media-box weui-media-box_appmsg js_related_item js_wx_tap_highlight wx_tap_cell",attrs:{"data-index":i,"data-url":n.url,"data-time":n.send_time,"data-recalltype":n.recall_type,"data-isreaded":n.is_readed,"data-bizuin":n.bizuin,"data-mid":n.mid,"data-idx":n.idx,"data-item_show_type":n.item_show_type,"data-exptype":n.exptype,"data-ext_info":n.ext_info,"data-report_info":e.reportInfo},on:{click:e.jumpArticle}},[t("div",{staticClass:"weui-media-box__bd"},[t("div",{class:["ellipsis_relate_title mask_ellipsis_wrp mask_ellipsis_auto_height",n.is_pay_subscribe?n.is_paid?"relate_article_paid":"relate_article_pay":"relate_article_default",e.showRecReason?"relate_article_tag_before":""],attrs:{role:"link",tabindex:"0","aria-labelledby":"relate_article_title_"+n.mid+"_"+n.idx+" js_a11y_comma relate_article_tag_"+n.mid+" js_a11y_comma relate_article_nickname_"+n.mid+"_"+n.idx+" js_a11y_comma relate_article_num_"+n.mid+"_"+n.idx}},[t("div",{staticClass:"mask_ellipsis_text",attrs:{"aria-hidden":"true"}},[e._v(" "+e._s(n.title)+" "),n.is_pay_subscribe&&n.is_paid?t("span",{staticClass:"pay__tag"},[e._v(" Paid ")]):n.is_pay_subscribe?t("span",{staticClass:"unpay__tag"},[e._v(" Pay ")]):e._e()]),t("div",{staticClass:"mask_ellipsis",attrs:{"aria-hidden":"true"}},[t("div",{staticClass:"mask_ellipsis_text",attrs:{id:"relate_article_title_"+n.mid+"_"+n.idx}},[e._v(" "+e._s(n.title)+" "),n.is_pay_subscribe&&n.is_paid?t("span",{staticClass:"pay__tag"},[e._v(" Paid ")]):n.is_pay_subscribe?t("span",{staticClass:"unpay__tag"},[e._v(" Pay ")]):e._e()]),t("div",{staticClass:"mask_ellipsis_placeholder"}),t("div",{staticClass:"mask_ellipsis_extra"},[n.is_pay_subscribe&&n.is_paid?t("span",{staticClass:"pay__tag"},[e._v(" Paid ")]):n.is_pay_subscribe?t("span",{staticClass:"unpay__tag"},[e._v(" Pay ")]):e._e()])])]),t("div",{staticClass:"weui-media-box__info weui-flex"},[t("div",{staticClass:"weui-media-box__info__inner weui-flex weui-flex_align-center weui-flex__item"},[e.showRecReason&&n.rec_reason&&n.rec_reason.wording?t("div",{staticClass:"weui-media-box__info__meta relate_profile_tag",attrs:{"aria-hidden":"true",id:"relate_article_tag_"+n.mid+"_"+n.idx}},[t("span",{staticClass:"icon_appmsg_tag",style:e._f("getRecTagStyle")(n.rec_reason,e.darkModeMatches)},[e._v(" "+e._s(n.rec_reason.wording)+" ")])]):e._e(),t("div",{staticClass:"js_profile relate_profile_nickname weui-media-box__info__meta",attrs:{"aria-hidden":"true",id:"relate_article_nickname_"+n.mid+"_"+n.idx,"data-username":n.username}},[e._v(" "+e._s(n.nickname)+" ")]),e.isKuaiXun?t("div",{staticClass:"js_profile relate_profile_nickname weui-media-box__info__meta",attrs:{"aria-hidden":"true",id:"relate_article_nickname_"+n.mid+"_"+n.idx}},[e._v(" "+e._s(e._f("dateToString")(n.send_time))+" ")]):e._e(),e.showRecReason?e._e():t("div",{staticClass:"weui-media-box__info__meta",attrs:{"aria-hidden":"true",id:"relate_article_num_"+n.mid+"_"+n.idx}},[n.old_like_num>=10?[e._v("Like "+e._s(n.like_num_wording))]:n.is_pay_subscribe&&n.pay_cnt?[e._v(" Pay "+e._s(n.pay_cnt_wording)+" ")]:n.read_num?[e._v("Reads "+e._s(n.read_num_wording))]:e._e()],2)]),t("div",{staticClass:"relate_article_opr"},[t("button",{ref:"feedbackBtn",refInFor:!0,staticClass:"reset_btn dislike_btn js_feedback_btn weui-wa-hotarea",attrs:{type:"button"},on:{touchstart:function(e){e.stopPropagation()},touchend:function(e){e.stopPropagation()},mousedown:function(e){e.stopPropagation()},click:function(t){return t.stopPropagation(),e.showFeedback(i)}}},[e._v(" 不喜欢 ")])]),t("div",{ref:"feedbackBd",refInFor:!0,class:["feedback_dialog_wrp js_feedback_dialog",e.feedbackIdx===i?"feedback_dialog_show":""],attrs:{role:"dialog","aria-modal":"true",tabindex:"0","aria-hidden":e.feedbackIdx!==i?"true":"false"},on:{click:function(e){e.stopPropagation()},touchstart:function(e){e.stopPropagation()},touchmove:function(e){e.preventDefault()},touchend:function(e){e.stopPropagation()},mousedown:function(e){e.stopPropagation()}}},[t("div",{staticClass:"weui-mask js_mask",attrs:{role:"button","aria-label":"Close"},on:{click:e.hideFeedback}}),t("div",{class:["feedback_dialog js_dialog_wrp","top"===e.feedbackPos?"feedback_dialog_pos_top":""]},[t("div",{staticClass:"feedback_dialog_hd weui-flex"},[t("div",{staticClass:"weui-flex__item feedback_dialog_title"},[e._v("不看的原因")]),t("button",{class:["weui-btn weui-btn_primary weui-btn_mini js_submit",e.hasFeedbackReason?"":"weui-btn_disabled"],attrs:{type:"button"},on:{click:function(t){return e.submitFeedback(n)}}},[e._v(" OK ")])]),t("div",{staticClass:"feedback_dialog_bd"},[t("ul",{staticClass:"feedback_tag_list"},[e._l(e.reason,(function(n){return t("li",{key:n.value,class:["feedback_tag_item js_reason js_tag_item",e.feedbackReasonTacitly[n.value]?"feedback_tag_selected":""],attrs:{role:"checkbox","aria-checked":!!e.feedbackReasonTacitly[n.value],"data-value":n.value},on:{click:e.chooseFeedbackReason}},[e._v(" "+e._s(n.name)+" ")])})),e._l(n.keyword,(function(n,i){return[i<2?t("li",{key:n,class:["feedback_tag_item js_keyword js_tag_item",e.feedbackReasonKeyword[n]?"feedback_tag_selected":""],attrs:{role:"checkbox","aria-checked":!!e.feedbackReasonKeyword[n],"data-value":n},on:{click:e.chooseFeedbackReason}},[e._v(" 对"+e._s(n)+"不感兴趣 ")]):e._e()]}))],2)])])])])]),t("div",{staticClass:"weui-media-box__ft"},[t("img",{directives:[{name:"wxpic-src",rawName:"v-wxpic-src",value:n.cover,expression:"item.cover"}],staticClass:"relate_article_cover"})])])})),e.relatedArticleListInfo&&2===e.relatedArticleListInfo.style?t("Intersect",{attrs:{threshold:[1]},on:{"~enter":function(t){return e.preloadMoreKuaixun.apply(null,arguments)}}},[t("div",{ref:"moreNews",staticClass:"more_news weui-media-box",on:{click:e.goKuaixunFeed}},[e._v(" 更多快讯 "),t("svg",{attrs:{width:"10",height:"20",viewBox:"0 0 10 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.04504 5.48386L2.92893 4.59998L7.74467 9.41572C8.06978 9.74083 8.07266 10.265 7.74467 10.593L2.92893 15.4088L2.04504 14.5249L6.56556 10.0044L2.04504 5.48386Z"}})])])]):e._e()],2):[e._m(0),t("div",{staticClass:"relate_article_list relate_article_placeholder"},[t("div",{ref:"relatedPlaceholder",staticClass:"weui-media-box weui-media-box_appmsg"},[t("div",{staticClass:"weui-media-box_placeholder"})])])]],2)])]):e._e()])}),[function(){var e=this._self._c;return e("div",{staticClass:"relate_list_loading"},[e("span",{staticClass:"weui-primary-loading",attrs:{role:"img","aria-label":"Loading..."}},[e("span",{staticClass:"weui-primary-loading__dot"})])])}],!1,null,"1c91e5c8",null,null).exports;const ya=pt({name:"mp-related-search",props:{needShow:{type:Boolean,required:!0}},data:()=>({wordList:[],isClicked:!1,itemsLoaded:!1,itemClickedStates:[],observedSearchItems:[],titleObserver:null,keywordObserver:null,exposeItems:new Set,isLargeFont:!1,executed:!1}),watch:{needShow(e){e&&(this.getData(),this.executed=!0)},itemsLoaded(e){e&&this.$nextTick((()=>{this.setObserver(),this.setFontChange()}))}},beforeDestroy(){this.titleObserver&&this.titleObserver.disconnect(),this.keywordObserver&&this.keywordObserver.disconnect()},methods:{getData(){this.executed||pe({url:"/mp/relatedsearchword?action=getsearchword&__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&enterid=").concat(window.enterid,"&request_id=").concat(Date.now(),"&scene=").concat(window.source,"&sessionid=").concat(window.sessionid),type:"GET",dataType:"json",success:e=>{0===e.base_resp.ret&&(this.wordList=e.list,this.itemClickedStates=this.wordList.map((()=>!1)),this.itemsLoaded=!0,ue.setSum(368675,5,1))}})},clickSearchWords(e){const{word:t,s1s_stat_info:n,s1s_context_info:i,source:o}=this.wordList[e],a={s1sKeywordsData:{s1sContextInfo:i,s1sStatInfo:n}};Ce({query:t,scene:173,parentType:95,thirdExtParam:encodeURIComponent(JSON.stringify(a))}),this.reportRelatedKeywords(3e3,n,o,t),ue.setSum(368675,7,1)},toggleClickedState(e,t){this.$set(this.itemClickedStates,e,t)},setItemRef(e){e&&this.observedSearchItems.push(e)},setObserver(){this.titleObserver=new IntersectionObserver(((e,t)=>{e.forEach((e=>{const{target:n}=e;e.isIntersecting&&(this.reportRelatedKeywords(2e3,this.wordList[0].s1s_stat_info,0,""),t.unobserve(n),ue.setSum(368675,6,1))}))}),{root:null}),this.$refs.relatedTitle&&this.titleObserver.observe(this.$refs.relatedTitle),this.keywordObserver=new IntersectionObserver(((e,t)=>{e.forEach((e=>{const{target:n}=e;e.isIntersecting&&!this.exposeItems.has(n)&&setTimeout((()=>{if(e.isIntersecting){this.exposeItems.add(n);const e=n.getAttribute("data-idx"),{s1s_stat_info:i,source:o,word:a}=this.wordList[e];this.reportRelatedKeywords(2004,i,o,a),t.unobserve(n)}}),500)}))}),{root:null}),this.observedSearchItems.forEach((e=>{this.keywordObserver.observe(e)}))},setFontChange(){const e=Bt();this.isLargeFont=e>=1.2,P((()=>{const e=Bt();this.isLargeFont=e>=1.2}))},reportRelatedKeywords(e,t,n,i){Ze({log_id:31671,action_type:e,query:i,s1s_status_info:t,query_pull_type:n})}}},(function(){var e=this,t=e._self._c;return e.wordList.length>0?t("div",{staticClass:"related_search_container"},[t("h1",{ref:"relatedTitle",staticClass:"related_search_title"},[e._v("Search")]),t("ul",{staticClass:"related_search_words_list"},e._l(e.wordList,(function(n,i){return t("li",{key:i,ref:e.setItemRef,refInFor:!0,staticClass:"related_search_words_li",class:{active:e.itemClickedStates[i],large_font:e.isLargeFont,normal_font:!e.isLargeFont},attrs:{"data-idx":i},on:{click:function(t){return e.clickSearchWords(i)},touchstart:function(t){return e.toggleClickedState(i,!0)},touchend:function(t){return e.toggleClickedState(i,!1)},touchcancel:function(t){return e.toggleClickedState(i,!1)}}},[t("span",{ref:"textSpanNode",refInFor:!0},[e._v(e._s(n.word))]),i%2==0?t("div",{staticClass:"dividing_line"}):e._e()])})),0)]):e._e()}),[],!1,null,"e1829158",null,null).exports,va="--appmsgExtra-BG";const ba=pt({components:{[wa.name]:wa,[ya.name]:ya,[Lt.name]:Lt,[R.name]:R,[D.name]:D},data:()=>({isNewMpApp:ke.isNewMpApp,bottomBounceColor:va,hasExtLoadDone:!1,hasBottomAd:!1,hasRelatedArticle:!1,fetchBeforeExtResp:!window.__immersiveListMode,commentStatus:{showPreComment:!1,isShowComment:!1,isLoading:!1,isInitial:!1,isEmpty:!0},adObserver:null,onlyComment:"1"===_e.getQuery("only_comment"),cmtTopStyle:location.href.indexOf("scrolltodown")>-1?{height:0,overflow:"hidden"}:null}),computed:{cmtStoreBase:()=>ke.isNewMpApp?"mp-app-comment":"mp-comment",...p(["extRes"]),...p({fansMsgEnabled(e,t){return t["".concat(this.cmtStoreBase,"/fansMsgEnabled")]},commentEnabled(e,t){return t["".concat(this.cmtStoreBase,"/commentEnabled")]},commentId(e,t){return t["".concat(this.cmtStoreBase,"/commentId")]},writeCommentEntry(e,t){return t["".concat(this.cmtStoreBase,"/writeCommentEntry")]}}),isShowRelatedSearchWord(){return!(!this.extRes||void 0===this.extRes.show_related_search_word)&&0!==this.extRes.show_related_search_word},hasExtraCnt(){return this.fansMsgEnabled||1===this.commentEnabled&&1*this.commentId!=0||this.hasBottomAd||this.hasRelatedArticle}},watch:{bottomBounceColor(e){this.setBottomBounceColor(e)}},created(){this.setBottomBounceColor(this.bottomBounceColor),Pe.on("ext-complete-success",(()=>{this.hasExtLoadDone=!0,this.updateBgColor()}))},mounted(){location.href.indexOf("scrolltodown")>-1&&Pe.on("ext-complete",(()=>{setTimeout((()=>{const e=document.getElementById("page-content"),t={compEle:e,compType:"pageContent",compIdx:0};Re.renderCompSilentlyPreHandler(t),e.style.cssText=null,Re.renderCompSilently(t);const n={compEle:this.$refs.cmtTop,compType:"commentTop",compIdx:0};Re.renderCompSilentlyPreHandler(n),this.cmtTopStyle=null,this.$nextTick((()=>{Re.renderCompSilently(n)}))}),1e3)}))},beforeDestroy(){this.adObserver&&this.adObserver.disconnect()},methods:{loadBottomAd(){const e=new IntersectionObserver((t=>{t.forEach((t=>{if(t.isIntersecting){const{target:n}=t;"js_bottom_opr_right"===n.id?(ue.setSum(364569,0,1),e.unobserve(n)):n.classList.contains("mpda_bottom_container")&&(ue.setSum(364569,1,1),e.unobserve(n))}}))}),{root:null,rootMargin:"0px",threshold:.05}),t=document.getElementById("js_bottom_opr_right"),n=document.querySelector(".mpda_bottom_container");t&&e.observe(t),n&&e.observe(n),this.adObserver=e,this.hasBottomAd=!0,this.updateBgColor()},onRelatedArticleListDataChange(e){this.hasRelatedArticle=e.length>0,this.updateBgColor()},commentStatusChange(e,t){this.commentStatus[e]=t,this.updateBgColor()},updateBgColor(){this.hasExtLoadDone?this.commentStatus.isShowComment&&!this.commentStatus.isEmpty||this.commentStatus.isShowComment&&this.commentStatus.isInitial&&!this.fansMsgEnabled&&this.writeCommentEntry?this.bottomBounceColor="":this.hasBottomAd||this.hasRelatedArticle||this.commentStatus.isShowComment&&(!this.commentStatus.isShowComment||!this.commentStatus.isEmpty||this.commentStatus.isLoading||this.commentStatus.isInitial)?this.bottomBounceColor=va:this.bottomBounceColor="":this.commentStatus.showPreComment?this.bottomBounceColor="":this.bottomBounceColor=va},setBottomBounceColor(e){Nt.set(e?{bottom:Mt.get(e)}:void 0),document.body.classList[e?"remove":"add"]("wx_wap_page_primary")},scrollToComment(){const e=this.$refs.comment.$refs.comment.$el.getBoundingClientRect();j.start({y:e.y+window.scrollY})},submitComment(e){this.__submitingComment||(this.__submitingComment=!0,this.$refs.comment.$refs.comment.sendComment({content:e,successEnd:this.scrollToComment,complete:()=>{this.__submitingComment=!1}}))},showAccessComment(e){this.$refs.comment.$refs.comment.showCmtInput(e)},onRenderComment(e){},onShowMoreRepliesSuccess(){},beforeHidePercomment(){document.scrollingElement.style.minHeight||(document.scrollingElement.style.minHeight=document.scrollingElement.scrollHeight+"px",this.__hasSetTmpMinHeight=!0)},afterHidePercomment(){this.__hasSetTmpMinHeight&&(document.scrollingElement.style.minHeight="",this.__hasSetTmpMinHeight=!1)}}},(function(){var e=this,t=e._self._c;return t("div",{class:{has_extra_cnt:e.hasExtraCnt},staticStyle:{position:"relative"},attrs:{id:"page_bottom_area"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.onlyComment,expression:"!onlyComment"}],ref:"cmtTop",style:e.cmtTopStyle},[t("div",{staticStyle:{"font-size":"0",height:"0"},attrs:{"aria-hidden":"true"}},[e._v("​")]),t("mp-bottom-ad",{on:{"ad-load":e.loadBottomAd}}),t("mp-related-article",{on:{"list-data-change":e.onRelatedArticleListDataChange}}),t("mp-related-search",{attrs:{"need-show":e.isShowRelatedSearchWord}})],1),t("mp-appmsg-comment",{ref:"comment",attrs:{"lazy-show":!0,"fetch-before-ext-resp":e.fetchBeforeExtResp},on:{"per-comment-status":t=>e.commentStatusChange("showPreComment",t),"show-comment-change":t=>e.commentStatusChange("isShowComment",t),"loading-change":t=>e.commentStatusChange("isLoading",t),"initial-change":t=>e.commentStatusChange("isInitial",t),"empty-change":t=>e.commentStatusChange("isEmpty",t),"render-comment":e.onRenderComment,"show-more-replies-success":e.onShowMoreRepliesSuccess,"before-hide-percomment":e.beforeHidePercomment,"after-hide-percomment":e.afterHidePercomment}}),e.isNewMpApp?t("mp-interaction-bar",{on:{"submit-comment":e.submitComment,"scroll-to-comment":e.scrollToComment,"show-access-comment":e.showAccessComment}}):e._e()],1)}),[],!1,null,null,null,null).exports,ka=window.Vue;const xa=document.getElementById("profileBt");const Sa=pt({name:"mp-profile-card",data:()=>({nickname:window.title,headImg:window.round_head_img,signature:window.profile_signature_new?window.profile_signature_new:window.profile_signature,originalArticleCount:0,verifyPrincipal:"",isVerify:!1,showProfileCard:!1,unloginMobile:Wt(),showPcProfileCard:!1}),computed:{arrowPositionStyle:()=>({left:xa.offsetWidth/2-8+"px"}),qrcodeImgSrc(){let e=10000005;const t=document.referrer;if(0==t.indexOf("http://weixin.sogou.com")?e=10000006:0==t.indexOf("https://wx.qq.com")&&(e=10000007),window.isSg)return window.sg_qr_code.htmlDecode();return(new Image).src="/mp/report?action=pcclick&__biz="+window.biz+"&uin="+window.uin+"&scene="+e+"&r="+Math.random(),"/mp/qrcode?scene="+e+"&size=102&__biz="+window.biz+"&mid="+window.mid+"&idx="+window.idx+"&sn="+window.sn+"&send_time="+window.send_time}},mounted(){xa.addEventListener("click",(e=>{this.showPcProfileCard=!0,e.stopPropagation()}));const e=document.getElementById("js_profile_qrcode");document.addEventListener("click",(t=>{const n=t.target;e&&n!=xa&&n!=e&&(this.showPcProfileCard=!1)})),pe({type:"GET",url:"/mp/authorinfo?biz=".concat(window.biz),success:e=>{try{const t=JSON.parse(e),{identity_name:n,is_verify:i,original_article_count:o}=t;n&&(this.verifyPrincipal=n),i&&(this.isVerify=i),o&&(this.originalArticleCount=o)}catch(t){console.log(t)}},error:e=>{console.log(e)}})}},(function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.showPcProfileCard,expression:"showPcProfileCard"}],ref:"js_profile_qrcode",staticClass:"profile_card_container",attrs:{id:"js_profile_qrcode"}},[t("div",{staticClass:"profile_card_wrap"},[t("div",{staticClass:"profile_card_qrcode"},[t("img",{staticClass:"profile_qrcode_img",attrs:{id:"js_profile_qrcode_img",src:e.qrcodeImgSrc,alt:"profile_qrcode"}})]),t("div",{staticClass:"profile_card_info"},[t("div",[t("span",{staticClass:"profile_info_nickname"},[e._v(" "+e._s(e.nickname)+" ")])]),e.isVerify?t("div",{staticClass:"profile_verify_principal profile_card_info_meta"},[t("span",{staticClass:"profile_main_text"},[e._v(e._s(e.verifyPrincipal))]),e.isVerify?t("div",{staticClass:"profile_verify-icon"},[1===e.isVerify?t("i",{staticClass:"profile_item-title-type__person inline-icon"}):t("i",{staticClass:"profile_item-title-type inline-icon"})]):e._e()]):e._e(),e.signature?t("div",{staticClass:"profile_card_info_meta"},[t("p",{staticClass:"profile_card_info_meta_text profile_card_signature"},[e._v(" "+e._s(e.signature)+" ")])]):e._e(),e.originalArticleCount?t("p",{staticClass:"profile_original_count profile_card_info_meta"},[t("span",{staticClass:"profile_card_info_meta_text"},[e._v(e._s(e.originalArticleCount)+"篇原创内容")])]):e._e()])]),t("div",{staticClass:"profile_arrow_wrp",style:e.arrowPositionStyle,attrs:{id:"js_profile_arrow_wrp"}},[t("i",{staticClass:"profile_arrow arrow_out"}),t("i",{staticClass:"profile_arrow arrow_in"})])])}),[],!1,null,"da33bb4f",null,null).exports,Ia=window.Vue;const Ca=Ft({name:"mp-feedback",props:{show:{type:Boolean,default:!1},pos:{type:String,default:"bottom"},title:{type:String,default:"不看的原因"},reason:{type:Array,default:function(){return[]}},keyword:{type:Array,default:function(){return[]}},dialogStyle:{type:Object,default:function(){return{}}},reasonLiStyle:{type:Object,default:function(){return{}}},arrowStyle:{type:Object,default:function(){return{}}},showMask:{type:Boolean,default:!0},maskStyle:{type:Object,default:function(){return{}}},showMaskTransition:{type:Boolean,default:!0},showSubmitFeedback:{type:Boolean,default:!0},isSelected:{type:Boolean,default:!0},showShadow:{type:Boolean,default:!1}},data:function(){return{innerShow:!1,reasonTacitly:{},reasonKeyword:{}}},watch:{show:{handler:function(e){var t=this;e?n.show({alpha:this.showMask?.2:0,onClick:function(){t.hideFeedback()}}):(this.reasonTacitly={},this.reasonKeyword={}),this.innerShow=e},immediate:!0}},computed:{hasFeedbackReason:function(){return!!(Object.keys(this.reasonTacitly).length+Object.keys(this.reasonKeyword).length)}},methods:{hideFeedback:function(){this.innerShow=!1,this.reasonTacitly={},this.reasonKeyword={},this.$emit("hide"),n.hide()},submitFeedback:function(){var e=this;this.hasFeedbackReason&&(this.$emit("submit",{tacitly:Object.keys(this.reasonTacitly).map((function(t){return e.reasonTacitly[t]})),keyword:Object.keys(this.reasonKeyword)}),this.hideFeedback())},chooseFeedbackReason:function(e,t){if(this.isSelected){var n=e.currentTarget,i=be.hasClass(n,"js_reason")?this.reasonTacitly:this.reasonKeyword,o=n.dataset.value;i[o]?this.$delete(i,o):this.$set(i,o,t)}else this.$emit("selectFeedback")}}},(function(){var e=this,t=e._self._c;return t("div",{ref:"feedbackBd",class:["feedback_dialog_wrp feedback_dialog_radius_tail js_feedback_dialog",e.innerShow?"feedback_dialog_show":"",e.showMaskTransition?"feedback_mask":""],attrs:{role:"dialog","aria-modal":"true",tabindex:"0","aria-hidden":!e.innerShow},on:{click:function(e){e.stopPropagation()},touchstart:function(e){e.stopPropagation()},touchend:function(e){e.stopPropagation()},touchmove:function(e){e.stopPropagation(),e.preventDefault()}}},[t("div",{staticClass:"weui-mask js_mask",style:{background:e.maskStyle.background,backdropFilter:e.maskStyle.filter},attrs:{role:"button","aria-label":"Close"},on:{click:e.hideFeedback}}),e._t("default"),t("div",{class:["feedback_dialog js_dialog_wrp","top"===e.pos?"feedback_dialog_pos_top":"",e.showShadow?"feedback_dialog_shadow":""],style:e.dialogStyle},[t("div",{staticClass:"feedback_dialog_hd weui-flex"},[t("div",{staticClass:"weui-flex__item feedback_dialog_title"},[e._v(e._s(e.title))]),e.showSubmitFeedback?t("button",{class:["weui-btn weui-btn_primary weui-btn_mini js_submit",e.hasFeedbackReason?"":"weui-btn_disabled"],attrs:{type:"button",disabled:!e.hasFeedbackReason},on:{click:e.submitFeedback}},[e._v(" OK ")]):e._e()]),t("div",{staticClass:"feedback_dialog_bd"},[t("ul",{staticClass:"feedback_tag_list"},[e._l(e.reason,(function(n){return t("li",{key:n.value,class:["feedback_tag_item js_reason js_tag_item",e.reasonTacitly[n.value]?"feedback_tag_selected":""],style:e.reasonLiStyle,attrs:{role:"checkbox","aria-checked":!!e.reasonTacitly[n.value],"data-value":n.value},on:{click:function(t){return e.chooseFeedbackReason(t,n)}}},[e._v(" "+e._s(n.name)+" ")])})),e._l(e.keyword,(function(n,i){return[i<2?t("li",{key:n,class:["feedback_tag_item js_keyword js_tag_item",e.reasonKeyword[n]?"feedback_tag_selected":""],attrs:{role:"checkbox","aria-checked":!!e.reasonKeyword[n],"data-value":n},on:{click:function(t){return e.chooseFeedbackReason(t,n)}}},[e._v(" 对"+e._s(n)+"不感兴趣 ")]):e._e()]}))],2)]),t("div",{class:["feedback_dialog_tail","top"===e.pos?"":"feedback_dialog_tail_pos_up"],style:e.arrowStyle})])],2)}),[],!1,null,"8becc158",null,null).exports;!function(){try{if("undefined"!=typeof document){var e=document.createElement("style");e.appendChild(document.createTextNode('.feedback_dialog_wrp[data-v-8becc158]{opacity:0;-webkit-user-select:none;-ms-user-select:none;user-select:none;pointer-events:none}.feedback_dialog_wrp.feedback_mask[data-v-8becc158]{transition:opacity .07s ease-out}.feedback_dialog_wrp .weui-mask[data-v-8becc158]{background:rgba(0,0,0,.2)}.feedback_dialog[data-v-8becc158]{position:absolute;z-index:5000;font-size:10px;right:calc(-16px - 6.4em);top:calc(100% + 10px);width:288px;padding:16px;box-sizing:border-box;background-color:var(--weui-BG-5);color:var(--weui-FG-0);line-height:1.4;border-radius:8px;transition:transform .15s cubic-bezier(.175,.885,.32,1.1);-ms-transform:scale(0);transform:scale(0);-ms-transform-origin:80% 0;transform-origin:80% 0}.feedback_dialog[data-v-8becc158]:before{content:"";display:inline-block;width:0;height:0;border-width:6px;border-style:dashed;border-color:transparent;border-top-width:0;border-bottom-color:var(--weui-BG-5);border-bottom-style:solid;position:absolute;right:calc(7.4em + 10px);top:-6px}.feedback_dialog_radius_tail .feedback_dialog[data-v-8becc158]:before{display:none}.feedback_dialog_tail[data-v-8becc158]{pointer-events:none;position:absolute;left:50%;margin-left:-4px;width:8px;height:8px;border-radius:1.5px;background:var(--weui-BG-5);-ms-transform:rotate(45deg);transform:rotate(45deg);top:auto;bottom:-3px;left:auto;right:calc(7.4em + 12px)}.feedback_dialog_tail[data-v-8becc158]:before,.feedback_dialog_tail[data-v-8becc158]:after{content:"";position:absolute;width:8px;height:8px;border-radius:50%;box-shadow:-6.5px 0 0 0 var(--weui-BG-5)}.feedback_dialog_tail[data-v-8becc158]:before{bottom:-7px;left:6px;-ms-transform:rotate(74deg);transform:rotate(74deg);-ms-transform-origin:0 0;transform-origin:0 0}.feedback_dialog_tail[data-v-8becc158]:after{top:-2px;right:-7px;-ms-transform:rotate(16deg);transform:rotate(16deg);-ms-transform-origin:0 100%;transform-origin:0 100%}.feedback_dialog_tail_pos_up[data-v-8becc158]{bottom:auto;top:-3px}.feedback_dialog_tail_pos_up[data-v-8becc158]:before,.feedback_dialog_tail_pos_up[data-v-8becc158]:after{box-shadow:6.5px 0 0 0 var(--weui-BG-5)}.feedback_dialog_tail_pos_up[data-v-8becc158]:before{bottom:1px;left:-6px;-ms-transform:rotate(16deg);transform:rotate(16deg)}.feedback_dialog_tail_pos_up[data-v-8becc158]:after{top:-15px;right:0;-ms-transform:rotate(80deg);transform:rotate(80deg)}.feedback_dialog_hd[data-v-8becc158]{-ms-flex-align:center;align-items:center}.feedback_dialog_title[data-v-8becc158]{padding-right:16px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;font-size:15px;font-weight:500;color:var(--weui-FG-0)}.feedback_dialog_bd[data-v-8becc158]{padding-top:4px}.feedback_tag_list[data-v-8becc158]{font-size:0}.feedback_tag_item[data-v-8becc158]{--weui-TAG-TEXT-GREEN: #07C160;--weui-TAG-BACKGROUND-GREEN: rgba(7, 193, 96, .1);margin-right:8px;margin-top:8px;display:inline-block;vertical-align:middle;font-size:14px;width:auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-wrap:normal;max-width:100%;padding:8px 12px;border-radius:4px;box-sizing:border-box;color:var(--weui-FG-0);background:rgba(0,0,0,.03);-webkit-tap-highlight-color:rgba(0,0,0,0)}.feedback_tag_item.feedback_tag_selected[data-v-8becc158]{color:var(--weui-TAG-TEXT-GREEN);background-color:var(--weui-TAG-BACKGROUND-GREEN)}.feedback_tag_item[data-v-8becc158]:active{position:relative}.feedback_tag_item[data-v-8becc158]:active:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.1)}.feedback_dialog_pos_top[data-v-8becc158]{top:auto;bottom:calc(100% + 10px)}.feedback_dialog_pos_top[data-v-8becc158]:before{border-bottom:0;border-top:6px solid var(--weui-BG-5);top:auto;bottom:-6px}.feedback_dialog_show[data-v-8becc158]{opacity:1;pointer-events:all}.feedback_dialog_show.feedback_mask[data-v-8becc158]{transition:all .05s ease-in}.feedback_dialog_show .feedback_dialog[data-v-8becc158]{-ms-transform:scale(1);transform:scale(1)}@media screen and (min-width: 400px){.feedback_dialog[data-v-8becc158]{left:auto;width:320px}}@media (prefers-color-scheme: dark){.feedback_tag_item[data-v-8becc158]{background-color:#ffffff08}}.feedback_dialog[data-v-8becc158]{-ms-transform-origin:50% 0;transform-origin:50% 0}.feedback_dialog.feedback_dialog_pos_top[data-v-8becc158]{-ms-transform-origin:50% 100%;transform-origin:50% 100%}.feedback_dialog_shadow[data-v-8becc158]{box-shadow:0 4px 25px #0003}')),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}}();const Ta=pt({components:{[Ca.name]:Ca},data(){var e,t;return{isShowFeedBack:!1,feedbackArrowStyle:{right:"10px"},feedbackDialogStyle:{position:"absolute",width:"auto",top:"27px",right:"0px"},feedbackReasonLiStyle:{marginRight:0},media:null==(e=window.matchMedia)?void 0:e.call(window,"(prefers-color-scheme: dark)"),isDarkMode:null==(t=window.matchMedia)?void 0:t.call(window,"(prefers-color-scheme: dark)").matches,bottomBarDom:null,bottomBarZIndex:0,bottomBarMaskDom:null,bottomBarMaskZIndex:0,payPanelDom:null,payPanelZIndex:0}},methods:{showFeedBack(){pe({url:"/publicpoc/mparticlefeedback?action=Report&bizuin=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&feedback_reason_enum=0"),type:"POST"}),this.isShowFeedBack=!0,n.show({color:"#ffffff",alpha:0}),this.bottomBarDom=document.querySelector("#js_article_bottom_bar"),this.bottomBarDom&&(this.bottomBarZIndex=this.bottomBarDom.style.zIndex,this.bottomBarDom.style.zIndex=0),this.bottomBarMaskDom=document.querySelector(".bottom_bar_padding_mask"),this.bottomBarMaskDom&&(this.bottomBarMaskZIndex=this.bottomBarMaskDom.style.zIndex,this.bottomBarMaskDom.style.zIndex=0),this.payPanelDom=document.querySelector("#js_pay_panel"),this.payPanelDom&&(this.payPanelZIndex=this.payPanelDom.style.zIndex,this.payPanelDom.style.zIndex=0)},selectFeedbackFn(){this.hideFeedBack(),pe({url:"/publicpoc/mparticlefeedback?action=Report&bizuin=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&feedback_reason_enum=1"),type:"POST"}),window.weui.toast("已反馈",{duration:800})},darkModeListener(){var e;this.isDarkMode=null==(e=this.media)?void 0:e.matches},hideFeedBack(){this.isShowFeedBack=!1,n.hide(),this.bottomBarDom&&(this.bottomBarDom.style.zIndex=this.bottomBarZIndex),this.bottomBarMaskDom&&(this.bottomBarMaskDom.style.zIndex=this.bottomBarMaskZIndex),this.payPanelDom&&(this.payPanelDom.style.zIndex=this.payPanelZIndex),n.hide()}},computed:{maskBackground(){return this.isDarkMode?"linear-gradient(to bottom, rgba(25,25,25,1), rgba(25,25,25,0.5) 120px, rgba(25,25,25,0.5) 120px)":"linear-gradient(to bottom, rgba(255, 255, 255, 1), rgba(255, 255, 255, 0.5) 120px, rgba(255, 255, 255, 0.5) 120px)"},maskFilter(){return this.isShowFeedBack?"blur(5px)":"blur(0px)"}},created(){this.media.addEventListener?this.media.addEventListener("change",this.darkModeListener):this.media.addListener(this.darkModeListener)},destroyed(){this.media.removeEventListener?this.media.removeEventListener("change",this.darkModeListener):this.media.removeListener(this.darkModeListener)}},(function(){var e=this,t=e._self._c;return t("div",{ref:"feedbackIcon",staticClass:"rich_media_meta_feedback dislike_btn",on:{click:function(t){return t.stopPropagation(),e.showFeedBack.apply(null,arguments)}}},[t("mp-feedback",{attrs:{show:e.isShowFeedBack,"arrow-style":e.feedbackArrowStyle,"dialog-style":e.feedbackDialogStyle,title:"反馈",showSubmitFeedback:!1,reason:[{name:"标题有误导性"}],isSelected:!1,showShadow:!0,showMask:!1,maskStyle:{background:e.maskBackground,filter:e.maskFilter},reasonLiStyle:e.feedbackReasonLiStyle,showMaskTransition:!0},on:{hide:e.hideFeedBack,selectFeedback:e.selectFeedbackFn}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowFeedBack,expression:"isShowFeedBack"}],staticClass:"dislike_btn inner"})])],1)}),[],!1,null,"6abc76d6",null,null).exports,Aa=window.Vue;const Ea={tagName:"mp-common-cpslink",componentIdPropName:"data-link-component-id",clickReportPropName:"data-click-report-url",exposureReportPropName:"data-exposure-report-url",banPropName:"data-ban-status"},Pa={};function Ra(e){const t=Number(decodeURIComponent(e.getAttribute(Ea.banPropName)));return 1===t||0===t||-1===t}function Da(e){pe({url:"/mp/cps_product_info?action=UrlGet&product_type=1&url=".concat(encodeURIComponent(e)),type:"GET"})}function ja(e){De.on(e,"click",(()=>{const t=decodeURIComponent(e.getAttribute("data-jump-url")),n=decodeURIComponent(e.getAttribute(Ea.clickReportPropName)||"");Ra(e)&&t&&(n&&Da(n),$e(t))}))}function Oa(){const e=document.getElementsByTagName(Ea.tagName);for(const t of e){const e=t.getAttribute(Ea.componentIdPropName);if(Pa[e])continue;const n=t.getBoundingClientRect();if(n.bottom>0&&n.top<window.innerHeight){const n=decodeURIComponent(t.getAttribute(Ea.exposureReportPropName)||"");if(!Ra(t)||!n)continue;Da(n),Pa[e]=!0}}}const Ba={initCpslink:function(){const e=document.getElementsByTagName(Ea.tagName);for(const t of e)t.classList.add("js_wx_tap_highlight"),ja(t);De.on(window,"scroll",Oa)},updateCpslinkStatus:function(e){for(const t of e){if(!t||!t.component_id)continue;const e=t.component_id,n=document.querySelector("".concat(Ea.tagName,"[").concat(Ea.componentIdPropName,'="').concat(e,'"]'));n&&(n.setAttribute(Ea.clickReportPropName,t.click_url),n.setAttribute(Ea.exposureReportPropName,t.exp_url),n.setAttribute(Ea.banPropName,t.merge_status))}Oa()}},La='<div id="page-content">\n  \x3c!--S 全屏播放 full_screen_mv--\x3e\n  <div id="js_mpvedio_wrapper_<#=vid#>" style="position:relative;height:100%">\n    <div class="add_bg_color appmsg_video">\n      <div id="js_video_tail_panel_<#=vid#>" class="video_tail_module video_screen_half" style="display: none;">\n        <div class="video_tail_module__hd" id="js_video_tail_hd">\n          <div class="account_info_wrp">\n            <div class="profile_info_wrp js_go_profile">\n              <img class="account_avatar" src="" alt="" id="js_tail_panel_account_avatar">\n                <div class="account_name" id="js_tail_panel_account_name"></div>\n                <div class="subscription_info subscription_success">\n                  <div class="account_subscription_tips js_subscription_success" id="js_subscription_success"\n                    style="display: none;">已关注</div>\n                  <i class="account_link_icon js_profile_icon" id="js_profile_icon"></i>\n                </div>\n            </div>\n            <div class="btn_account_subscription js_btn_account_subscription" id="js_btn_account_subscription" style="display: none;">\n              Follow</div>\n          </div>\n          <div class="opr_wrp">\n            <span class="opr_item_wrp js_replay" id="js_replay">\n              <i class="opr_item refresh_icon"></i>\n              <span class="opr_item_text">Replay</span>\n            </span>\n            <span class="opr_item_wrp share_item_wrp js_share_button" id="js_tail_share_button"\n              style="display: none;">\n              <i class="opr_item share_icon"></i>\n              <span class="opr_item_text">Share</span>\n            </span>\n            \x3c!--点赞后 加className selected--\x3e\n            <span class="opr_item_wrp like_item_wrp" id="js_tail_like_button" style="display: none;">\n              <i class="opr_item like_icon"></i>\n              <span class="opr_item_text">Like</span>\n            </span>\n            \x3c!-- <span class="opr_item_wrp recommend_item_wrp" id="js_tail_channel_button"\n              style="display: none;">\n              <i class="opr_item video-logo_icon"></i>\n              <span class="opr_item_text">随便看看</span>\n            </span> --\x3e\n          </div>\n        </div>\n\n        \x3c!-- 有拓展内容 --\x3e\n        <div class="have_expand" id="js_expand_area">\n        </div>\n\n        \x3c!-- 广告内容 --\x3e\n        <div class="ad_area" id="js_tail_video_ad_area">\n        </div>\n      </div>\n    </div>\n    <div id="js_vue_player_<#=index#>"></div>\n  </div>\n  \x3c!--E 视频播放器--\x3e\n  \x3c!-- S 视频社交--\x3e\n  <div id="bottom_bar" class="interact_video" style="display:none;height: 35px;">\n    <div class="inter_opr">\n      <a id="video_detail_btn" href="javascript:;" target="_blank" class="access_original">\n        Video Details\n      </a>\n    </div>\n  </div>\n</div>';function Na(){const e={hasShowBotbar:!1,mpVideoBotH:37,showComment:!0,loverCount:{}};let t={};function n(e,t){const n=t||window.location.search,i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),o=n.substr(n.indexOf("?")+1).match(i);return null!=o?o[2]:""}function i(t){return document.querySelector("#js_mp_video_container_".concat(e.iframeIdx," #").concat(t))}function o(){!function(){let n=e.ratio;t.vw&&t.vh&&(n=t.vw/t.vh);const o=t.vw||e.dom.js_mpvedio.offsetWidth,a=Math.ceil(o/n),r=[At];ke.isWechat&&!ke.isNewMpApp&&(he.os.iphone||he.os.android)&&new Date(1e3*window.ct)>new Date("2022/01/12 19:00:00 GMT+0800")&&r.push(Et);const s={cgiData:t,preview:!(1*t.preview!=1),isInIframe:!0,hitBizuin:t.hit_bizuin,hitVid:t.hit_vid,fromid:e.scene,oriStatus:e.ori_status,isMpVideo:t.txvideo_vid?0:t.is_mp_video,plugins:r,oriVid:e.vid,vid:t.txvideo_vid?t.txvideo_vid:e.vid,ckey:t.txvideo_vid?"":e.ckey,ckey_ad:e.ckey_ad,width:o,height:a,__biz:e.__biz,uin:e.uin,mid:e.mid,idx:e.idx,coverFit:"contain",vtitle:window.msg_title,videoTitle:window.msg_title,useFeFullscreen:!0,comment_id:e.comment_id,scene_type:0,autoplay:e.autoplay,videoMd5:t.video_md5,headImgUrl:window.round_head_img,canShareVideo:!t.isPaySubscribe,bizUserName:window.user_name,bizNickName:window.nickname,profileTabType:1,leaveReport12710Type:1,storeFactory:e=>{const t=new O.Store({modules:{[B.name]:B},state:{...L(),cgiData:e},mutations:N()});return t.registerModule([B.name,M.name],M),t.registerModule([B.name,q.name],q),t}},c=Ct();e.myPlayer=new Tt({el:"#js_vue_player_"+e.iframeIdx,opt:s,store:c}),e.myPlayer.$on("player-ready",(()=>{if(e.dom.js_mpvedio.style.height="100%",W.showReprint()&&!e.hasShowBotbar){const n=i("bottom_bar");n&&(n.style.display="",e.hasShowBotbar=!0,Te.postMessage({type:"addVideoIframeHeight",data:{vid:t.txvideo_vid||e.id,height:e.mpVideoBotH}}))}Te.postMessage({type:"videoInited",data:{vid:e.id,ori_status:e.ori_status,hit_bizuin:t.hit_bizuin,hit_vid:t.hit_vid}})})),e.myPlayer.$on("video-ready",(()=>{Te.postMessage({type:"removeVideoLoading",data:{vid:e.vid}})})),e.myPlayer.$on("fullscreenchange",(t=>{"frontend"===t.type&&(t.state&&e.dom.js_mpvedio.parentNode!==document.body?(e.dom.js_mpvedio.style="position: fixed; top: 0; width: 100%; height: 100%",e.dom.js_mpvedio.style.zIndex=510,e.dom.js_article.style.opacity=0,window.requestAnimationFrame((()=>{document.body.appendChild(e.dom.js_mpvedio),t.supportSwipeBack||(e.dom.js_article.style.transition="opacity .1s")}))):t.state||e.dom.js_mpvedio.parentNode===e.dom.page_content||(e.dom.page_content.appendChild(e.dom.js_mpvedio),t.supportSwipeBack?(e.dom.js_mpvedio.style="position: relative; height: 100%",e.dom.js_article.style.opacity=1):(e.dom.js_mpvedio.style="",setTimeout((()=>{e.dom.js_article.style.opacity=1}),150))))}))}()}function a(a){const{vid:r,vh:s,vw:c,ratio:l,index:d,is_mp_video:u}=a,p=(window.__videoPageInfos||[]).find((({video_id:e})=>e===r))||{};new Promise((e=>{u?e():pe({url:"/mp/videoplayer?action=tx_video&biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&vid=").concat(r,"&source=").concat(window.source),type:"GET",dataType:"json",f:"json",success:t=>{t&&t.base_resp&&0===t.base_resp.ret?e(t.ckey):e()},error:()=>e()})})).then((a=>{t={hit_bizuin:p.hit_bizuin,hit_vid:p.hit_vid,ori_status:p.ori_status,hit_username:p.hit_username,is_mp_video:/^wxv/.test(p.hit_vid)||p.is_mp_video,vh:s,vw:c,vid:r,ckey:a,ratio:l,iframeIdx:d,biz:window.biz,mid:window.mid,idx:window.idx,uin:window.uin,__biz:window.biz,video_title:window.cgiData.title||"",is_login:window.is_login,user_uin:window.user_uin,username:window.user_name,nick_name:window.nickname,preview:!!window.is_temp_url,create_time:window.create_time,source_encode_biz:window.source_encode_biz,comment_id:window.comment_id,show_comment:window.show_comment,isPaySubscribe:1*window.isPaySubscribe||0,bizNickname:window.nickname,roundHeadImg:window.round_head_img,subscene:window.subscene,enterid:1*window.enterid,sessionid:window.sessionid,channel_session_id:window.channel_session_id,real_item_show_type:window.real_item_show_type,item_show_type:window.item_show_type,clientversion:window.clientversion,devicetype:window.devicetype,isprofileblock:window.isprofileblock,sn:window.sn||n("sign",window.location.href)||"",scene:window.source||window.scene||n("scene",window.location.href)||0},1*t.ori_status==1?e.ori_status=1:1*t.ori_status==2?e.ori_status=2:e.ori_status=3,e.showComment=1*t.show_comment==1,e.comment_id=t.comment_id,e.vid=t.vid,e.ckey=t.ckey,e.ckey_ad=t.ckey_ad,e.__biz=t.__biz,e.uin=t.uin,e.mid=t.mid,e.idx=t.idx,e.scene=t.scene||n("scene",window.location.href)||0,e.autoplay=!!e.container.getAttribute("__sec_open_auto_play__"),e.iframeIdx=t.iframeIdx,e.dom={js_article:document.getElementById("js_article"),js_mpvedio:i("js_mpvedio_wrapper_"+e.vid),page_content:i("page-content")},o(),function(){const o=i("h5_profile_btn");o&&2===t.ori_status&&De.tap(o,(()=>{const e="https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz="+t.source_encode_biz+"&scene=111#wechat_redirect";ke.isWindowsWechat||ke.isMacWechat?location.href=e:xe.invoke("openUrlWithExtraWebview",{url:e,openType:1},(t=>{-1===t.err_msg.indexOf("ok")&&(location.href=e)}))}));const a=i("video_detail_btn");a&&/^wxv_/.test(t.vid||"")&&De.tap(a,(()=>{const i=["https://mp.weixin.qq.com/mp/video?t=pages/video_detail_new","&vid=",e.vid,"&mid=",e.mid,"&__biz=",e.__biz,"&idx=",e.idx,"&sn=",window.sn||n("sign",window.location.href)||"","&vidsn=",t&&t.vidsn?t.vidsn:"","&scene=100#wechat_redirect"];e.myPlayer&&e.myPlayer.extendMpReportData({detail_click:1}),window.location.href=i.join("")}))}()}))}return{createMpVideoDom:function(t,n,i){const o=_e.getQuery("vid",i),r=t.getAttribute("data-vw"),s=t.getAttribute("data-vh"),c=t.getAttribute("data-ratio"),l=document.createElement("span"),d=t.attributes;for(let e=d.length-1;e>=0;e--)l.setAttribute(d[e].name,d[e].value);l.id="js_mp_video_container_"+n,l.setAttribute("vid",o),l.classList.add("video_iframe"),l.style.cssText=t.style.cssText,l.style.display="none";const u=je.tmpl(La,{vid:o,index:n,video_h:s},!1);l.innerHTML=u;const p=t.parentNode;return p?(p.lastChild===t?p.appendChild(l):p.insertBefore(l,t.nextSibling),p.removeChild(t),e.container=l,a({iframe:l,vid:o,vh:s,vw:r,ratio:c,index:n,is_mp_video:/^wxv_.+$/.test(o||"")}),l):null}}}function Ma(){const e={txVideoReg:/^http(s)*\:\/\/v\.qq\.com\/iframe\/(preview|player)\.html\?/,mpVideoReg:/^http(s)*\:\/\/mp\.weixin\.qq\.com\/mp\/readtemplate\?t=pages\/video_player_tmpl/,video_iframe:[],video_top:[]};function t(e){console.info("iframe_onload");let t=0;try{const n=document.getElementsByTagName("html").item(0).style["-webkit-text-size-adjust"],i=e.contentDocument;if(i){const e=i.getElementsByTagName("html").item(0);e&&(e.style["-webkit-text-size-adjust"]=n)}xe.on("menu:setfont",(()=>{const t=function(e){let t=0;return e.contentDocument&&e.contentDocument.body.offsetHeight?t=e.contentDocument.body.offsetHeight:e.Document&&e.Document.body&&e.Document.body.scrollHeight?t=e.Document.body.scrollHeight:e.document&&e.document.body&&e.document.body.scrollHeight&&(t=e.document.body.scrollHeight),t}(e);e.parentElement&&0!==t&&(e.style.height="".concat(t,"px"))})),e.contentDocument&&e.contentDocument.body.offsetHeight?t=e.contentDocument.body.offsetHeight:e.Document&&e.Document.body&&e.Document.body.scrollHeight?t=e.Document.body.scrollHeight:e.document&&e.document.body&&e.document.body.scrollHeight&&(t=e.document.body.scrollHeight);if(e.parentElement&&(e.style.height=t+"px"),/MSIE\s(7|8)/.test(navigator.userAgent)&&e.contentWindow&&e.contentWindow.document){const t=e.contentWindow.document.getElementsByTagName("html");t&&t.length&&(t[0].style.overflow="hidden")}const o=e.contentWindow.document,a=o.querySelectorAll(".vote_option_title .img_panel img"),r="data-prevent-longtap";for(const e of a){if("1"===e.getAttribute(r))continue;e.setAttribute(r,"1"),e.style["pointer-events"]="none",e.addEventListener("touchstart",(e=>e.preventDefault()));const t=e.parentNode,n=t.parentNode,i=o.createElement("div");i.setAttribute("style","\n          position: absolute;\n          left: 0;\n          top: 0;\n          width: 100%;\n          height: 100%;\n        "),n.style.position="relative",n.removeChild(t),i.appendChild(t),n.appendChild(i),i.addEventListener("touchstart",(()=>e.dispatchEvent(new MouseEvent("click"))),!0)}bi&&bi.postPageHeightMessage&&bi.postPageHeightMessage("updatePageHeight"),console.log("financeUtils done"),Re.emitRenderNewHeightEvt()}catch(su){}}const n=[].slice.call(document.getElementsByTagName("iframe")),i=[],o=Math.ceil(1e4*Math.random());window.reportVid=[];for(let r=0,s=n.length;r<s;++r){const a=n[r],s=r;let c=a.getAttribute("data-src")||"";const l=a.className||"";let d=a.getAttribute("src")||c;if(!c||"#"===c){let e=a.getAttribute("data-display-src");if(e&&(0==e.indexOf("/cgi-bin/readtemplate?t=vote/vote-new_tmpl")||0==e.indexOf("https://mp.weixin.qq.com/cgi-bin/readtemplate?t=vote/vote-new_tmpl"))){e=e.replace(/&amp;/g,"&");const t=e.split("&"),n=["/mp/newappmsgvote?action=show"];t.forEach((e=>{0!=e.indexOf("__biz=")&&0!=e.indexOf("supervoteid=")||n.push(e)})),n.length>1&&(c=n.join("&")+"#wechat_redirect")}}if(d&&(e.txVideoReg.test(d)||e.mpVideoReg.test(d))||a.getAttribute("data-mpvid")&&a.getAttribute("data-mpvid").startsWith("wxv_")){const t=_e.getQuery("vid",c)||a.getAttribute("data-mpvid"),n=(window.__videoPageInfos||[]).find((e=>e.video_id===t)),i=n&&n.hit_vid;if(z.isShowMpVideo()||e.mpVideoReg.test(d)||"".concat(i).startsWith("wxv_")){if(!t)return;const n=a.getAttribute("data-vw"),i=a.getAttribute("data-vh");"qq.com"==document.domain&&((new Image).src="https://badjs.weixinbridge.com/badjs?id=139&level=4&from="+window.encodeURIComponent(window.location.host)+"&msg="+window.encodeURIComponent(window.location.href),ue.setLogs({id:27302,key:100,value:1,log:"[beforeD]"+window.encodeURIComponent(window.location.href)})),window.reportVid.push(t),d=["/mp/videoplayer?video_h=",i,"&video_w=",n,"&scene=",window.source,"&random_num=",o,"&article_title=",encodeURIComponent(window.msg_title.htmlDecode()),"&source=4&vid=",t,"&mid=",appmsgid,"&idx=",itemidx||idx,"&__biz=",biz,"&nodetailbar=",window.is_temp_url?1:0,"&uin=",uin,"&key=",key,"&pass_ticket=",pass_ticket,"&version=",version,"&devicetype=",window.devicetype||"","&wxtoken=",window.wxtoken||"","&sessionid=",window.sessionid||"","&preview=",window.is_temp_url?1:0,"&is_in_pay_subscribe=",window.isPaySubscribe,"&nickname=".concat(window.nickname),"&roundHeadImg=".concat(window.round_head_img),"&enterid=".concat(window.enterid),"&subscene=".concat(window.subscene)].join("");const r=Na().createMpVideoDom(a,s,d);e.video_iframe.push({dom:r,vid:t})}}else if(c&&(c.indexOf("newappmsgvote")>-1&&(l.indexOf("js_editor_vote_card")>=0||l.indexOf("vote_iframe")>=0)||0==c.indexOf("http://mp.weixin.qq.com/bizmall/appmsgcard")&&(l.indexOf("card_iframe")>=0||l.indexOf("js_editor_card")>=0)||c.indexOf("appmsgvote")>-1||c.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")>-1)){if(window.is_transfer_msg&&!window.reprint_ticket&&c.indexOf(window.biz)<0)return void i.push(a);if(window.__second_open__||(c=c.replace(/^http:/,location.protocol)),l.indexOf("card_iframe")>=0||l.indexOf("js_editor_card")>=0){-1===l.indexOf("card_iframe")&&(a.className+=" card_iframe"),-1===l.indexOf("res_iframe")&&(a.className+=" res_iframe");let e=c.replace("#wechat_redirect",["&pass_ticket=",pass_ticket,"&scene=",source,"&msgid=",appmsgid,"&msgidx=",itemidx||idx,"&version=",version,"&devicetype=",window.devicetype||"","&child_biz=",biz,"&wxtoken=",window.wxtoken||""].join(""));reprint_ticket&&(e+=["&mid=",mid,"&idx=",idx,"&reprint_ticket=",reprint_ticket,"&source_mid=",source_mid,"&source_idx=",source_idx].join("")),window.__second_open__?pe({url:e,type:"GET",f:"html",success:function(n){a.setAttribute("src",e),a.contentWindow.document.open("text/html","replace"),a.contentWindow.document.write(n),a.contentWindow.document.close(),a.contentWindow.history.replaceState(null,null,e),-1==c.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")&&(a.onload=function(){t(a)})}}):(a.setAttribute("src",e),-1==c.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")&&(a.onload=function(){t(a)}))}else{let e=c.indexOf("#wechat_redirect")>-1,n=["&uin=",uin,"&key=",key,"&pass_ticket=",pass_ticket,"&wxtoken=",window.wxtoken||""].join("");reprint_ticket?n+=["&mid=",mid,"&idx=",idx,"&reprint_ticket=",reprint_ticket,"&source_mid=",source_mid,"&source_idx=",source_idx,"&appmsg_token=",appmsg_token].join(""):(l.indexOf("vote_iframe")>=0||l.indexOf("js_editor_vote_card")>=0)&&(n+=["&mid=",mid,"&idx=",idx,"&appmsg_token=",appmsg_token].join(""),-1===l.indexOf("vote_iframe")&&(a.className+=" vote_iframe"));let i=e?c.replace("#wechat_redirect",n):c+n;window.__second_open__?pe({url:i,type:"GET",f:"html",success:function(e){a.contentWindow.Ajax=pe,a.setAttribute("src",i),a.contentWindow.document.open("text/html","replace"),a.contentWindow.document.write(e),a.contentWindow.document.close(),a.contentWindow.history.replaceState(null,null,i),-1==c.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")&&(a.onload=function(){t(a)})}}):(a.setAttribute("src",i),-1==c.indexOf("mp.weixin.qq.com/mp/getcdnvideourl")&&(a.onload=function(){t(a)}))}a.appmsg_idx=r}}function a(){const t=window.pageYOffset||document.documentElement.scrollTop,n=e.video_top.length,i=t+Oe.getInnerHeight();let o=0;for(let a=0;a<n;a++){const t=e.video_top[a];t.reported?o++:i>=t.start&&i<=t.end&&(t.reported=!0,setTimeout(function(e,t,n){return function(){const i=Ae.getVideoInfo();let o="",a="",r=3;i[e]&&(i[e].hit_bizuin&&(o=i[e].hit_bizuin),i[e].hit_vid&&(a=i[e].hit_vid),i[e].ori_status&&(r=i[e].ori_status)),W.report({step:1,hit_vid:a,hit_bizuin:o,ori_status:r,vid:e,screen_num:Math.ceil(t/n),screen_height:n})}}(t.vid,i,Oe.getInnerHeight()),1e4))}o==n&&(De.off(window,"scroll",a),e.video_top=null,e.video_iframe=null,a=null)}if(i.forEach((e=>e.parentNode.removeChild(e))),window.iframe_reload=function(){n.forEach((e=>{const n=e.getAttribute("src");n&&(n.indexOf("newappmsgvote")>-1||n.indexOf("appmsgvote")>-1)&&t(e)}))},"getElementsByClassName"in document){const e=document.getElementsByClassName("video_iframe");for(let t,n=0;t=e.item(n++);)t.setAttribute("scrolling","no"),t.style.overflow="hidden"}e.video_iframe.length>0&&setTimeout((()=>{const t=e.video_iframe,n=document.getElementById("js_article");for(let i=0,o=t.length;i<o;i++){const o=t[i];if(!o||!o.dom)return;let a=o.dom;const r=parseFloat(getComputedStyle(a).getPropertyValue("height"));let s=0;for(;a&&n!==a;)s+=a.offsetTop,a=a.offsetParent;e.video_top.push({start:s+r/2,end:s+r/2+Oe.getInnerHeight(),reported:!1,vid:o.vid})}a(),De.on(window,"scroll",a)}))}const qa=[],Wa='<span class="original_img_wrp">\n<span class="tips_global">From : <#=source_nickname#></span>\n</span>';function za(e){let t=e.getAttribute("data-src")||e.getAttribute("src"),n=_e.getQuery("vid",t),i=e.getAttribute("data-vw"),o=e.getAttribute("data-vh"),a=e.getAttribute("data-ratio"),r=document.createElement("span");r.setAttribute("data-ratio",a),r.id="js_tx_video_container_"+Math.random(),r.className="js_tx_video_container",r.style.cssText=e.style.cssText,r.style.display="none";let s=e.parentNode;if(s)return s.lastChild===e?s.appendChild(r):s.insertBefore(r,e.nextSibling),Pt.createTxVideo({containerId:r.id,vid:n,width:i,height:o,autoplay:!1,allowFullScreen:!0,onSuccess:function(e){r.playerObj=e.player,function(e,t){if(!t||!e)return;let n=e.parentNode;if(!n)return;let i=[];for(let o=0,a=n.children.length;o<a;o++){let e=n.children[o];e.className.indexOf("js_img_placeholder")>=0&&e.getAttribute("data-vid")==t&&i.push(e)}for(let o=0,a=i.length;o<a;o++)n.removeChild(i[o]);e.style.display="block"}(r,n),r.style.display="block"},onError:function(){}}),s.removeChild(e),r}function Fa(){let e="27613";Je.getData({biz:biz,appmsg_type:appmsg_type,mid:mid,sn:sn,idx:idx,scene:source,title:msg_title,ct:ct,abtest_cookie:abtest_cookie,devicetype:devicetype,version:window.clientversion,is_need_ticket:qa&&qa.length>0?1:0,is_need_ad:0,comment_id:comment_id,is_need_reward:is_need_reward,both_ad:0,reward_uin_count:is_need_reward?3*F.getCountPerLine({can_reward:!0})-1:0,send_time:window.send_time||"",msg_daily_idx:msg_daily_idx,item_show_type:window.item_show_type,is_original:0,is_only_read:is_only_read,req_id:window.req_id||"",pass_ticket:pass_ticket,is_temp_url:window.is_temp_url||0,rtId:e,rtKey:"50",appmsg_like_type:window.appmsg_like_type,is_pay_subscribe:window.isPaySubscribe,pay_subscribe_uin_count:window.isPaySubscribe?3*m.getCountPerLine():0,has_red_packet_cover:window.__appmsgCgiData.has_red_packet_cover,export_key:_e.getQuery("exportkey"),export_key_extinfo:"",onSuccess:function(t){if(t)try{if(window.__second_open__&&t&&1*!!t.bizfile_ret==1&&(window.localStorage&&window.localStorage.setItem&&window.localStorage.setItem("isBanned-".concat(window.biz,"-").concat(window.mid,"-").concat(window.idx),"1"),window.location.href.indexOf("?")>-1?window.location.href=window.location.href+"&r="+Math.random()+"#wechat_redirect":window.location.href=window.location.href+"?r="+Math.random()+"#wechat_redirect"),l.commit("SET_EXT_RES",t),window.__second_open__&&t.pay_subscribe_info&&1*t.pay_subscribe_info.is_paid!=isPaid)return Xe.report110809(11),(new Image).src="https://badjs.weixinbridge.com/badjs?id=244&level=4&from="+window.encodeURIComponent(window.location.host)+"&msg="+window.encodeURIComponent(window.location.href),void xe.invoke("handleMPPageAction",{action:"paySuccess",fullUrl:window.location.href,itemShowType:window.item_show_type,url:location.href},(e=>{e.err_msg.indexOf("ok")>-1?Xe.report110809(19):Xe.report110809(20),window.localStorage&&window.localStorage.setItem&&window.localStorage.setItem("isPaid-".concat(window.biz,"-").concat(window.mid,"-").concat(window.idx),"1"),window.location.href=window.location.href+"&r="+Math.random()+"#wechat_redirect"}));if(t&&t.base_resp&&t.base_resp.wxtoken&&(window.wxtoken=t.base_resp.wxtoken),window.fromWeixinCached&&Ma(),function(e){if(!e||!e.img_copy_info||!e.img_copy_info.list)return;let t={},n=e.img_copy_info.list,i=window.__appmsgCgiData.copyright_stat,o=window.__appmsgCgiData.source_biz;for(let r=0,s=n.length;r<s;r++){let e=n[r];if(2==e.type){if(2==i&&o==e.source_uin)continue;t[e.img_url]={source_nickname:e.source_nickname,source_uin:e.source_uin,source_encode_biz:e.source_encode_biz||""}}}let a=document.getElementsByTagName("img");for(let r=0,s=a.length;r<s;r++){let e=a[r],n=e.getAttribute("data-src")||e.getAttribute("data-backsrc")||"";if(t[n]){let i=document.createElement("div");i.innerHTML=je.tmpl(Wa,t[n],!1);let o=i.children[0],a=e.parentNode.insertBefore(o,e),r=a.children[0];!function(e,t){De.on(t,"click",(function(t){let n="https://mp.weixin.qq.com/mp/profile_ext?action=home&__biz="+e.source_encode_biz+"&scene=112#wechat_redirect";return ke.isWindowsWechat||ke.isMacWechat?(location.href=n,!1):(xe.invoke("openUrlWithExtraWebview",{url:n,openType:1},(function(e){-1==e.err_msg.indexOf("ok")&&(location.href=n)})),!1)}))}(t[n],r),a.insertBefore(e,r)}}}(t),t.ret)return;t.red_packet_cover_data&&t.red_packet_cover_data.cover_uri_data&&t.red_packet_cover_data.cover_uri_data.length>0&&(Oi.init(),Oi.render({list:t.red_packet_cover_data.cover_uri_data})),t.link_component_list&&t.link_component_list.length&&Ba.updateCpslinkStatus(t.link_component_list),window.isFans=t.is_fans,function(e){let t=e.appmsgstat||{};const n=e.appmsgact||{},i=e.paySubscribeInfo||{};window.paySubscribeInfo=i,window.isFans=e.is_fans,window.appmsgstat||(window.appmsgstat=t),dt(),F.initAuthorName(e.reward,{reward_entrance_enable_for_preview:e.reward_entrance_enable_for_preview}),window.isPaySubscribe&&m.init(i,l);const o=document.querySelector("#js_star");o&&Ut(o,1*t.star_num||0,window.can_use_star,t.star_status);let a=[];const{old_liked_before:r,seen_before:s,favorite_before:c,share_before:d,reward_before:u,pay_before:p}=n,{old_liked:h,liked:_}=t;(h||r)&&a.push("like"),(_||s)&&a.push("zaikan"),c&&a.push("collect"),d&&a.push("share"),u&&a.push("reward"),p&&a.push("pay"),window.is_like_profile_gray=e.show_biz_banner,window.is_like_profile_gray&&a.push("gray"),(a.length>0||Qo)&&l.commit("mp-like-profile/setSources",a),e.close_related_article&&l.commit("mp-related-article/setNotLoad",!0),t.old_liked||n.old_liked_before?l.commit("mp-related-article/setSources",["praised",!0]):t.liked||n.seen_before?l.commit("mp-related-article/setSources",["liked",!0]):n.favorite_before?l.commit("mp-related-article/setSources",["favorited",!0]):n.share_before?l.commit("mp-related-article/setSources",["shared",!0]):Qo?l.commit("mp-related-article/setSources",["recommend",!0]):e.show_related_article?l.commit("mp-related-article/setSources",["force",!0]):n.reward_before?l.commit("mp-related-article/setSources",["rewarded",!0]):n.pay_before&&l.commit("mp-related-article/setSources",["paid",!0])}({show_biz_banner:t.show_biz_banner,appmsgstat:t.appmsgstat,appmsgact:t.appmsgact,comment_enabled:t.comment_enabled,comment_count:t.comment_count,only_fans_can_comment:t.only_fans_can_comment,only_fans_days_can_comment:t.only_fans_days_can_comment,is_fans_days:t.is_fans_days,reward:{reward_total:t.reward_total_count,is_reward_total_count_cut:t.is_reward_total_count_cut,reward_head_img_infos:t.reward_head_img_infos||[],can_reward:t.can_reward,user_can_reward:t.user_can_reward,reward_qrcode_ticket:t.reward_qrcode_ticket,timestamp:t.timestamp,reward_author_head:t.reward_author_head,rewardsn:t.rewardsn,scene:source,is_need_reward:is_need_reward,title:msg_title,author_id:author_id,appmsgextRtId:e,appmsgextRtKey:"50",can_whisper:t.can_whisper},reward_entrance_enable_for_preview:t.reward_entrance_enable_for_preview,reward_wording:t.reward_wording,reward_author_head:t.reward_author_head,comment_entrance_enable_for_preview:t.comment_entrance_enable_for_preview,share_redirect_url:t.share_redirect_url||"",logo_url:t.logo_url,nick_name:t.nick_name,is_fans:t.is_fans,paySubscribeInfo:t.pay_subscribe_info,share_flag:t.share_flag,test_flag:t.test_flag,show_related_article:t.show_related_article,close_related_article:t.close_related_article,related_article_fast_close:t.related_article_fast_close,hit_bizrecommend:t.hit_bizrecommend}),window.ext_complete_success=!0,Pe.emit("ext-complete-success")}catch(su){return fe.log("[Appmsg] error parse async data, biz="+biz+", mid="+mid),ue.setLogs({id:24729,key:1,value:1,log:"biz:".concat(biz,",mid:").concat(mid,",uin:").concat(uin,",[key1]").concat(encodeURIComponent(su.toString())).substring(0,1024)}),console&&console.error(su),void(void 0!==window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&WX_BJ_REPORT.BadJs.onError(su))}},onError:function(){ue.setLogs({id:24729,key:2,value:1,log:"biz:".concat(biz,",mid:").concat(mid,",uin:").concat(uin,",[key2]ajax_err")})},onComplete:function(){window.ext_complete=!0,ke.isOnlyWechat||(console.warn("window.ext_complete_success:",window.ext_complete_success),window.ext_complete_success=!0),Pe.emit("ext-complete")}})}function Ua(){!function(){let e=document.getElementsByTagName("iframe"),t=[];for(let o=0,a=e.length;o<a;++o)t.push(e[o]);e=null;let n=document.getElementById("js_content").offsetWidth,i=n/W.getRatio();window.logs.video_cnt=0;for(let o=0,a=t.length;o<a;++o){let e=t[o],a=e.getAttribute("data-src")||"",r=e.getAttribute("src")||a;if(r)if(0==r.indexOf("http://z.weishi.com/weixin/player.html"))r=r.replace(/width=\d+/g,"width="+n),r=r.replace(/height=\d+/g,"height="+i),e.width=n,e.height=i,e.style.setProperty&&(e.style.setProperty("width",n+"px","important"),e.style.setProperty("height",i+"px","important")),e.setAttribute("src",r),window.__addIdKeyReport&&window.__addIdKeyReport("28307",10),window.logs.video_cnt++;else{if(/http(s)*\:\/\/v\.qq\.com\/iframe\/(preview|player)\.html\?/.test(r)){const t=_e.getQuery("vid",a)||e.getAttribute("data-mpvid"),n=(window.__videoPageInfos||[]).find((e=>e.video_id===t)),i=n&&n.hit_vid;if(!z.isShowMpVideo()&&!"".concat(i).startsWith("wxv_")){const t=za(e);t&&qa.push(t),"function"==typeof window.__addIdKeyReport&&(window.__addIdKeyReport("28307",10),ke.isWechat&&ke.isWindowsWechat?window.__addIdKeyReport("110644",0):ke.isWechat&&ke.isMacWechat&&window.__addIdKeyReport("110644",1))}window.logs.video_cnt++;continue}/^http(s)*\:\/\/mp\.weixin\.qq\.com\/mp\/readtemplate\?t=pages\/video_player_tmpl/.test(r)&&window.logs.video_cnt++}}qa.length>0&&"function"==typeof window.__getVideoWh&&De.on(window,"resize",(function(){try{for(let e=0,t=qa.length;e<t;e++){let t=qa[e],n=t.playerObj;if(n){let e=window.__getVideoWh(t);t.style.width=e.w+"px",t.style.height=e.h+"px",n.resize({width:e.vw,height:e.vh})}}}catch(su){}}),!1)}(),Fa()}document.querySelectorAll("mp-common-product");const Ha=window.user_uin||0,Va=Math.floor(Ha/100)%1e3,Ka=0!==Ha&&Va<1001;function $a(e,t){window.logs.img={download:{},read:{},load:{}};const n=document.getElementById("js_cover");if(n){let e=n.getAttribute("data-src");e&&(e.isCDN()&&(e=e.imgChange640(),t&&(e=ft(e)),e=ge(e,5),is_https_res||Ka?e=e.http2https():"http:"!=location.protocol&&-1==navigator.userAgent.indexOf("MicroMessenger")||(e=e.https2http())),setTimeout((function(){n.onload=function(){Ht.setProperty(n,"height","auto","important"),Ht.setProperty(n,"visibility","visible","important")},n.setAttribute("src",e)}),0),window.logs.img.read[e]=!0,window.logs.img.load[e]=!0,n.removeAttribute("data-src"))}function i(e){return parseInt(e,10)||0}window.logs.outer_pic=0;const o=document.getElementsByTagName("img");for(let a=0,l=o.length;a<l;a++){const e=o[a].getAttribute("data-src");e&&e.isGif()&&o[a].classList.add("__bg_gif")}const r=document.getElementsByClassName("__bg_gif");for(let a=0,l=r.length;a<l;++a)r[a].setAttribute("data-order",a);const s=function(e){try{let t=e.childNodes,n=getComputedStyle(e);(n.backgroundImage.match(/https\:\/\/mmbiz\.qpic\.cn/)||n.backgroundImage.match(/http\:\/\/mmbiz\.qpic\.cn/))&&window.__addIdKeyReport("111535",2);for(let e=0;e<t.length;e++)"a"!=t[e].tagName.toLowerCase()&&s(t[e])}catch(su){}};try{const e=document.getElementsByTagName("a");for(let t=0;t<e.length;t++){const n=e.item(t);null!=(n.getAttribute("href")||"").match(/^http/)&&s(n)}}catch(su){}let c=!1;window.isCartoonCopyright||window.is_care_mode||new Mo({attrKey:"data-src",imgOccupied:!0,crossOrigin:!0,inImgRead(e){e&&(window.logs.img.read[e]=!0)},changeSrc(n,i,o,a){if(!n)return"";if(window.__offlineCacheScheme)return n.offline();let r=n;if(n.isCDN())r=r.imgChange640(),e&&r.canHevc()?(r=gt(r,!1),window.__addIdKeyReport("28307",91)):t?(r=ft(r),window.__addIdKeyReport("28307",84)):r=we(r,"tp","nowebp",!0),r=ge(r,"img"===a?5:15),is_https_res||Ka?(r=r.http2https(),window.__addIdKeyReport("28307",77)):"http:"!=location.protocol&&-1==navigator.userAgent.indexOf("MicroMessenger")||(r=r.https2http(),window.__addIdKeyReport("28307",70));else try{new RegExp("^http(s)?://((mmbiz.qpic.cn/.*)|(m.qpic.cn/.*)|(mmsns.qpic.cn/.*)|(shp.qpic.cn/.*)|(puui.qpic.cn/.*)|(wx.qlogo.cn/.*)|(mmbiz.qlogo.cn/.*)|((a|b)[0-9]*.photo.store.qq.com/.*)|(mp.weixin.qq.com/.*)|(res.wx.qq.com/.*))").test(n)||(window.__addIdKeyReport("28307",9),window.logs.outer_pic++)}catch(su){}return r=r.replace(/^http\:\/\/(a|b)(\d)+\.photo\.store\.qq\.com/g,"http://m.qpic.cn"),/^http(s)?:\/\/m\.qpic\.cn([\/?].*)*$/i.test(r)&&!t&&(r=we(r,"t","",!0)),r=we(r,"wx_lazy","1",!0),"anonymous"==i.crossOrigin&&(r=we(r,"wx_co","1",!0)),console.log(r,a,r.isJpg(),n),!wt()||"img"!==a&&!r.isJpg()||r.isGif()||(r=yt(r)),vt(r)&&window.__addIdKeyReport("28307",106),window.logs.img.load[r]=!0,fe.log("[Appmsg] image_load_event_change_src. originsrc:"+n+"  ^^^ newsrc : "+r),i.start_load_time=+new Date,r},onerror(e,t,n,o){let a,r=t&&t.__retryload||0;if("img"===o&&r>=2&&function(e,t,n){const o=n;!o||(o.width<40||o.height<40)&&(i(o.style.width)<40||i(o.style.height)<40)||o.classList.contains("wx_img_placeholder_err")||(o.classList.add("wx_img_placeholder_err"),o.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==",window.__addIdKeyReport("28307",51),o.bindRetry||(o.bindRetry=!0,De.on(o,"click",(()=>(window.__addIdKeyReport("28307",66),o.classList.remove("wx_img_placeholder_err"),e=e.https2http(),t.__retryload++,t.src=we(e,"retryload",t.__retryload,!0),!1)))))}(e,t,n),!e||r>2)return;if(!e.isCDN()){if(!wt())return;if(!vt(e))return}const s=0==e.indexOf("https://")?7:0;window.__addIdKeyReport("28307",72+s),r<=1&&window.__addIdKeyReport("28307",75+1*r+s),e.isWxpic()?(window.__addIdKeyReport("28307",93),window.WX_BJ_REPORT&&WX_BJ_REPORT.BadJs.report("imgError:hevc",e,{mid:"mmbizwap:imgMonitor",view:"wap_appmsg"}),r<=1&&window.__addIdKeyReport("28307",96+1*r)):e.isWebp()?(window.__addIdKeyReport("28307",86),window.WX_BJ_REPORT&&WX_BJ_REPORT.BadJs.report("imgError:webp",e,{mid:"mmbizwap:imgMonitor",view:"wap_appmsg"}),r<=1&&window.__addIdKeyReport("28307",89+1*r)):window.WX_BJ_REPORT&&WX_BJ_REPORT.BadJs.report("imgError",e,{mid:"mmbizwap:imgMonitor",view:"wap_appmsg"}),vt(e)&&window.__addIdKeyReport("28307",108),"img"===o&&r<2&&(r++,t.__retryload=r,1==r&&e.indexOf("http://")>-1?(e=e.http2https(),window.__addIdKeyReport("28307",60),window.__addIdKeyReport("28307",77)):1==r&&e.indexOf("https://")>-1?(window.__addIdKeyReport("28307",61),window.__addIdKeyReport("28307",77)):2==r&&e.indexOf("mmbiz.qpic.cn")>-1&&(e=e.replace("mmbiz.qpic.cn","mmbiz.qlogo.cn")).indexOf(!1)&&(e=e.http2https()),vt(e)&&(e=bt(e)),t.start_load_time=+new Date,a=e=we(e,"retryload",r,!0)),window.__has_imgfailed||(window.__has_imgfailed=!0,window.__addIdKeyReport("28307",65)),fe.log("[Appmsg] image_load_event_on_error. src:"+e),t.setAttribute("data-fail",1);try{if("[object Array]"==Object.prototype.toString.call(t.lazyLoadOnerror))for(let e=0,n=t.lazyLoadOnerror.length;e<n;e++)"function"==typeof t.lazyLoadOnerror[e]&&t.lazyLoadOnerror[e].call(t)}catch(su){}let c=10;return/tp\=webp/.test(e)&&(c=11),ue.setLogs({id:24729,key:c,value:1,log:encodeURIComponent(e)+"["+uin+"]"}),a},onload(e,t,n){var i;if(!window.__second_open__&&!c){const e=window.performance||window.msPerformance||window.webkitPerformance;if(!e||!e.timing)return;const t=window.location.protocol;a.saveSpeeds({uin:uin,pid:"https:"==t?462:417,speeds:{sid:35,time:Date.now()-e.timing.navigationStart}}),a.send(),c=!0}"img"===n&&(null==(i=null==t?void 0:t.classList)||i.remove("wx_img_placeholder_err"),t.gray&&!t.loadGif&&((t.width||t.naturalWidth)<120||(t.height||t.naturalHeight)<120?t.autoTap&&t.autoTap():t.span&&t.span.children&&t.span.children.item(0)&&(t.span.children.item(0).style.display="")));let o=t&&t.__retryload||0;if(o>2)return;fe.log("[Appmsg] image_load_event_onload_image. src:"+e+"  ^^^  retryloadtimes: "+o),t.setAttribute("data-fail",0),"img"===n&&function(e){try{const t=e.getAttribute("data-src");if(!/^https?\:\/\/mmbiz\.qpic\.cn/.test(t))return;let n=e.parentNode,i=!1;be.hasClass(n,"js_jump_icon")&&(i=!0);let o=!1;for(;n.tagName&&"body"!=n.tagName.toLowerCase();){if("a"==n.tagName.toLowerCase()){null!=(n.getAttribute("href")||"").match(/^http/)&&(o=!0);break}n=n.parentNode}if(i&&!o){let t=e.parentNode,n=t.parentNode;if(n){let e=document.createDocumentFragment();for(;t.firstChild;)e.appendChild(t.firstChild);n.insertBefore(e,t),n.removeChild(t)}}else if(!i&&o){let t=document.createElement("span"),n=getComputedStyle(e);"static"!=n.positon&&(t.style.position=n.positon),t.style.left=n.left,t.style.top=n.top,t.style.right=n.right,t.style.bottom=n.bottom,t.style.margin=n.margin,be.addClass(t,"js_jump_icon"),be.addClass(t,"h5_image_link"),e.style.position="static",e.style.margin="0px",e.parentNode.insertBefore(t,e),t.appendChild(e),window.__addIdKeyReport("111535",0)}}catch(su){}}(t);try{if("[object Array]"==Object.prototype.toString.call(t.lazyLoadOnload))for(let e=0,n=t.lazyLoadOnload.length;e<n;e++)"function"==typeof t.lazyLoadOnload[e]&&t.lazyLoadOnload[e].call(t)}catch(su){}const r=0==e.indexOf("https://")?7:0;window.__addIdKeyReport("28307",71+r),o<=1&&window.__addIdKeyReport("28307",73+1*o+r),e.isWxpic()?(window.__addIdKeyReport("28307",92),o<=1&&window.__addIdKeyReport("28307",94+1*o)):e.isWebp()&&(window.__addIdKeyReport("28307",85),o<=1&&window.__addIdKeyReport("28307",87+1*o)),vt(e)&&window.__addIdKeyReport("28307",107),window.__has_imgsucceed||(window.__has_imgsucceed=!0,window.__addIdKeyReport("28307",64)),1==o&&e.indexOf("http://")>-1&&window.__addIdKeyReport("28307",50),1==o&&e.indexOf("https://")>-1&&window.__addIdKeyReport("28307",52);const s=Math.random(),l=+new Date-t.start_load_time;l&&0==e.indexOf("https://")&&s<.5?(window.__addIdKeyReport("27822",121,l),window.__addIdKeyReport("27822",122)):l&&s<5e-4&&(window.__addIdKeyReport("27822",124,l),window.__addIdKeyReport("27822",125)),"img"!==n||""===t.style.filter||"none"===t.style.filter||/translate(Z|3d)\(/.test(t.style.transform)||(t.style.transform+=" translateZ(0)",t.style.webkitTransform+=" translateZ(0)")},detect(e){if(!e||!e.time||!e.loadList)return;const t=e.time,n=e.loadList;window.logs&&window.logs.img&&window.logs.img.download&&(window.logs.img.download[t]=n)},container:document.getElementById("page-content")})}function Ja(){const e=document.getElementById("js_read_container"),t={player:null,srcId:"__wxtag__".concat(window.biz,"-").concat(window.mid,"-").concat(window.idx),mediaId:"",tag:"===mediaId-sep===",playDuration:0,playTime:0,maxNum:5,curNum:0,format:"",type:6,speed:100,voiceInfo:{title:"",nickname:"",appmsgUrl:"",duration:0},voiceOpt:null,lock:!1,status:"stop",currentTime:0,beginTime:0,leaveNeedReport:!1,pause2PlayNeedReport:!1,isSeek:!1,loadingTimer:null},n=e=>"".concat(e,"&uin=").concat(window.uin,"&key=").concat(window.key,"&pass_ticket=").concat(encodeURIComponent(window.pass_ticket)),i=()=>{if(t.curNum>10)return(e=>{if(!e&&null!==t.loadingTimer)return clearTimeout(t.loadingTimer),void(t.loadingTimer=null);xe.invoke("handleMPPageAction",{action:"showToast",status:e?"loading":"dismissloading"})})(!1),t.lock=!1,void window.weui.alert("System busy. Try again later.");t.curNum++;const e=t.curNum>t.maxNum?5e3:1e3;pe({url:"/mp/msgvoice?action=getvoiceinfo&__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&sn=").concat(window.sn,"&type=").concat(t.type,"&speed=").concat(t.speed),type:"GET",dataType:"json",async:!0,success:a=>{if(a&&a.base_resp&&0===a.base_resp.ret)if(a.mediaid){t.mediaId=a.mediaid;const e=encodeURIComponent("__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx)),i=t.voiceInfo;t.voiceOpt={protocol:2===a.format?"hls":"",src:n("https://mp.weixin.qq.com/mp/msgvoice?action=get_voice&mediaid=".concat(a.mediaid,"&devicetype=").concat(window.devicetype,"&_type=").concat(t.type,"&speed=").concat(t.speed,"&encodeurl=").concat(e)),lowbandUrl:n("https://mp.weixin.qq.com/mp/msgvoice?action=get_voice&mediaid=".concat(a.mediaid,"&devicetype=").concat(window.devicetype,"&_type=").concat(t.type,"&speed=").concat(t.speed,"&encodeurl=").concat(e)),title:i.title,epname:"Source Article",singer:i.nickname?"".concat(i.nickname,"的语音"):"Official Account audio",srcId:t.srcId+t.tag+t.mediaId,coverImgUrl:"",webUrl:i.appmsgUrl,musicbar_url:"https://mp.weixin.qq.com/mp/msgvoice?action=ttspage&__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&sn=").concat(window.sn,"&type=").concat(t.type,"#wechat_redirect"),needStartMusicUI:0},o()}else setTimeout(i,1e3);else console.log("getvoiceinfo err",a),setTimeout(i,e)},error:t=>{console.log("getvoiceinfo err",t),setTimeout(i,e)}})},o=()=>{t.player=qe.init({protocal:"hls",wxIndex:t.voiceOpt.srcId,type:7,comment_id:"",src:t.voiceOpt.src,jsapi2Src:t.voiceOpt.src+"&voice_type=1",allowPause:!0,duration:t.voiceInfo.duration,title:t.voiceOpt.title,singer:t.voiceOpt.singer,epname:t.voiceOpt.epname,coverImgUrl:t.voiceOpt.coverImgUrl,playingCss:"share_audio_playing",playCssDom:e.getElementsByClassName("js_read_main")[0],playArea:e.getElementsByClassName("js_read_play")[0],progress:e.getElementsByClassName("js_read_progress")[0],fileSize:0,playtimeDom:e.getElementsByClassName("js_read_playtime")[0],bufferDom:e.getElementsByClassName("js_read_buffer")[0],playdotDom:e.getElementsByClassName("js_read_playdot")[0],seekRange:e.getElementsByClassName("js_read_seekRange")[0],seekContainer:e.getElementsByClassName("js_read_main")[0],loadingDom:e.getElementsByClassName("js_read_loading")[0],detailArea:"",detailUrl:t.voiceOpt.musicbar_url,webUrl:t.voiceOpt.musicbar_url})};pe({url:"/mp/msgvoice?action=ttspage&__biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx,"&sn=").concat(window.sn,"&type=").concat(t.type,"&f=json"),type:"GET",dataType:"json",async:!0,success:n=>{n&&n.base_resp&&0===n.base_resp.ret?(t.voiceInfo={title:n.title,nickname:n.nickname,appmsgUrl:n.appmsg_url,duration:1*n.voice_info.duration},i(),e.getElementsByClassName("js_read_duration")[0].innerHTML=(e=>{const t=e=>e>=10?e:"0".concat(e);return"".concat(t(Math.floor(e/60)),":").concat(t(e%60))})(1*n.voice_info.duration)):window.weui.alert("System busy. Try again later.")},error:e=>{console.log("ttspage err: ",e),window.weui.alert("网络不可用，请检查网络设置")}})}const Ga=!ke.isWechat||ke.isWindowsWechat||ke.isMacWechat||ke.isNewMpApp,Ya=ke.isAndroid&&window.clientversion<"28002A00"||ke.isIOS&&window.clientversion<"18002824",Xa=ke.isAndroid&&window.clientversion<"28002800"||ke.isIOS&&window.clientversion<"18002831",Qa=e=>e?qe.encodeStr(e).replace(/^\s/,"").replace(/\s$/,""):"";class Za{constructor(){this.validTagLen=0,this.adapter={1:We,2:ze},this.tagMap={qqmusic:{eles:[],isClMusic:!1,watchAttrs:[],renderTag:"mp-common-qqmusic"},"mp-common-qqmusic":{eles:[],isClMusic:!1,watchAttrs:["musicid"],renderTag:"mp-common-qqmusic"},"mp-common-clmusic":{eles:[],isClMusic:!0,type2Wording:{1:"Music",2:"专辑",3:"歌单"},renderTag:"mp-common-clmusic",watchAttrs:["listenid","categoryid"]}},this.tagNameList=Object.keys(this.tagMap),this.validateEnv()&&(this.renderTag(),console.log("➜ music tag",this.tagMap),this.renderCard())}validateEnv(){try{const e=document.querySelector("#js_content");return this.tagNameList.forEach((t=>{this.tagMap[t].eles=Array.from(e.querySelectorAll(t))})),this.validTagLen=this.tagNameList.reduce(((e,t)=>e+this.tagMap[t].eles.length),0),!!this.validTagLen}catch(e){return console.error("validateEnv err",e),!1}}renderTag(){this.tagNameList.forEach((e=>{const t=this.tagMap[e],{renderTag:n,eles:i}=t;i.forEach(((t,o)=>{if(n!==e){const e=((e,t)=>{const n=document.createElement(t);for(const i of e.attributes)n.setAttribute(i.name,i.value);return n.innerHTML=e.innerHTML,e.parentNode.replaceChild(n,e),n})(t,n);this.tagMap[n].eles.push(e),i.splice(o,1,null)}})),t.eles=i.filter((e=>e))}))}renderCard(){this.batchGetClMusicInfo().then((()=>{this.tagNameList.forEach((e=>{const t=this.tagMap[e],{eles:n,watchAttrs:i,isClMusic:o}=t;n.forEach(((e,t)=>{be.addClass(e,"js_wx_tap_highlight");let n={isClMusic:o,posIndex:t,media_id:Qa(e.getAttribute("mid"))||"",singer:Qa(e.getAttribute("singer"))||"",albumid:Qa(e.getAttribute("albumid"))||"",otherid:Qa(e.getAttribute("otherid"))||"",musicid:Qa(e.getAttribute("musicid"))||"",albumurl:Qa(e.getAttribute("albumurl"))||"",audiourl:Qa(e.getAttribute("audiourl"))||"",listenId:Qa(e.getAttribute("listenid"))||"",clMusicType:parseInt(e.getAttribute("type"))||"",musictype:parseInt(e.getAttribute("musictype"))||1,music_name:Qa(e.getAttribute("music_name"))||"",jumpurlkey:Qa(e.getAttribute("jumpurlkey"))||"",categoryId:Qa(e.getAttribute("categoryid"))||"",duration:parseInt(e.getAttribute(o?"duration":"play_length")||0,10)};if(n.musictype>2&&(n.musictype=2),!n.singer){const t=e.getAttribute("src")||"",i=decodeURIComponent(_e.getQuery("singer",t)||"");n.singer=Qa(i)||""}o?(n.type=11,n.pauseCss="",n.allowPause=!1):this.adapter[n.musictype]&&"function"==typeof this.adapter[n.musictype].initData&&(n=this.adapter[n.musictype].initData(n,{scene:0}),e.setAttribute("albumurl",n.albumurl)),e.setAttribute("posindex",t),this.reRenderCard(e,i),o&&!e.isErrStatus?1!==n.clMusicType||Ya||Ga?this.bindEvent(e,n):this.renderPlayer(e,n):o||this.renderPlayer(e,n)}))}))}))}reRenderCard(e,t=[]){e&&t.forEach((t=>{const n=e.getAttribute(t);n&&(e.removeAttribute(t),e.setAttribute(t,n))}))}renderPlayer(e,t){setTimeout((()=>{fe.log("[Music] init "+t.detailUrl);const n="".concat(t.musicid||t.listenId,"_").concat(t.posIndex);var i;t.player=qe.init({epname:"Music",mid:t.media_id,singer:t.singer,songId:t.musicid,type:t.type||0,otherid:t.otherid,albumid:t.albumid,wxIndex:t.posIndex,duration:t.duration,listenId:t.listenId,webUrl:t.webUrl||"",isClMusic:t.isClMusic,coverImgUrl:t.albumurl,jumpurlkey:t.jumpurlkey,playingCss:"share_audio_playing",pauseCss:t.pauseCss||"",allowPause:!!t.allowPause,title:(i=t.music_name,i?qe.decodeStr(i):""),detailUrl:t.detailUrl||"",playArea:e.shadowRoot.querySelector("#music_play_".concat(n)),playCssDom:e.shadowRoot.querySelector("#music_main_".concat(n)),detailArea:e.shadowRoot.querySelector("#music_home_".concat(n))})}),0)}bindEvent(e,t){setTimeout((()=>{const n=t.clMusicType,i="".concat(t.listenId||t.categoryId,"_").concat(t.posIndex),o=e.shadowRoot.querySelector("#music_main_".concat(i)),a=e.shadowRoot.querySelector("#music_play_".concat(i));o&&De.on(o,"click",(()=>{if(Ga)(window.weui||window).alert("请在手机微信内操作");else if(1===n&&Ya||(2===n||3===n)&&Xa)xe.invoke("confirmDialog",{title:"当前版本暂不支持，请更新至微信最新版本",confirmText:"Update Now",cancelText:"Cancel"},(e=>{-1!==e.err_msg.indexOf(":ok")?location.href=ke.isIOS?"https://itunes.apple.com/cn/app/id414478124?mt=8&ls=1":"https://support.weixin.qq.com/update/":-1!==e.err_msg.indexOf("system:")&&(window.weui||window).alert("当前版本暂不支持，请更新至微信最新版本")}));else{const t=Qa(e.getAttribute("categoryid"))||"";xe.invoke("openTingView",{action:"openCategory",category_id:t,sync_get:!0},(e=>{console.log("["+t+"], res: "+JSON.stringify(e))}))}})),a&&(De.on(a,"mousedown",(e=>e.stopPropagation())),De.on(a,"touchstart",(e=>e.stopPropagation())))}),0)}batchGetClMusicInfo(){return new Promise(((e,t)=>{const n=this.tagMap["mp-common-clmusic"],i=n.eles;if(!i.length)return void e();const o=this,a={count:i.length};i.forEach(((e,t)=>{const n=1*e.getAttribute("type");a["type".concat(t)]=n,a["source".concat(t)]=1*e.getAttribute("music_source"),a["username".concat(t)]=e.getAttribute("username")||"",a["id".concat(t)]=e.getAttribute(1===n?"listenid":"categoryid")||""})),pe({url:"/mp/finder_music_appmsg?action=get",type:"POST",async:!0,dataType:"json",data:a,success(t){var a;if(0===(null==(a=null==t?void 0:t.base_resp)?void 0:a.ret)){const e=t.music_info_list||[];i.forEach((t=>{const i=1*t.getAttribute("type"),a=t.getAttribute(1===i?"listenid":"categoryid")||"",r=e.find((e=>e.id===a));if(r){const{flag:e}=r;switch(1*e!=0&&(t.isErrStatus=!0),1*e){case 0:o.updateClMusicCardInfo(t,r),t.setAttribute("verify_err","");break;case 1:t.setAttribute("verify_err","".concat(n.type2Wording[i],"暂时无法播放"));break;case 2:t.setAttribute("verify_err","".concat(n.type2Wording[i],"已被作者删除"));break;case 3:t.setAttribute("verify_err","".concat(n.type2Wording[i],"已被设置为私密"));break;case 4:t.setAttribute("verify_err","因作者隐私设置，暂时无法查看该内容")}}}))}e()},error:e})}))}updateClMusicCardInfo(e,t){const{type:n}=t,i=t.user_info||{};let o={};switch(1*n){case 1:o=t.music;break;case 2:o=t.album;break;case 3:o=t.playlist}e.setAttribute("count",o.item_num||0);try{const t=new URL(e.getAttribute("albumurl")||""),n=new URLSearchParams(t.search);n.delete("picformat");const i=new URL(o.cover||"");"".concat(t.origin).concat(t.pathname,"?").concat(n.toString())!=="".concat(i.origin).concat(i.pathname).concat(i.search)&&e.setAttribute("albumurl",o.cover||"")}catch(a){console.error(a)}e.setAttribute("singer",i.nickname||o.author||""),e.setAttribute("duration",o.duration||""),e.setAttribute("avatar",i.headimg_url||""),e.setAttribute("music_name",o.name||o.title||"")}}const er=293511,tr=({listenId:e,onSuccess:t,onError:n,onComplete:i})=>{ue.setSum(er,11,1),pe({url:"/mp/listenplayer?action=add_to_playlist&__biz=".concat(window.biz,"&appmsgid=").concat(window.mid,"&idx=").concat(window.idx),type:"POST",dataType:"json",async:!0,data:{data:JSON.stringify({listen_id:e})},success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof t&&t(e):("function"==typeof n&&n(),ue.setSum(er,14,1))},error:()=>{"function"==typeof n&&n(),ue.setSum(er,14,1)},complete:()=>{"function"==typeof i&&i()}})},nr=({listenId:e,onSuccess:t,onError:n,onComplete:i})=>{ue.setSum(er,39,1),pe({url:"/mp/listenplayer?action=rm_from_playlist&__biz=".concat(window.biz,"&appmsgid=").concat(window.mid,"&idx=").concat(window.idx),type:"POST",dataType:"json",async:!0,data:{data:JSON.stringify({listen_id:e})},success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof t&&t():("function"==typeof n&&n(e),ue.setSum(er,40,1))},error:()=>{"function"==typeof n&&n(),ue.setSum(er,39,1)},complete:()=>{"function"==typeof i&&i()}})},ir=ke.isWechat&&!ke.isWindowsWechat&&!ke.isMacWechat&&!ke.isNewMpApp,or={getTingIsOpenPromise:null,getListenLaterIsOpenPromise:null,musicLen:0,musicList:{},isTingOpen:-1,isSupportListenLater:ir?1:0,srcRoot:"".concat(location.protocol,"//res.wx.qq.com/voice/getvoice?mediaid=#meidaid#"),inWechat:ir,channelsInfo:[]};function ar(e){return document.getElementById(e)}function rr(e,t){let n=0;for(let i=0;i<or.musicLen;i++){const o=or._oElements[i],a={};let r=o.getAttribute("voice_encode_fileid")||"";try{r=decodeURIComponent(r)}catch(su){}if(t&&(a.audioPanelVue=t),a.voiceid=qe.encodeStr(r)||o.getAttribute("listen_id"),a.voiceid=a.voiceid.replace(/&#61;/g,"=").replace(/^\s/,"").replace(/\s$/,""),a.isaac=1*o.getAttribute("isaac2")||0,a.src=or.srcRoot.replace("#meidaid#",a.voiceid),a.hasAddedListenLater=0,o.setAttribute("has-added-listen-later",0),1===a.isaac&&(a.jsapi2Src=a.src+"&voice_type=1"),a.voiceid&&"undefined"!=a.voiceid){if(a.albumLink="",e&&e.length>0&&e.forEach((e=>{if(e.voice_id===r)return e.appmsgalbuminfo&&(a.albumTitle=e.appmsgalbuminfo.title||"",a.albumLink=e.appmsgalbuminfo.link.html(!1).replace("#wechat_redirect","")+"#wechat_redirect",a.albumNum=e.appmsgalbuminfo.tag_content_num||0,a.albumid=e.appmsgalbuminfo.album_id||0),!1})),o.setAttribute("data-verify_state",3),o.setAttribute("data-trans_state",1),cr(o,a,n),"undefined"!=typeof voiceid&&r&&window.voiceid&&r===window.voiceid){const e=o.offsetTop+122-40;setTimeout((()=>{window.scrollTo(0,e)}),0)}n++}}(function(){const e=[...ar("js_content").getElementsByTagName("mp-common-claudio")];return new Promise((t=>{if(!e.length)return void t(e);const n={video_snap_num:e.length};e.forEach(((e,t)=>{n["exportid_".concat(t)]=e.dataset.id,n["username_".concat(t)]=e.dataset.username,n["listen_id".concat(t)]=e.getAttribute("listen_id")})),pe({url:"/mp/appmsg_video_snap?action=batch_get_video_snap",type:"POST",dataType:"json",async:!0,data:n,success(n){n&&n.base_resp&&0===n.base_resp.ret&&(or.channelsInfo=n.video_snap_info),t(e)},error(){t(e)}})}))})().then((e=>{or.channelsInfo.length&&e.forEach((e=>{const{flag:t,added_in_playlist:n}=or.channelsInfo.find((t=>t.export_id===e.dataset.id));switch(e.setAttribute("has-added-listen-later",n),t){case 1:e.setAttribute("err_tips","当前音频已被作者删除");break;case 2:case 4:e.setAttribute("err_tips","当前音频暂时无法播放");break;case 3:e.setAttribute("err_tips","当前音频已被设置私密")}}))}))}function sr(e,t){e.setAttribute("play_length",t.play_length||1),e.setAttribute("data-verify_state",void 0===t.voice_verify_state?3:t.voice_verify_state),e.setAttribute("data-trans_state",void 0===t.voice_trans_state?1:t.voice_trans_state)}function cr(e,t,n){t.duration=parseInt((1*e.getAttribute("play_length")||0)/1e3,10),t.posIndex=n;let i=e.getAttribute("name")||"";try{i=decodeURIComponent(i)}catch(su){}if(t.title=qe.encodeStr(i).replace(/^\s/,"").replace(/\s$/,""),t.fileSize=1*e.getAttribute("high_size")||0,t.cover=(e.getAttribute("cover")||"").html(!1),t.nickname=window.nickname,t.voiceTag="v",be.addClass(e,"js_wx_tap_highlight"),or.getTingIsOpenPromise.then((()=>{!function(e,t){if(t.isShowListenLater=1===or.isSupportListenLater&&!window.is_pay_subscribe&&!window.tts_is_ban,e.setAttribute("show-listen-later",t.isShowListenLater?1:0),t.playArea=e.shadowRoot.querySelector(".js_voice_play"),t.progress=e.shadowRoot.querySelector(".js_audio_card_progress_inner"),t.bufferDom=e.shadowRoot.querySelector(".js_audio_card_progress_buffer"),t.loadingDom=e.shadowRoot.querySelector(".js_audio_card_progress_loading"),t.playdotDom=e.shadowRoot.querySelector(".js_audio_card_progress_handle"),t.seekRange=e.shadowRoot.querySelector(".js_audio_card_progress_wrp"),t.audioProgressBarDom=e.shadowRoot.querySelector(".js_audio_progress_bar"),t.playpercent=e.shadowRoot.querySelector(".js_voice_percent"),t.playpercentDesc=e.shadowRoot.querySelector(".js_voice_percent_desc"),t.listenLaterDom=e.shadowRoot.querySelector(".js_audio_listen_later"),t.albumDom=e.shadowRoot.querySelector(".js_voice_album"),t.playtimeDom=e.shadowRoot.querySelector(".js_duration"),"MP-COMMON-CLAUDIO"===e.tagName&&!function(e){const t=e=>e.stopPropagation();if(!ke.isWechat||ke.isWindowsWechat||ke.isMacWechat||ke.isNewMpApp)return De.on(e.detailArea,"click",(()=>{(window.weui||window).alert("请在手机微信内操作")})),e.listenLaterDom&&De.on(e.listenLaterDom,"touchstart",t),e.listenLaterDom&&De.on(e.listenLaterDom,"mousedown",t),De.on(e.playArea,"touchstart",t),De.on(e.playArea,"mousedown",t),!1;if(ke.isAndroid&&window.clientversion<"28002655"||ke.isIOS&&window.clientversion<"18002725"){const n=()=>{xe.invoke("confirmDialog",{title:"当前版本暂不支持，请更新至微信最新版本",confirmText:"Update Now",cancelText:"Cancel"},(e=>{-1!==e.err_msg.indexOf(":ok")?location.href=ke.isIOS?"https://itunes.apple.com/cn/app/id414478124?mt=8&ls=1":"https://support.weixin.qq.com/update/":-1!==e.err_msg.indexOf("system:")&&(window.weui||window).alert("当前版本暂不支持，请更新至微信最新版本")}))};return De.on(e.detailArea,"click",n),e.listenLaterDom&&De.on(e.listenLaterDom,"touchstart",t),e.listenLaterDom&&De.on(e.listenLaterDom,"mousedown",t),De.on(e.playArea,"touchstart",t),De.on(e.playArea,"mousedown",t),!1}return!0}(t))return void(e.style.opacity=1);(function(e,t){const n=e.voiceid+"_"+e.posIndex;let i="";if(window.voice_in_appmsg&&window.voice_in_appmsg[e.voiceid]){const t=window.voice_in_appmsg[e.voiceid];let n=window.biz||"",o=window.mid||"",a=window.idx||"";t.bizuin&&t.appmsgid&&t.idx&&(n=t.bizuin,o=t.appmsgid,a=t.idx);i=(window.location.protocol||"https:")+"//mp.weixin.qq.com/mp/audio?_wxindex_=#_wxindex_#&scene=104&__biz=#biz#&mid=#mid#&idx=#idx#&voice_id=#voice_id#&sn=#sn##wechat_redirect".replace("#_wxindex_#",e.posIndex).replace("#biz#",n).replace("#mid#",o).replace("#idx#",a).replace("#voice_id#",e.voiceid).replace("#sn#",t.sn||"")}fe.log("[Voice] init"+i);const o=qe.decodeStr(e.title);e.player=qe.init({wxIndex:e.posIndex,type:2,songId:e.voiceid,comment_id:"",src:e.src,jsapi2Src:e.jsapi2Src,allowPause:!0,duration:e.duration,title:o,singer:window.nickname?window.nickname+"'s audio":"Official Account audio",epname:"Source Article",coverImgUrl:window.__appmsgCgiData.hd_head_img,playingCss:"share_audio_playing",pauseCss:"share_audio_pause",playCssDom:e.detailArea||ar("voice_main_"+n),playArea:e.playArea||ar("voice_play_"+n),progress:e.progress||ar("voice_progress_"+n),fileSize:e.fileSize,playtimeDom:e.playtimeDom||ar("voice_playtime_"+n),bufferDom:e.bufferDom||ar("voice_buffer_"+n),playdotDom:e.playdotDom||ar("voice_playdot_"+n),playpercent:e.playpercent||ar("voice_percent_"+n),playpercentDesc:e.playpercentDesc||ar("voice_percent_desc_"+n),seekRange:e.seekRange||ar("voice_seekRange_"+n),seekContainer:e.detailArea||ar("voice_main_"+n),loadingDom:e.loadingDom||ar("voice_loading_"+n),detailArea:e.detailArea||ar("voice_main_"+n)||"",albumDom:e.albumDom||ar("voice_album_"+n),detailUrl:i,webUrl:window.msg_link,speedList:[.75,1,1.25,1.5,2],audioCardBody:ar("audio_card_bd_".concat(n)),ctrlArea:ar("audio_card_control_".concat(n)),fastBackBtn:ar("audio_fast_back_".concat(n)),fastForwardBtn:ar("audio_fast_forward_".concat(n)),doubleSpeedBtn:ar("audio_double_speed_".concat(n)),isAudio:!0,isClAudio:"MP-COMMON-CLAUDIO"===t.tagName,userName:window.user_name||"",articleCoverCdnUrl1_1:window.cdn_url_1_1,tingExtInfo:{bizuin:window.biz&&1*window.atob(window.biz)||0,appmsgid:1*window.mid||0,idx:1*window.idx||0,audio_id:e.voiceid||"",is_album_page:!1},albumInfo:{albumId:e.albumid||"",albumName:e.albumTitle||"",albumUrl:e.albumLink||""},finderInfo:e.finderInfo||{},cover:e.cover||"",author:e.author||"",listenId:e.listenId||"",isTingOpen:or.isTingOpen,isSupportListenLater:or.isSupportListenLater,hasAddedListenLater:e.hasAddedListenLater||0,audioDurationDom:ar("audio_duration_".concat(n)),listenLaterDom:e.listenLaterDom||ar("audio_listen_later_".concat(n)),useNewListenLaterCgi:!!e.audioPanelVue,audioRealTimeDom:ar("audio_real_playtime_".concat(n)),audioProgressBarDom:e.audioProgressBarDom||ar("audio_progress_bar_".concat(n)),listBase64:e.listBase64||"",detailAreaClickHook:()=>{const n=e.audioPanelVue;return!(!n||!e.listenId)&&(n.playingListenId===e.listenId&&n.isPlaying?n.show(!1):function(e,t,n=!1){var i;const o=e.audioPanelVue;if(null==(i=null==o?void 0:o.show)||i.call(o,!0),lr(e,t,1),tr({listenId:e.listenId||"",onSuccess:()=>{var t;return null==(t=null==o?void 0:o.getListData)?void 0:t.call(o,!0,(t=>{if(o.notifyAppListChange(),n&&!o.supportDynamicPlayList){const n=t.find((t=>t.listen_id===e.listenId));n&&(o.selectInfo=n.listen_item,o.play(n.listen_item,!1))}}))}}),n&&(null==o?void 0:o.supportDynamicPlayList)){const n=function(e,t){return{listen_id:e.listenId,title:qe.decodeStr(e.title||"")||"",author:e.author||"",duration:e.duration,cover:e.cover||"",type:"MP-COMMON-CLAUDIO"===t.tagName?4:3,...e.finderInfo?{finder_info:e.finderInfo}:{},author_info:{nickname:e.author||"",type:"MP-COMMON-CLAUDIO"===t.tagName?4:3,username:window.user_name||""},article_info:{audio_id:e.voiceid||"",audio_title:qe.decodeStr(e.title||"")||"",audio_url:e.src,author:e.author||"",biz_username:window.user_name||"",cover:e.cover||"",duration:e.duration,url:window.msg_link}}}(e,t);o.selectInfo=n,o.play(n,!1)}}(e,t,!0),!0)},onListenLaterStart:()=>{const n=e.audioPanelVue;if(lr(e,t,1),n){const e=Date.now();xe.invoke("showBottomToast",{id:"".concat(e),title:"已加入「稍后听」",iconData:"iVBORw0KGgoAAAANSUhEUgAAAEgAAABICAMAAABiM0N1AAAAVFBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////8wXzyWAAAAHHRSTlMAAwQKDQ8SFx0fIC4zaGttfoeTl5inrrGzzNfmamG/UwAAAAFiS0dEAf8CLd4AAADCSURBVFjD7dfbDoJADATQonhFFPEK8///6YOgoIvabaMxmXnenDRL2ywiDMMwP0xeODlA4eS4SDngIq2vDqqpSz2olnTo0Pl/Z7VNPtkbi3dOVmM/cqgnq4FhSekMSop7PjRHy8R0PyLpuTkcqEn33Yclbf+Mj2FJ34dhKaafQ1LcXDxLsfP1KMXPaV+yzHtXsu2NWz+VG0U/v6zJvMf6kmUfdiXbXr1L1v3cSlanleyOSLoDTnOXZ/Rkxl8ShmG+lwsknDDzI+DkEwAAAABJRU5ErkJggg==",subtitle:n?"Details":"",needArrow:!!n,clickable:!!n}),n&&xe.on("onClickBottomToast",(()=>{var e;return null==(e=null==n?void 0:n.show)?void 0:e.call(n,!0)}))}},onListenLaterError:()=>{lr(e,t,0)},onCancelListenLaterStart:()=>{lr(e,t,0)},onCancelListenLaterError:()=>{lr(e,t,1)},onPlaySuccess:()=>{const n=e.audioPanelVue;e.listenId&&n&&tr({listenId:e.listenId||"",onSuccess:()=>lr(e,t,1)})}})})(t,e),e.style.opacity=1}(e,t)})),or.getListenLaterIsOpenPromise.then((()=>{const t=1===or.isSupportListenLater&&!window.is_pay_subscribe&&!window.tts_is_ban;e.setAttribute("show-listen-later",t?1:0)})),"MP-COMMON-CLAUDIO"===e.tagName)return(t={posIndex:n,voiceTag:"v"}).type=4,t.listenId=e.getAttribute("listen_id"),t.duration=1*e.getAttribute("duration"),t.cover=e.getAttribute("cover").html(!1),t.title=e.getAttribute("name"),t.author=e.getAttribute("author"),t.finderInfo={nonceId:e.getAttribute("data-nonceid"),tid:e.getAttribute("data-tid")},t.hasAddedListenLater=e.getAttribute("has-added-listen-later"),e.setAttribute("cover",t.cover),t.detailArea=e.shadowRoot.querySelector(".js_wx_claudio_card"),or.musicList[t.listenId+"_"+t.posIndex]=t,window.musicList[t.listenId+"_"+t.posIndex]=t,void be.addClass(e,"mp_common_channel");if(1===window.is_temp_url&&window.voice_in_appmsg[t.voiceid]){const{transState:n,voiceVerifyState:i}=window.voice_in_appmsg[t.voiceid];e.removeAttribute("err_tips"),e.setAttribute("data-verify_state",void 0===i?3:i),e.setAttribute("data-trans_state",void 0===n?1:n),qe.rollStatus(t.voiceid,(t=>{sr(e,t)}))}else qe.getVoiceStatus(t.voiceid).then((n=>{var i,o,a,r;n&&(e.removeAttribute("err_tips"),n.play_length&&parseInt((1*n.play_length||0)/1e3,10)!==1*e.getAttribute("play_length")&&(t.duration=parseInt((1*n.play_length||0)/1e3,10),t.listenId=n.listen_id||0,e.setAttribute("listen_id",n.listen_id||0),t.hasAddedListenLater=n.added_in_playlist||0,e.setAttribute("has-added-listen-later",n.added_in_playlist||0),t.player&&t.player._o&&(t.player._o.duration=t.duration,null==(o=null==(i=t.player.player)?void 0:i.setDuration)||o.call(i,t.duration),t.player._o.hasAddedListenLater=t.hasAddedListenLater,t.player._o.listenId=t.listenId,null==(r=null==(a=t.player.player)?void 0:a.setListenId)||r.call(a,t.listenId),setTimeout((()=>{var e;t.player.playtimeDomInnerHtml=(null==(e=t.player._o.playtimeDom)?void 0:e.innerHTML)||""})))),sr(e,n))}));t.detailArea=e.shadowRoot.querySelector(".js_wx_mpaudio_card"),or.musicList[t.voiceid+"_"+t.posIndex]=t,window.musicList[t.voiceid+"_"+t.posIndex]=t,be.addClass(e,"mp_common_audio")}function lr(e,t,n){e.hasAddedListenLater=n,t.setAttribute("has-added-listen-later",n),e.player&&(e.player._o.hasAddedListenLater=n),e.audioPanelVue&&(e.audioPanelVue.needUpdate=!0)}function dr(e,t){if(function(){const e=ar("js_content");return!(!e||(or._oElements=[...e.getElementsByTagName("mp-common-mpaudio"),...e.getElementsByTagName("mp-common-claudio")],or._oElements.length<=0))}())try{or.getTingIsOpenPromise=new Promise((e=>{or.inWechat?xe.invoke("getTingAudioState",{},(t=>{/:ok$/.test(t.err_msg)?or.isTingOpen=1:-9999!==t.err_code&&-1===t.err_msg.indexOf("function_not_exist")||(or.isTingOpen=0),e()})):e()})),or.getListenLaterIsOpenPromise=new Promise((e=>{let t=null;t=setTimeout((()=>{or.isSupportListenLater=0,e()}),3e3),or.inWechat?xe.invoke("handleMPPageAction",{action:"isSupportAddToTingPlayList"},(n=>{t&&clearTimeout(t),/:ok$/.test(n.err_msg)?or.isSupportListenLater=1:or.isSupportListenLater=0,e()})):e()})),or.musicLen=or._oElements.length,rr(e,t)}catch(n){console.error(n)}}window.musicList={};const ur='\x3c!-- 发表留言 --\x3e\n<#if(window.new_appmsg){#>\n  <div id="js_cmt_mine" class="discuss_container_wrp" style="display:none;">\n    <div class="discuss_container editing access">\n        <div class="discuss_container_inner">\n          <div class="discuss_container_hd">\n            <h2 class="rich_media_title">\n                <#if(window.item_show_type == 10){#>\n                    <#=textPageTitle#>\n                <#}else{#>\n                    <#=window.msg_title.html(1)#>\n                <#}#>\n            </h2>\x3c!-- 标题要转义 --\x3e\n            <span id="log"></span>\n            <div class="frm_textarea_box_wrp">\n                <span class="frm_textarea_box">\n                    <#if(window.friend_comment_enabled == 1){#>\n                    \x3c!-- <textarea id="js_cmt_input" class="frm_textarea" placeholder="Comments are visible to your friends and can be seen by everyone after being approved by the Official Account."></textarea> --\x3e\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="Comments will be visible to everyone after being approved by the Official Account."></textarea>\n                    <#}else{#>\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="Comments will be visible to everyone after being approved by the Official Account."></textarea>\n                    <#}#>\n                    <div class="emotion_tool">\n                        <span class="emotion_switch" style="display:none;"></span>\n                        <span id="js_emotion_switch" class="pic_emotion_switch_wrp">\n                            <img class="pic_default" src="<#=window.icon_emotion_switch#>" alt="">\n                            <img class="pic_active" src="<#=window.icon_emotion_switch_active#>" alt="">\n                            <img class="pic_default_primary" src="<#=window.icon_emotion_switch_primary#>" alt="">\n                            <img class="pic_active_primary" src="<#=window.icon_emotion_switch_active_primary#>" alt="">\n                        </span>\n                    </div>\n                </span>\n            </div>\n            <div class="emotion_panel" id="js_emotion_panel">\n                <span class="emotion_panel_arrow_wrp" id="js_emotion_panel_arrow_wrp">\n                    <i class="emotion_panel_arrow arrow_out"></i>\n                    <i class="emotion_panel_arrow arrow_in"></i>\n                </span>\n                <div class="emotion_list_wrp" id="js_slide_wrapper">\n                    \x3c!--<ul class="emotion_list"></ul>--\x3e\n                    \x3c!--<li class="emotion_item"><i class="icon_emotion"></i></li>--\x3e\n                </div>\n                <ul class="emotion_navs" id="js_navbar">\n                    \x3c!--<li class="emotion_nav"></li>--\x3e\n                </ul>\n            </div>\n            <div class="discuss_btn_wrp"><a id="js_cmt_submit" class="btn btn_primary btn_discuss btn_disabled" href="##">Comment</a></div>\n          </div>\n          <div class="discuss_container_bd">\n            <div class="" style="display:none">\n                <div class="mod_title_context">\n                    <strong class="mod_title">My Comments</strong>\n                </div>\n                <ul class="discuss_list" id="js_cmt_mylist"></ul>\n            </div>\n            <div class="weui-loadmore" id="js_mycmt_loading">\n                <i class="weui-loading"></i>\n                <span class="weui-loadmore__tips">Loading...</span>\n            </div>\n            <div id="js_cmt_toast" style="display: none;">\n                <div class="weui-mask_transparent"></div>\n                <div class="weui-toast">\n                    <i class="weui-icon-success-no-circle weui-icon_toast"></i>\n                    <p class="weui-toast__content">Commented</p>\n                </div>\n            </div>\n            <div class="weui-dialog__wrp weui-transition_opacity-hide" id="js_delete_panel_mobile">\n                <div class="weui-mask"></div>\n                <div class="weui-dialog">\n                    <div class="weui-dialog__bd">Delete this comment?</div>\n                    <div class="weui-dialog__ft">\n                    <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_default" id="js_delete_cancel_mobile">Cancel</a>\n                    <a href="javascript:;" class="weui-dialog__btn weui-dialog__btn_primary" id="js_delete_confirm_mobile">Delete</a>\n                    </div>\n                </div>\n            </div>\n          </div>\n        </div>\n    </div>\n  </div>\n<#}else{#>\n    <div id="js_cmt_mine" class="discuss_container editing access" style="display:none;">\n        <div class="discuss_container_inner">\n            <h2 class="rich_media_title"><#=window.msg_title.html(1)#></h2>\x3c!-- 标题要转义 --\x3e\n            <span id="log"></span>\n            <div class="frm_textarea_box_wrp">\n                <span class="frm_textarea_box">\n                    <#if(window.friend_comment_enabled == 1){#>\n                    \x3c!-- <textarea id="js_cmt_input" class="frm_textarea" placeholder="Comments are visible to your friends and can be seen by everyone after being approved by the Official Account."></textarea> --\x3e\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="Comments will be visible to everyone after being approved by the Official Account."></textarea>\n                    <#}else{#>\n                    <textarea id="js_cmt_input" class="frm_textarea" placeholder="Comments will be visible to everyone after being approved by the Official Account."></textarea>\n                    <#}#>\n                    <div class="emotion_tool">\n                        <span class="emotion_switch" style="display:none;"></span>\n                        <span id="js_emotion_switch" class="pic_emotion_switch_wrp">\n                            <img class="pic_default" src="<#=window.icon_emotion_switch#>" alt="">\n                            <img class="pic_active" src="<#=window.icon_emotion_switch_active#>" alt="">\n                        </span>\n                        <div class="emotion_panel" id="js_emotion_panel">\n                            <span class="emotion_panel_arrow_wrp" id="js_emotion_panel_arrow_wrp">\n                                <i class="emotion_panel_arrow arrow_out"></i>\n                                <i class="emotion_panel_arrow arrow_in"></i>\n                            </span>\n                            <div class="emotion_list_wrp" id="js_slide_wrapper">\n                                \x3c!--<ul class="emotion_list"></ul>--\x3e\n                                \x3c!--<li class="emotion_item"><i class="icon_emotion"></i></li>--\x3e\n                            </div>\n                            <ul class="emotion_navs" id="js_navbar">\n                                \x3c!--<li class="emotion_nav"></li>--\x3e\n                            </ul>\n                        </div>\n                    </div>\n                </span>\n            </div>\n            <div class="discuss_btn_wrp"><a id="js_cmt_submit" class="btn btn_primary btn_discuss btn_disabled" href="##">Comment</a></div>\n            <div class="discuss_list_wrp" style="display:none">\n                <div class="rich_tips with_line title_tips discuss_title_line">\n                    <span class="tips">My Comments</span>\n                </div>\n                <ul class="discuss_list" id="js_cmt_mylist"></ul>\n            </div>\n            <div class="rich_tips tips_global loading_tips" id="js_mycmt_loading">\n                <img src="<#=window.icon_loading_white#>" class="rich_icon icon_loading_white" alt="">\n                <span class="tips">Loading...</span>\n            </div>\n            <div class="wx_poptips" id="js_cmt_toast" style="display:none;">\n                <img alt="" class="icon_toast" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGoAAABqCAYAAABUIcSXAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3NpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyMTUxMzkxZS1jYWVhLTRmZTMtYTY2NS0xNTRkNDJiOGQyMWIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTA3QzM2RTg3N0UwMTFFNEIzQURGMTQzNzQzMDAxQTUiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTA3QzM2RTc3N0UwMTFFNEIzQURGMTQzNzQzMDAxQTUiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NWMyOGVjZTMtNzllZS00ODlhLWIxZTYtYzNmM2RjNzg2YjI2IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjIxNTEzOTFlLWNhZWEtNGZlMy1hNjY1LTE1NGQ0MmI4ZDIxYiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pmvxj1gAAAVrSURBVHja7J15rF1TFMbXk74q1ZKHGlMkJVIhIgg1FH+YEpEQJCKmGBpThRoSs5jVVNrSQUvEEENIhGiiNf9BiERICCFIRbUiDa2qvudbOetF3Tzv7XWGffa55/uS7593977n3vO7e5+199p7v56BgQGh0tcmvAUERREUQVEERREUQVEERREUQVEERREUQVEERREUQVEERREUQVEERVAUQVEERVAUQbVYk+HdvZVG8b5F0xj4RvhouB+eCy8KrdzDJc1RtAX8ILxvx98V1GyCSkN98Cx4z/95/Wn4fj6j6tUEeN4wkFSnw1MJqj5NhBfAuwaUHREUg4lqNMmePVsHll/HFhVfe1t3FwpJI8DXCCquDrCWNN4B6Tb4M3Z98aTPmTvh0YHl18PXw29yZiKejoPvcUD6E74yFBJbVDk6Bb7K8aP/Hb4c/tRzEYIqprPhSxzlf4Uvhb/0Xoig8qnHAJ3lqPMzfDH8XZ4LEpRf2sVdA5/sqPO9Qfop70UJyn+/boaPddT5yrq7VUUvTIVJI7q74MMddXR8NB1eXcYvhBpZm0s2w72/o86HFoKvLau/pYaXzjLMdUJ6y0LwtWV9CIIaXtvA8+G9HHV03u5q+K+yH47U0NoRngPv7KjzHDwTLj0bS1BDazfJJlcnOOostC6ysnCT+q80G/sIvFVgeW09D8FPVT0uoP7VfvAD8NjA8pqmuAN+OcYAjso0RbIZ8DGB5TVNcRO8JMaHY9SXSdfa3eeANJimWBLrA7JFiZwIXye+NMUV8CcxP2SRFjXefok7NRjSGZJlWUPvw2/wtNiQirSoXWyMsR28wR7AzzYM0oXw+Y7yK+CLJGeaoqjyrJSdZJD6Ov4+z5y6NJc0Az7NUecHydIUy+v60KNyQHoM3nKI1y7YCFiq0i7uBvgER52vDdKqWn9djhY1Dn4G3n6Ecqm2rF74dvgoR53S0hQxW9RJAZAGW5bSn58QJA27dQ7uIEedjywEX5NKVxCqsY6y+qA+LxFI4+yZ6oH0trWkNan80jygtIUsc5SflgAsDXgehfdx1KkkTRE76tN+Xue2jnTU0Ru1oIbvpt30bBtKhOp5yaaRkts0lic8V1i6dPcIRx2d/l8Y8XtNNEg7OOo8bl1kmmOKnDsO88CaYzejau0hWZqiL7C83oCH4SeTHvwV2BqqsHRVztSEYOmWF80NeXZT6Hd4KflResE9vCnBOlCyGfDNAstHTVPUDWoQ1t3iW+9WNizvlhfd4aerXd+ThqiMfNR6+9LvOOro5OY5JX2H4+F7HZD+kGzlamMgldWiirQsjcwWFbjmqZJteekJLK9pisvgL6RhKvuciZiwzrWWGapfrPy30kBVcSBIrw0aD3PU0XB6cehntq7rTMf7/2iQlktDVdXJLXlg6VjmiYBn6rWSTRCH6hvJ0hQrpcGq8oidsmHpTP8t8DGO9/vcWt9qabiqPgup1yKyQwvC2tSefZ73SSpNkUJ4PlLorlHZ+446nc8f3fIyywlJhwrTuwVSjBa1ccvSxN0hjjoK5xVrYZMd9V6XbFfgBukixTwGLg8sDam3dZR/wZ6L/dJlin1en8LS+bgpFbz3Ygvzu1J1HKxYNqxGpCmaCEo12rrBorD6LRp8UbpcdR5VWhTW35KlKd6QFqjuM2XzwlpnMxTvSkuUwuG/Xlg6NtPjbT6WFimF/VG6LEvXgn8QGDjMbBukVECFwhpoS+CQatfX2Q1q6H7wENHdrfCr0lKleEB9JyxNneus+VJpsVL9TwI6W65LovWIGl3KtVJaLv7LBwYTFEERFEVQFEERFEVQFEERFEVQFEERFEVQFEERFEVQFEERFFWq/hFgADUMN4RzT6/OAAAAAElFTkSuQmCC">\n                <p class="toast_content">Commented</p>\n            </div>\n        </div>\n    </div>\n<#}#>\n<div class="weui-webview-nav" style="display:none;" id="js_fake_bar">\n    <button class="weui-webview-nav__btn_goback" id="js_cmt_goback">goback</button>\n    <button class="weui-webview-nav__btn_forward weui-webview-nav__btn_disabled" disabled="disabled">forward</button>\n</div>';const pr={tagName:"mp-common-poi",oldTagName:"mppoi",isWechat:(ke.isAndroid||ke.isIOS)&&(ke.isWechat||ke.isWxWork)&&!ke.isNewMpApp,screen_height:Oe.getInnerHeight(),commonReportData:{bizuin:1*Fe(window.biz),msgid:1*window.mid,itemidx:1*window.idx,sessionidnew:window.sessionid,enterid:1*window.enterid},poiDom:[]},mr=e=>{pr.isWechat?ke.isWxWork?Ee():xe.invoke("openLocation",{latitude:1*e.latitude,longitude:1*e.longitude,name:e.name,address:e.address,poiCardExpand:!0,infoUrl:""},(function(e){-1!==e.err_msg.indexOf("ok")?ue.setSum(110809,53,1):ue.setSum(110809,54,1)})):ke.isNewMpApp?window.open("https://apis.map.qq.com/uri/v1/marker?marker=coord:".concat(e.latitude,",").concat(e.longitude,";title:").concat(encodeURIComponent(e.name),";addr:").concat(encodeURIComponent(e.address))):new Be({msg:"请使用移动端微信打开。"})},hr=(e={})=>{const t=e.dom,n=e.poiInfo;De.on(t,"click",(function(e){e.stopPropagation(),e.preventDefault(),me.report(19937,Object.assign({},pr.commonReportData,{type:2,actiontype:2})),ue.setSum(110809,55,1),mr(n)}),!0)},_r=()=>{for(let e=0;e<pr.poiDom.length;e++){const t=pr.poiDom[e];if(1*t.getAttribute("data-hasreport")!=1){t.setAttribute("data-hasreport",1);const e=document.documentElement.scrollTop||document.body.scrollTop;t.clientHeight+t.offsetTop>=e+t.clientHeight/2&&t.clientHeight+t.offsetTop<=e+t.clientHeight/2+pr.screen_height&&("A"===t.tagName?(me.report(19937,Object.assign({},pr.commonReportData,{type:1,actiontype:1})),ue.setSum(110809,58,1)):(me.report(19937,Object.assign({},pr.commonReportData,{type:2,actiontype:1})),ue.setSum(110809,56,1)))}}},fr={oldTagName:"mpsearch",tagName:"mp-common-search",isWechat:(ke.isAndroid||ke.isIOS)&&(ke.isWechat||ke.isWxWork)&&!ke.isNewMpApp,keywords:[],screen_height:Oe.getInnerHeight(),exposeHasReport:0,commonReportData:{BizUin:window.biz,MsgId:1*window.mid,ItemIdx:1*window.idx,SearchKeyWord:"",SessionId:window.sessionid,EnterId:1*window.enterid,Scene:1*window.source,SubScene:1*window.subscene}},gr=(e={})=>{De.on(e.dom,"click",(function(){const e=fr.keywords.map((e=>e.label)).join(";");if(me.report(19453,Object.assign({},fr.commonReportData,{SearchKeyWord:e,EventType:2})),ue.setSum(110809,47,1),fr.isWechat){if(ke.isWxWork)Ee();else if((ke.isIOS&&ke.ltVersion("7.0.12")||ke.isAndroid&&ke.ltVersion("7.0.12"))&&!ke.isWxWork)return void new Be({msg:"当前微信版本不支持展示该内容，请升级至最新版本。"});const e=[];for(let t=0;t<fr.keywords.length;t++)e.push({hotword:fr.keywords[t].label,id:t,optype:1});xe.invoke("openWXSearchPage",{query:"",thirdExtParam:JSON.stringify({data:[{items:e,title:window.nickname+"推荐搜索",type:4}],from:"mpWidget",bizUserName:window.user_name,bizNickName:window.nickname,id:"mpWidget_".concat(fr.commonReportData.BizUin,":").concat(fr.commonReportData.MsgId,":").concat(fr.commonReportData.ItemIdx)})},(function(e){-1!==e.err_msg.indexOf("ok")?ue.setSum(110809,48,1):ue.setSum(110809,49,1)}))}else new Be({msg:"请使用移动端微信打开。"})}));const t=()=>{if(!fr.exposeHasReport){fr.exposeHasReport=1;const t=document.documentElement.scrollTop||document.body.scrollTop;if(e.dom.clientHeight+e.dom.offsetTop>=t+e.dom.clientHeight/2&&e.dom.clientHeight+e.dom.offsetTop<=t+e.dom.clientHeight/2+fr.screen_height){const e=fr.keywords.map((e=>e.label)).join(";");me.report(19453,Object.assign({},fr.commonReportData,{SearchKeyWord:e,EventType:1})),ue.setSum(110809,46,1)}}};De.on(window,"scroll",t),t()};let wr={pvele:[],checkInScreenId:null,reportRandom:Math.random()};function yr(){if(console.log("weproduct init"),"function"!=typeof document.getElementsByClassName)return;let e=document.getElementsByClassName("js_product_container");e&&e.length>0&&(!function(e){try{for(let t=0,n=e.length;t<n;t++){let n=e[t];if(n.className.indexOf("js_list_container")>=0){let e=n.querySelector("img.js_cover");if(e){let t=e.parentNode.getBoundingClientRect();e.style.setProperty("width",t.width+"px","important"),e.style.setProperty("height",t.height+"px","important"),e.style.setProperty("background-size","unset","important"),"0"==e.getAttribute("data-fail")?vr.call(e):e.getAttribute("data-fail")||(e.lazyLoadOnload=e.lazyLoadOnload||[],e.lazyLoadOnload.push(vr))}}}}catch(su){}}(e),t.getAppidInfo({onSuccess:function(n){wr.data=n.data,function(e){for(let i=0,o=e.length;i<o;i++)!function(e,n){De.on(e,"click",".js_product_loop_content",(function(e){let i=e.delegatedTarget,o=i.getAttribute("data-wxaappid"),a=i.getAttribute("data-wxapath"),r=i.getAttribute("data-pid"),s=i.getAttribute("data-appid"),c=i.querySelector(".cps_inner_info_title").innerHTML;return t.jumpUrl({privateExtraData:{cookies:"cps_package=123456; expires=1538286412; busid=mmbiz_ad_cps; domain=*"},sourceAppId:s,appid:o,path:a,scene:1091,sceneNote:[encodeURIComponent(location.href),user_name,msg_title,encodeURIComponent(r),c,a].join(":"),beforeNonWechatWarn:function(){},beforeJumpBackupPage:function(){},onJsapiCallback:function(e){if("openWeApp:ok"===e.err_msg&&r){let e=2;2==i.getAttribute("data-pidtype")&&(e=4),kr([{wxa_appid:o,pid:r,type:e,absolute_order:n+1,appid:i.getAttribute("data-appid")||"",templateid:i.getAttribute("data-templateid")||"",relative_order:1*i.getAttribute("data-order"),packid:i.getAttribute("data-packid")||""}])}}}),!1}))}(e[i],i);let n=document.getElementsByClassName("js_product_loop_content");if(n&&n.length>0&&Oe.getInnerHeight()){for(let e=0;e<n.length;e++)wr.pvele.push(n[e]);br(),De.on(window,"scroll",br)}}(e)}})),setTimeout((function(){let e=document.getElementsByClassName("js_product_loop_content").length,t=document.getElementsByClassName("js_product_err_container").length;ue.setSum("64469","15",e+t),ue.setSum("64469","16",e),ue.setSum("64469","18",t)}),0)}function vr(){let e=this.parentNode;if(!e)return;let t=document.createElement("span");t.className=this.className,t.style.background='url("'+this.src+'") no-repeat center',e.insertBefore(t,this),e.removeChild(this)}function br(e){wr.checkInScreenId&&clearTimeout(wr.checkInScreenId),wr.checkInScreenId=setTimeout((function(){wr.checkInScreenId=null;let e=[];for(let t=0;t<wr.pvele.length;t++){let n=wr.pvele[t],i=n.getBoundingClientRect();if((i.height||i.bottom-i.top)>0&&i.top<Oe.getInnerHeight()&&i.bottom>0){let i=n.getAttribute("data-pid");if(i){let o=1;2==n.getAttribute("data-pidtype")&&(o=3),e.push({wxa_appid:n.getAttribute("data-wxaappid"),pid:i,type:o,absolute_order:t+1,appid:n.getAttribute("data-appid")||"",templateid:n.getAttribute("data-templateid")||"",relative_order:1*n.getAttribute("data-order"),packid:n.getAttribute("data-packid")||""})}wr.pvele.splice(t--,1)}}kr(e),0==wr.pvele.length&&(De.off(window,"scroll",br),br=null)}),100)}function kr(e){if(!e||0==e.length)return;let t={batch_no:_e.getQuery("batch_no")||"",bizuin:window.biz||"",biz:window.biz||"",mid:window.mid||"",idx:window.idx||"",total:e.length};for(let n=0;n<e.length;n++){let i=e[n],o=n+1;for(let e in i)i.hasOwnProperty(e)&&(t[e+""+o]=i[e])}pe({url:"/mp/productreport?",type:"POST",data:t,dataType:"json",async:!0})}const xr=window.location.protocol+"//support.weixin.qq.com/update/";let Sr=[],Ir=1,Cr=_e.getQuery("fontScale");function Tr(e){Cr=e.fontScale,setTimeout((()=>{const e=document.getElementsByTagName("wx-open-subscribe")||[];for(let t=0;t<e.length;t++)e[t].setAttribute("size",Ir),e[t].setAttribute("scale",Cr),Ir++}),50)}function Ar(){if(!document.getElementById("js_content"))return;const e=document.querySelectorAll("mpsubscribe");for(let t=0;t<e.length;t++){const n=e[t],i=document.createElement("mp-common-subscribe"),o=n.getAttribute("data-templateidlist"),a=n.getAttribute("data-index")||0;n.parentNode.appendChild(i),n.parentNode.removeChild(n),i.setAttribute("data-templateidlist",o),i.setAttribute("data-index",a)}Sr=document.getElementsByTagName("mp-common-subscribe")||[];for(let t=0;t<Sr.length;t++){const e=Sr[t],n=e.getAttribute("data-templateidlist")||[],i=e.getAttribute("data-index")||0,o=window.__is_support_wxOpen?1:0;e.setAttribute("data-scene",window.is_temp_url?3:2),e.setAttribute("data-username",window.user_name),e.setAttribute("data-supportwxopen",o),e.setAttribute("data-scale",Cr),e.setAttribute("data-index",i),e.setAttribute("data-tagContent","订阅通知"),e.setAttribute("data-templateidlist",n),o||e.classList.add("js_subsc_btn")}P(Tr),function(){const e=document.getElementsByClassName("js_subsc_btn")||[];for(let t=0;t<e.length;t++){const n=e[t];De.on(n,"click",(()=>{zt("js_subsc_btn")||(window.uin&&window.key&&ke.isWechat&&!ke.isWindowsWechat&&!ke.isMacWechat?document.getElementById("js_update_dialog").style.display="block":window.weui.alert("请在手机微信内操作"))}))}De.on(document.getElementById("js_update_cancel"),"click",(()=>{document.getElementById("js_update_dialog").style.display="none"})),De.on(document.getElementById("js_update_confirm"),"click",(()=>{Se.jumpUrl(xr,!0)}))}()}function Er(){if(!networkType)return;let e=window.performance||window.msPerformance||window.webkitPerformance;if(!e||void 0===e.getEntries)return;let t,n,i=document.getElementsByTagName("img"),o=i.length,a=navigator.userAgent,r=!1;n=RegExp.$1;for(let s=0,c=i.length;s<c;s++){if(t=parseInt(100*Math.random()),t>100)continue;let c=i[s].getAttribute("src");if(!c||c.indexOf("mp.weixin.qq.com")>=0)continue;let l,d=e.getEntries();for(let e=0;e<d.length;e++)if(l=d[e],l.name==c){let e=i[s].getAttribute("data-fail"),t=0;try{a.match(/iphone/i)?t=1:a.match(/android/i)&&(t=2),me.report(11065,{Uin:parseInt(atob(window.biz))||0,IfSuccess:e?1:0,Device:t,user_agent:navigator.userAgent,net_type:networkType,url:c,delay_time:parseInt(l.duration)>0?parseInt(l.duration):0,img_size:i[s].fileSize||0,sample:o>100?100:o,user_device:navigator.userAgent,client_version:n,appmsg_id:parseInt(window.appmsgid,10)})}catch(cu){console.log(cu)}r=!0;break}if(r)break}}let Pr={"network_type:fail":"fail","network_type:edge":"2g/3g","network_type:wwan":"2g/3g","network_type:wifi":"wifi"};const Rr='<div id="js_profile_ban" style="display: none;">\n  <div class="weui-mask_transparent"></div>\n  <div class="weui-toast">\n    <i class="weui-icon-warn weui-icon_toast"></i>\n    <p class="weui-toast__content">该账号因违规无法跳转</p>\n  </div>\n</div>';let Dr=[];const jr=[];function Or(e){try{return 1*window.atob(e)}catch(su){}return 0}function Br(e,t,n,i){me.report(22316,{BizUin:Or(window.biz),AppMsgID:window.parseInt(window.mid,10)||0,ItemIndex:window.parseInt(window.idx,10)||0,Itemshowtype:0,SessionId:window.sessionid+"",EnterId:window.parseInt(window.enterid,10)||0,Scene:1*window.source,Subscene:1*window.subscene,ActionType:e,toBizuin:Or(t),isBizBan:1*n,isMassSend:1*window.appmsg_type,CardType:i})}function Lr(){if(Dr&&Dr.length&&jr.length===Dr.length)De.off(window,"scroll",Lr);else for(let e=0;e<Dr.length;e++){const t=Dr[e],n=t.querySelector(".js_wx_profile_card");if(n&&n.getBoundingClientRect().top>0&&n.getBoundingClientRect().top+n.getBoundingClientRect().height/2<=Oe.getInnerHeight()){const e=n.getAttribute("data-id"),i=n.getAttribute("data-index");if(-1===jr.indexOf(i)){jr.push(i);Br(0,e,n.getAttribute("data-isban"),1*t.getAttribute("data-from"))}}}}function Nr(e,t,n,i,o,a){e.addEventListener("click",(()=>{if(Br(1,n,i,a),i){const e=document.getElementById("js_profile_ban");"none"===e.style.display&&(e.style.display="block",setTimeout((()=>{e.style.display="none"}),2e3))}else Ve.goProfile({biz:n,scene:124},{username:t,scene:"200"},null,o)}))}function Mr(e){return window.mp_profile.find((t=>t.fakeid===e))}function qr(){!function(){const e=document.getElementById("js_content");if(!e)return;Dr=Array.from(document.getElementsByTagName("mpprofile"))||[];const t=Array.from(document.getElementsByTagName("mp-common-profile"))||[],n=Dr.concat(t);window.mp_profile.forEach((e=>{e.round_head_img&&(e.round_head_img=e.round_head_img.compressCDNImgSize(),e.round_head_img=_e.addWxfrom(e.round_head_img,19))}));for(let o=0;o<n.length;o++){let t=n[o];const i=t.getAttribute("data-id"),a=1*t.getAttribute("data-from"),r=Mr(i)||{},{alias:s="",fakeid:c,is_biz_ban:l,nickname:d="",original_num:u,round_head_img:p,signature:m="",username:h,biz_account_status:_}=r,f=t.parentNode&&t.parentNode.querySelector('[data-preloadingid="'.concat(i,'"]'));if(f&&t.parentNode.removeChild(f),r){if("MPPROFILE"===t.tagName){const e=document.createElement("mp-common-profile");t.parentNode.appendChild(e),t.parentNode.removeChild(t),t=e}t.setAttribute("data-index",o),t.setAttribute("data-id",c),t.setAttribute("data-headimg",p),t.setAttribute("data-nickname",d.htmlDecode()),t.setAttribute("data-alias",s.htmlDecode()),t.setAttribute("data-signature",m.htmlDecode()),t.setAttribute("data-origin_num",1*u),t.setAttribute("data-is_biz_ban",1*l),t.setAttribute("data-isban",1*l),t.setAttribute("data-biz_account_status",1*_),t.classList.add("js_wx_tap_highlight"),Nr(t,r.username,r.fakeid,r.is_biz_ban,r.biz_account_status,a)}else t.innerHTML="";const g=U({startElem:n[o],endElem:e},{rules:["CSS[Opacity<1]","CSS[Height=0]"]});if(g.length>0){ue.setSum(299174,3,1);const e="biz=".concat(window.biz,"&mid=").concat(window.mid,"&idx=").concat(window.idx);window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("profileCoverDetect","".concat(e),{mid:"mmbizwap:appmsg_covertest",view:"wap_business",_info:{url:location.href,hitArr:g}})}}Lr();const i=document.createElement("div");i.innerHTML=je.tmpl(Rr,{}),document.body.appendChild(i)}(),De.on(window,"scroll",Lr)}const Wr=[],zr=document.getElementsByTagName("mp-common-sticker"),Fr=new Map,Ur=[],Hr=[];for(const ct of zr){Ur.push(ct.dataset.md5);const e=Fr.get(ct.dataset.md5);e?(e.push(ct),Fr.set(ct.dataset.md5,e)):(Fr.set(ct.dataset.md5,[ct]),ct.dataset.buf||Hr.push(ct.dataset.md5))}const Vr={EXPOSE:0,CLICK:1,LONGTAP:2};function Kr(e,t){const n=t.dataset.md5,i=Number(t.dataset.type),o=t.dataset.emoji_url,a=Number(t.dataset.is_ban),r=t.dataset.buf;me.report(29377,{bizuin:window.biz&&Number(window.atob(window.biz))||0,msgid:window.parseInt(window.mid,10)||0,itemidx:window.parseInt(window.idx,10)||0,SessionId:window.sessionid+"",EnterId:window.parseInt(window.enterid,10)||0,scene:1*window.source,Subscene:1*window.subscene,action:e,md5:n,type:i,url:o,isBan:a,buf:r})}function $r(){var e;!function(){for(const e of zr)De.longtap(e,(function(t){if(t.stopPropagation(),1===parseInt(e.dataset.is_ban,10))return;Kr(Vr.LONGTAP,e);Jr(e.dataset.emoji_url,e.dataset.md5,1,e.dataset.buf||"",!0)}),!0),De.tap(e,(function(t){if(t.stopPropagation(),1===parseInt(e.dataset.is_ban,10))return;Kr(Vr.CLICK,e);Jr(e.dataset.emoji_url,e.dataset.md5,0,e.dataset.buf||"",!0)}))}(),e=Ur,pe({type:"POST",url:"/mp/checkemoticon?action=checkmd5batch",data:{action:"checkmd5batch",md5ListJson:JSON.stringify({list:e})},dataType:"json",timeout:3e3,success:e=>{e&&e.base_resp&&-1!==e.base_resp.ret&&e.is_ban_list&&Array.isArray(e.is_ban_list)&&e.is_ban_list.forEach(((e,t)=>{zr[t].dataset.is_ban=e}))}}),function(e){if(0===e.length)return;pe({type:"POST",url:"/mp/getemojibuf?action=getbuf",data:{action:"getbuf",md5ListJson:JSON.stringify({list:e})},dataType:"json",timeout:3e3,success:e=>{if(e&&e.base_resp&&-1!==e.base_resp.ret&&e.emoji_info&&Array.isArray(e.emoji_info)){e.emoji_info.forEach((e=>{if(e.md5){Fr.get(e.md5).forEach((t=>{t.dataset.buf=e.buf}))}}))}},complete:()=>{}})}(Hr),function(){let e=null;e=new IntersectionObserver((function(t,n){t.forEach((t=>{if(t.isIntersecting){const n=t.target;Kr(Vr.EXPOSE,n),e.unobserve(n)}}))}),{threshold:.5}),zr.forEach((t=>{e.observe(t)}))}()}function Jr(e,t,n,i,o){const a=new XMLHttpRequest;a.open("GET",e,!0),a.responseType="arraybuffer",a.onload=function(e){const r=new Uint8Array(a.response);let s=r.length;const c=new Array(s);for(;s--;)c[s]=String.fromCharCode(r[s]);const l=c.join(""),d=window.btoa(l);if(o)xe.invoke("emoticonAPICollection",{md5:t,opType:n,imageDataString:d,emojiInfoBuf:i},(function(e){}));else{if(!Wr)return;Wr.push({md5:t,emojiInfoBuf:i,opType:n,imgDataString:d})}return d},a.onerror=function(e){console.log("xmlHttp.onerror",e)},a.onabort=function(e){console.log("xmlHttp.onabort",e)},a.send()}const Gr={tagName:"mp-common-answer",isWechat:(ke.isAndroid||ke.isIOS)&&ke.isWechat&&!ke.isWxWork&&!ke.isNewMpApp,isPCWechat:ke.isWindowsWechat||ke.isMacWechat},Yr=Array.from(document.getElementsByTagName(Gr.tagName)),Xr=[],Qr=[];Yr&&Yr.length&&Yr.forEach((e=>{Number(e.dataset.card_type)?Xr.push(e):Qr.push(e)}));const Zr={EXPOSE:1,CLICK:2,ANSWER:3};function es(e){let t=[];try{if(e){const n=JSON.parse(e);n&&n.list&&Array.isArray(n.list)&&(t=n.list)}}catch(n){console.log(n)}return t}function ts(e,t){const n=window.parseInt(t.dataset.usertype,10),i=es(t.dataset.picture_clist),o=es(t.dataset.video_list);me.report(30376,{bizuin:window.biz&&Number(window.atob(window.biz))||0,msgid:window.parseInt(window.mid,10)||0,itemidx:window.parseInt(window.idx,10)||0,title:window.msg_title||"",accountType:1===n?2:1,accountUin:t.dataset.username,answerCardId:t.dataset.aid,questionId:t.dataset.qid,hasComment:t.dataset.comment?1:0,hasPicture:i.length>0?1:0,hasVideo:o.length>0?1:0,actionType:e,type:Number(t.dataset.card_type)?1:0})}function ns(e,t,n={}){let i="";n.minVersion&&(i+="&min_version=".concat(encodeURIComponent(n.minVersion)));const o="#/".concat(e);let a="";return Object.keys(t).forEach((e=>{e&&void 0!==t[e]&&(a+="".concat(a?"&":"?").concat(encodeURIComponent(e),"=").concat(encodeURIComponent(String(t[e]))))})),"https://search.weixin.qq.com/cgi-bin/newsearchweb/userclientjump?path=page%2Fask%2Findex".concat(i).concat(o).concat(a)}function is(e,t=100){if(e)return e.replace(/\n|\r|\t/g," ").replace(/"|'/g,"").slice(0,t)}function os(e){const t=e.map((e=>{var t,n,i,o,a,r,s,c,l,d,u,p;const m=null==(n=null==(t=e.answer_content)?void 0:t.video_list)?void 0:n.map((e=>e.media_info?{like_count:e.media_info.like_count||0,thumb_url:e.media_info.thumb_url||""}:{}));let h="";(null==(i=e.answer_content)?void 0:i.text)&&(h=is(e.answer_content.text,350));let _="";if(null==(a=null==(o=e.answer_top_comment)?void 0:o.content)?void 0:a.text){const t=is(e.answer_top_comment.content.text,100),n=e.answer_top_comment.nickname;t&&(_="".concat(n,"：").concat(t))}return{question_text:e.question_text,state:e.answer_content.state,usertype:e.type,like_count:e.like_count||0,forward_count:e.forward_count||0,comment_count:e.comment_count||0,username:null==(r=e.user_info)?void 0:r.username,nickname:null==(s=e.user_info)?void 0:s.nickname,headimg_url:null==(c=e.user_info)?void 0:c.headimg_url,aid:null==(l=e.answer_content)?void 0:l.aid,qid:null==(d=e.answer_content)?void 0:d.qid,content_text:h,content_type:null==(u=e.answer_content)?void 0:u.type,picture_list:null==(p=e.answer_content)?void 0:p.picture_list,video_list:m,comment:_}}));Qr.forEach(((e,n)=>{if(t[n]){const i=t[n].state;if(4!==i)2===i?e.dataset.message="回答仍在审核中":8===i?e.dataset.message="回答审核不通过":64===i&&(e.dataset.message="该回答已被删除"),e.dataset.status=2;else{e.dataset.like_count=t[n].like_count,e.dataset.forward_count=t[n].forward_count,e.dataset.comment_count=t[n].comment_count,t[n].comment&&t[n].comment.length&&(e.dataset.comment=t[n].comment.slice(0,100));const i=t[n].picture_list;i&&i.length&&Array.isArray(i)&&(e.dataset.picture_clist=JSON.stringify({list:i.slice(0,4)}));const o=t[n].video_list;o&&(e.dataset.video_list=JSON.stringify({list:o})),e.dataset.content_text=t[n].content_text,e.classList.add("js_wx_tap_highlight")}}}))}function as(){if(!Yr||!Yr.length)return;const e={count:Qr.length,type:[],username:[],aid:[],qid:[],question_id:[]};Xr&&Xr.length&&Xr.forEach((t=>{e.question_id.push(t.dataset.qid)})),Qr&&Qr.length&&Qr.forEach((t=>{const{usertype:n,username:i,aid:o,qid:a}=t.dataset;e.type.push(n),e.username.push(i),e.aid.push(o),e.qid.push(a)})),pe({type:"POST",url:"/mp/zhuge_appmsg?action=get_qa_info",data:e,dataType:"json",timeout:3e3,success:e=>{if(e&&e.base_resp&&-1!==e.base_resp.ret){const t=e.answer_list;t&&Array.isArray(t)&&os(t);const n=e.question_list;n&&Array.isArray(n)&&function(e){const t=e.map((e=>({qid:e.question_content.qid,question_text:e.question_content.text,answer_count:e.answer_count,follow_count:e.follow_count,state:e.question_content.state})));Xr.forEach(((e,n)=>{if(t[n]){const i=t[n].state;4!==i?(2===i?e.dataset.message="问题仍在审核中":8===i?e.dataset.message="问题审核不通过":64===i&&(e.dataset.message="该问题已被删除"),e.dataset.status=2):(e.dataset.follow_count=t[n].follow_count,e.dataset.answer_count=t[n].answer_count,e.classList.add("js_wx_tap_highlight"))}}))}(n)}},complete:()=>{Qr.forEach((e=>{1===Number(e.dataset.status)&&(e.dataset.status=0)})),Xr.forEach((e=>{1===Number(e.dataset.status)&&(e.dataset.status=0)}))}})}function rs(){as(),function(){for(const e of Yr){const t=e.shadowRoot.querySelector("button");t&&De.on(t,"touchstart",(e=>{e.stopPropagation()})),De.on(e,"click",(t=>{var n;if(2!==Number(e.dataset.status))if(Gr.isWechat){const n=t.composedPath();if(n&&Array.isArray(n)){const t=n[0];!t||"BUTTON"!==t.tagName||window.zhuge_user_limit||window.is_teenager?(ts(Zr.CLICK,e),xe.invoke("openLiteApp",{appId:"wxalite2fd372f050eecd471a4392786dfae78c",page:"pages/question/entry",query:{qid:e.dataset.qid,aid:e.dataset.aid,scene:7,sceneNote:"".concat(window.biz?window.atob(window.biz):"0","_").concat(window.mid,"_").concat(window.idx)}},(e=>{console.log("open w1w",e)}))):(ts(Zr.ANSWER,e),xe.invoke("openLiteApp",{appId:"wxalite2fd372f050eecd471a4392786dfae78c",page:"pages/answer-editor/entry",query:{qid:e.dataset.qid,scene:7,sceneNote:"".concat(window.biz?window.atob(window.biz):0,"_").concat(window.mid,"_").concat(window.idx)}},(e=>{console.log("open w1w",e)})))}}else if(Gr.isPCWechat){const t=ns("pages/question/entry",{qid:e.dataset.qid,aid:e.dataset.aid,scene:7,sceneNote:"".concat(window.atob(window.biz),"_").concat(window.mid,"_").concat(window.idx)});window.open(t)}else n="请在手机微信端打开",setTimeout((function(){window.weui?window.weui.alert(n):window.alert(n)}),0)}))}}(),function(){let e=null;e=new IntersectionObserver((function(t,n){t.forEach((t=>{if(t.isIntersecting){const n=t.target;ts(Zr.EXPOSE,n),e.unobserve(n)}}))}),{threshold:0}),Yr.forEach((t=>{e.observe(t)}))}()}const ss={tagName:"mp-common-product",CHANNEL_PRODUCT_DOMAIN:"https://mp.weixin.qq.com",isWechat:(ke.isAndroid||ke.isIOS)&&ke.isWechat&&!ke.isWxWork&&!ke.isNewMpApp,exposureInit:!1};function cs(e,t,n){if(e){if(n&&"2"!==n.getAttribute("data-cardtype")){n.parentNode.style.margin="0 auto 24px";const e={compEle:n,compType:"channelProduct",compIdx:Array.from(document.getElementsByTagName("mp-common-product")).indexOf(n)};Re.renderCompSilentlyPreHandler(e),Kt(n,n.getAttribute("data-windowproduct")),Re.renderCompSilently(e)}!function(){if(ss.exposureInit)return;ss.exposureInit=!0;let e=null;e=new IntersectionObserver(((e,t)=>{e.forEach((e=>{if(e.isIntersecting){const n=e.target;try{const e=n.shadowRoot.querySelector("iframe");e&&e.contentWindow&&(Zt(e.contentWindow,"webEvent",{type:"expose"}),t.unobserve(n))}catch(cu){console.error(cu)}}}))}),{threshold:1}),en.forEach((t=>{e.observe(t)}))}()}}const ls={init:function(){Gt(en),Yt(),Xt(),window.addEventListener("message",(e=>{const{iframeEle:t,productEle:n}=Qt(e.source);if(e.origin===ss.CHANNEL_PRODUCT_DOMAIN&&n&&t)try{const{action:i,value:o}=JSON.parse(e.data);if(!i)return;const a=t.contentWindow;switch(i){case"changeFrameStyle":!function(e,t,n){if("2"!==t.getAttribute("data-cardtype")&&e&&t&&n&&"object"==typeof n)try{const i={compEle:t,compType:"channelProduct",subCompType:"cardHeight",compIdx:Array.from(document.getElementsByTagName("mp-common-product")).indexOf(t)};for(const t of Object.keys(n))"height"===t&&Re.renderCompSilentlyPreHandler(i),e.style[t]=n[t],"height"===t&&Re.renderCompSilently(i)}catch(cu){console.error(cu)}}(t,n,o);break;case"onFrameReady":cs(a,0,n)}}catch(cu){console.error(cu)}}))}},ds=window.Vue,us={cacheTime:6e5,networkType:"",isPc:/(WindowsNT)|(Windows NT)|(Macintosh)/i.test(navigator.userAgent),defaultErrorWording:"视频加载失败，请刷新页面再试",defaultHeadImgUrl:"http://mmbiz.qpic.cn/mmbiz/a5icZrUmbV8p5jb6RZ8aYfjfS2AVle8URwBt8QIu6XbGewB9wiaWYWkPwq4R7pfdsFibuLkic16UcxDSNYtB8HnC1Q/0",playerStatus:{formatId:null},netTypeMap:{"network_type:fail":"fail","network_type:edge":"2g/3g","network_type:wwan":"2g/3g","network_type:wifi":"wifi"},definitionMap:{20003:4,10002:3,10003:2,10004:1,10102:3,10103:2,10104:1},resolutionNameMap:{10002:"超清",10003:"高清",10004:"流畅",10102:"超清",10103:"高清",10104:"流畅",20003:"自动"},playbackRateInfo:[{rate:.5,name:"0.5倍"},{rate:.75,name:"0.75倍"},{rate:1,name:"1.0倍"},{rate:1.5,name:"1.5倍"},{rate:2,name:"2.0倍"}],allCpsPlayersOfPage:{}},ps={NOT_IN_WECHAT:91,VIDEO_BAN:92},ms=new tn("cps_video_info"),hs=["继续观看",""],_s=["再次观看","refresh"],fs={1:hs.concat("135px"),2:_s.concat("135px"),201:hs.concat("100%"),202:_s.concat("100%"),203:hs.concat("135px"),204:_s.concat("135px")},gs=ds.extend({components:{Intersect:x,[Rt.name]:Rt},provide:{playerScene:"cps"},data:()=>({id:Date.now()+"_"+Math.floor(Math.random()*Math.floor(Date.now())),opt:null,playerOpt:null,wrapStyle:null,videoStyle:null,posterStyle:null,topStickyExpendWhenPaused:!1,showScreenshotMask:!1,screenshot:"",toastTips:"",canLoad:!0}),computed:{...p(["cgiData"]),...p("mp-video-player",["errType","errCode","errMsg","fullscreenStatus","orientationStatus","refreshBtnStatus","topStickyInfoStatus","commonReportData"]),innerPlugins(){return this.opt&&this.opt.plugins&&this.opt.plugins.filter((e=>e.type===Dt.TYPE_INNER))||[]},coverPlugins(){return this.opt&&this.opt.plugins&&this.opt.plugins.filter((e=>e.type===Dt.TYPE_COVER))||[]},controlPlugins(){return this.opt&&this.opt.plugins&&this.opt.plugins.filter((e=>e.type===Dt.TYPE_CONTROL))||[]},profilePlugins(){return this.opt&&this.opt.plugins&&this.opt.plugins.filter((e=>e.type===Dt.TYPE_PROFILE))||[]},topStickyInfoWording(){const e=fs[this.topStickyInfoStatus];return e&&e[0]||"继续观看"},topStickyInfoIconClass(){const e=fs[this.topStickyInfoStatus];return e&&e[1]||""},topStickyInfoMaskWidth(){const e=fs[this.topStickyInfoStatus];return e&&e[2]||"100%"},extInfo(){return this.opt&&this.opt.extInfo||{}},isDramaVideo(){return this.extInfo&&this.extInfo.dramaInfo}},watch:{orientationStatus(e){this.$emit("orientation-change",e),this.fullscreenStatus?1===e?this.showScreenshotMask=!0:setTimeout((()=>{this.showScreenshotMask=!1}),250):this.showScreenshotMask=!1}},mounted(){us.allCpsPlayersOfPage[this.id]=this,this.opt&&this.opt.dontAutoInit||this.init(),this.onPageResize(),this.opt&&this.opt.autoplayWhenExpose&&(this.__debouncedOnScroll=Se.debounce(this.onPageScroll.bind(this),250),window.addEventListener("scroll",this.__debouncedOnScroll),this.__debouncedOnScroll()),window.addEventListener("unload",this.onPageUnload),window.addEventListener("resize",this.onPageResize),document.addEventListener("visibilitychange",this.onVisibilityChange)},beforeDestroy(){this.opt&&this.opt.autoplayWhenExpose&&this.__debouncedOnScroll&&window.removeEventListener("scroll",this.__debouncedOnScroll),window.removeEventListener("unload",this.onPageUnload),window.removeEventListener("resize",this.onPageResize),document.removeEventListener("visibilitychange",this.onVisibilityChange)},methods:{...g("mp-video-player",["setError"]),init(){this.initController(),ye.addSpecificReport("native_data",(()=>({video_data:{vid:this.opt.vid,lastPlayedTime:this.getCurrentTime(),lastPlayedTimeExpiredTime:(Date.now()+us.cacheTime)/1e3}})))},initController(){this.opt={bizUserName:"",bizNickName:"",profileTabType:2,videoTitle:"",headImgUrl:"",preview:!1,fromid:0,oriStatus:3,isMpVideo:0,mpVideoCoverUrl:"",mpVideoTransInfo:[],showFullscreenMenu:!0,videoMd5:"",oriVid:"",vid:"",ckey:"",width:0,height:0,autoplay:!1,muted:!1,loop:!1,__biz:"",uin:"",mid:"",idx:"",comment_id:"",scene_type:0,hitBizuin:"",hitVid:"",totalRange:10,useFeFullscreen:!1,coverFit:"contain",lazyLoad:!1,blurFullscreenBackground:"all",canMute:!0,canFullscreen:!1,canChangePlaybackRate:!1,canPraiseVideo:!1,canShareVideo:!1,canLikeVideo:!1,...this.$options.opt,useWcSlPlayer:!1,useImmersiveMode:!1,isMpVideo:!0},this.opt.oriVid=this.opt.oriVid||this.opt.vid,this.opt.headImgUrl=this.opt.headImgUrl||us.defaultHeadImgUrl,1!=this.opt.oriStatus&&2!=this.opt.oriStatus&&(this.opt.oriStatus=3),this.__reportData=H.getVideoReportData(),this.__gWidth=this.__gWidth||this.opt.width,this.__gHeight=this.__gHeight||this.opt.height,this.__playRangeInfo=[],this.__dynamicErrMsg="",this.__isUnloaded=!1,this.__isShowTx=!1,this.__dataCount=0,this.__targetDataCount=2,this.__coverUrl="",this.__cacheStartTs=0,this.__initialData=null,this.__preventResize=Boolean(this.opt.initFullscreenStatus),this.__vInfo={status:null,coverUrl:"",dynamicData:null},this.initLazyLoad(),this.hideError(),this.initLegacyPlugins(),this.initReportData(),this.getCache(),window.__timelineInitialData&&(this.__initialData=window.__timelineInitialData,delete window.__timelineInitialData),this.getCoverUrl(),this.getAdvanceCodecSupportBeforeCallback((()=>{us.playerStatus&&!us.playerStatus.formatId?ws((()=>this.getDynamicData())):this.getDynamicData()}))},reinit(e){this.opt&&"object"==typeof this.opt&&(this.$options.opt=e),delete this.__gWidth,delete this.__gHeight,this.$nextTick(this.init)},reload(){this.playerOpt=null,this.initController(),this.triggerEvent("reload")},resetPlayer(){const e=this.$refs.player;e&&(e.__canplay=!1,e.pause(),e.preventOperating(2),e.$refs.video.currentTime=0,e.currentTime=0)},initLazyLoad(){this.canLoad=!this.opt.lazyLoad,this.opt.lazyLoad&&(this.$on("startLoadVideo",(()=>{this.canLoad=!0,this.$nextTick((()=>{this.initPlugins(),this.triggerEvent("playerReady")}))})),this.$on("hideVideo",(()=>{this.canLoad=!1})))},initLegacyPlugins(){const e=this.opt.plugins||[];this.__blockPlugin={},this.__legacyPlugins=[];const t=new jt;t.setPlayer(this),t.init&&t.init(),this.__legacyPlugins.push(t);for(let n=0,i=e.length;n<i;n++){const t=e[n];t.prototype instanceof Dt||(t.setPlayer(this),t.init&&t.init(),this.__legacyPlugins.push(t))}},initPlugins(){this.$refs.innerPlugins&&this.$refs.innerPlugins.forEach((e=>e.initContext(this))),this.$refs.coverPlugins&&this.$refs.coverPlugins.forEach((e=>e.initContext(this))),this.$refs.controlPlugins&&this.$refs.controlPlugins.forEach((e=>e.initContext(this))),this.$refs.profilePlugins&&this.$refs.profilePlugins.forEach((e=>e.initContext(this)))},destroyPlugins(){this.opt.plugins=[],this.__legacyPlugins.forEach((e=>e.destroy&&e.destroy())),this.__legacyPlugins=[],this.__blockPlugin={}},initReportData(){let e=this.__reportData;e.mid=this.opt.mid,e.__biz=this.opt.__biz,e.idx=this.opt.idx,e.vid=this.opt.vid,e.commentid=this.opt.comment_id,e.scene_type=this.opt.scene_type,e.auto_play=this.opt.autoplay?1:0,e.fromid=this.opt.fromid,e.hit_bizuin=this.opt.hitBizuin,e.hit_vid=this.opt.hitVid,this.__monitorUid=this.triggerEvent("initMonitor",64728),this.__monitorUid2=this.triggerEvent("initMonitor",380812)},getReportTypeBySceneType(){return 0==this.opt.scene_type?1:1==this.opt.scene_type||2==this.opt.scene_type?2:4==this.opt.scene_type?3:7==this.opt.scene_type?4:0},onPageScroll(){const e=this.$refs.player;if(!this.__exposing)return void(!this.opt||!this.opt.autoplayWhenExpose||e&&e.isEnd()||this.__coverNextShowing||(this.__shouldPlayAfterCanplay=!1,setTimeout((()=>this.pause()))));Object.keys(us.allCpsPlayersOfPage).filter((e=>us.allCpsPlayersOfPage[e]&&us.allCpsPlayersOfPage[e].__exposing)).reduce(((e,t)=>{const n=us.allCpsPlayersOfPage[t].$el.getBoundingClientRect();let i=0;return n.top>=0?i=Math.max(Math.min(window.innerHeight-n.top,n.height),0):n.bottom>=0&&(i=Math.max(Math.min(n.bottom,window.innerHeight),0)),e[t]=i,i>=e.max&&(e.max=i,e.maxId=t),e}),{max:0,maxId:""}).maxId===this.id?!this.opt||!this.opt.autoplayWhenExpose||e&&e.isEnd()||this.__coverNextShowing||e&&e.isPlay()||(this.__canPlay?setTimeout((()=>{const e=this.getPlayer();e&&e.resumeOperating(),this.play(),this.triggerEvent("exposeAutoPlay")})):this.__shouldPlayAfterCanplay=!0):!this.opt||!this.opt.autoplayWhenExpose||e&&e.isEnd()||this.__coverNextShowing||(this.__shouldPlayAfterCanplay=!1,setTimeout((()=>this.pause())))},onPageUnload(e){if(this.__isUnloaded)return;this.__isUnloaded=!0;let t=this.__reportData;if(0===t.videoerror?this.cacheData():this.clearCache(),e&&"leaveReport"===e.type){const e=[];for(let n in t)t.hasOwnProperty(n)&&e.push(n+"="+encodeURIComponent(t[n]));return{reportUrl:"/mp/videoreport?",method:"POST",reportData:e.join("&")}}H.videoreport({data:t,async:!1})},onVisibilityChange(){document.hidden&&this.cacheData()},onPageResize(){this.__preventResize||(this.$refs.player&&this.$refs.player.isWcSlPlayer?this.fullscreenStatus||setTimeout((()=>{const e=this.$el.parentNode,t=e&&e.getBoundingClientRect(),n=t&&t.width||0;0!==n&&this.setVideoSize({width:n})}),0):this.opt.height&&this.opt.width&&(this.__isShowTx&&this.__txPlayer?setTimeout((()=>{try{const e=this.$el.parentNode,t=e&&e.getBoundingClientRect(),n=this.opt.width/this.opt.height,i=t&&t.width||0,o=Math.floor(i/n);0!==i&&(e.style.height=o+"px",this.__gWidth=i,this.__gHeight=o,this.__txPlayer.resize({width:i,height:o}))}catch(su){}}),0):setTimeout((()=>{const e=this.$el.parentNode,t=e&&e.getBoundingClientRect(),n=t.width,i=t.height;0!==n&&(this.__gWidth=n,this.__gHeight=i,this.setVideoSize({width:n,height:i}))}),250)))},getCache(){const e=function(e,t,n,i,o){let a=ms.get(i||o);if(!a)return null;try{if(a=JSON.parse(a)||{},!a.time||Date.now()-us.cacheTime>1*a.time)return vs(i||o),a.videoInfo={status:ys(e,t,n,i||o)},a}catch(su){return vs(i||o),null}return a=a.videoInfo?a:{videoInfo:{}},a.videoInfo.status=ys(e,t,n,i||o),a.videoInfo?a:null}(this.opt.__biz,this.opt.mid,this.opt.idx,this.opt.vid||this.opt.playUrl);if(e){const t=this.__vInfo;t.dynamicData=e.videoInfo.dynamicData||null,t.coverUrl=e.videoInfo.coverUrl||"",t.status=e.videoInfo.status||null,this.__cacheStartTs=e.time||null}},cacheData(){const e=this.$refs.player,t=this.__vInfo;e&&(t.status||(t.status={}),"function"==typeof e.isEnd&&(t.status.isEnd=e.isEnd()),"function"==typeof e.getCurTime&&(t.status.playTime=e.getCurTime()),"function"==typeof e.getPlaybackRate&&(t.status.playbackRate=e.getPlaybackRate()),!this.__initialData&&this.__coverUrl&&(t.coverUrl=this.__coverUrl),function(e,t,n,i,o,a){let r={dynamicData:o.dynamicData||null,coverUrl:o.coverUrl||""};const s=Date.now()+864e5;ms.set(i,JSON.stringify({time:a||Date.now(),videoInfo:r}),s),o.status&&ms.set(e+t+n+i,JSON.stringify(o.status),s)}(this.opt.__biz,this.opt.mid,this.opt.idx,this.opt.vid||this.opt.playUrl,this.__vInfo,this.__cacheStartTs))},clearCache(){vs(this.opt.vid||this.opt.playUrl)},getCoverUrl(){this.__coverUrl=this.opt.cover,this.__dataCount++,this.videoDataReady(),this.getFloatCoverBase64(this.__coverUrl)},getDynamicData(){if(window.cgiData.is_teenager||window.is_teenager)return this.__dynamicErrMsg="青少年模式下暂不支持观看视频",this.__reportData.duration_ms=0,this.__vInfo.dynamicData=null,this.__dataCount=this.__targetDataCount,void setTimeout((()=>this.videoDataReady()),0);if(this.isDramaVideo){if(!ke.isWechat)return this.__dynamicErrMsg="请在微信客户端打开",this.__reportData.videoerror=ps.NOT_IN_WECHAT,this.__reportData.duration_ms=0,this.__vInfo.dynamicData=null,this.__dataCount=this.__targetDataCount,void setTimeout((()=>this.videoDataReady()),0);if(this.extInfo&&this.extInfo.dramaInfo&&this.extInfo.dramaInfo.ban)return this.__dynamicErrMsg="视频暂时无法播放",this.__reportData.videoerror=ps.VIDEO_BAN,this.__reportData.duration_ms=0,this.__vInfo.dynamicData=null,this.__dataCount=this.__targetDataCount,setTimeout((()=>this.videoDataReady()),0),void fe.error("cps player controller: failed to play drama video: dramaBan")}this.__vInfo.dynamicData={data:{formatid:10003,time:this.opt.duration,title:"",width:this.opt.videoWidth,height:this.opt.videoHeight,file_size:0,totalUrl:this.opt.playUrl,rate:0,ori_url_info:[{format_id:10003,url:this.opt.playUrl}]}},this.__dataCount++,this.videoDataReady()},videoDataReady(){this.__dataCount===this.__targetDataCount&&(this.__isShowTx?this.removeLoading():this.__vInfo.dynamicData?this.createPlayer():(this.removeLoading(),fe.error("cps player controller: failed to create player because no dynamic data")))},createPlayer(){let e=this.__vInfo,t=this.__reportData,n=e.dynamicData.data;this.__reportData.duration_ms=parseInt(1e3*n.time),this.initPlayRangeInfo({durationMs:this.__reportData.duration_ms}),t.vtitle=this.opt.vtitle||n.title||"";const i=this.getReportTypeBySceneType();let o,a;if(n.ori_url_info){const e=function(e){const t={};return e.url_info.forEach((n=>{let i;const o=n.format_id;switch(1*o){case 20003:case 10002:case 10003:case 10004:t[us.definitionMap[o]]||(i=us.definitionMap[o]);break;case 10102:case 10103:case 10104:e.h265&&(i=us.definitionMap[o])}i&&(t[i]=n)})),t}({h265:this.__supportH256,url_info:n.ori_url_info});o=n.ori_url_info.find((e=>10004===e.format_id)),a=Object.keys(e).filter((e=>1*e!==us.definitionMap[20003]||this.opt.useWcSlPlayer&&ke.isWechat&&ke.isAndroid&&ke.gtVersion("7.0.16",1))).sort(((e,t)=>t-e)).map((t=>{const n=e[t];return{name:n.video_quality_wording||us.resolutionNameMap[n.format_id],formatId:n.format_id,height:n.height,width:n.width,src:n.url}}))}const r=_e.getQuery("play_time");let s=0;this.__initialData?s=this.__initialData.initialTime||0:""!==r?s=1*r||0:e.status&&!e.status.isEnd&&(s=e.status.playTime||0),console.info("[CPS Video Info]",n),fe.info("cps player controller: begin to create player",JSON.stringify(n)),this.playerOpt={...this.opt,__biz:this.opt.__biz,mid:this.opt.mid,idx:this.opt.idx,bizUserName:this.opt.bizUserName,bizNickName:this.opt.bizNickName,profileTabType:this.opt.profileTabType,videoTitle:t.vtitle,videoReportType:i,coverFit:this.opt.coverFit,cover:this.__coverUrl,width:this.__gWidth,height:this.__gHeight,videoWidth:n.width,videoHeight:n.height,duration:n.time,autoplay:this.opt.autoplay,flowNotice:this.opt.flowNotice,flow:n.flow,loop:this.opt.loop,muted:this.opt.muted,src:n.totalUrl,formatId:n.formatid,headImgUrl:this.opt.headImgUrl,useWcSlPlayer:this.opt.useWcSlPlayer,useImmersiveMode:this.opt.useImmersiveMode,useFeFullscreen:this.opt.useFeFullscreen,oriStatus:this.opt.oriStatus,initialTime:s,resolutionInfo:a,retryResolution:o,playbackRateInfo:us.playbackRateInfo,playbackRateBtnInfoDefaultId:2,showFullscreenMenu:this.opt.showFullscreenMenu,videoMd5:this.opt.videoMd5,extinfo:{hit_bizuin:this.opt.hitBizuin,hit_vid:this.opt.hitVid,vid:this.opt.vid,preview:this.opt.preview,pageplayer:this},fileSize:n.file_size,checkPlayAuthority:this.checkPlayAuthority,readNum:this.__immersiveData&&this.__immersiveData.view_num&&this.__immersiveData.view_num.pv||0,praiseNum:this.__immersiveData&&this.__immersiveData.like_num&&this.__immersiveData.like_num.pv||0,likeNum:this.__immersiveData&&this.__immersiveData.seen_num&&this.__immersiveData.seen_num.pv||0,isPraised:this.__immersiveData&&this.__immersiveData.like_num&&this.__immersiveData.like_num.liked||0,isLiked:this.__immersiveData&&this.__immersiveData.seen_num&&this.__immersiveData.seen_num.seen||0,disableBorderRadius:!0,alwaysShowControl:this.opt.alwaysShowControl,hideDuration:this.opt.hideDuration||!1},this.$nextTick((()=>{this.initPlugins(),this.triggerEvent("playerReady")}))},removeLoading(){this.afterRemoveLoading()},afterRemoveLoading(){if(!this.__isShowTx&&!this.__vInfo.dynamicData)if(this.opt.isMpVideo){let e=1;(-1!==[72,73].indexOf(this.__reportData.videoerror)||window.cgiData.is_teenager||window.is_teenager||-1!==Object.values(ps).indexOf(this.__reportData.videoerror))&&(e=2),this.showError(this.__dynamicErrMsg,e)}else this.showError(this.__dynamicErrMsg||"",window.cgiData.is_teenager||window.is_teenager?2:void 0);const e=this.getVideoData();this.triggerEvent("videoReady",{formatId:e&&e.formatid})},showError(e,t){e=e||us.defaultErrorWording,this.setError({type:t||1,code:this.__reportData.videoerror,msg:e,refresh:e===us.defaultErrorWording?1:0})},hideError(){this.setError({type:0,code:0,msg:"",refresh:0})},checkPlayAuthority(e){this.opt.checkNoPaid?pe({type:"GET",dataType:"json",timeout:3e4,url:"/mp/videoplayer?action=check_video_paid_status&__biz=".concat(this.opt.__biz,"&mid=").concat(this.opt.mid,"&idx=").concat(this.opt.idx),success:t=>{1==!t.can_play?window.weui.confirm("此视频来自于付费内容，在原文付费后才可播放",{buttons:[{type:"default",label:"Cancel"},{label:"前往原文",onClick:()=>{this.opt.openArticle()}}]}):"function"==typeof e.allowPlay&&e.allowPlay()}}):"function"==typeof e.allowPlay&&e.allowPlay()},onExpose(){this.__exposing=!0,this.triggerEvent("playerExpose")},onExposeLeave(){this.$refs.player,this.__exposing=!1,this.triggerEvent("playerExposeLeave")},onLoaded(){setTimeout((()=>{this.removeLoading()}),0),fe.info("cps player controller: succ created player")},onTimeupdate(e){if(!this.__reportedTimeupdate){this.__reportedTimeupdate=!0;this.$refs.player.getLog().loadwait}if(!this.__reportedPv){this.__reportedPv=!0;const e=this.__monitorUid,t=this.__monitorUid2;this.triggerEvent("clearMonitor",e),this.triggerEvent("clearMonitor",t),this.opt.isMpVideo?(this.triggerEvent("setMonitor",t,{12:1,13:1}),this.triggerEvent("sendMonitor",t)):(this.triggerEvent("setMonitor",e,{0:1,1:1}),this.triggerEvent("sendMonitor",e))}this.__reportData.last_ms=parseInt(1e3*e.currentTime),this.__reportData.video_play_time=parseInt(1e3*e.currentTime),this.triggerEvent("timeupdate",e)},onBeginPlay(){const e=this.__reportData;e.client_time_when_play=Math.round(Date.now()/1e3),e.click_play_button=1,!this.$refs.player.autoplay&&this.recoverPlaybackRate(),this.triggerEvent("beginPlay")},onDurationchange(){this.$refs.player.autoplay&&this.recoverPlaybackRate()},onTouchVideo(){this.triggerEvent("touchVideo")},onOpenSourcePage(){this.triggerEvent("openSourcePage")},onFastForward(){this.triggerEvent("fastForward")},onReplay(){this.triggerEvent("replay")},onStatusChange(e){const t=this.__reportData;"loading"!==e.status||"seeked"!==e.subStatus&&"seeking"!==e.subStatus||this.initPlayRangeInfo({durationMs:t.duration_ms}),"pause"===e.status?this.computePlayTotalTimeForKyk(e):"play"===e.status||e.status,"loading"===e.status&&"waiting"===e.subStatus&&("play"===e.preStatus||"loading"===e.preStatus&&"seeked"===e.preSubStatus||"loading"===e.preStatus&&e.preSubStatus),this.triggerEvent("statusChange",e)},onAfterReplay(){this.triggerEvent("afterReplay")},onHandDragComplete(e){this.triggerEvent("handDragComplete",e)},onBarDragComplete(e){this.triggerEvent("barDragComplete",e)},onEnd(){const e=this.__vInfo,t=this.__reportData;e.dynamicData.data,this.getReportTypeBySceneType(),t.hasended=1,this.triggerEvent("beforeEnd",this.playerOpt.loop),this.playerOpt.loop?(this.__reportedPv=!1,this.__reportData.replay=1):this.triggerEvent("resetVideo"),this.triggerEvent("end",this.playerOpt.loop),this.initPlayRangeInfo({durationMs:t.duration_ms})},onError(e){const t=this.__reportData;this.__monitorUid;const n=this.__monitorUid2;switch(!e||!e.errorcode||e.errorcode>5||e.errorcode<=0?t.videoerror=46:t.videoerror=e.errorcode+40,this.__reportedPv||(this.__reportedPv=!0,this.triggerEvent("setMonitor",n,{12:1})),this.triggerEvent("setMonitor",n,{14:1}),1*e.errorcode){case 1:this.triggerEvent("setMonitor",n,{15:1});break;case 2:this.triggerEvent("setMonitor",n,{16:1});break;case 3:this.triggerEvent("setMonitor",n,{17:1});break;case 4:this.triggerEvent("setMonitor",n,{18:1});break;case 5:this.triggerEvent("setMonitor",n,{19:1});break;case 6:this.triggerEvent("setMonitor",n,{39:1});break;default:this.triggerEvent("setMonitor",n,{20:1})}this.triggerEvent("sendMonitor",n),t.v_err_code=e.errorcode,this.showError(),this.initPlayRangeInfo({durationMs:t.duration_ms})},onErrorRetry(){const e=this.__monitorUid2;this.triggerEvent("setMonitor",e,{64:1}),this.triggerEvent("sendMonitor",e)},onFirstBufferingTime(e){var t;if(this.__hasFirstPlayed||this.$refs.player.autoplay,this.opt.isMpVideo){this.$store.state.cgiData;const e=this.getVideoData();null==(t=e.ori_url_info)||t.some((e=>1*e.format_id%1e3>100)),e.formatid,e.formatid}this.__hasFirstPlayed||(this.__hasFirstPlayed=!0),this.triggerEvent("firstBufferingTime",e)},onPlayingBufferingTime(e){this.triggerEvent("playingBufferingTime",e)},onUserplay(e){this.triggerEvent("userplay",e),1===e.tapType||e.tapType},onUserpause(e){this.triggerEvent("userpause",{curTime:this.getCurrentTime(),...e});const t=this.__reportData;t.pause_num=(t.pause_num||0)+1,1===e.tapType||e.tapType},onWaiting(e){this.triggerEvent("waiting",e)},onPlay(e){this.__pauseTimestamp&&delete this.__pauseTimestamp,this.triggerEvent("play",e)},onPause(e){this.triggerEvent("pause",e),this.__pauseTimestamp=Date.now()},onMidPlayClick(){},onAfterCheckVideoFit(e){let t={97:1};!0===e.needToFit&&(t[98]=1,t[100]=1,e.os.ios&&(t[103]=1),e.os.android&&(t[106]=1),!0===e.supportObjectFit&&(t[101]=1,e.os.ios&&(t[104]=1),e.os.android&&(t[107]=1)));const n=this.__monitorUid;this.triggerEvent("setMonitor",n,t),this.triggerEvent("sendMonitor",n)},onBindError(e){this.triggerEvent("bindError",e)},onRateChange(e){this.triggerEvent("rateChange",e),"changed"===e.action&&this.cacheData()},onResolutionChange(e){"changed"===e.action&&(us.playerStatus.formatId=e.infoAfter&&e.infoAfter.formatId||null,ms.set("playerStatus",JSON.stringify({playerStatus:us.playerStatus}),Date.now()+6048e5),xe.invoke("handleMPPageAction",{action:"setLocalData",key:"formatId",data:String(us.playerStatus.formatId),url:location.href},(e=>{console.log("setLocalData"+JSON.stringify(e))})),fe.info("player controller: set player status cache "+JSON.stringify(us.playerStatus))),this.triggerEvent("resolutionChange",e)},onBrightnessChange(e){this.triggerEvent("brightnessChange",e)},onVolumeChange(e){this.triggerEvent("volumeChange",e)},onLoadedMetaData(){if(this.getAndUpdateVideoInfo(),this.__canPlay=!0,this.__shouldPlayAfterCanplay){const e=this.getPlayer();e&&e.resumeOperating(),this.play(),this.triggerEvent("exposeAutoPlay"),this.__shouldPlayAfterCanplay=!1}this.triggerEvent("loadedmetadata")},onProfileJump(e){this.triggerEvent("profileJump",e)},onProcessStateChange(e){this.triggerEvent("processStateChange",e)},onCanplay(e){this.getAndUpdateVideoInfo(),this.triggerEvent("canplay",e)},onAfterFirstLoaded(e){this.triggerEvent("afterfirstloaded",e)},onShowControlBar(e){this.triggerEvent("showControlBar",e)},onHideControlBar(e){this.triggerEvent("hideControlBar",e)},triggerEvent(e,...t){const n=[].concat(this.$refs.innerPlugins||[],this.$refs.coverPlugins||[],this.$refs.controlPlugins||[],this.$refs.profilePlugins||[],this.__legacyPlugins),i=this.__blockPlugin[e]||this.__blockPlugin.all;let o,a,r=0;if(i&&"function"==typeof i.recv&&(o=i.recv(e,...t),"[object Object]"===Object.prototype.toString.call(o)?(r|=o.code,a=o.data):r|=o,1&r))return a;for(let c=0,l=n.length;c<l;++c){try{o=n[c].recv(e,...t)}catch(s){console.error("player controller plugin error:",s,e,t)}if("[object Object]"===Object.prototype.toString.call(o)?(r|=o.code,a=o.data):r|=o,2&r)break}if(!(this._blockInnerHandler||4&r)){const n=this[e+"InnerHandler"];n&&(o=n.apply(this,[e,...t]),"[object Object]"===Object.prototype.toString.call(o)&&(a=o.data))}return 8&r||this.emitEvent(e.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase())),...t),a},emitEvent(e,...t){e&&this.$emit(e,...t)},getAndUpdateVideoInfo(){const e=this.getPlayer();if(e&&e.$refs.video){const t=Math.round(e.$refs.video.duration),n=e.$refs.video.videoWidth,i=e.$refs.video.videoHeight;t!==this.playerOpt.duration&&0!==t&&this.$set(this.playerOpt,"duration",t),n!==this.playerOpt.videoWidth&&0!==n&&this.$set(this.playerOpt,"videoWidth",n),i!==this.playerOpt.videoHeight&&0!==i&&this.$set(this.playerOpt,"videoHeight",i)}},setBlockPlugin(e,t){this.__blockPlugin[e]=t},getPlayer(){return this.$refs.player},supportWcSlPlayer(){return!!this.$refs.player&&this.$refs.player.supportWcSlPlayer()},getAdvanceCodecSupportBeforeCallback(e){this.checkH265Support(e)},checkH265Support(e){if(this.opt.useWcSlPlayer&&he.os.iphone)this.__supportH256=!0,"function"==typeof e&&e();else if(this.opt.useWcSlPlayer&&he.os.android)ke.gtVersion("8.0.14",1)?xe.invoke("handleVideoAction",{action:"supportCodec",codecId:172,height:1920,width:1080,frameRate:60},(t=>{const n=-1!==t.err_msg.indexOf(":ok");this.__supportH256=n,"function"==typeof e&&e()})):(this.__supportH256=!1,"function"==typeof e&&e());else{let t=!1;t=ke.isIOS&&he.os.getNumVersion()>=11?!he.isLockdownMode():ke.isAndroid?this.checkH5VideoCanPlayType('video/mp4; codecs="hvc1"'):this.checkH5VideoCanPlayType('video/mp4; codecs="hevc"'),this.__supportH256=t,"function"==typeof e&&e()}},checkH5VideoCanPlayType(e){const t=document.createElement("video");if("function"==typeof t.canPlayType){const n=t.canPlayType(e);if("maybe"==n.toLowerCase()||"probably"==n.toLowerCase())return!0}return!1},initPlayRangeInfo(e){if(e.durationMs<=0)return;const t=this.opt.totalRange;function n(e,t){const n=[{start:0,end:e,hasReport:!1}];for(;;){let i=n[n.length-1];if(i.end>=t)break;n.push({start:i.end,end:i.end+e,hasReport:!1})}return n}1e3*t>=e.durationMs?this.__playRangeInfo=n(1e3,e.durationMs):this.__playRangeInfo=n(Math.ceil(e.durationMs/t),e.durationMs)},getTraceId:()=>0,getOrderid:()=>0,getOriStatus(){return this.opt.oriStatus},getFromid(){return this.opt.fromid},resetVideoInnerHandler(){this.$refs.player.isWcSlPlayer?this.$refs.player.showCover():this.$refs.player.resetVideo()},coverNextShowStatusChangeInnerHandler(e){this.__coverNextShowing=e},pause(){this.$refs.player&&this.$refs.player.pause4outer()},play(){this.$refs.player&&this.$refs.player.play4outer()},getRealPlayTime(){let e=0,t=this.$refs.player;return t&&(e=Math.round(1e3*t.getPlayTotalTime())),e},getCurrentTime(){let e=0,t=this.$refs.player;return t&&(e=t.getCurTime()),e},getCurrentTimeMs(){return Math.round(1e3*this.getCurrentTime())},getVideoData(){return this.__vInfo&&this.__vInfo.dynamicData&&this.__vInfo.dynamicData.data?this.__vInfo.dynamicData.data:null},getReportData(){return this.__reportData},extendMpReportData(e){Object.assign(this.__reportData,e)},getMpReportData(){return this.__reportData},recoverPlaybackRate(){const e=this.__vInfo.status,t=e&&e.playbackRate||1;this.$refs.player.setPlaybackRate(t),this.$refs.player.isWcSlPlayer&&setTimeout((()=>{this.$refs.player&&this.$refs.player.setPlaybackRate(t)}),250)},setLoop(e){this.playerOpt&&(this.playerOpt.loop=e)},setMuted(e){this.playerOpt&&(this.playerOpt.muted=e)},setAutoplay(e){this.$refs.player&&(this.$refs.player.autoplay=e)},setVideoSize(e){this.playerOpt&&("number"==typeof e.width&&(this.playerOpt.width=e.width),"number"==typeof e.height&&(this.playerOpt.height=e.height))},getVideoDuration(){return this.playerOpt&&this.playerOpt.duration||0},getFloatCoverBase64(e){const t=new Image;t.crossOrigin="anonymous",t.onload=()=>{t.onload=null,t.onerror=null;try{const e=t.naturalWidth||t.width,n=t.naturalHeight||t.height,i=document.createElement("canvas"),o=i.getContext("2d"),a=640,r=1280;i.width=a,i.height=r,i.style.width=a+"px",i.style.height=r+"px";const s=function(e="cover",t,n,i,o){let a=1,r=0,s=0,c=i,l=o,d=0,u=0,p=t,m=n,h=t/n,_=i/o;"cover"===e?_>=h?(a=n/o,r=(i-t/a)/2,c=t/a,l=o):(a=t/i,s=(o-n/a)/2,c=i,l=n/a):"contain"===e&&(_>=h?(a=t/i,u=(n-o*a)/2,m=o*a):(a=n/o,d=(t-i*a)/2,p=i*a));return[r,s,c,l,d,u,p,m]}("contain",a,r,e,n);o.drawImage(t,...s),o.beginPath(),o.moveTo(a/2-50,r/2-60),o.lineTo(a/2-50,r/2+60),o.lineTo(a/2+50,r/2),o.fillStyle="rgba(255,255,255,0.8)",o.strokeStyle="rgba(255,255,255,0.8)",o.shadowBlur=100,o.shadowColor="rgba(0,0,0,0.5)",o.fill(),o.closePath(),o.stroke(),this.__floatCoverBase64=i.toDataURL("image/jpeg",0),this.__floatCoverBase64=this.__floatCoverBase64.replace("data:image/jpeg;base64,","")}catch(su){this.__floatCoverBase64="",console.error(su)}},t.onerror=()=>{this.__floatCoverBase64="",t.onload=null,t.onerror=null},t.src=e},showToast(e){this.__toastTimeoutId&&clearTimeout(this.__toastTimeoutId),this.toastTips=e,this.__toastTimeoutId=setTimeout((()=>{this.__toastTimeoutId=null,this.toastTips=""}),1e3)},computePlayTotalTimeForKyk(e){},getCurrentDefinition(){return us.playerStatus.formatId?us.definitionMap[us.playerStatus.formatId]:this.__vInfo.dynamicData?us.definitionMap[this.__vInfo.dynamicData.data.formatid]:0},onTouchMoveHorizontally(e){this.triggerEvent("touchMoveHorizontally",e)},onPlayerTouchEnd(e){this.triggerEvent("playerTouchEnd",e)},onSeekingStatusChange(e){this.triggerEvent("seekingStatusChange",e)},onSwipeBack(e){this.triggerEvent("swipeBack",e)},onMuteChange(e){Object.keys(us.allCpsPlayersOfPage).forEach((t=>{const n=us.allCpsPlayersOfPage[t],i=n&&n.$refs.player,o=i&&i.$refs.video;o&&(o.muted=e,i.$set(i.opt,"muted",e))})),this.triggerEvent("muteChange",e)},onClickPlaySwitch(e){this.triggerEvent("clickPlaySwitch",e)}}});function ws(e){!us.networkType&&ke.isWechat&&(ke.isIOS||ke.isAndroid)?xe.invoke("getNetworkType",{},(t=>{us.networkType=us.netTypeMap[t.err_msg]||"fail","network_type:edge"!=t.err_msg&&"network_type:wwan"!=t.err_msg||(t.detailtype||t.subtype)&&(us.networkType=t.detailtype||t.subtype),"function"==typeof e&&e()})):"function"==typeof e&&e()}function ys(e,t,n,i){let o=ms.get(e+t+n+i);if(!o)return null;try{o=JSON.parse(o)||{}}catch(su){return function(e,t,n,i){ms.remove(e+t+n+i)}(e,t,n,i),null}return o}function vs(e){ms.remove(e)}ws(),function(){let e=ms.get("playerStatus");if(e){try{e=JSON.parse(e)||{}}catch(su){return void vs("playerStatus")}e.playerStatus&&(us.playerStatus=e.playerStatus,fe.info("cps player controller: get player status cache "+JSON.stringify(us.playerStatus)))}}();const bs=gs;Rt._getFormatTime,Rt._getAllPlayersOfPage;const ks=pt(bs,(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("intersect",{attrs:{threshold:[.5]},on:{enter:e.onExpose,leave:e.onExposeLeave}},[t("div",{staticClass:"mp-video-player",style:{height:e.fullscreenStatus?"100vh":"100%"}},[0===e.errType&&e.playerOpt?t("mp-video-player",{ref:"player",class:101===e.fullscreenStatus?"opr_fade_out":"",attrs:{opt:e.playerOpt,"can-load":e.canLoad,"wrap-style":e.wrapStyle,"video-style":e.videoStyle,"poster-style":e.posterStyle},on:{loaded:e.onLoaded,timeupdate:e.onTimeupdate,"begin-play":e.onBeginPlay,durationchange:e.onDurationchange,"status-change":e.onStatusChange,"after-replay":e.onAfterReplay,"hand-drag-complete":e.onHandDragComplete,"bar-drag-complete":e.onBarDragComplete,end:e.onEnd,error:e.onError,"error-retry":e.onErrorRetry,"first-buffering-time":e.onFirstBufferingTime,"playing-buffering-time":e.onPlayingBufferingTime,userplay:e.onUserplay,userpause:e.onUserpause,waiting:e.onWaiting,play:e.onPlay,pause:e.onPause,"mid-play-click":e.onMidPlayClick,"after-check-video-fit":e.onAfterCheckVideoFit,"bind-error":e.onBindError,"rate-change":e.onRateChange,"resolution-change":e.onResolutionChange,"brightness-change":e.onBrightnessChange,"volume-change":e.onVolumeChange,"profile-jump":e.onProfileJump,"process-state-change":e.onProcessStateChange,canplay:e.onCanplay,"show-control-bar":e.onShowControlBar,"hide-control-bar":e.onHideControlBar,replay:e.onReplay,"touch-video":e.onTouchVideo,"open-source-page":e.onOpenSourcePage,"fast-forward":e.onFastForward,loadedmetadata:e.onLoadedMetaData,"touch-move-horizontally":e.onTouchMoveHorizontally,"player-touch-end":e.onPlayerTouchEnd,"seeking-status-change":e.onSeekingStatusChange,"swipe-back":e.onSwipeBack,afterfirstloaded:e.onAfterFirstLoaded,"mute-change":e.onMuteChange,"click-play-switch":e.onClickPlaySwitch},scopedSlots:e._u([{key:"poster",fn:function({cover:n,coverStatus:i,videoSnapshot:o,withoutCover:a}){return[t("div",{directives:[{name:"show",rawName:"v-show",value:(n&&0!==i||o)&&!a,expression:"(cover && coverStatus !== 0 || videoSnapshot) && !withoutCover"}],staticClass:"poster_cover_wrp",style:e.posterStyle},[t("div",{staticClass:"poster_cover",style:"background-image: url(".concat(o||n.imgChange640(),"); background-size: contain; background-color: transparent;")}),t("div",{staticClass:"poster_cover_blur_wrp"},[t("div",{staticClass:"poster_cover_blur"}),t("div",{staticClass:"poster_cover",style:"background-image: url(".concat(o||n.imgChange640(),"); background-size: cover;")})])])]}},{key:"video_background",fn:function({cover:e}){return[t("div",{staticClass:"poster_cover_blur_wrp"},[t("div",{staticClass:"poster_cover_blur"}),t("div",{staticClass:"poster_cover",style:"background-image: url(".concat(e.imgChange640(),"); background-size: cover;")})])]}},{key:"inner",fn:function(){return e._l(e.innerPlugins,(function(e,n){return t(e,{key:n,ref:"innerPlugins",refInFor:!0,tag:"component"})}))},proxy:!0},{key:"cover",fn:function(){return e._l(e.coverPlugins,(function(e,n){return t(e,{key:n,ref:"coverPlugins",refInFor:!0,tag:"component"})}))},proxy:!0},{key:"control",fn:function(){return e._l(e.controlPlugins,(function(e,n){return t(e,{key:n,ref:"controlPlugins",refInFor:!0,tag:"component"})}))},proxy:!0},{key:"profile",fn:function(){return e._l(e.profilePlugins,(function(e,n){return t(e,{key:n,ref:"profilePlugins",refInFor:!0,tag:"component"})}))},proxy:!0}],null,!1,4255383019)}):1===e.errType?t("div",{staticClass:"wrp_pop_tips wx_video_error_box js_error_box"},[t("div",{staticClass:"wx_video_error_msg js_error_area"},[t("p",{attrs:{role:"heading"}},[e._v(e._s(e.errMsg))]),t("i",{staticClass:"wx_video_error_code"},[e._v("Error code: "+e._s(e.errCode))]),0!==e.refreshBtnStatus?t("a",{staticClass:"wx_video_error_msg_btn js_video_errormsg_btn",attrs:{role:"button",href:"javascript:void(0);"},on:{click:e.reload}},[t("img",{staticClass:"wx_video_error_refresh",attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAqCAMAAADhynmdAAAAQlBMVEUAAACcnJycnJycnJyoqKicnJycnJycnJycnJycnJyfn5+cnJydnZ2enp6kpKSdnZ2cnJyenp6cnJycnJycnJybm5t8KrXMAAAAFXRSTlMAyeb3CNp3tJRvHIEtJhBgqztWRJ+p5TqGAAABCklEQVQ4y5WTi27DIAxFAUMhgTzX8/+/urB2pdKI0x0pSoRuruyLbf7gF3PBaDE6X44LyY0D1SJQsfd9PpMM/CJx60v8SmV1HMSi1lKyA1n0jnwWSO08l04uJbxpBmTrpDtbGB6fmxC6Tc4BHv9aZDJdJsHW9w43Jez9x8T5M4l31WZsJn2bsYY+nUum2lQkGIVANPZ4FCLWOJImSTgjZE2SkU9crmu57mj9JBc93Qzj9R1d3HSG5bN5MRsnUzcGKK8Ns02z+Da7rYQE4bUE2PG1C6kVnkCyf0pwX8/jwbyxCLhcHpKTFkvkwK3pRmXtRrVFoTGYLvN+t0EUl0qrRaF1pFBz0anp/ptvNB4SY1XDAVMAAAAASUVORK5CYII=",alt:""}}),e._v(" Refresh ")]):e._e()]),t("img",{staticClass:"wx_video_error_loading js_video_errormsg_loading",staticStyle:{display:"none"},attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADkAAAA5CAMAAAC7xnO3AAAAY1BMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+aRQ2gAAAAIXRSTlMAOx20pMJbzBQNTDGTh2ohLCZmeUF2hEmXCFdxUquef4yHE17nAAACnklEQVRIx9WW2xqiIBSFRc1AUATJU1a+/1MOm0NYKvnNXM260ZLftRcbqCQinOLI0yiY/iXKuUZPjx5Fk+6RhF1yHiVF0wC6IZfr9fqIkpRqdNyQ9AoiUU8g+YZ8Xn96YmNKvkhkLMskKgEo/yJzaxkXeZsGsjeWKEIFU/FBZgA+D5yEwGtTgR0J18lYUvdcLZ1YkUjLf+a0saYYSG/J3Hury+WSkTCjCETtF6Mvd8QGJMZSWIfsAlKhWGRl5zQ1ZNBDgy/zzvvFavWUK7SyTRs+rsiUZS/4LHIHyo8VgBx7vDkKx2WhPS7dD1Q6cNlu2dTa0gMys4bz/vJR6ph8ADgcVcSVUkfnhzJTc6gRj8fbCOHk30UI2KC+V4gKjskJQqC5frFHli0kafogFIfFkAXVCSqdAFVR8pmtVCWiXCtaarbWpGtQAYx7sjf2GCbfjFRQpH7lTLucveSMBE7+Z6VqViT2/PVs0d7hPk9TUcTaUuVaT8k/f/v6SXOgyG7InZaSvM8vj/309LrbvpSAORDH2/kWGyHhm/u5AYUc8qdFBRRrsV749bRv6I5x1OY50GZUUxQz9aGplAXZcOQ1DL3vwsTyvHQ2YWgjZV2rDTmxYRjUuoBvcQDr7QRLBiiNzJ4BawG3FLtTmEMGBigTRyC2oIKht1vbwLWrKmXKBZal+yApDGhm4q5JCVdNdrZeQBe8B44WnE2NGmxrR1bCvMugHdkhSwMWI9wjIGeosnPlJmNrst6PQrpeFkBSyAmkdD016DYqAVC6HHcNtnCPgazcuytAd5IqB/qYtq4bkP7vnEaL3W4KH9/HhKBAKl8XFUlMIWYIek4hZgh6UtjHBLVA4pPkCKRf9jOQ5Kwp1UvPDyb3qkPJaRG8Ln7f8Q8Bki/Kj5IYnQAAAABJRU5ErkJggg=="}})]):2===e.errType?t("div",{staticClass:"wrp_pop_tips wx_video_msg_primary js_error_box",style:{height:e.fullscreenStatus?"100%":"calc(100% - 12px)"}},[t("div",{staticClass:"wx_video_msg_primary_inner"},[t("p",{staticClass:"wx_video_msg_primary_text"},[e._v(e._s(e.errMsg))])])]):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:e.toastTips,expression:"toastTips"}]},[t("div",{staticClass:"weui-mask_transparent"}),t("div",{staticClass:"weui-toast",style:{top:0===e.orientationStatus?"45%":"50%",position:"absolute"}},[t("i",{staticClass:"weui-icon-success-no-circle weui-icon_toast"}),t("p",{staticClass:"weui-toast__content"},[e._v(e._s(e.toastTips))])])]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showScreenshotMask,expression:"showScreenshotMask"}],staticClass:"fullscreen-screenshot__layer",staticStyle:{"background-color":"#000"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.screenshot,expression:"screenshot"}],staticClass:"fullscreen-screenshot__layer",style:"z-index: -1; background-image: url("+e.screenshot+")"})],1)])}),[],!1,null,"ef111776",null,null).exports;window.Vue.use(O);const xs=()=>{const e=new O.Store({modules:{[B.name]:B},state:L(),mutations:N()});return e.commit(V.SET_CGI_DATA,K(window.cgiData)),e.commit(V.SET_URL_PARAMS,$()),[J].forEach((t=>e.registerModule([B.name,t.name],t))),e};const Ss=()=>{let e=0;const t=he.os.version;let n="unknown";return he.os.ios&&(e=1,n="IOS ".concat(t)),he.os.android&&(e=2,n="Android ".concat(t)),{os:e,os_ver:n}},Is=e=>{let t="";try{e||(b.report312728(2),b.report309906(82),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("cpsProductData",JSON.stringify(e),{mid:"mmbizwap:cps_product_data",view:"wap_business"}));const n=JSON.parse(e).kvs;for(const e of n)"js_version"===e.key&&(t=e.value)}catch(cu){b.report312728(3)}return t||(b.report312728(1),t="v112"),t};async function Cs(){try{const e=await function(){const e=_e.getQuery("environment"),t="/mp/cps_product_info?action=GetCpsVersion&kol_uin_c=".concat(window.biz).concat(e?"&environment=1":"");return new Promise(((e,n)=>{pe({url:t,dataType:"json",async:!0,success(t){e(t)},error(e){n(e)}})}))}();if(e.cps_version){let t;const n=Is(e.cps_version),i=_e.getQuery("environment");return t=_e.getQuery("forcecpsversion")||n,i&&(t="test/".concat(t)),t}}catch(cu){console.error("getCpsFinalVersion error",cu)}}async function Ts({traceId:e,appId:t}){var n,i,o,a,r,s;try{const c=await function({appId:e,traceId:t}){const n={uin:window.user_uin,kol_uin:window.biz,cps_detail:JSON.stringify({device_info:Ss(),user_info:{media_specified_id:"".concat(window.user_uin)},kol_uin:window.biz,uin:"".concat(window.user_uin),req_infos:[{select_trace_id:t||Date.now().toString(),sku_id:"498_".concat(e),game_info:{app_id:e}}],extinfo:JSON.stringify({article:{uin:"".concat(window.user_uin),mid:window.mid,idx:window.idx,mode:303}})})};return new Promise(((e,t)=>{pe({url:"/mp/cps_product_info?action=Detail",type:"POST",dataType:"json",async:!0,data:n,success(t){e(t)},error(e){t(e)}})}))}({traceId:e,appId:t}),l=JSON.parse(null==c?void 0:c.detailrsp);if(0===(null==l?void 0:l.ret)){const e=await(s=null==(a=null==(o=null==(i=null==(n=null==l?void 0:l.detail_info)?void 0:n[0])?void 0:i.game_info)?void 0:o.video_info)?void 0:a.video_uid,new Promise(((e,t)=>{pe({url:"/mp/cps_product_info?action=minigame_vid&vid=".concat(s),type:"GET",dataType:"json",success(t){e(t)},error(e){t(e)}})})));0===(null==(r=null==e?void 0:e.base_resp)?void 0:r.ret)&&(l.video_url=null==e?void 0:e.video_url)}return l}catch(cu){console.error("getAllMiniGameData error: ",cu)}}async function As({srcAppid:e,dramaId:t,planId:n,playAppid:i,traceId:o,mode:a}){return new Promise(((r,s)=>{pe({type:"POST",url:"/mp/mini_drama_info?action=link",data:{kol_uin:window.biz,uin:window.user_uin,cps_detail:JSON.stringify({device_info:Ss(),extinfo:JSON.stringify({article:{uin:"".concat(window.user_uin),mid:window.mid,idx:window.idx,mode:a}}),kol_uin:window.biz,req_infos:[{app_id:i,drama_info:{drama_id:t,src_appid:e},plan_id:n,promoter_id:window.biz,select_trace_id:o||Date.now().toString()}],uin:"".concat(window.user_uin),user_info:{media_specified_id:"".concat(window.user_uin)}})},success(e){var t;0===(null==(t=null==(e=JSON.parse(e))?void 0:e.base_resp)?void 0:t.ret)?r(e.data):(s(),b.report312728(13))},error(e){b.report312728(14),s(e)}})}))}async function Es({playAppid:e,srcAppid:t,mediaNo:n,dramaId:i}){return new Promise(((o,a)=>{pe({type:"POST",url:"/mp/mini_drama_info?action=play_info",data:{appid:e,src_appid:t,media_no:n,drama_id:i},success(e){o(e)},error(e){a(e)}})}))}function Ps({dramaInfo:e,cover:t,playUrl:n,width:i,height:o,duration:a,cpsReportId:r,wrpWidth:s,wrpHeight:c,canFullscreen:l,customFullscreenAction:d,alwaysShowControl:u,cpsCardType:p=1,hideDuration:m=!1}){const h=document.createElement("div");h.setAttribute("class","video_cps_wrp"),h.setAttribute("style","width: ".concat(s,"px;height: ").concat(c,"px;")),h.setAttribute("slot","cps-video-component");const _=document.createElement("div");_.id="js_cps_video",h.appendChild(_);const f=function(e){const t=(e.el instanceof Element?e.el:document.querySelector(e.el)).parentNode;return new ks({el:e.el,opt:{cover:e.cover,playUrl:e.playUrl,plugins:e.plugins||[],width:+e.wrpWidth||t.offsetWidth,height:+e.wrpHeight||t.offsetHeight,videoWidth:e.width||0,videoHeight:e.height||0,duration:e.duration||0,muted:e.muted||!1,extInfo:e.extInfo,autoplayWhenExpose:e.autoplayWhenExpose,canFullscreen:e.canFullscreen||!1,customFullscreenAction:e.customFullscreenAction,alwaysShowControl:e.alwaysShowControl,hideDuration:e.hideDuration||!1,cgiData:window.cgiData,preview:!(1*window.is_temp_url!=1),__biz:window.cgiData.biz,uin:window.cgiData.uin||window.user_uin,mid:window.cgiData.mid,idx:window.cgiData.idx,loop:!0,scene_type:6,autoplay:!1,flowNotice:!1,useFeFullscreen:!0},store:xs()})}({el:_,width:i,height:o,wrpWidth:s,wrpHeight:c,duration:a,cover:t,playUrl:n,plugins:[Ot],muted:!0,autoplayWhenExpose:!0,extInfo:{dramaInfo:e},canFullscreen:l,customFullscreenAction:d,alwaysShowControl:u,hideDuration:m}),g=e=>({BizUin:window.biz,MsgId:+window.mid,Idx:+window.idx,PlayletCpsIdStr:r,SessionId:window.sessionid,EnterId:+window.enterid,EventTime:parseInt(1e3*f.getCurrentTime(),10),PlayTime:f.getRealPlayTime(),Duration:parseInt(1e3*f.getVideoDuration(),10),PageUrl:window.location.href,IsFans:window.isFans+1,CpsCardType:p,...e}),w=e=>{const t=g(e);console.log("cps video report 32253",e.EventType,t),me.report(32253,t)};return f.$on("player-expose",(()=>{f.__hasReportExpose||(w({EventType:1}),f.__hasReportExpose=!0)})),f.$on("click-play-switch",(e=>{w({EventType:e?3:2}),e&&w({EventType:10})})),f.$on("end",(()=>w({EventType:4}))),f.$on("replay",(()=>w({EventType:5}))),f.$on("seeking-status-change",(e=>!e&&w({EventType:6}))),f.$on("mute-change",(e=>w({EventType:e?8:7}))),f.$on("expose-auto-play",(()=>w({EventType:9}))),f.$on("cover-next-show-status-change",(e=>e&&w({EventType:13}))),f.$on("cover-next-click",(e=>e&&w({EventType:14}))),me.leaveReport(32253,(()=>g({EventType:16}))),{videoPlayer:f,dom:h,report32253:w}}const Rs=(e,t)=>{const n=document.createElement(t);Array.from(e.attributes).forEach((e=>n.setAttribute(e.name,e.value)));const{parentNode:i}=e;return i&&i.replaceChild(n,e),n};function Ds(e,t,n=(()=>{})){if(e&&!zt("mp-common-cpsad")){if(!ke.isOnlyWechat)return b.report312728(19),void alert("Open Mini Program in Weixin");t.sceneNote?t.sceneNote+=":".concat(window.source_appid):t.sceneNote=window.source_appid,t.sourceAppId=window.source_appid,xe.invoke("openWeApp",t,n),Ms(St.CLICK_AD_ACTION,"",e.shadowRoot.querySelector("iframe"))}}function js(e,t){var n;const i=null==(n=e.shadowRoot)?void 0:n.querySelector(".cps_video_footer"),o=new IntersectionObserver(((e,n)=>{e.forEach((e=>{e.isIntersecting&&(t&&t(),n.unobserve(e.target))}))}));i&&o.observe(i)}const Os={LIST:"list",CARD:"card",MP_VIDEO_PLAY:"video-play"};function Bs(e,t){return"".concat(e," | ").concat(t)}function Ls(e,t,n){Ms(St.PROXY_CALLBACK_ACTION,{aid:e.aid,proxyId:e.proxyId,proxyData:t},n)}function Ns(e,t,n){if(-1===[St.CPS_AD_FRAME_DOMAIN].indexOf(e.origin))return;const{iframeEle:i,aid:o}=function(e,t){let n,i;for(const o in t)if(Object.hasOwnProperty.call(t,o)&&(n=t[o].shadowRoot.querySelector("iframe"),n&&n.contentWindow===e)){i=Number(o);break}return{aid:i,iframeEle:n}}(e.source,n);if(!i)return;const{action:a}=t,r=t.value||{};switch(a){case St.FRAME_READY:!function(e,t,n){const i=e[n],o=function(e){const{dataset:t}=e,n=t.adtype,i={};if(n===St.CPS_GOODS_TYPE.SHORT_PLAY){const{dramaid:o,srcappid:a,templateid:r,playappid:s,planid:c,defaultpath:l,traceid:d}=t,u=l?decodeURIComponent(l):"";r===Os.MP_VIDEO_PLAY&&(i.respInfo=e.shortPlayDataResp),Object.assign(i,{adType:n,dramaId:o,srcAppid:a,templateId:r,playAppid:s,planId:c,defaultPath:u,selectTraceId:d})}else if(n===St.CPS_GOODS_TYPE.MINI_GAME){const{appid:o,traceid:a,templateid:r,imgurl:s}=t;r===Os.MP_VIDEO_PLAY&&(i.respInfo=e.miniGameDataResp),Object.assign(i,{adType:n,appId:o,selectTraceId:a,templateId:r,selectedImg:s?decodeURIComponent(s):""})}else{const{pid:e,traceid:n,extinfo:o,templateid:a}=t;Object.assign(i,{traceId:n,goodsId:e,extInfo:o,templateId:a||"list"})}return i}(i);Object.assign(o,{aid:n,cpsVersion:i.getAttribute("data-cpsversion"),type:St.CPS_GOODS_TYPE.NEW_GOODS}),Ms(St.SET_PAGE_DATA_ACTION_NAME,{biz:window.biz,uin:window.uin,scene:window.scene,source:window.source,idx:window.idx,mid:window.mid,isSg:window.isSg,userUin:window.user_uin,sn:window.sn,appmsgid:window.appmsgid,sendTime:window.send_time||"",passTicket:decodeURIComponent(window.pass_ticket),itemShowType:window.item_show_type,bodyScrollTop:Oe.getScrollTop(),screenHeight:Oe.getInnerHeight(),adOffsetTop:s.getOffset(t).offsetTop,createIframeTime:Date.now(),pageUrl:location.href,heightWidthRate:9/16,boundingClientRect:t.getBoundingClientRect(),type:St.CPS_GOODS_TYPE.NEW_GOODS,skin:_e.getQuery("color_scheme")},t),Ms(St.SET_AD_DATA_ACTION_NAME,{goodsInfo:o,type:St.CPS_GOODS_TYPE.NEW_GOODS,hideAdMark:window.hideAdMarkOnCps},t)}(n,i,o);break;case St.PROXY_ACTION:!function(e,t,n){var i,o;if("jsapi"===e.proxyType)return void function(e,t){const n=e.proxyData||{},i=function(e){const t=e.proxyData||{},{methodName:n}=t;if(-1===St.AD_JSAPI_WHITE_LIST.indexOf(n))return Bs(St.INVALID_METHOD_NAME_MSG_PREFIX,n);return!0}(e);if("string"==typeof i)return void Ls(e,{err_msg:i},t);const o=i=>{Ls(e,i,t),"openUrlWithExtraWebview"===n.methodName&&-1===i.err_msg.indexOf("ok")&&(location.href=n.args.url)};try{if("on"===n.methodType)xe[n.methodType](n.methodName,o);else{if("openWeApp"===n.methodName||"openEmbeddedWeApp"===n.methodName){let{sceneNote:e}=n.args;if(e?e+=":".concat(window.source_appid):e=window.source_appid,n.args.sceneNote=e,n.args.sourceAppId=window.source_appid,zt("mp-common-cpsad"))return}"openEmbeddedWeApp"===n.methodName&&(ke.isIOS&&ke.gtVersion("8.0.42",!0)||ke.isAndroid&&ke.gtVersion("8.0.42",!0))?xe[n.methodType]("openEmbeddedWeApp",Object.assign({modalHeightRatio:.8,allowFullScreen:!0,blurMask:!1},n.args),(e=>{e&&e.err_msg&&-1!==e.err_msg.indexOf(":ok")?o(e):xe[n.methodType]("openWeApp",n.args,o)})):("openEmbeddedWeApp"===n.methodName&&(n.methodName="openWeApp"),xe[n.methodType](n.methodName,n.args,o))}}catch(a){console.error(a),Ls(e,{err_msg:Bs(St.INVALID_METHOD_TYPE_MSG_PREFIX,n.methodType)},t)}"adDataReport"===n.methodName&&1===n.args.need_record_page_operation&&b.report115849(41)}(e,t);const a=e.proxyData||{};if("bizapi"===e.proxyType){if("request"===a.methodName)return void function(e,t){const n=e.proxyData||{},i=n.args||{};if(-1===St.AD_REQ_PATH_WHITE_LIST.indexOf(i.path))return void Ls(e,{err_msg:Bs(St.INVALID_REQ_PATH_MSG_PREFIX,i.path)},t);pe({type:i.requestType,url:"".concat(i.path,"?").concat(i.requestQuery||""),data:i.requestBody||{},mayAbort:!0,success:n=>{Ls(e,{err_msg:"request:success",response:n},t)},error:(n,i)=>{Ls(e,{err_msg:"request:error",xhr:n,err_info:i},t)}})}(e,t);if("addIdKeyReport"===a.methodName)return void ue.setSum(a.args.id,a.args.key,a.args.val);if("addBadJsReport"===a.methodName)null==(o=null==(i=window.WX_BJ_REPORT)?void 0:i.BadJs)||o.report("AdFrameError:".concat(a.args.id),a.args.msg)}}(r,i,n[o]);break;case St.CHANGE_FRAME_STYLE:!function(e,t,n){!1===e.display&&(n.style.display="none");if(e.height){const i=e.height.slice&&"px"===e.height.slice(-2)||"number"==typeof e.height?"".concat(Math.ceil(parseFloat(e.height,10)),"px"):e.height;t.style.height=i,function(e){const t=e.getAttribute("data-planid"),n=e.getAttribute("data-pid"),i=e.getAttribute("data-traceid"),o={compEle:e,compType:"mp-common-cpsad",compIdx:Array.from(document.querySelectorAll("mp-common-cpsad")).indexOf(e)};Re.renderCompSilentlyPreHandler(o),Kt(e,t||n||i||""),Re.renderCompSilently(o)}(n)}if(e.width){const n=e.width.slice&&"px"===e.width.slice(-2)||"number"==typeof e.width?"".concat(Math.ceil(parseFloat(e.width,10)),"px"):e.width;t.style.width=n}}(r,i,n[o]);break;case St.PROXY_CONSOLE:!function(e){const{method:t,data:n}=e;if("function"==typeof console[t]){const e=[].concat(n);console[t](...e)}}(r)}}function Ms(e,t,n){const i=n.contentWindow;i&&b.postMessage(i,e,t,St.CPS_AD_FRAME_DOMAIN)}const qs={tagName:"mp-common-cpsad",oldTagName:"mpcps",cpsVersion:"",iframeMap:{}},Ws=document.getElementById("js_article"),zs=document.getElementById("content_bottom_interaction"),Fs=!!window.is_login;function Us(){const e=document.querySelectorAll("".concat(qs.oldTagName,",").concat(qs.tagName));0!==e.length&&Cs().then((t=>{t&&(e.forEach((e=>{e.tagName.toLowerCase()===qs.oldTagName&&(e=Rs(e,qs.tagName));const n=Math.ceil(1e4*Math.random());qs.iframeMap[n]=e;const{templateid:i,adtype:o}=e.dataset;i===Os.MP_VIDEO_PLAY?o===St.CPS_GOODS_TYPE.SHORT_PLAY?function(e,t){const{dramaid:n,srcappid:i,planid:o,parentwidth:a,playappid:r,mediano:s,defaultpath:c,traceid:l=""}=e.dataset;(async function({srcAppid:e,dramaId:t,playAppid:n,mediaNo:i,planId:o,traceId:a}){try{let r,s=203;if(i){const[c,l]=await Promise.all([Es({srcAppid:e,dramaId:t,playAppid:n,mediaNo:i}),As({dramaId:t,srcAppid:e,playAppid:n,planId:o,traceId:a,mode:s})]);r={shortPlayDataResp:JSON.parse(l),videoResp:JSON.parse(c)},b.report312728(16)}else{s=205;const i=await As({dramaId:t,srcAppid:e,playAppid:n,planId:o,traceId:a,mode:s});r={shortPlayDataResp:JSON.parse(i)},b.report312728(17)}return r}catch(cu){console.error("getAllShortPlayData error: ",cu)}})({dramaId:n,srcAppid:i,playAppid:r,mediaNo:s,planId:o,traceId:l}).then((n=>{var i;const{shortPlayDataResp:l,videoResp:d}=n;let u,p;0===(null==l?void 0:l.ret)?(u=function(e){var t,n,i;const o=(null==(t=e.detail_info[0])?void 0:t.drama_info)||{},{cover_url:a,drama_name:r,media_count:s,theme:c,ext:{hot_degree:l},status:d}=o,u=(null==(n=e.detail_info[0])?void 0:n.wx_miniprogram_link)||"",p=(null==(i=e.detail_info[0])?void 0:i.wx_miniprogram_app_username)||"",m={dramaCoverUrl:a,dramaName:r,dramaNum:s,categoryName:c.replace(/、/g,"/"),hotView:l,status:d,path:u,userName:p};return u||b.report312728(14),m}(l),e.shortPlayDataResp=l,p=s&&0===(null==(i=null==d?void 0:d.base_resp)?void 0:i.ret)?function(e){const{coverurl:t,duration:n,jump_appid:i,video_url:o,height:a,width:r}=e;return{videoCoverUrl:t,duration:n,jumpAppid:i,videoPlayUrl:o,videoWidth:r,videoHeight:a}}(d):{videoCoverUrl:e.getAttribute("data-materialcoverurl"),videoPlayUrl:e.getAttribute("data-materialurl")}):b.report312728(18),u.path||b.report312728(20);const m={relativeURL:decodeURIComponent(u.path||c),appId:r,scene:1091,userName:u.userName},h=e=>{var t,n,i;-1===(null==(t=null==e?void 0:e.err_msg)?void 0:t.indexOf("ok"))?(ue.setSum(309906,41,1),null==(i=null==(n=window.WX_BJ_REPORT)?void 0:n.BadJs)||i.report("AdFrameError:PROXY_ID_JUMP_SHORT_PLAY","errMsg:".concat(JSON.stringify(e.err_msg)))):ue.setSum(309906,42,1)},_={drama_name:u.dramaName,total_num:u.dramaNum,cover_url:u.dramaCoverUrl,drama_class:u.categoryName,hot_view:u.hotView,appid:r,jump_path:u.path||decodeURIComponent(c),ban:2===u.status};if(2===u.status)return void e.setAttribute("data-banvideo",1);const{dom:f,report32253:g,videoPlayer:w}=Ps({cpsReportId:o,dramaInfo:_,cover:p.videoCoverUrl,playUrl:p.videoPlayUrl,duration:p.duration||0,width:p.videoWidth||0,height:p.videoHeight||0,wrpWidth:a,wrpHeight:a,canFullscreen:!0,alwaysShowControl:!1,hideDuration:!0,customFullscreenAction:()=>{Ds(e,m,h),g({EventType:15})}});w&&w.$on("cover-next-click",(()=>{Ms(St.CLICK_AD_ACTION,"",e.shadowRoot.querySelector("iframe"))})),e.setAttribute("data-videocarddata",JSON.stringify({videoCoverUrl:u.dramaCoverUrl,name:u.dramaName,categoryInfo:"".concat(u.dramaNum,"集"),categoryName:u.categoryName})),e.addEventListener("click",(t=>{(t.composedPath()||[]).some((e=>{var t;return null==(t=e.classList)?void 0:t.contains("cps_video_footer")}))&&(Ds(e,m,h),g({EventType:12}))})),js(e,(()=>{g({EventType:11})})),e.appendChild(f),e.setAttribute("data-cpsversion",t),e.setAttribute("data-ready",1)})).catch((e=>{console.error("getShortPlayData err: ",e)}))}(e,t):o===St.CPS_GOODS_TYPE.MINI_GAME&&function(e,t){const{appid:n,traceid:i,parentwidth:o,videorate:a}=e.dataset;Ts({traceId:i,appId:n}).then((r=>{var s,c,l,d,u,p,m,h,_,f,g,w,y,v;e.miniGameDataResp=r;const b=null==(s=null==r?void 0:r.detail_info)?void 0:s[0],k={relativeURL:(null==b?void 0:b.wx_miniprogram_link)||"",appId:n,scene:1311,userName:(null==b?void 0:b.wx_miniprogram_app_username)||"",sceneNote:"".concat(window.biz,":").concat(window.mid,":").concat(window.idx)},x={drama_name:null==(c=null==b?void 0:b.game_info)?void 0:c.name,cover_url:null==(l=null==b?void 0:b.game_info)?void 0:l.logo,drama_class:(null==(d=null==b?void 0:b.game_info)?void 0:d.brief_intro)||(null==(u=null==b?void 0:b.game_info)?void 0:u.description),appid:null==(p=null==b?void 0:b.game_info)?void 0:p.app_id,jump_path:k.relativeURL,banStatue:0,cover_style:{width:"48px",height:"48px",margin:"16px 0 16px 16px"},cover_next_info_style:{borderRadius:"8px"},ban:2===(null==(m=null==b?void 0:b.game_info)?void 0:m.status)};if(2===(null==(h=null==b?void 0:b.game_info)?void 0:h.status))return void e.setAttribute("data-banvideo",1);const S=function(e){return Math.max(1,Math.min(16/9,e))}(a)||16/9,{dom:I,videoPlayer:C,report32253:T}=Ps({cpsReportId:i,dramaInfo:x,cover:null==(f=null==(_=null==b?void 0:b.game_info)?void 0:_.video_info)?void 0:f.cover_img_url,playUrl:null==r?void 0:r.video_url,duration:0,width:0,height:0,wrpWidth:o,wrpHeight:S>1?o/S:o,canFullscreen:!0,cpsCardType:2,hideDuration:!0,customFullscreenAction:()=>{Ds(e,k),T({EventType:15})}});C&&C.$on("cover-next-click",(()=>{Ms(St.CLICK_AD_ACTION,"",e.shadowRoot.querySelector("iframe"))})),e.setAttribute("data-videocarddata",JSON.stringify({videoCoverUrl:null==(w=null==(g=null==b?void 0:b.game_info)?void 0:g.video_info)?void 0:w.cover_img_url,name:null==(y=null==b?void 0:b.game_info)?void 0:y.name,categoryInfo:null==(v=null==b?void 0:b.game_info)?void 0:v.category_3_name,categoryName:"小游戏"})),e.addEventListener("click",(t=>{(t.composedPath()||[]).some((e=>{var t;return null==(t=e.classList)?void 0:t.contains("cps_video_footer")}))&&(Ds(e,k),T({EventType:12}))})),js(e,(()=>{T({EventType:11})})),e.appendChild(I),e.setAttribute("data-cpsversion",t),e.setAttribute("data-ready",1)})).catch((e=>{console.error("getAllMiniGameData err: ",e)}))}(e,t):(e.setAttribute("data-cpsversion",t),e.setAttribute("data-ready",1))})),function(e,t,n,...i){const o=e=>{let o;if(!t||e.origin===t){if("object"!=typeof e.data)try{o=JSON.parse(e.data)}catch(a){return}else o=e.data;"function"==typeof n&&n(e,o,...i)}};e.addEventListener("message",o)}(window,St.CPS_AD_FRAME_DOMAIN,Ns,qs.iframeMap))})).catch((e=>{console.error("initArticleCps error:",e)}))}function Hs(){window.addEventListener&&window.addEventListener("load",(function(){window.__moonsafe_mutation_report_keys||(window.__moonsafe_mutation_report_keys={});const e=window.moon&&window.moon.moonsafe_id||29715,t=window.moon&&window.moon.moonsafe_key||0;let n=[],i={};const o=function(e,t,o){o=o||1,i[e]||(i[e]=0),i[e]+=o,t&&(!function(e){return"[object Array]"==Object.prototype.toString.call(e)}(t)?n.push(t):n=n.concat(t)),setTimeout((function(){a()}),1500)},a=function(){const o=[],r=n.length,s=["r="+Math.random()];for(const n in i)i.hasOwnProperty(n)&&o.push(e+"_"+(1*n+1*t)+"_"+i[n]);for(let e=0;e<r&&!(e>=10);++e)s.push("log"+e+"="+encodeURIComponent(n[e]));if(0==o.length&&s.length<=1)return;const c="idkey="+o.join(";")+"&lc="+(s.length-1)+"&"+s.join("&");let l;if(window.ActiveXObject)try{l=new ActiveXObject("Msxml2.XMLHTTP")}catch(su){try{l=new ActiveXObject("Microsoft.XMLHTTP")}catch(d){l=!1}}else window.XMLHttpRequest&&(l=new XMLHttpRequest);l&&(l.open("POST",location.protocol+"//mp.weixin.qq.com/mp/jsmonitor?",!0),l.setRequestHeader("cache-control","no-cache"),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.onreadystatechange=function(){4===l.readyState&&(n.length>10?(n=n.slice(10),a()):(n=[],i={}))},n=[],i={},l.send(c))};try{if(!window.__observer)return;const e=window.__observer_data;if(window.__observer.takeRecords){const t=window.__observer.takeRecords();if(t&&t.length){e.count++;const n=new Date;t.forEach((function(t){const n=t.addedNodes;for(let i=0;i<n.length;i++){const t=n[i];if("SCRIPT"===t.tagName){const n=t.src;!n||/qq\.com/.test(n)||/weishi\.com/.test(n)||e.list.push(n)}}})),e.exec_time+=new Date-n}}window.__observer.disconnect();const t=window.__moonsafe_mutation_report_keys.observer||2,n=window.__moonsafe_mutation_report_keys.script_src||8,i=window.__moonsafe_mutation_report_keys.setattribute||9,a=window.__moonsafe_mutation_report_keys.ajax||10,r=25;for(let c=0;c<e.list.length;c++){const n=e.list[c],i=["[moonsafe][observer][url]:"+location.href,"[moonsafe][observer][src]:"+n,"[moonsafe][observer][ua]:"+navigator.userAgent];e.list.length==c+1&&(i.push("[moonsafe][observer][count]:"+e.count),i.push("[moonsafe][observer][exec_time]:"+e.exec_time+"ms")),o(t,i),"inlinescript_without_nonce"==n&&o(r,i)}const s=window.__danger_src;if(s){const e=[{key:"xmlhttprequest",idkey:a},{key:"script_src",idkey:n},{key:"script_setAttribute",idkey:i}];for(let t=0;t<e.length;t++){const n=e[t].key,i=s[n];if(i&&i.length)for(let a=0;a<i.length;a++){const r=["[moonsafe]["+n+"][url]:"+location.href,"[moonsafe]["+n+"][src]:"+i[a],"[moonsafe]["+n+"][ua]:"+navigator.userAgent];o(e[t].idkey,r)}}}}catch(su){o(3,["[moonsafe][observer][exception]:"+su])}}),!1)}Ws&&Ws.addEventListener("click",(()=>{for(const e in qs.iframeMap)Ms(St.CLICK_OUTSIDE_ACTION,"",qs.iframeMap[e])})),Oe.bindDebounceScrollEvent((()=>{const e=Oe.getScrollTop();let t=Oe.getInnerHeight();if(Fs&&zs){const e=Math.floor(null==zs?void 0:zs.getBoundingClientRect().height)||0;t=Oe.getInnerHeight()-e}let n=!1;try{const i=e+t;for(const t in qs.iframeMap){const o=qs.iframeMap[t].shadowRoot.querySelector("iframe"),a=s.getOffset(o).offsetTop;if(("play"===o.contentWindow.videoStatus||"loading"===o.contentWindow.videoStatus)&&i>a&&e<a+o.offsetHeight){n=!0;break}}}catch(i){}for(const o in qs.iframeMap){const i=qs.iframeMap[o].shadowRoot.querySelector("iframe");if(!i)continue;const a=s.getOffset(i).offsetTop;Ms(St.PAGE_SCROLL_ACTION,{bodyScrollTop:e,adOffsetTop:a,screenHeight:t,hasVideoPlayingInScreen:n,boundingClientRect:i.getBoundingClientRect()},i)}}));const Vs=pt({props:{show:{type:Boolean,default:!1},tipsWording:{type:String,default:""}},model:{prop:"show",event:"change"},methods:{display(){this.$emit("change",!0)},hide(){this.$emit("change",!1)}}},(function(){var e=this;return(0,e._self._c)("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"tips",attrs:{role:"alert"}},[e._v(e._s(e.tipsWording))])}),[],!1,null,"e2eb5158",null,null).exports;function Ks(e,t=1){const n=e/1e3;if(n<0)return 1===t?"0秒":"00:00";if(n<60)return 1===t?"".concat(parseInt(n,10),"秒"):"00:".concat(String(parseInt(n,10)).padStart(2,"0"));const i=n/60,o=parseInt(n%60,10);if(i>=60&&1===t){const e=parseInt(i/60,10),n=parseInt(i-60*e,10);return 0===n&&1===t?"".concat(e,"小时"):1===t?"".concat(e,"小时").concat(n,"分钟"):"".concat(String(e).padStart(2,"0"),":").concat(String(n).padStart(2,"0"),":").concat(String(o).padStart(2,"0"))}return 1===t?"".concat(parseInt(i,10),"分钟"):"".concat(String(parseInt(i,10)).padStart(2,"0"),":").concat(String(o).padStart(2,"0"))}function $s(e){return-1!==[0,1,2,3,4,10,11].indexOf(e)}const Js=pt({inject:["version","supportSetShutdown"],filters:{durationNumFormatter:e=>Ks(e,2)},props:{show:{type:Boolean,default:!0},isPlaying:{type:Boolean,default:!1},hasSetShutDown:{type:Boolean,default:!1},playRate:{type:Number,default:1},duration:{type:Number,default:0},currentTime:{type:Number,default:0}},data:()=>({moving:!1}),computed:{playRateWording(){return 1!==this.playRate&&"number"==typeof this.playRate?100*this.playRate%10==0?"".concat(this.playRate.toFixed(1),"倍"):"".concat(this.playRate.toFixed(2),"倍"):"倍速"}},methods:{onTouchStart(e){e.pageX<20||!this.$refs.progress||(this.moving=!0,this.__rect=this.$refs.progress.getBoundingClientRect(),this.__nowPlaying=this.info,this.$emit("seek"),document.addEventListener("touchmove",this.onTouchMove,{capture:!0}),document.addEventListener("touchend",this.onTouchEnd,{capture:!0}))},onTouchMove(e){var t,n;if(!this.moving||!this.__rect)return;const i=e.pageX||(null==(n=null==(t=e.changedTouches)?void 0:t[0])?void 0:n.pageX)||0,o=this.getTouchPercent(i,this.__rect),a=this.duration*o/1e3;return this.$emit("seeking",a),e.preventDefault(),e.stopPropagation(),!1},onTouchEnd(e){var t,n;if(!this.moving||!this.__rect)return;const i=e.pageX||(null==(n=null==(t=e.changedTouches)?void 0:t[0])?void 0:n.pageX)||0,o=this.getTouchPercent(i,this.__rect),a=this.duration*o/1e3;return this.$emit("seeked",a),this.moving=!1,document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd),e.preventDefault(),e.stopPropagation(),!1},getTouchPercent:(e,t)=>Math.max(0,Math.min(1,(e-t.left)/t.width))}},(function(){var e=this,t=e._self._c;return t("div",{staticClass:"card-item__operate-area"},[t("div",{staticClass:"card-item__progress-bar-wrp",style:"--percent: ".concat(100*(e.currentTime?1e3*e.currentTime/e.duration:0),"%")},[t("div",{ref:"progress",staticClass:"card-item__progress-bar",class:e.moving?"active":"",attrs:{role:"progressbar"}}),t("div",{staticClass:"card-item__progress-active-area js_wx_tap_highlight_exclude",attrs:{"aria-hidden":"true"},on:{"!touchstart":function(t){return t.stopPropagation(),t.preventDefault(),e.onTouchStart.apply(null,arguments)}}}),t("div",{staticClass:"card-item__time-info"},[t("span",{attrs:{role:"timer"}},[e._v(e._s(e._f("durationNumFormatter")(1e3*e.currentTime||0)))]),e.duration&&e.currentTime?t("span",{attrs:{role:"timer"}},[e._v("-"+e._s(e._f("durationNumFormatter")(e.duration-1e3*e.currentTime)))]):e.duration?t("span",{attrs:{role:"timer"}},[e._v("-"+e._s(e._f("durationNumFormatter")(e.duration)))]):e._e()])]),t("div",{staticClass:"card-item__btn-wrp"},[t("div",{staticClass:"card-item__btn-group rate-group"},[t("div",{staticClass:"card-item__btn-playback-rate js_wx_tap_highlight",attrs:{role:"button",tabindex:"0"},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),(()=>e.$emit("change-rate")).apply(null,arguments)}}},[e._v(e._s(e.playRateWording))])]),t("div",{staticClass:"card-item__btn-group playing-group"},[t("div",{staticClass:"card-item__btn-back-15s js_wx_tap_highlight icon-play-backward",attrs:{role:"button",tabindex:"0"},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),(()=>e.$emit("backward")).apply(null,arguments)}}}),t("div",{staticClass:"card-item__btn-play js_wx_tap_highlight_exclude",class:e.isPlaying?"icon-pause":"icon-play",attrs:{role:"button",tabindex:"0"},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),(()=>e.$emit("toggle-play")).apply(null,arguments)}}}),t("div",{staticClass:"card-item__btn-forward-30s js_wx_tap_highlight icon-play-forward",attrs:{role:"button",tabindex:"0"},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),(()=>e.$emit("forward")).apply(null,arguments)}}})]),e.supportSetShutdown?t("div",{staticClass:"card-item__btn-group shutdown-group"},[t("div",{staticClass:"card-item__btn-set-shutdown js_wx_tap_highlight",class:e.hasSetShutDown?"icon-set-shutdown-done":"icon-set-shutdown",attrs:{role:"button",tabindex:"0","aria-haspopup":"true"},on:{"!click":function(t){return t.stopPropagation(),t.preventDefault(),(t=>e.$emit("set-shutdown",t.target)).apply(null,arguments)}}})]):e._e()])])}),[],!1,null,"82304cab",null,null).exports;var Gs=Object.defineProperty,Ys=Object.getOwnPropertySymbols,Xs=Object.prototype.hasOwnProperty,Qs=Object.prototype.propertyIsEnumerable,Zs=(e,t,n)=>t in e?Gs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ec=(e,t)=>{for(var n in t||(t={}))Xs.call(t,n)&&Zs(e,n,t[n]);if(Ys)for(var n of Ys(t))Qs.call(t,n)&&Zs(e,n,t[n]);return e},tc=(e,t)=>{var n={};for(var i in e)Xs.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&Ys)for(var i of Ys(e))t.indexOf(i)<0&&Qs.call(e,i)&&(n[i]=e[i]);return n};const nc=window.Vue.getCurrentInstance,ic=window.Vue.unref,oc=window.Vue.watch,ac=window.Vue.onUnmounted,rc=window.Vue.onMounted,sc=window.Vue.nextTick,cc=window.Vue.isRef,lc=window.Vue.defineComponent,dc=window.Vue.computed,uc=window.Vue.toRefs,pc=window.Vue.ref,mc=window.Vue.reactive,hc=window.Vue.h;window.Vue.isProxy;const _c="[vue-draggable-plus]: ";function fc(e,t,n){return n>=0&&n<e.length&&e.splice(n,0,e.splice(t,1)[0]),e}function gc(e,t){return Array.isArray(e)&&e.splice(t,1),e}function wc(e,t,n){return Array.isArray(e)&&e.splice(t,0,n),e}function yc(e,t,n){const i=e.children[n];e.insertBefore(t,i)}function vc(e){e.parentNode&&e.parentNode.removeChild(e)}function bc(e,t=document){var n;let i=null;return i="function"==typeof(null==t?void 0:t.querySelector)?null==(n=null==t?void 0:t.querySelector)?void 0:n.call(t,e):document.querySelector(e),i||function(e){console.warn(_c+e)}("Element not found: ".concat(e)),i}function kc(e,t){Object.keys(e).forEach((n=>{t(n,e[n])}))}const xc=Object.assign;
/**!
 * Sortable 1.15.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function Sc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ic(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sc(Object(n),!0).forEach((function(t){Tc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Cc(e){return(Cc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ac(){return Ac=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ac.apply(this,arguments)}function Ec(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function Pc(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var Rc=Pc(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),Dc=Pc(/Edge/i),jc=Pc(/firefox/i),Oc=Pc(/safari/i)&&!Pc(/chrome/i)&&!Pc(/android/i),Bc=Pc(/iP(ad|od|hone)/i),Lc=Pc(/chrome/i)&&Pc(/android/i),Nc={capture:!1,passive:!1};function Mc(e,t,n){e.addEventListener(t,n,!Rc&&Nc)}function qc(e,t,n){e.removeEventListener(t,n,!Rc&&Nc)}function Wc(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(n){return!1}return!1}}function zc(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function Fc(e,t,n,i){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&Wc(e,t):Wc(e,t))||i&&e===n)return e;if(e===n)break}while(e=zc(e))}return null}var Uc,Hc=/\s+/g;function Vc(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var i=(" "+e.className+" ").replace(Hc," ").replace(" "+t+" "," ");e.className=(i+(n?" "+t:"")).replace(Hc," ")}}function Kc(e,t,n){var i=e&&e.style;if(i){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];!(t in i)&&-1===t.indexOf("webkit")&&(t="-webkit-"+t),i[t]=n+("string"==typeof n?"":"px")}}function $c(e,t){var n="";if("string"==typeof e)n=e;else do{var i=Kc(e,"transform");i&&"none"!==i&&(n=i+" "+n)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function Jc(e,t,n){if(e){var i=e.getElementsByTagName(t),o=0,a=i.length;if(n)for(;o<a;o++)n(i[o],o);return i}return[]}function Gc(){return document.scrollingElement||document.documentElement}function Yc(e,t,n,i,o){if(e.getBoundingClientRect||e===window){var a,r,s,c,l,d,u;if(e!==window&&e.parentNode&&e!==Gc()?(r=(a=e.getBoundingClientRect()).top,s=a.left,c=a.bottom,l=a.right,d=a.height,u=a.width):(r=0,s=0,c=window.innerHeight,l=window.innerWidth,d=window.innerHeight,u=window.innerWidth),(t||n)&&e!==window&&(o=o||e.parentNode,!Rc))do{if(o&&o.getBoundingClientRect&&("none"!==Kc(o,"transform")||n&&"static"!==Kc(o,"position"))){var p=o.getBoundingClientRect();r-=p.top+parseInt(Kc(o,"border-top-width")),s-=p.left+parseInt(Kc(o,"border-left-width")),c=r+a.height,l=s+a.width;break}}while(o=o.parentNode);if(i&&e!==window){var m=$c(o||e),h=m&&m.a,_=m&&m.d;m&&(c=(r/=_)+(d/=_),l=(s/=h)+(u/=h))}return{top:r,left:s,bottom:c,right:l,width:u,height:d}}}function Xc(e,t,n){for(var i=nl(e,!0),o=Yc(e)[t];i;){if(!(o>=Yc(i)[n]))return i;if(i===Gc())break;i=nl(i,!1)}return!1}function Qc(e,t,n,i){for(var o=0,a=0,r=e.children;a<r.length;){if("none"!==r[a].style.display&&r[a]!==rd.ghost&&(i||r[a]!==rd.dragged)&&Fc(r[a],n.draggable,e,!1)){if(o===t)return r[a];o++}a++}return null}function Zc(e,t){for(var n=e.lastElementChild;n&&(n===rd.ghost||"none"===Kc(n,"display")||t&&!Wc(n,t));)n=n.previousElementSibling;return n||null}function el(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"!==e.nodeName.toUpperCase()&&e!==rd.clone&&(!t||Wc(e,t))&&n++;return n}function tl(e){var t=0,n=0,i=Gc();if(e)do{var o=$c(e),a=o.a,r=o.d;t+=e.scrollLeft*a,n+=e.scrollTop*r}while(e!==i&&(e=e.parentNode));return[t,n]}function nl(e,t){if(!e||!e.getBoundingClientRect)return Gc();var n=e,i=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=Kc(n);if(n.clientWidth<n.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!n.getBoundingClientRect||n===document.body)return Gc();if(i||t)return n;i=!0}}}while(n=n.parentNode);return Gc()}function il(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function ol(e,t){return function(){if(!Uc){var n=arguments;1===n.length?e.call(this,n[0]):e.apply(this,n),Uc=setTimeout((function(){Uc=void 0}),t)}}}function al(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function rl(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function sl(e,t,n){var i={};return Array.from(e.children).forEach((function(o){var a,r,s,c;if(Fc(o,t.draggable,e,!1)&&!o.animated&&o!==n){var l=Yc(o);i.left=Math.min(null!==(a=i.left)&&void 0!==a?a:1/0,l.left),i.top=Math.min(null!==(r=i.top)&&void 0!==r?r:1/0,l.top),i.right=Math.max(null!==(s=i.right)&&void 0!==s?s:-1/0,l.right),i.bottom=Math.max(null!==(c=i.bottom)&&void 0!==c?c:-1/0,l.bottom)}})),i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}var cl="Sortable"+(new Date).getTime();function ll(){var e,t=[];return{captureAnimationState:function(){(t=[],this.options.animation)&&[].slice.call(this.el.children).forEach((function(e){if("none"!==Kc(e,"display")&&e!==rd.ghost){t.push({target:e,rect:Yc(e)});var n=Ic({},t[t.length-1].rect);if(e.thisAnimationDuration){var i=$c(e,!0);i&&(n.top-=i.f,n.left-=i.e)}e.fromRect=n}}))},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e[n][i])return Number(n);return-1}(t,{target:e}),1)},animateAll:function(n){var i=this;if(!this.options.animation)return clearTimeout(e),void("function"==typeof n&&n());var o=!1,a=0;t.forEach((function(e){var t=0,n=e.target,r=n.fromRect,s=Yc(n),c=n.prevFromRect,l=n.prevToRect,d=e.rect,u=$c(n,!0);u&&(s.top-=u.f,s.left-=u.e),n.toRect=s,n.thisAnimationDuration&&il(c,s)&&!il(r,s)&&(d.top-s.top)/(d.left-s.left)==(r.top-s.top)/(r.left-s.left)&&(t=function(e,t,n,i){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*i.animation}(d,c,l,i.options)),il(s,r)||(n.prevFromRect=r,n.prevToRect=s,t||(t=i.options.animation),i.animate(n,d,s,t)),t&&(o=!0,a=Math.max(a,t),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),t),n.thisAnimationDuration=t)})),clearTimeout(e),o?e=setTimeout((function(){"function"==typeof n&&n()}),a):"function"==typeof n&&n(),t=[]},animate:function(e,t,n,i){if(i){Kc(e,"transition",""),Kc(e,"transform","");var o=$c(this.el),a=o&&o.a,r=o&&o.d,s=(t.left-n.left)/(a||1),c=(t.top-n.top)/(r||1);e.animatingX=!!s,e.animatingY=!!c,Kc(e,"transform","translate3d("+s+"px,"+c+"px,0)"),this.forRepaintDummy=function(e){return e.offsetWidth}(e),Kc(e,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),Kc(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){Kc(e,"transition",""),Kc(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),i)}}}}var dl=[],ul={initializeByDefault:!0},pl={mount:function(e){for(var t in ul)ul.hasOwnProperty(t)&&!(t in e)&&(e[t]=ul[t]);dl.forEach((function(t){if(t.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")})),dl.push(e)},pluginEvent:function(e,t,n){var i=this;this.eventCanceled=!1,n.cancel=function(){i.eventCanceled=!0};var o=e+"Global";dl.forEach((function(i){t[i.pluginName]&&(t[i.pluginName][o]&&t[i.pluginName][o](Ic({sortable:t},n)),t.options[i.pluginName]&&t[i.pluginName][e]&&t[i.pluginName][e](Ic({sortable:t},n)))}))},initializePlugins:function(e,t,n,i){for(var o in dl.forEach((function(i){var o=i.pluginName;if(e.options[o]||i.initializeByDefault){var a=new i(e,t,e.options);a.sortable=e,a.options=e.options,e[o]=a,Ac(n,a.defaults)}})),e.options)if(e.options.hasOwnProperty(o)){var a=this.modifyOption(e,o,e.options[o]);void 0!==a&&(e.options[o]=a)}},getEventProperties:function(e,t){var n={};return dl.forEach((function(i){"function"==typeof i.eventProperties&&Ac(n,i.eventProperties.call(t[i.pluginName],e))})),n},modifyOption:function(e,t,n){var i;return dl.forEach((function(o){e[o.pluginName]&&o.optionListeners&&"function"==typeof o.optionListeners[t]&&(i=o.optionListeners[t].call(e[o.pluginName],n))})),i}};var ml=["evt"],hl=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.evt,o=Ec(n,ml);pl.pluginEvent.bind(rd)(e,t,Ic({dragEl:fl,parentEl:gl,ghostEl:wl,rootEl:yl,nextEl:vl,lastDownEl:bl,cloneEl:kl,cloneHidden:xl,dragStarted:Ll,putSortable:El,activeSortable:rd.active,originalEvent:i,oldIndex:Sl,oldDraggableIndex:Cl,newIndex:Il,newDraggableIndex:Tl,hideGhostForTarget:nd,unhideGhostForTarget:id,cloneNowHidden:function(){xl=!0},cloneNowShown:function(){xl=!1},dispatchSortableEvent:function(e){_l({sortable:t,name:e,originalEvent:i})}},o))};function _l(e){!function(e){var t=e.sortable,n=e.rootEl,i=e.name,o=e.targetEl,a=e.cloneEl,r=e.toEl,s=e.fromEl,c=e.oldIndex,l=e.newIndex,d=e.oldDraggableIndex,u=e.newDraggableIndex,p=e.originalEvent,m=e.putSortable,h=e.extraEventProperties;if(t=t||n&&n[cl]){var _,f=t.options,g="on"+i.charAt(0).toUpperCase()+i.substr(1);!window.CustomEvent||Rc||Dc?(_=document.createEvent("Event")).initEvent(i,!0,!0):_=new CustomEvent(i,{bubbles:!0,cancelable:!0}),_.to=r||n,_.from=s||n,_.item=o||n,_.clone=a,_.oldIndex=c,_.newIndex=l,_.oldDraggableIndex=d,_.newDraggableIndex=u,_.originalEvent=p,_.pullMode=m?m.lastPutMode:void 0;var w=Ic(Ic({},h),pl.getEventProperties(i,t));for(var y in w)_[y]=w[y];n&&n.dispatchEvent(_),f[g]&&f[g].call(t,_)}}(Ic({putSortable:El,cloneEl:kl,targetEl:fl,rootEl:yl,oldIndex:Sl,oldDraggableIndex:Cl,newIndex:Il,newDraggableIndex:Tl},e))}var fl,gl,wl,yl,vl,bl,kl,xl,Sl,Il,Cl,Tl,Al,El,Pl,Rl,Dl,jl,Ol,Bl,Ll,Nl,Ml,ql,Wl,zl=!1,Fl=!1,Ul=[],Hl=!1,Vl=!1,Kl=[],$l=!1,Jl=[],Gl="undefined"!=typeof document,Yl=Bc,Xl=Dc||Rc?"cssFloat":"float",Ql=Gl&&!Lc&&!Bc&&"draggable"in document.createElement("div"),Zl=function(){if(Gl){if(Rc)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),ed=function(e,t){var n=Kc(e),i=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),o=Qc(e,0,t),a=Qc(e,1,t),r=o&&Kc(o),s=a&&Kc(a),c=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+Yc(o).width,l=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+Yc(a).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&r.float&&"none"!==r.float){var d="left"===r.float?"left":"right";return!a||"both"!==s.clear&&s.clear!==d?"horizontal":"vertical"}return o&&("block"===r.display||"flex"===r.display||"table"===r.display||"grid"===r.display||c>=i&&"none"===n[Xl]||a&&"none"===n[Xl]&&c+l>i)?"vertical":"horizontal"},td=function(e){function t(e,n){return function(i,o,a,r){var s=i.options.group.name&&o.options.group.name&&i.options.group.name===o.options.group.name;if(null==e&&(n||s))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"==typeof e)return t(e(i,o,a,r),n)(i,o,a,r);var c=(n?i:o).options.group.name;return!0===e||"string"==typeof e&&e===c||e.join&&e.indexOf(c)>-1}}var n={},i=e.group;(!i||"object"!=Cc(i))&&(i={name:i}),n.name=i.name,n.checkPull=t(i.pull,!0),n.checkPut=t(i.put),n.revertClone=i.revertClone,e.group=n},nd=function(){!Zl&&wl&&Kc(wl,"display","none")},id=function(){!Zl&&wl&&Kc(wl,"display","")};Gl&&!Lc&&document.addEventListener("click",(function(e){if(Fl)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Fl=!1,!1}),!0);var od=function(e){if(fl){var t=function(e,t){var n;return Ul.some((function(i){var o=i[cl].options.emptyInsertThreshold;if(o&&!Zc(i)){var a=Yc(i),r=e>=a.left-o&&e<=a.right+o,s=t>=a.top-o&&t<=a.bottom+o;if(r&&s)return n=i}})),n}((e=e.touches?e.touches[0]:e).clientX,e.clientY);if(t){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[cl]._onDragOver(n)}}},ad=function(e){fl&&fl.parentNode[cl]._isOutsideThisEl(e.target)};function rd(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=Ac({},t),e[cl]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return ed(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==rd.supportPointer&&"PointerEvent"in window&&!Oc,emptyInsertThreshold:5};for(var i in pl.initializePlugins(this,e,n),n)!(i in t)&&(t[i]=n[i]);for(var o in td(t),this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!t.forceFallback&&Ql,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?Mc(e,"pointerdown",this._onTapStart):(Mc(e,"mousedown",this._onTapStart),Mc(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(Mc(e,"dragover",this),Mc(e,"dragenter",this)),Ul.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),Ac(this,ll())}function sd(e,t,n,i,o,a,r,s){var c,l,d=e[cl],u=d.options.onMove;return!window.CustomEvent||Rc||Dc?(c=document.createEvent("Event")).initEvent("move",!0,!0):c=new CustomEvent("move",{bubbles:!0,cancelable:!0}),c.to=t,c.from=e,c.dragged=n,c.draggedRect=i,c.related=o||t,c.relatedRect=a||Yc(t),c.willInsertAfter=s,c.originalEvent=r,e.dispatchEvent(c),u&&(l=u.call(d,c,r)),l}function cd(e){e.draggable=!1}function ld(){$l=!1}function dd(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,i=0;n--;)i+=t.charCodeAt(n);return i.toString(36)}function ud(e){return setTimeout(e,0)}function pd(e){return clearTimeout(e)}rd.prototype={constructor:rd,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Nl=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,fl):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,i=this.options,o=i.preventOnFilter,a=e.type,r=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,s=(r||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,l=i.filter;if(function(e){Jl.length=0;for(var t=e.getElementsByTagName("input"),n=t.length;n--;){var i=t[n];i.checked&&Jl.push(i)}}(n),!fl&&!(/mousedown|pointerdown/.test(a)&&0!==e.button||i.disabled)&&!c.isContentEditable&&(this.nativeDraggable||!Oc||!s||"SELECT"!==s.tagName.toUpperCase())&&!((s=Fc(s,i.draggable,n,!1))&&s.animated||bl===s)){if(Sl=el(s),Cl=el(s,i.draggable),"function"==typeof l){if(l.call(this,e,s,this))return _l({sortable:t,rootEl:c,name:"filter",targetEl:s,toEl:n,fromEl:n}),hl("filter",t,{evt:e}),void(o&&e.cancelable&&e.preventDefault())}else if(l&&(l=l.split(",").some((function(i){if(i=Fc(c,i.trim(),n,!1))return _l({sortable:t,rootEl:i,name:"filter",targetEl:s,fromEl:n,toEl:n}),hl("filter",t,{evt:e}),!0}))))return void(o&&e.cancelable&&e.preventDefault());i.handle&&!Fc(c,i.handle,n,!1)||this._prepareDragStart(e,r,s)}}},_prepareDragStart:function(e,t,n){var i,o=this,a=o.el,r=o.options,s=a.ownerDocument;if(n&&!fl&&n.parentNode===a){var c=Yc(n);if(yl=a,gl=(fl=n).parentNode,vl=fl.nextSibling,bl=n,Al=r.group,rd.dragged=fl,Pl={target:fl,clientX:(t||e).clientX,clientY:(t||e).clientY},Ol=Pl.clientX-c.left,Bl=Pl.clientY-c.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,fl.style["will-change"]="all",i=function(){hl("delayEnded",o,{evt:e}),rd.eventCanceled?o._onDrop():(o._disableDelayedDragEvents(),!jc&&o.nativeDraggable&&(fl.draggable=!0),o._triggerDragStart(e,t),_l({sortable:o,name:"choose",originalEvent:e}),Vc(fl,r.chosenClass,!0))},r.ignore.split(",").forEach((function(e){Jc(fl,e.trim(),cd)})),Mc(s,"dragover",od),Mc(s,"mousemove",od),Mc(s,"touchmove",od),Mc(s,"mouseup",o._onDrop),Mc(s,"touchend",o._onDrop),Mc(s,"touchcancel",o._onDrop),jc&&this.nativeDraggable&&(this.options.touchStartThreshold=4,fl.draggable=!0),hl("delayStart",this,{evt:e}),!r.delay||r.delayOnTouchOnly&&!t||this.nativeDraggable&&(Dc||Rc))i();else{if(rd.eventCanceled)return void this._onDrop();Mc(s,"mouseup",o._disableDelayedDrag),Mc(s,"touchend",o._disableDelayedDrag),Mc(s,"touchcancel",o._disableDelayedDrag),Mc(s,"mousemove",o._delayedDragTouchMoveHandler),Mc(s,"touchmove",o._delayedDragTouchMoveHandler),r.supportPointer&&Mc(s,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(i,r.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){fl&&cd(fl),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;qc(e,"mouseup",this._disableDelayedDrag),qc(e,"touchend",this._disableDelayedDrag),qc(e,"touchcancel",this._disableDelayedDrag),qc(e,"mousemove",this._delayedDragTouchMoveHandler),qc(e,"touchmove",this._delayedDragTouchMoveHandler),qc(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?Mc(document,"pointermove",this._onTouchMove):Mc(document,t?"touchmove":"mousemove",this._onTouchMove):(Mc(fl,"dragend",this),Mc(yl,"dragstart",this._onDragStart));try{document.selection?ud((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(n){}},_dragStarted:function(e,t){if(zl=!1,yl&&fl){hl("dragStarted",this,{evt:t}),this.nativeDraggable&&Mc(document,"dragover",ad);var n=this.options;!e&&Vc(fl,n.dragClass,!1),Vc(fl,n.ghostClass,!0),rd.active=this,e&&this._appendGhost(),_l({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(Rl){this._lastX=Rl.clientX,this._lastY=Rl.clientY,nd();for(var e=document.elementFromPoint(Rl.clientX,Rl.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Rl.clientX,Rl.clientY))!==t;)t=e;if(fl.parentNode[cl]._isOutsideThisEl(e),t)do{if(t[cl]){if(t[cl]._onDragOver({clientX:Rl.clientX,clientY:Rl.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);id()}},_onTouchMove:function(e){if(Pl){var t=this.options,n=t.fallbackTolerance,i=t.fallbackOffset,o=e.touches?e.touches[0]:e,a=wl&&$c(wl,!0),r=wl&&a&&a.a,s=wl&&a&&a.d,c=Yl&&Wl&&tl(Wl),l=(o.clientX-Pl.clientX+i.x)/(r||1)+(c?c[0]-Kl[0]:0)/(r||1),d=(o.clientY-Pl.clientY+i.y)/(s||1)+(c?c[1]-Kl[1]:0)/(s||1);if(!rd.active&&!zl){if(n&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(wl){a?(a.e+=l-(Dl||0),a.f+=d-(jl||0)):a={a:1,b:0,c:0,d:1,e:l,f:d};var u="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");Kc(wl,"webkitTransform",u),Kc(wl,"mozTransform",u),Kc(wl,"msTransform",u),Kc(wl,"transform",u),Dl=l,jl=d,Rl=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!wl){var e=this.options.fallbackOnBody?document.body:yl,t=Yc(fl,!0,Yl,!0,e),n=this.options;if(Yl){for(Wl=e;"static"===Kc(Wl,"position")&&"none"===Kc(Wl,"transform")&&Wl!==document;)Wl=Wl.parentNode;Wl!==document.body&&Wl!==document.documentElement?(Wl===document&&(Wl=Gc()),t.top+=Wl.scrollTop,t.left+=Wl.scrollLeft):Wl=Gc(),Kl=tl(Wl)}Vc(wl=fl.cloneNode(!0),n.ghostClass,!1),Vc(wl,n.fallbackClass,!0),Vc(wl,n.dragClass,!0),Kc(wl,"transition",""),Kc(wl,"transform",""),Kc(wl,"box-sizing","border-box"),Kc(wl,"margin",0),Kc(wl,"top",t.top),Kc(wl,"left",t.left),Kc(wl,"width",t.width),Kc(wl,"height",t.height),Kc(wl,"opacity","0.8"),Kc(wl,"position",Yl?"absolute":"fixed"),Kc(wl,"zIndex","100000"),Kc(wl,"pointerEvents","none"),rd.ghost=wl,e.appendChild(wl),Kc(wl,"transform-origin",Ol/parseInt(wl.style.width)*100+"% "+Bl/parseInt(wl.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,i=e.dataTransfer,o=n.options;hl("dragStart",this,{evt:e}),rd.eventCanceled?this._onDrop():(hl("setupClone",this),rd.eventCanceled||((kl=rl(fl)).removeAttribute("id"),kl.draggable=!1,kl.style["will-change"]="",this._hideClone(),Vc(kl,this.options.chosenClass,!1),rd.clone=kl),n.cloneId=ud((function(){hl("clone",n),!rd.eventCanceled&&(n.options.removeCloneOnHide||yl.insertBefore(kl,fl),n._hideClone(),_l({sortable:n,name:"clone"}))})),!t&&Vc(fl,o.dragClass,!0),t?(Fl=!0,n._loopId=setInterval(n._emulateDragOver,50)):(qc(document,"mouseup",n._onDrop),qc(document,"touchend",n._onDrop),qc(document,"touchcancel",n._onDrop),i&&(i.effectAllowed="move",o.setData&&o.setData.call(n,i,fl)),Mc(document,"drop",n),Kc(fl,"transform","translateZ(0)")),zl=!0,n._dragStartId=ud(n._dragStarted.bind(n,t,e)),Mc(document,"selectstart",n),Ll=!0,Oc&&Kc(document.body,"user-select","none"))},_onDragOver:function(e){var t,n,i,o,a=this.el,r=e.target,s=this.options,c=s.group,l=rd.active,d=Al===c,u=s.sort,p=El||l,m=this,h=!1;if(!$l){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),r=Fc(r,s.draggable,a,!0),E("dragOver"),rd.eventCanceled)return h;if(fl.contains(e.target)||r.animated&&r.animatingX&&r.animatingY||m._ignoreWhileAnimating===r)return R(!1);if(Fl=!1,l&&!s.disabled&&(d?u||(i=gl!==yl):El===this||(this.lastPutMode=Al.checkPull(this,l,fl,e))&&c.checkPut(this,l,fl,e))){if(o="vertical"===this._getDirection(e,r),t=Yc(fl),E("dragOverValid"),rd.eventCanceled)return h;if(i)return gl=yl,P(),this._hideClone(),E("revert"),rd.eventCanceled||(vl?yl.insertBefore(fl,vl):yl.appendChild(fl)),R(!0);var _=Zc(a,s.draggable);if(!_||function(e,t,n){var i=Yc(Zc(n.el,n.options.draggable)),o=sl(n.el,n.options,wl),a=10;return t?e.clientX>o.right+a||e.clientY>i.bottom&&e.clientX>i.left:e.clientY>o.bottom+a||e.clientX>i.right&&e.clientY>i.top}(e,o,this)&&!_.animated){if(_===fl)return R(!1);if(_&&a===e.target&&(r=_),r&&(n=Yc(r)),!1!==sd(yl,a,fl,t,r,n,e,!!r))return P(),_&&_.nextSibling?a.insertBefore(fl,_.nextSibling):a.appendChild(fl),gl=a,D(),R(!0)}else if(_&&function(e,t,n){var i=Yc(Qc(n.el,0,n.options,!0)),o=sl(n.el,n.options,wl),a=10;return t?e.clientX<o.left-a||e.clientY<i.top&&e.clientX<i.right:e.clientY<o.top-a||e.clientY<i.bottom&&e.clientX<i.left}(e,o,this)){var f=Qc(a,0,s,!0);if(f===fl)return R(!1);if(n=Yc(r=f),!1!==sd(yl,a,fl,t,r,n,e,!1))return P(),a.insertBefore(fl,f),gl=a,D(),R(!0)}else if(r.parentNode===a){n=Yc(r);var g,w,y,v=fl.parentNode!==a,b=!function(e,t,n){var i=n?e.left:e.top,o=n?e.right:e.bottom,a=n?e.width:e.height,r=n?t.left:t.top,s=n?t.right:t.bottom,c=n?t.width:t.height;return i===r||o===s||i+a/2===r+c/2}(fl.animated&&fl.toRect||t,r.animated&&r.toRect||n,o),k=o?"top":"left",x=Xc(r,"top","top")||Xc(fl,"top","top"),S=x?x.scrollTop:void 0;if(Nl!==r&&(w=n[k],Hl=!1,Vl=!b&&s.invertSwap||v),g=function(e,t,n,i,o,a,r,s){var c=i?e.clientY:e.clientX,l=i?n.height:n.width,d=i?n.top:n.left,u=i?n.bottom:n.right,p=!1;if(!r)if(s&&ql<l*o){if(!Hl&&(1===Ml?c>d+l*a/2:c<u-l*a/2)&&(Hl=!0),Hl)p=!0;else if(1===Ml?c<d+ql:c>u-ql)return-Ml}else if(c>d+l*(1-o)/2&&c<u-l*(1-o)/2)return function(e){return el(fl)<el(e)?1:-1}(t);return p=p||r,p&&(c<d+l*a/2||c>u-l*a/2)?c>d+l/2?1:-1:0}(e,r,n,o,b?1:s.swapThreshold,null==s.invertedSwapThreshold?s.swapThreshold:s.invertedSwapThreshold,Vl,Nl===r),0!==g){var I=el(fl);do{I-=g,y=gl.children[I]}while(y&&("none"===Kc(y,"display")||y===wl))}if(0===g||y===r)return R(!1);Nl=r,Ml=g;var C=r.nextElementSibling,T=!1,A=sd(yl,a,fl,t,r,n,e,T=1===g);if(!1!==A)return(1===A||-1===A)&&(T=1===A),$l=!0,setTimeout(ld,30),P(),T&&!C?a.appendChild(fl):r.parentNode.insertBefore(fl,T?C:r),x&&al(x,0,S-x.scrollTop),gl=fl.parentNode,void 0!==w&&!Vl&&(ql=Math.abs(w-Yc(r)[k])),D(),R(!0)}if(a.contains(fl))return R(!1)}return!1}function E(s,c){hl(s,m,Ic({evt:e,isOwner:d,axis:o?"vertical":"horizontal",revert:i,dragRect:t,targetRect:n,canSort:u,fromSortable:p,target:r,completed:R,onMove:function(n,i){return sd(yl,a,fl,t,n,Yc(n),e,i)},changed:D},c))}function P(){E("dragOverAnimationCapture"),m.captureAnimationState(),m!==p&&p.captureAnimationState()}function R(t){return E("dragOverCompleted",{insertion:t}),t&&(d?l._hideClone():l._showClone(m),m!==p&&(Vc(fl,El?El.options.ghostClass:l.options.ghostClass,!1),Vc(fl,s.ghostClass,!0)),El!==m&&m!==rd.active?El=m:m===rd.active&&El&&(El=null),p===m&&(m._ignoreWhileAnimating=r),m.animateAll((function(){E("dragOverAnimationComplete"),m._ignoreWhileAnimating=null})),m!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(r===fl&&!fl.animated||r===a&&!r.animated)&&(Nl=null),!s.dragoverBubble&&!e.rootEl&&r!==document&&(fl.parentNode[cl]._isOutsideThisEl(e.target),!t&&od(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),h=!0}function D(){Il=el(fl),Tl=el(fl,s.draggable),_l({sortable:m,name:"change",toEl:a,newIndex:Il,newDraggableIndex:Tl,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){qc(document,"mousemove",this._onTouchMove),qc(document,"touchmove",this._onTouchMove),qc(document,"pointermove",this._onTouchMove),qc(document,"dragover",od),qc(document,"mousemove",od),qc(document,"touchmove",od)},_offUpEvents:function(){var e=this.el.ownerDocument;qc(e,"mouseup",this._onDrop),qc(e,"touchend",this._onDrop),qc(e,"pointerup",this._onDrop),qc(e,"touchcancel",this._onDrop),qc(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;Il=el(fl),Tl=el(fl,n.draggable),hl("drop",this,{evt:e}),gl=fl&&fl.parentNode,Il=el(fl),Tl=el(fl,n.draggable),rd.eventCanceled||(zl=!1,Vl=!1,Hl=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),pd(this.cloneId),pd(this._dragStartId),this.nativeDraggable&&(qc(document,"drop",this),qc(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Oc&&Kc(document.body,"user-select",""),Kc(fl,"transform",""),e&&(Ll&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),wl&&wl.parentNode&&wl.parentNode.removeChild(wl),(yl===gl||El&&"clone"!==El.lastPutMode)&&kl&&kl.parentNode&&kl.parentNode.removeChild(kl),fl&&(this.nativeDraggable&&qc(fl,"dragend",this),cd(fl),fl.style["will-change"]="",Ll&&!zl&&Vc(fl,El?El.options.ghostClass:this.options.ghostClass,!1),Vc(fl,this.options.chosenClass,!1),_l({sortable:this,name:"unchoose",toEl:gl,newIndex:null,newDraggableIndex:null,originalEvent:e}),yl!==gl?(Il>=0&&(_l({rootEl:gl,name:"add",toEl:gl,fromEl:yl,originalEvent:e}),_l({sortable:this,name:"remove",toEl:gl,originalEvent:e}),_l({rootEl:gl,name:"sort",toEl:gl,fromEl:yl,originalEvent:e}),_l({sortable:this,name:"sort",toEl:gl,originalEvent:e})),El&&El.save()):Il!==Sl&&Il>=0&&(_l({sortable:this,name:"update",toEl:gl,originalEvent:e}),_l({sortable:this,name:"sort",toEl:gl,originalEvent:e})),rd.active&&((null==Il||-1===Il)&&(Il=Sl,Tl=Cl),_l({sortable:this,name:"end",toEl:gl,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){hl("nulling",this),yl=fl=gl=wl=vl=kl=bl=xl=Pl=Rl=Ll=Il=Tl=Sl=Cl=Nl=Ml=El=Al=rd.dragged=rd.ghost=rd.clone=rd.active=null,Jl.forEach((function(e){e.checked=!0})),Jl.length=Dl=jl=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":fl&&(this._onDragOver(e),(t=e).dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault());break;case"selectstart":e.preventDefault()}var t},toArray:function(){for(var e,t=[],n=this.el.children,i=0,o=n.length,a=this.options;i<o;i++)Fc(e=n[i],a.draggable,this.el,!1)&&t.push(e.getAttribute(a.dataIdAttr)||dd(e));return t},sort:function(e,t){var n={},i=this.el;this.toArray().forEach((function(e,t){var o=i.children[t];Fc(o,this.options.draggable,i,!1)&&(n[e]=o)}),this),t&&this.captureAnimationState(),e.forEach((function(e){n[e]&&(i.removeChild(n[e]),i.appendChild(n[e]))})),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return Fc(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var i=pl.modifyOption(this,e,t);n[e]=void 0!==i?i:t,"group"===e&&td(n)},destroy:function(){hl("destroy",this);var e=this.el;e[cl]=null,qc(e,"mousedown",this._onTapStart),qc(e,"touchstart",this._onTapStart),qc(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(qc(e,"dragover",this),qc(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Ul.splice(Ul.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!xl){if(hl("hideClone",this),rd.eventCanceled)return;Kc(kl,"display","none"),this.options.removeCloneOnHide&&kl.parentNode&&kl.parentNode.removeChild(kl),xl=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(xl){if(hl("showClone",this),rd.eventCanceled)return;fl.parentNode!=yl||this.options.group.revertClone?vl?yl.insertBefore(kl,vl):yl.appendChild(kl):yl.insertBefore(kl,fl),this.options.group.revertClone&&this.animate(fl,kl),Kc(kl,"display",""),xl=!1}}else this._hideClone()}},Gl&&Mc(document,"touchmove",(function(e){(rd.active||zl)&&e.cancelable&&e.preventDefault()})),rd.utils={on:Mc,off:qc,css:Kc,find:Jc,is:function(e,t){return!!Fc(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:ol,closest:Fc,toggleClass:Vc,clone:rl,index:el,nextTick:ud,cancelNextTick:pd,detectDirection:ed,getChild:Qc},rd.get=function(e){return e[cl]},rd.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(rd.utils=Ic(Ic({},rd.utils),e.utils)),pl.mount(e)}))},rd.create=function(e,t){return new rd(e,t)},rd.version="1.15.2";var md,hd,_d,fd,gd,wd,yd=[],vd=!1;function bd(){yd.forEach((function(e){clearInterval(e.pid)})),yd=[]}function kd(){clearInterval(wd)}var xd=ol((function(e,t,n,i){if(t.scroll){var o,a=(e.touches?e.touches[0]:e).clientX,r=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,c=t.scrollSpeed,l=Gc(),d=!1;hd!==n&&(hd=n,bd(),md=t.scroll,o=t.scrollFn,!0===md&&(md=nl(n,!0)));var u=0,p=md;do{var m=p,h=Yc(m),_=h.top,f=h.bottom,g=h.left,w=h.right,y=h.width,v=h.height,b=void 0,k=void 0,x=m.scrollWidth,S=m.scrollHeight,I=Kc(m),C=m.scrollLeft,T=m.scrollTop;m===l?(b=y<x&&("auto"===I.overflowX||"scroll"===I.overflowX||"visible"===I.overflowX),k=v<S&&("auto"===I.overflowY||"scroll"===I.overflowY||"visible"===I.overflowY)):(b=y<x&&("auto"===I.overflowX||"scroll"===I.overflowX),k=v<S&&("auto"===I.overflowY||"scroll"===I.overflowY));var A=b&&(Math.abs(w-a)<=s&&C+y<x)-(Math.abs(g-a)<=s&&!!C),E=k&&(Math.abs(f-r)<=s&&T+v<S)-(Math.abs(_-r)<=s&&!!T);if(!yd[u])for(var P=0;P<=u;P++)yd[P]||(yd[P]={});(yd[u].vx!=A||yd[u].vy!=E||yd[u].el!==m)&&(yd[u].el=m,yd[u].vx=A,yd[u].vy=E,clearInterval(yd[u].pid),(0!=A||0!=E)&&(d=!0,yd[u].pid=setInterval(function(){i&&0===this.layer&&rd.active._onTouchMove(gd);var t=yd[this.layer].vy?yd[this.layer].vy*c:0,n=yd[this.layer].vx?yd[this.layer].vx*c:0;"function"==typeof o&&"continue"!==o.call(rd.dragged.parentNode[cl],n,t,e,gd,yd[this.layer].el)||al(yd[this.layer].el,n,t)}.bind({layer:u}),24))),u++}while(t.bubbleScroll&&p!==l&&(p=nl(p,!1)));vd=d}}),30),Sd=function(e){var t=e.originalEvent,n=e.putSortable,i=e.dragEl,o=e.activeSortable,a=e.dispatchSortableEvent,r=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var c=n||o;r();var l=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,d=document.elementFromPoint(l.clientX,l.clientY);s(),c&&!c.el.contains(d)&&(a("spill"),this.onSpill({dragEl:i,putSortable:n}))}};function Id(){}function Cd(){}function Td(e){return null==e?e:JSON.parse(JSON.stringify(e))}Id.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var i=Qc(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(t,i):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:Sd},Ac(Id,{pluginName:"revertOnSpill"}),Cd.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:Sd},Ac(Cd,{pluginName:"removeOnSpill"}),rd.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?Mc(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Mc(document,"pointermove",this._handleFallbackAutoScroll):t.touches?Mc(document,"touchmove",this._handleFallbackAutoScroll):Mc(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;!this.options.dragOverBubble&&!t.rootEl&&this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?qc(document,"dragover",this._handleAutoScroll):(qc(document,"pointermove",this._handleFallbackAutoScroll),qc(document,"touchmove",this._handleFallbackAutoScroll),qc(document,"mousemove",this._handleFallbackAutoScroll)),kd(),bd(),clearTimeout(Uc),Uc=void 0},nulling:function(){gd=hd=md=vd=wd=_d=fd=null,yd.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,i=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,a=document.elementFromPoint(i,o);if(gd=e,t||this.options.forceAutoScrollFallback||Dc||Rc||Oc){xd(e,this.options,a,t);var r=nl(a,!0);vd&&(!wd||i!==_d||o!==fd)&&(wd&&kd(),wd=setInterval((function(){var a=nl(document.elementFromPoint(i,o),!0);a!==r&&(r=a,bd()),xd(e,n.options,a,t)}),10),_d=i,fd=o)}else{if(!this.options.bubbleScroll||nl(a,!0)===Gc())return void bd();xd(e,this.options,nl(a,!1),!1)}}},Ac(e,{pluginName:"scroll",initializeByDefault:!0})}),rd.mount(Cd,Id);let Ad=null,Ed=null;function Pd(e=null,t=null){Ad=e,Ed=t}const Rd=Symbol("cloneElement");function Dd(...e){var t,n;const i=null==(t=nc())?void 0:t.proxy,o=e[0];let[,a,r]=e;Array.isArray(ic(a))||(r=a,a=null);let s=null;const{immediate:c=!0,clone:l=Td,customUpdate:d}=null!=(n=ic(r))?n:{};const u={onUpdate:function(e){if(d)return void d(e);const{from:t,item:n,oldIndex:i,newIndex:o}=e;if(vc(n),yc(t,n,i),cc(a)){const e=[...ic(a)];a.value=fc(e,i,o)}else fc(ic(a),i,o)},onStart:function(e){var t;const n=ic(null==(t=ic(a))?void 0:t[e.oldIndex]),i=l(n);Pd(n,i),e.item[Rd]=i},onAdd:function(e){const t=e.item[Rd];if(!function(e){return void 0===e}(t)){if(vc(e.item),cc(a)){const n=[...ic(a)];return void(a.value=wc(n,e.newDraggableIndex,t))}wc(ic(a),e.newDraggableIndex,t)}},onRemove:function(e){const{from:t,item:n,oldIndex:i,oldDraggableIndex:o,pullMode:r,clone:s}=e;if(yc(t,n,i),"clone"!==r)if(cc(a)){const e=[...ic(a)];a.value=gc(e,o)}else gc(ic(a),o);else vc(s)},onEnd:function(){sc((()=>{Pd()}))}};function p(e){const t=ic(o);return e||(e=function(e){return"string"==typeof e}(t)?bc(t,null==i?void 0:i.$el):t),e&&!function(e){return e instanceof HTMLElement}(e)&&(e=e.$el),e||function(e){console.error(_c+e)}("Root element not found"),e}function m(){var e;const t=null!=(e=ic(r))?e:{},n=tc(t,["immediate","clone"]);return kc(n,((e,t)=>{(function(e){return 111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97)})(e)&&(n[e]=(e,...n)=>(xc(e,{data:Ad,clonedData:Ed}),t(e,...n)))})),function(e,t){const n=ec({},e);return Object.keys(t).forEach((i=>{n[i]?n[i]=function(e,t,n=null){return function(...i){return e.apply(n,i),t.apply(n,i)}}(e[i],t[i]):n[i]=t[i]})),n}(null===a?{}:u,n)}const h=e=>{e=p(e),s&&_.destroy(),s=new rd(e,m())};oc((()=>r),(()=>{s&&kc(m(),((e,t)=>{null==s||s.option(e,t)}))}),{deep:!0});const _={option:(e,t)=>null==s?void 0:s.option(e,t),destroy:()=>{null==s||s.destroy(),s=null},save:()=>null==s?void 0:s.save(),toArray:()=>null==s?void 0:s.toArray(),closest:(...e)=>null==s?void 0:s.closest(...e)};return function(e){nc()?rc(e):sc(e)}((()=>{c&&h()})),function(e){nc()&&ac(e)}(_.destroy),ec({start:h,pause:()=>null==_?void 0:_.option("disabled",!0),resume:()=>null==_?void 0:_.option("disabled",!1)},_)}const jd=["update","start","add","remove","choose","unchoose","end","sort","filter","clone","move","change"],Od=lc({name:"VueDraggable",model:{prop:"modelValue",event:"update:modelValue"},props:["clone","animation","ghostClass","group","sort","disabled","store","handle","draggable","swapThreshold","invertSwap","invertedSwapThreshold","removeCloneOnHide","direction","chosenClass","dragClass","ignore","filter","preventOnFilter","easing","setData","dropBubble","dragoverBubble","dataIdAttr","delay","delayOnTouchOnly","touchStartThreshold","forceFallback","fallbackClass","fallbackOnBody","fallbackTolerance","fallbackOffset","supportPointer","emptyInsertThreshold","scroll","forceAutoScrollFallback","scrollSensitivity","scrollSpeed","bubbleScroll","modelValue","tag","target","customUpdate",...jd.map((e=>"on".concat(e.replace(/^\S/,(e=>e.toUpperCase())))))],emits:["update:modelValue",...jd],setup(e,{slots:t,emit:n,expose:i,attrs:o}){const a=jd.reduce(((e,t)=>(e["on".concat(t.replace(/^\S/,(e=>e.toUpperCase())))]=(...e)=>n(t,...e),e)),{}),r=dc((()=>{const t=uc(e),n=tc(t,["modelValue"]),i=Object.entries(n).reduce(((e,[t,n])=>{const i=ic(n);return void 0!==i&&(e[t]=i),e}),{});return ec(ec({},a),function(e){return Object.keys(e).reduce(((t,n)=>(void 0!==e[n]&&(t[function(e){return e.replace(/-(\w)/g,((e,t)=>t?t.toUpperCase():""))}(n)]=e[n]),t)),{})}(ec(ec({},o),i)))})),s=dc({get:()=>e.modelValue,set:e=>n("update:modelValue",e)}),c=pc(),l=mc(Dd(e.target||c,s,r));return i(l),()=>{var n;return hc(e.tag||"div",{ref:c},null==(n=null==t?void 0:t.default)?void 0:n.call(t,l))}}});const Bd=pt({name:"audio-list-item",filters:{durationFormatter:e=>Ks(e)},components:{Progress:Js},inject:["version","supportSetShutdown"],props:{playing:{type:Boolean,default:!1},info:{type:Object,required:"required"},isPlaying:{type:Boolean,default:!1},playRate:{type:Number,default:1},hasSetShutDown:{type:Boolean,default:!1}}},(function(){var e,t=this,n=t._self._c;return n("div",{staticClass:"card-item__wrp js_wx_tap_highlight",class:{"now-playing":t.playing,"gray-active":-1!==[2,3].indexOf(t.version),"none-active":1===t.version},on:{click:()=>t.$emit("click")}},[n("div",{staticClass:"card-item__info-area"},[2!==t.version?n("div",{staticClass:"card-item__cover",class:1===t.version?"small-cover":"",style:"background-image: url(".concat(t.info.listen_item&&t.info.listen_item.cover,")"),attrs:{role:"figure"}},[1===t.version?n("div",{directives:[{name:"show",rawName:"v-show",value:t.playing,expression:"playing"}],staticClass:"playing",class:{pause:!t.isPlaying}},[n("div",{staticClass:"dot1"}),n("div",{staticClass:"dot2"}),n("div",{staticClass:"dot3"}),n("div",{staticClass:"dot4"})]):t._e()]):t._e(),t.info.listen_item?n("div",{staticClass:"card-item__info"},[n("div",{staticClass:"card-item__title",class:{"bold-title":(2===t.version||3===t.version)&&t.playing,"small-title":1===t.version}},[t._v(t._s((null==(e=t.info.listen_item.article_info)?void 0:e.audio_title)||t.info.listen_item.title))]),n("div",{staticClass:"card-item__desc"},[t._e(),n("span",[t._v(t._s(t.info.listen_item.author)+" ")]),t.info.listen_item.duration&&(2!==t.version&&3!==t.version||!t.playing)?[t.info.currentTime&&t.info.currentTime<parseInt(t.info.listen_item.duration/1e3,10)?n("span",[t._v("剩余"+t._s(t._f("durationFormatter")(t.info.listen_item.duration-1e3*t.info.currentTime)))]):n("span",[t._v(t._s(t._f("durationFormatter")(t.info.listen_item.duration)))])]:t._e()],2)]):t._e()]),2!==t.version&&3!==t.version||!t.playing?t._e():n("Progress",t._g({attrs:{"play-rate":t.playRate,"is-playing":t.isPlaying,"current-time":t.info.currentTime,"has-set-shut-down":t.hasSetShutDown,duration:t.info.listen_item.duration}},t.$listeners))],1)}),[],!1,null,"e6aadcbd",null,null).exports;const Ld=pt({props:{options:{type:Array,required:"required"},activeKey:{type:[Number,String],default:""},wrpStyle:{type:[Object,String],default:""},show:{type:Boolean,default:!1}},model:{prop:"show",event:"change"},data(){return{activeIndex:this.options.findIndex((e=>e.key===this.activeKey))}},computed:{varsStyle(){return Object.keys(this.wrpStyle).filter((e=>0===e.indexOf("--transform"))).reduce(((e,t)=>({...e,[t]:this.wrpStyle[t]})),{})}},watch:{activeKey(e){this.activeIndex=this.options.findIndex((t=>t.key===e))}},methods:{onClick(e){this.activeIndex=e,this.$emit("select",this.options[e]),this.$emit("change",!1)}}},(function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"fade"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticClass:"option-menu__wrp",style:e.varsStyle,attrs:{"aria-modal":"true"},on:{click:function(t){return t.target!==t.currentTarget?null:e.$emit("change",!1)}}},[t("div",{staticClass:"option-menu",style:e.wrpStyle},e._l(e.options,(function(n,i){return t("div",{key:n.key,staticClass:"option-item",class:e.activeIndex===i?"active":"",on:{click:function(t){return e.onClick(i)}}},[t("span",[e._v(e._s(n.value))]),t("span",{directives:[{name:"show",rawName:"v-show",value:e.activeIndex===i,expression:"activeIndex === index"}],staticClass:"weui-icon-checked"})])})),0)])])}),[],!1,null,"3bfe7d18",null,null).exports;let Nd=0;const Md=293511,qd=new tn("audio_panel"),Wd=ke.isIOS&&ke.getInner()>="18003238"||ke.isAndroid&&ke.getInner()>="28003259",zd=ke.isIOS&&ke.getInner()>="18003238"||ke.isAndroid&&ke.getInner()>="28003258",Fd=e=>(t,n,i)=>i.findIndex((n=>n[e]===t[e]))===n;const Ud=pt({name:"mp-audio-panel",filters:{durationFormatter:e=>Ks(e),durationNumFormatter:e=>Ks(e,2)},components:{Tips:Vs,Progress:Js,Teleport:nn,Intersect:x,OptionMenu:Ld,VueDraggable:Od,[Bd.name]:Bd,[G.name]:G,[Y.name]:Y,[w.name]:w,[X.name]:X},provide(){return{supportSetShutdown:zd,supportDynamicPlayList:Wd,version:this.$options.version||1}},data(){let e="";if(he.os.pc)e="20%";else switch(this.$options.version){case 2:case 3:case 1:e="".concat(screen.height/4-(screen.height-window.innerHeight),"px")}const t=qd.get("play-rate")||1,n=[{key:"none",value:"不开启"},...[15,30,60,90].map((e=>({key:e,value:"".concat(e,"分钟")}))),{key:"whenEnd",value:"当前单集结束后"}];return{firstScreenDataReady:!1,firstScreenDataError:!1,isShow:!1,cardTitleAnime:!1,panelContentHeight:screen.height/4*3-70,isShowList:!1,isPlaying:!1,playLoading:!1,playingType:0,playingListenId:"",playingSrcId:"",startRoutePoint:{x:0,y:0},animeRoutePoints:[],isShowingListenLaterAnime:!1,loading:!1,hasMore:!0,listSessionBuffer:"",hasInList:!1,list:[],playInfo:{},selectInfo:{},base64:"",version:this.$options.version||1,lastPlayId:"",isOpened:!1,tipsShow:!1,tipsWording:"",shutdownType:"none",shutdownLeftTime:0,shutdownPanelShow:!1,shutdownPanelPosition:{top:"100vh",left:"100vw"},topAnimeAreaInfo:null,topAnimeAreaTop:"",showTopAnimeArea:!1,playingAreaHide:!1,dragMoving:!1,slideMoving:!1,needUpdate:!1,playChanging:!1,showPlayingBar:!1,disableTransition:!1,transitionDis:0,transitionGapByScroll:0,modalTop:e,playRate:t,shutdownOptions:n,supportSetShutdown:zd,supportDynamicPlayList:Wd}},computed:{animeCoverStyle(){return["left: ".concat(this.startRoutePoint.x,"px; top: ").concat(this.startRoutePoint.y,"px;"),this.isShowingListenLaterAnime?"visibility: visible;":"visibility: hidden;","background-image: url(".concat(this.playInfo.cover,")")].join(";")},playBtnIconClass(){const e=this.playingListenId===this.playInfo.listen_id,t=this.isPlaying&&e;return e&&this.playLoading?"weui-loading":t?"icon-pause":"icon-play"},playingInfo(){var e;return this.list.find((e=>e.listen_id===this.playingListenId))||{listen_id:null==(e=this.selectInfo)?void 0:e.listen_id,listen_item:this.selectInfo}},playingIndex(){return this.list.findIndex((e=>{var t;return e.listen_id===(this.playingListenId||(null==(t=this.selectInfo)?void 0:t.listen_id))}))},showProgress(){return this.selectInfo&&(this.selectInfo.listen_id!==this.playInfo.listen_id||this.playingListenId===this.selectInfo.listen_id||this.playingSrcId===this.selectInfo.src_id)}},watch:{list(e){-1!==(e||[]).findIndex((e=>e.listen_id===this.playInfo.listen_id))?this.hasInList=!0:this.hasInList=!1},playInfo:{handler(e){this.selectInfo={...e}},immediate:!0,deeply:!0},selectInfo(){this.$nextTick((()=>{setTimeout((()=>{this.checkCardTitleAnime(),this.startCardTitleAnime()}),50)}))}},created(){this.getFirstScreenData(),this.__debounceScroll=function(e,t){let n,i;return function(){const o=this,a=arguments,r=Date.now();n&&r<n+t?(clearTimeout(i),i=setTimeout((function(){n=r,e.apply(o,a)}),t)):(n=r,e.apply(o,a))}}(this.onScroll,300),xe.invoke("getTingAudioState",{},(e=>{/:ok$/.test(e.err_msg)?Nd=1:-9999!==e.err_code&&-1===e.err_msg.indexOf("function_not_exist")||(Nd=0)}))},mounted(){var e,t;this.registerStatusObserver(),setTimeout((()=>this.checkCardTitleAnime())),xe.on("menu:setfont",(()=>{const e=this.$refs.playWrp;if(!e)return;const{height:t}=e.getBoundingClientRect();this.panelContentHeight=t,this.checkCardTitleAnime()})),document.addEventListener("visibilitychange",this.onVisibilityChange);const n=null==(t=null==(e=this.$refs.bottomModal)?void 0:e.$refs)?void 0:t.contentAreaWrp;n&&n.addEventListener("scroll",this.__debounceScroll);const i=document.querySelector(".audio-panel-modal .weui-half-screen-dialog__bd");i.addEventListener("touchmove",(e=>{if(this.dragMoving)return e.preventDefault(),e.stopPropagation(),!1})),this.onDragScroll=(e,t,n,o,a)=>{i.scrollTop+=t,this.transitionGapByScroll+=t,this.transitionDis+=t}},beforeDestroy(){var e,t;this.stopCountdown(),document.removeEventListener("visibilitychange",this.onVisibilityChange);const n=null==(t=null==(e=this.$refs.bottomModal)?void 0:e.$refs)?void 0:t.contentAreaWrp;n&&n.removeEventListener("scroll",this.__debounceScroll)},methods:{show(e=!1,t=!1){var n,i;try{this.selectInfo=this.playInfo||{},this.$refs.bottomModal.show(),this.checkCardTitleAnime(),this.__titleAnime&&(this.__titleAnime.cancel(),this.__titleAnime=void 0);const o=t||!this.isOpened||this.needUpdate;return this.needUpdate=!1,e||2!==this.version&&3!==this.version?(e||1===this.version)&&o&&this.getListData(!0):(null==(n=this.playInfo)?void 0:n.listen_id)?this.isPlaying&&(null==(i=this.playInfo)?void 0:i.listen_id)===this.playingListenId&&this.playingListenId?o&&this.getListData(!0):this.supportDynamicPlayList?(this.addToListenLater(this.playInfo,(()=>{o&&this.getListData(!0)})),this.play(this.playInfo),this.report({EventType:4})):this.addToListenLater(this.playInfo,(()=>{this.play(this.playInfo),o&&this.getListData(!0),this.report({EventType:4})})):this.__autoPlayWhenGetFirstScreenData=!0,this.report({EventType:2}),this.isOpened=!0,ue.setSum(Md,8,1),this.registerClientListUpdatedListener(),this.getStatus((e=>{e.playRate&&(this.playRate=+e.playRate,qd.set("play-rate",+e.playRate))})),!0}catch(su){return!1}},hide(){this.$refs.bottomModal.hide(),this.__titleAnime&&(this.__titleAnime.cancel(),this.__titleAnime=void 0)},showList(){ue.setSum(Md,9,1),this.isShowList=!0,this.__titleAnime&&(this.__titleAnime.cancel(),this.__titleAnime=void 0),this.report({EventType:7})},hideList(){this.isShowList=!1,this.startCardTitleAnime()},changePlay(e,t=0,n=!1){var i,o,a,r,s,c,l;if(this.playingListenId===e.listen_id&&this.isPlaying)return this.pause(!1),void(n&&this.report({EventType:5,Pos:t}));if(this.playChanging=!0,this.__changePlayTimeout&&(clearTimeout(this.__changePlayTimeout),this.__changePlayTimeout=null),this.__changePlayTimeout=setTimeout((()=>{this.playChanging=!1}),500),this.playingAreaHide&&(2===this.version||3===this.version)){this.__afterTopAnimeAreaEnterTimeout&&(clearTimeout(this.__afterTopAnimeAreaEnterTimeout),this.__afterTopAnimeAreaEnterTimeout=null);const n=document.querySelector(".audio-list__item-slide-wrp.pos-".concat(t)),d=null==(o=null==(i=null==n?void 0:n.getBoundingClientRect)?void 0:i.call(n))?void 0:o.top,u=null==(l=null==(c=null==(s=null==(r=null==(a=this.$refs.bottomModal)?void 0:a.$refs)?void 0:r.contentAreaWrp)?void 0:s.getBoundingClientRect)?void 0:c.call(s))?void 0:l.top;this.topAnimeAreaInfo=e,this.topAnimeAreaTop=d&&u&&d-u||"",this.showTopAnimeArea=!0}!n||this.playingListenId===e.listen_id&&this.list[0].listen_id===e.listen_id?this.play(e.listen_item):this.supportDynamicPlayList?(this.addToListenLater(e.listen_item),this.play(e.listen_item)):this.addToListenLater(e.listen_item,(()=>this.play(e.listen_item))),this.selectInfo={...e.listen_item},n?this.report({EventType:4,Pos:t}):(ue.setSum(Md,10,1),this.report({EventType:11,Pos:t}))},toggleListenLater(){var e,t,n,i;if(this.hasInList)return this.hasInList=!1,this.removeFromListenLater((null==(e=this.playInfo)?void 0:e.listen_id)||""),xe.invoke("vibrateShort",{style:"medium"}),this.report({EventType:12}),void ue.setSum(Md,19,1);this.isShowList||this.showListenLaterAnime();-1!==this.list.findIndex((e=>e.listen_id===this.playingListenId))&&this.playingListenId&&(null==(t=this.playInfo)?void 0:t.listen_id)&&this.playingListenId!==(null==(n=this.playInfo)?void 0:n.listen_id)?this.adjustToNextPlay({listen_item:this.playInfo,listen_id:null==(i=this.playInfo)?void 0:i.listen_id}):this.addToListenLater(this.playInfo),this.hasInList=!0,this.report({EventType:6})},togglePlay(){var e,t;(null==(e=this.playInfo)?void 0:e.listen_id)&&(this.isPlaying&&this.playingListenId===(null==(t=this.playInfo)?void 0:t.listen_id)?this.pause(!0):(this.hasInList||(this.isShowList||this.showListenLaterAnime(),xe.invoke("vibrateShort",{style:"medium"})),this.supportDynamicPlayList?(this.addToListenLater(this.playInfo),this.play(this.playInfo,!0)):this.addToListenLater(this.playInfo,(()=>this.play(this.playInfo,!0)))))},removeFinishedAudio(e){const t=e.results.filter((e=>{const t=this.list.find((t=>t.listen_id===e.listenId));if(!t)return;const n=t&&t.newAdded;return e.finished&&(e.currentTime>=95e-5*t.duration||0===e.currentTime)&&!n&&(!this.isPlaying||this.isPlaying&&e.listenId!==this.playingListenId)})).map((e=>e.listenId));this.batchRemoveFromListenLater(t)},startCountDown(){this.countdownInterval&&this.countdownIntervalId===this.playingListenId||(this.countdownInterval&&this.stopCountdown(),this.countdownIntervalId=this.playingListenId,this.__countdownResTime=0,this.countdownInterval=setInterval((()=>{this.__countdownResTime>=0?(this.__countdownResTime=0,this.getStatus((e=>{e&&e.item&&e.item.listenId&&"playing"===e.status?this.list=[...this.list.map((t=>t.listen_id===e.item.listenId&&e.currentTime?(t.currentTime=+e.currentTime||0,{...t}):t))]:this.stopCountdown()}))):this.list=[...this.list.map((e=>e.listen_id!==this.playingListenId?e:("number"==typeof e.currentTime&&(e.currentTime+=1),{...e})))],this.__countdownResTime+=1}),1e3))},stopCountdown(){this.countdownInterval&&(clearInterval(this.countdownInterval),this.countdownInterval=null,this.countdownIntervalId=void 0,this.__countdownResTime=0)},showTips(e,t=1500){e&&(this.__tipsTimeout&&(clearTimeout(this.__tipsTimeout),this.__tipsTimeout=null),this.tipsWording=e,this.tipsShow=!0,this.__tipsTimeout=setTimeout((()=>{this.tipsShow=!1,this.tipsWording=""}),t))},hideTips(){this.__tipsTimeout&&(clearTimeout(this.__tipsTimeout),this.__tipsTimeout=null),this.tipsShow=!1,this.tipsWording=""},callShutdownPanel(e){this.getStatus((t=>{let n=t.shutdown;if("string"==typeof t.shutdown&&t.shutdown)try{n=JSON.parse(t.shutdown)}catch(su){n=null}n?("afterMins"===n.shutdownType?this.shutdownType=n.time||0:this.shutdownType=n.shutdownType||"none",this.shutdownLeftTime=n.leftTime||0):(this.shutdownType="none",this.shutdownLeftTime=0);const i=null==e?void 0:e.getBoundingClientRect();this.shutdownPanelPosition={top:void 0,left:void 0,bottom:"".concat(window.innerHeight-(i.bottom+26),"px"),right:"".concat(window.innerWidth-i.left+4,"px"),"--transform-origin-top":"".concat(i.bottom-i.height/2,"px"),"--transform-origin-left":"".concat(i.left-4,"px")},this.shutdownPanelShow=!0}))},scrollToNowPlaying(){var e,t;const n=null==(t=null==(e=this.$refs.bottomModal)?void 0:e.$refs)?void 0:t.contentAreaWrp,i=document.querySelector(".audio-list__item-slide-wrp.now-playing");i&&n&&n.scrollTo({top:i.offsetTop,behavior:"smooth"})},registerClientListUpdatedListener(){!this.__hasRegisterClientListUpdatedListener&&this.supportDynamicPlayList&&(this.__hasRegisterClientListUpdatedListener=!0,xe.on("onTingPlayListRefresh",this.onTingPlayListRefresh))},addToListenLater(e,t){const n=e.listen_id||"",i=this.list.find((e=>e.listen_id===n)),o={newAdded:!0,currentTime:i&&i.currentTime,listen_id:n,listen_item:e};this.list=[o,...this.list].filter(((e,t,n)=>n.findIndex((t=>t.listen_id===e.listen_id))===t)),tr({listenId:n,onSuccess:()=>{this.notifyAppListChange(),this.$emit("add-to-listen-later",n)},onComplete:()=>"function"==typeof t&&t()})},adjustToNextPlay(e,t=0,n=!1){if(!(null==e?void 0:e.listen_id))return;const i=this.list.findIndex((t=>t.listen_id===e.listen_id));this.list=i<=0?[...this.list.slice(0,1),e,...this.list.slice(1)]:[...this.list.slice(0,1),this.list[i],...this.list.slice(1,i),...this.list.slice(i+1)],(({listenId:e,onSuccess:t,onError:n,onComplete:i})=>{ue.setSum(er,37,1),pe({url:"/mp/listenplayer?action=next_play&__biz=".concat(window.biz,"&appmsgid=").concat(window.mid,"&idx=").concat(window.idx),type:"POST",data:{listen_id:e},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof t&&t():("function"==typeof n&&n(),ue.setSum(er,38,1))},onError:()=>{"function"==typeof n&&n(),ue.setSum(er,38,1)},complete:()=>{"function"==typeof i&&i()}})})({listenId:e.listen_id||"",onSuccess:()=>this.notifyAppListChange()}),n&&this.report({EventType:23,Pos:t})},removeFromListenLater(e,t=0,n=!1){this.list=[...this.list].filter((t=>t.listen_id!==e)),nr({listenId:e,onSuccess:()=>{this.notifyAppListChange(),this.$emit("remove-from-listen-later",e)}}),n&&this.report({EventType:24,Pos:t})},batchRemoveFromListenLater(e){this.list=[...this.list].filter((t=>-1===e.indexOf(t.listen_id))),ke.isAndroid&&this.supportDynamicPlayList||e.forEach((e=>nr({listenId:e,onSuccess:()=>this.notifyAppListChange()})))},getFirstScreenData(){this.firstScreenDataError=!1,(({onSuccess:e,onError:t,onComplete:n})=>{ue.setSum(er,20,1),pe({url:"/mp/tts?action=getttslistenitem&__biz=".concat(window.biz,"&appmsgid=").concat(window.mid,"&idx=").concat(window.idx),type:"GET",dataType:"json",async:!0,success:n=>{n&&n.base_resp&&0===n.base_resp.ret&&n.tts_listenitem?"function"==typeof e&&e(n):("function"==typeof t&&t(n),ue.setSum(er,21,1))},error:()=>{"function"==typeof t&&t(),ue.setSum(er,21,1)},complete:()=>{"function"==typeof n&&n()}})})({onSuccess:e=>{this.firstScreenDataReady=!0,this.firstScreenDataError=!1,this.playInfo=e.tts_listenitem,this.base64=e.category_playlist_info_base64||"",this.$emit("list-base64-change",this.base64),!this.__autoPlayWhenGetFirstScreenData||2!==this.version&&3!==this.version||(this.supportDynamicPlayList?(this.addToListenLater(this.playInfo),this.getListData(!0),this.report({EventType:4})):this.addToListenLater(this.playInfo,(()=>{this.play(this.playInfo),this.getListData(!0),this.report({EventType:4})}))),this.__autoPlayWhenGetFirstScreenData=!1,setTimeout((()=>this.checkCardTitleAnime()))},onError:()=>{this.firstScreenDataReady=!1,this.firstScreenDataError=!0}})},getListData(e=!1,t){if(console.log("[audio panel] getList start:",e,this.hasMore,this.loading),!e&&(!this.hasMore||this.loading))return void this.$refs.bottomModal.finishPullUpLoad();this.loading=!0;const n=Math.random().toString("16").slice(2);this.loadingClientId=n,(({buffer:e,onSuccess:t,onError:n,onComplete:i})=>{ue.setSum(er,15,1),pe({url:"/mp/listenplayer?action=get_playlist&__biz=".concat(window.biz,"&appmsgid=").concat(window.mid,"&idx=").concat(window.idx),type:"POST",data:{session_buffer:e||"",count:20},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof t&&t(e):("function"==typeof n&&n(e),ue.setSum(er,16,1))},error:()=>{"function"==typeof n&&n(),ue.setSum(er,16,1)},complete:()=>{"function"==typeof i&&i()}})})({buffer:e?"":this.listSessionBuffer,onSuccess:i=>{if(n!==this.loadingClientId)return void(this.loading=!1);this.hasMore=i.has_more||!1,this.listSessionBuffer=i.session_buffer||"",this.base64=i.category_playlist_info_base64||"";const o=(i.results||[]).filter((e=>!!e.listen_id&&e.listen_item)).map((e=>({...e,newAdded:!0})));if(e){const e=this.list||[];this.list=[...o.map((t=>({...e.find((e=>e.listen_id===t.listen_id))||{},...t})))].filter(Fd("listen_id"))}else this.list=[...this.list,...o].filter(Fd("listen_id"));this.getPlayFinishedState(o.map((e=>e.listen_id))),this.loading=!1,"function"==typeof t&&t(this.list),console.log("[audio panel] getList: ".concat(JSON.stringify(i.results||[])," isFirst:").concat(e)),fe.info("[audio panel] getList: ".concat(JSON.stringify(i.results||[])," isFirst:").concat(e))},onError:()=>{n===this.loadingClientId?(this.loading=!1,this.hasMore=!1):this.loading=!1},onComplete:()=>{n===this.loadingClientId?this.$refs.bottomModal.finishPullUpLoad():this.loading=!1}})},report(e){var t;const n=(this.list||[]).find((e=>e.listen_id===this.playingListenId));try{const i={BizUin:window.biz,MsgId:+window.mid,Idx:+window.idx,ListenId:"".concat((null==n?void 0:n.listen_id)||""),ListenType:(null==(t=null==n?void 0:n.listen_item)?void 0:t.type)||0,Scene:1*window.source,SubScene:1*window.subscene,Pos:0,EventType:0,EventTime:parseInt(Date.now()/1e3,10),SessionId:"".concat(window.sessionid),EnterId:+window.enterid,ExpVersion:"".concat(this.version||0),PlayRate:parseInt(100*(this.playRate||1),10),ListenTime:parseInt(1e3*(+(null==n?void 0:n.currentTime)||0),10),ShutDownType:String(this.shutdownType)||"",ShutDownLeftTime:this.shutdownLeftTime||0,ListBase64:this.base64||"",TargetPos:0,...e};console.log("[audio panel] report data",i),me.report(32561,i)}catch(su){console.log("[audio panel] report error",su)}},play(e,t=!1,n=0){var i,o,a;const r=(e=>{var t,i,o,a,r,s,c,l,d,u,p,m,h,_,f;const g={username:(null==(t=null==e?void 0:e.author_info)?void 0:t.username)||"",name:(null==(i=null==e?void 0:e.author_info)?void 0:i.nickname)||"",bizUin:(null==(o=null==e?void 0:e.article_info)?void 0:o.bizuin)||"",webUrl:(null==(a=null==e?void 0:e.article_info)?void 0:a.url)||"",audioId:(null==(r=null==e?void 0:e.article_info)?void 0:r.audio_id)||""},w={appId:(null==(s=null==e?void 0:e.article_info)?void 0:s.biz_appid)||"",mid:"",webUrl:(null==(c=null==e?void 0:e.article_info)?void 0:c.url)||""},y={nonceId:(null==(l=null==e?void 0:e.finder_info)?void 0:l.nonce_id)||"",tid:(null==(d=null==e?void 0:e.finder_info)?void 0:d.tid)||""};return{listenId:(null==e?void 0:e.listen_id)||"",type:null==e?void 0:e.type,startTime:n,duration:parseInt((null==e?void 0:e.duration)/1e3,10)||123,srcId:(null==e?void 0:e.listen_id)||"",title:(null==(u=null==e?void 0:e.article_info)?void 0:u.audio_title)||(null==e?void 0:e.title)||(null==(p=null==e?void 0:e.article_info)?void 0:p.title)||(null==(m=null==e?void 0:e.finder_info)?void 0:m.title)||"",webUrl:(null==(h=null==e?void 0:e.article_info)?void 0:h.url)||"",dataUrl:null==(_=null==e?void 0:e.article_info)?void 0:_.audio_url,audioUrl:null==(f=null==e?void 0:e.article_info)?void 0:f.audio_url,author:(null==e?void 0:e.author)||"",cover:(null==e?void 0:e.cover)||"",...(null==e?void 0:e.article_info)?{mpInfo:g}:{},...(null==e?void 0:e.article_info)?{musicInfo:w}:{},...(null==e?void 0:e.finder_info)?{finderInfo:y}:{}}})(e);let s={openPlayerUI:!1,playMode:0,listenId:(null==e?void 0:e.listen_id)||"",itemList:[r],playbackRate:this.playRate||1,categoryPlaylistInfoBuffer:this.base64||"",categoryDeleteAfterListen:!0};const c={protocol:"",src:function(){var t;const n=(null==(t=null==e?void 0:e.article_info)?void 0:t.audio_url)||"",i=window.clientversion;return i&&(i>"18000e00"&&i<="18000e2d"||i>"18000f00"&&i<="18000f24")?"".concat(n,"&t=").concat(Date.now()):n}(),lowbandUrl:(null==(i=null==e?void 0:e.article_info)?void 0:i.audio_url)||"",title:null==e?void 0:e.title,epname:"",singer:(null==e?void 0:e.author)||"",srcId:null==e?void 0:e.listen_id,coverImgUrl:(null==e?void 0:e.cover)||"",webUrl:(null==(o=null==e?void 0:e.article_info)?void 0:o.url)||"",musicbar_url:(null==(a=null==e?void 0:e.article_info)?void 0:a.url)||"",needStartMusicUI:0,playbackRate:this.playRate||1,startTime:n},l=$s(null==e?void 0:e.type)&&1===Nd;let d=l?"setTingAudioState":"setBackgroundAudioState";l&&this.playingListenId&&this.playingListenId===r.listenId&&Wd&&!this.isPlaying&&!this.playLoading&&(d="operateTingAudio",s={operationType:"resume",srcId:this.playingSrcId}),xe.invoke(d,l?s:c,(t=>{console.log("[audio panel] play",d,l?s:c,t),fe.info("[audio panel] play ".concat(d," opt:").concat(JSON.stringify(l?s:c)," res:").concat(JSON.stringify(t))),-1===t.err_msg.indexOf("ok")?(this.hide(),window.weui.alert("暂无法播放，请重试"),ue.setSum(Md,17,1),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("t1t read fail","res: ".concat(JSON.stringify(t)," | url: ").concat(location.href),{mid:"mmbizwap:t1t_read_fail",view:"wap_business"})):(this.isPlaying=!0,this.playingListenId=e.listen_id||"",this.playingSrcId=e.listen_id||"")})),t&&(ue.setSum(Md,12,1),this.report({EventType:4,ListBase64:this.base64||""}))},pause(e=!0){e&&(ue.setSum(Md,13,1),this.report({EventType:5}));const t={operationType:"pause",srcId:this.playingSrcId},n=$s(this.playingType)&&1===Nd?"operateTingAudio":"operateBackgroundAudio";xe.invoke(n,t,(e=>{console.log("[audio panel] ".concat(n,": params:"),t,"res:",e),-1!==e.err_msg.indexOf("ok")&&(this.isPlaying=!1)}))},setCurrentTime(e,t){const n=this.list.findIndex((e=>e.listen_id===this.playingListenId)),i=this.list[n].listen_item.duration/1e3,o=parseInt(Math.max(Math.min(e,i),0),10),a={operationType:"seek",srcId:this.playingSrcId||"",seektime:o},r={operationType:"seek",currentTime:o},s=$s(this.list[n].listen_item.type)&&1===Nd,c=s?"operateTingAudio":"operateBackgroundAudio";xe.invoke(c,s?a:r,(e=>{console.log("[audio panel] ".concat(c),s?a:r,e),"function"==typeof t&&t()}))},getStatus(e,t=!0){xe.invoke(Nd?"getTingAudioState":"getBackgroundAudioState",{},(n=>{console.log("[audio panel] getStatus",Nd?"getTingAudioState":"getBackgroundAudioState",n),n&&n.item&&n.item.listenId&&t&&this.onGetStatusChange(n),"function"==typeof e&&e(n)}))},registerStatusObserver(){["onTingAudioStateChanged","onBackgroundAudioStateChange"].forEach((e=>{xe.on(e,(e=>{e&&e.item&&e.item.listenId&&this.onGetStatusChange(e)}))}))},getPlayFinishedState(e,t=!1){const n=(e||(this.list||[]).map((e=>e.listen_id))).filter((e=>e));n.length&&xe.invoke("operateTingAudio",{operationType:"getFinishedState",listenIds:n},(e=>{if(e&&e.err_msg&&-1!==e.err_msg.indexOf(":ok")){let n=e.results||[];if(ke.isAndroid&&"string"==typeof e.results)try{n=JSON.parse(n||"[]")||[]}catch(su){n=[]}n.forEach((e=>{const t=this.list.findIndex((t=>e.listenId===t.listen_id));-1!==t&&this.$set(this.list[t],"currentTime",+e.currentTime)})),this.getStatus((()=>this.removeFinishedAudio({results:n})),!t)}console.log("[audio panel] getPlayFinishedState",n,e)}))},notifyAppListChange(){this.supportDynamicPlayList&&xe.invoke("operateTingAudio",{operationType:"refreshPlayList",categoryPlaylistInfoBuffer:this.base64||""},(e=>{console.log("[audio panel] notify app refreshPlayList",e)}))},onShow(){this.isShow=!0,xe.invoke("operateTingAudio",{operationType:"setForegroundState",isForeground:!0},(e=>console.log("[audio panel] setForegroundState:true res:".concat(JSON.stringify(e)))))},onHide(){var e;this.isShow=!1,this.dragMoving=!1,xe.invoke("operateTingAudio",{operationType:"setForegroundState",isForeground:!1},(e=>console.log("[audio panel] setForegroundState:false res:".concat(JSON.stringify(e))))),this.$refs.bottomModal.scrollTo(0),this.report({EventType:3}),this.isShowList&&this.report({EventType:10}),null==(e=this.$refs.slideGroup)||e.reset()},onClickHideButton(){this.isShowList?(this.hideList(),this.report({EventType:9})):this.$refs.bottomModal.hide()},onScroll(){var e,t;const n=null==(t=null==(e=this.$refs.bottomModal)?void 0:e.$refs)?void 0:t.contentAreaWrp;n&&(n.scrollTop>130?this.playingAreaHide=!0:this.playingAreaHide=!1)},onVisibilityChange(){const e="visible"===document.visibilityState;e&&this.isOpened&&this.getListData(!0),e&&this.list&&this.list.length&&this.isOpened&&this.getPlayFinishedState(),e&&this.getStatus((e=>{e.playRate&&(this.playRate=+e.playRate,qd.set("play-rate",+e.playRate))}))},onGetStatusChange(e){var t;this.playingListenId=e.item.listenId,this.playingSrcId=e.item.srcId,this.playingType=e.item.type,"playing"===e.status?(this.isPlaying=!0,this.playLoading=!1,this.startCountDown(),this.list.some((t=>t.listen_id===e.item.listenId&&t.newAdded))&&(this.list=this.list.map((t=>t.listen_id===e.item.listenId?(t.newAdded=!1,t):t)))):"loading"===e.status?(this.isPlaying=!1,this.playLoading=!0,this.stopCountdown()):(this.playLoading=!1,this.isPlaying=!1,"idle"===e.status&&(this.playingListenId="",this.playingSrcId=""),this.stopCountdown()),e.duration&&this.playingInfo&&((null==(t=this.playingInfo.listen_item)?void 0:t.duration)&&this.playingInfo.listen_item.duration/1e3===e.duration||(this.list=this.list.map((t=>t.listen_item&&t.listen_id===e.item.listenId?(t.listen_item.duration=1e3*e.duration,t):t)))),(this.lastPlayId!==e.item.listenId||1===this.list.length&&"playing"!==e.status)&&this.getPlayFinishedState([this.lastPlayId],!0),this.lastPlayId&&this.lastPlayId!==e.item.listenId&&this.onSwitchAudio(e.item.listenId,this.lastPlayId),this.lastPlayId=e.item.listenId},onSwitchAudio(e,t){const n=this.list.find((t=>t.listen_id===e));n&&(this.selectInfo=n.listen_item),this.startCardTitleAnime()},onListScreenExpose(){this.report({EventType:8})},onPlayScreenExpose(){this.report({EventType:1}),this.showPlayingBar=!1},onPlayScreenLeave(){this.showPlayingBar=!0},onListItemExpose(e,t){},onListItemLeave(e,t){},onClickPlayingBar(){var e,t;const n=null==(t=null==(e=this.$refs.bottomModal)?void 0:e.$refs)?void 0:t.contentAreaWrp;null==n||n.scrollTo({top:0,behavior:"smooth"})},onSeeking(e,t){this.stopCountdown(),this.$set(this.list[t],"currentTime",parseInt(e,10)),this.__hasReportSeeking||(this.__hasReportSeeking=!0,this.report({EventType:18}),ue.setSum(Md,28,1))},onSeeked(e,t){this.$set(this.list[t],"currentTime",parseInt(e,10)),this.setCurrentTime(e),this.startCountDown(),this.__hasReportSeeking=!1,this.report({EventType:19}),ue.setSum(Md,29,1)},onSetShutdown(e){const{key:t}=e||{};"number"==typeof t?xe.invoke("operateTingAudio",{operationType:"setShutdown",shutdownType:"afterMins",time:t},(e=>{console.log("[audio panel] setShutdown afterMins",e),/:ok$/.test(e.err_msg)&&this.showTips("将在".concat(t,"分钟后停止播放"))})):(xe.invoke("operateTingAudio",{operationType:"setShutdown",shutdownType:t},(e=>{console.log("[audio panel] setShutdown",t,e),/:ok$/.test(e.err_msg)&&("none"===t?this.hideTips():this.showTips("将在此音频播放结束时停止播放"))})),"none"===t&&ue.setSum(Md,31,1)),this.shutdownType=t,"number"==typeof t&&(this.shutdownLeftTime=t),this.report({EventType:17}),ue.setSum(Md,30,1)},onBackward(e,t){var n;const i=-1===t?this.list.findIndex((e=>{var t;return e.listen_id===(null==(t=this.playInfo)?void 0:t.listen_id)})):t,o=Math.max(((null==(n=this.list[i])?void 0:n.currentTime)||0)-e,0);this.$set(this.list[i],"currentTime",parseInt(o,10)),this.setCurrentTime(o),this.report({EventType:14}),ue.setSum(Md,25,1)},onForward(e,t){var n,i;const o=-1===t?this.list.findIndex((e=>{var t;return e.listen_id===(null==(t=this.playInfo)?void 0:t.listen_id)})):t,a=Math.min(((null==(n=this.list[o])?void 0:n.currentTime)||0)+e,((null==(i=this.list[o])?void 0:i.duration)||1/0)/1e3);this.$set(this.list[o],"currentTime",parseInt(a,10)),this.setCurrentTime(a),this.report({EventType:15}),ue.setSum(Md,26,1)},onChangeRate(){const e=[1,1.25,1.5,.75],t=e.indexOf(this.playRate),n=e[(t+1)%e.length];this.playRate=n,xe.invoke("operateTingAudio",{operationType:"playRate",srcId:this.playingSrcId||"",playRate:this.playRate},(e=>{console.log("[audio panel] setPlayRate",e),1!==this.playRate?this.showTips("已切换至".concat(this.playRate,"倍速播放")):this.hideTips()})),qd.set("play-rate",n),this.report({EventType:16}),ue.setSum(Md,27,1)},onClickRemoveFromList(e,t,n){return e.stopPropagation(),e.preventDefault(),this.removeFromListenLater(t,n,!0),!1},onTingPlayListRefresh(e){console.log("deanti onTingPlayListRefresh",e)},onSlideStart(){this.slideMoving=!0},onSlideEnd(){this.slideMoving=!1},onMoveChosen(){this.dragMoving=!0,document.addEventListener("touchmove",this.onDragMove,{capture:!0}),xe.invoke("vibrateShort",{style:"medium"})},onMoveUnchoose(){this.dragMoving=!1},onMoveStart(e){this.dragMoving=!0,this.__dragStartY=e.originalEvent.pageY,this.transitionDis=0,this.transitionGapByScroll=0},onDragMove(e){const t=((e.touches&&e.touches[0]||{}).pageY||0)-this.__dragStartY;this.transitionDis=t+(ke.isIOS?this.transitionGapByScroll:0),e.preventDefault()},onMoveDone(){this.dragMoving=!1,document.removeEventListener("touchmove",this.onDragMove)},onMoveUpdate(e){var t,n;this.dragMoving=!1,this.__disableTransitionTimeout&&(clearTimeout(this.__disableTransitionTimeout),this.__disableTransitionTimeout=null),this.disableTransition=!0,this.__disableTransitionTimeout=setTimeout((()=>{this.disableTransition=!1}),500),(null==(t=this.list[0])?void 0:t.listen_id)!==this.playingListenId&&this.playingListenId&&(null==(n=this.list[0])?void 0:n.listen_item)&&this.changePlay(this.list[0],0,!1),(({listenId:e,pos:t,onSuccess:n,onError:i,onComplete:o})=>{ue.setSum(er,35,1),pe({url:"/mp/listenplayer?action=move&listen_id=".concat(e,"&target_pos=").concat(t,"&__biz=").concat(window.biz,"&appmsgid=").concat(window.mid,"&idx=").concat(window.idx),type:"POST",data:{listen_id:e,target_pos:t},async:!0,dataType:"json",success:e=>{e&&e.base_resp&&0===e.base_resp.ret?"function"==typeof n&&n():("function"==typeof i&&i(),ue.setSum(er,36,1))},error:()=>{"function"==typeof i&&i(),ue.setSum(er,36,1)},complete:()=>{"function"==typeof o&&o()}})})({listenId:e.data.listen_id||"",pos:e.newIndex,onSuccess:()=>this.notifyAppListChange()}),this.report({EventType:25,Pos:(null==e?void 0:e.oldIndex)||0,TargetPos:(null==e?void 0:e.newIndex)||0})},showTopAnime(){this.showTopAnimeArea=!0},afterTopAnimeAreaEnter(){this.__afterTopAnimeAreaEnterTimeout=setTimeout((()=>{this.showTopAnimeArea=!1}),0)},showListenLaterAnime(){},checkCardTitleAnime(){this.cardTitleAnime=!1},startCardTitleAnime(){if(!this.cardTitleAnime)return;const e=this.$refs.cardTitle;if(!e)return;if(this.__titleAnime)return;const t=e.children[0].getBoundingClientRect().width,n=t/40*1e3;this.__titleAnime=e.animate([{offset:0,transform:"translate3d(0, 0, 1.1px)"},{offset:1,transform:"translate3d(-".concat(t,"px, 0, 1.1px)")}],{easing:"linear",duration:n,delay:1e3}),this.__titleAnime.onfinish=()=>{this.__titleAnime=void 0}}}},(function(){var e,t,n,i,o,a,r,s,c,l,d,u=this,p=u._self._c;return p("div",{ref:"container"},[p("mp-bottom-modal",{ref:"bottomModal",attrs:{"close-btn-type":"fold","ext-class":"audio-panel-modal ".concat(u.slideMoving?"audio-panel-disable-touch-action":""),top:u.modalTop,"need-head-line":!1,"hide-when-sideslip":!u.dragMoving,"hide-when-scroll-down":!u.dragMoving,"header-type":1===u.version?"slide":"normal"},on:{show:u.onShow,hide:u.onHide,"click-slide-btn":u.hide,"show-after-animation":u.startCardTitleAnime,"hide-after-animation":u.hideList,"pullup-load":u.getListData}},[2===u.version||3===u.version?p("div",{staticClass:"modal-title",attrs:{slot:"title"},on:{click:u.scrollToNowPlaying},slot:"title"},[p("div",{staticClass:"title"},[u._v("播放列表")]),p("div",{directives:[{name:"show",rawName:"v-show",value:u.playingAreaHide&&u.playingListenId,expression:"playingAreaHide && playingListenId"}],staticClass:"desc"},[p("div",{staticClass:"playing",class:{pause:!u.isPlaying&&!u.playLoading},attrs:{role:"figure","aria-describedby":"播放中"}},[p("div",{staticClass:"dot1"}),p("div",{staticClass:"dot2"}),p("div",{staticClass:"dot3"}),p("div",{staticClass:"dot4"})]),p("span",[u._v(u._s(u.playingInfo&&u.playingInfo.listen_item&&u.playingInfo.listen_item.title))])])]):u._e(),p("div",{ref:"wrp",staticClass:"audio-panel__wrp",style:u.isShowList?"":"overflow: hidden;"},[u.firstScreenDataReady||u.firstScreenDataError?!u.firstScreenDataReady&&u.firstScreenDataError?p("div",{ref:"playWrp",staticClass:"audio-panel__screen error",on:{click:u.getFirstScreenData}},[p("div",{staticClass:"weui-loadmore"},[p("div",{staticClass:"weui-loadmore__tips"},[u._v("加载失败，请点击重试")])])]):[1===u.version?p("div",{staticClass:"audio-panel__playing-bar-wrp"},[p("transition",{attrs:{name:"fade"}},[p("div",{directives:[{name:"show",rawName:"v-show",value:u.showPlayingBar&&(null==(e=u.playingInfo)?void 0:e.listen_item)&&(u.isPlaying||u.playLoading||u.playChanging),expression:"showPlayingBar && playingInfo?.listen_item && (isPlaying || playLoading || playChanging)"}],staticClass:"audio-panel__playing-bar",on:{click:u.onClickPlayingBar}},[p("span",[u._v("Playing : "+u._s((null==(i=null==(n=null==(t=u.playingInfo)?void 0:t.listen_item)?void 0:n.article_info)?void 0:i.audio_title)||(null==(a=null==(o=u.playingInfo)?void 0:o.listen_item)?void 0:a.title)))])])])],1):u._e(),p("Intersect",{attrs:{threshold:[0]},on:{enter:u.onPlayScreenExpose,leave:u.onPlayScreenLeave}},[1===u.version?p("div",{ref:"playWrp",staticClass:"audio-panel__screen info-screen",class:{"playing-mask":u.showProgress}},[p("div",{staticClass:"audio-panel__play-area",class:{"show-progress":u.showProgress}},[p("div",{ref:"playerCover",staticClass:"audio-panel__play-area__cover",style:"background-image: url(".concat(u.selectInfo&&u.selectInfo.cover,")")}),p("div",{staticClass:"audio-panel__play-area__right"},[p("div",{staticClass:"audio-panel__play-area__info"},[p("div",{staticClass:"info-title"},[u._v(u._s((null==(s=null==(r=u.selectInfo)?void 0:r.article_info)?void 0:s.audio_title)||u.selectInfo.title))]),p("div",{staticClass:"info-desc"},[p("span",{staticClass:"info-desc__author",attrs:{id:"info-desc__author"}},[u._v(u._s(u.selectInfo.author))]),u.showProgress?2!==u.selectInfo.type?p("span",{staticClass:"info-desc__duration"},[u._v("音频由作者上传")]):u._e():p("span",{directives:[{name:"show",rawName:"v-show",value:u.selectInfo.duration,expression:"selectInfo.duration"}],staticClass:"info-desc__duration",class:u.showProgress?"hidden":"",attrs:{id:"info-desc__duration","aria-hidden":u.showProgress?"true":"false"}},[u._v(u._s(u._f("durationFormatter")(u.selectInfo.duration)))])]),p("div",{directives:[{name:"show",rawName:"v-show",value:!u.showProgress&&2!==u.selectInfo.type,expression:"!showProgress && selectInfo.type !== 2"}],staticClass:"info-desc"},[p("span",[u._v("音频由作者上传")])])]),u._e()])]),u._e(),p("transition-group",{staticClass:"audio-panel__operate-area-wrp",attrs:{name:"operate-fade"}},[u.showProgress?p("Progress",{key:"progress",attrs:{"play-rate":+u.playRate,"is-playing":u.isPlaying||u.playLoading,"current-time":(null==(c=u.playingInfo)?void 0:c.currentTime)||0,"has-set-shut-down":"none"!==u.shutdownType,duration:(null==(d=null==(l=u.playingInfo)?void 0:l.listen_item)?void 0:d.duration)||0},on:{"change-rate":function(e){return u.onChangeRate()},"set-shutdown":u.callShutdownPanel,forward:function(e){return u.onForward(30,u.playingIndex)},backward:function(e){return u.onBackward(15,u.playingIndex)},"toggle-play":function(e){return u.changePlay(u.playingInfo,u.playingIndex,!0)},seeked:e=>u.onSeeked(e,u.playingIndex),seeking:e=>u.onSeeking(e,u.playingIndex)}}):p("div",{key:"operate-btns",staticClass:"audio-panel__operate-area small"},[p("button",{staticClass:"operate-btn js_wx_tap_highlight",on:{click:u.togglePlay}},[p("i",{class:u.playBtnIconClass}),p("span",[u._v(u._s(u.isPlaying&&u.playingListenId===u.playInfo.listen_id?"Pause":"Play"))])]),p("button",{staticClass:"operate-btn",class:[u.hasInList?"has-in":"js_wx_tap_highlight"],on:{click:function(e){return u.toggleListenLater()}}},[p("i",{staticClass:"icon",class:[u.hasInList?"icon-correct":"icon-listen-later"]}),p("span",[u._v(u._s(u.hasInList?"已加入":"加入列表"))])])])],1)],1):u._e()]),p("Intersect",{attrs:{threshold:[0]},on:{enter:u.onListScreenExpose}},[p("div",{ref:"listScreen",staticClass:"audio-panel__screen list-screen",style:"--top-anime-top: ".concat(u.topAnimeAreaTop,"px; --top-anime-top-end: ").concat(-u.topAnimeAreaTop,"px;")},[p("div",{staticClass:"audio-panel__list-area",style:"--drag-ghost-transition-dis: ".concat(u.transitionDis,"px;")},[1===u.version?p("div",{ref:"listSubTitle",staticClass:"sub-title"},[u._v("播放列表")]):u._e(),p("mp-slide-view-group",{ref:"slideGroup"},[p("VueDraggable",{attrs:{delay:300,scroll:!0,"bubble-scroll":!1,"scroll-fn":u.onDragScroll,"touch-start-threshold":5,disabled:!u.supportDynamicPlayList&&!u.slideMoving,target:".audio-list-sort-wrp"},on:{end:u.onMoveDone,start:u.onMoveStart,update:u.onMoveUpdate,choose:u.onMoveChosen,unchoose:u.onMoveUnchoose},model:{value:u.list,callback:function(e){u.list=e},expression:"list"}},[p("transition-group",{staticClass:"audio-list-sort-wrp",attrs:{name:"audio-list"}},u._l(u.list,(function(e,t){return p("mp-slide-view",{key:"slide-item-".concat(e.listen_id),attrs:{disabled:!u.supportDynamicPlayList&&!u.dragMoving,"extra-class":["audio-list__item-slide-wrp","pos-".concat(t),u.playingListenId===e.listen_id?"now-playing":"",u.disableTransition?"disable-transition":""]},on:{end:u.onSlideEnd,start:u.onSlideStart},scopedSlots:u._u([{key:"btns",fn:function(){return[u.list.findIndex((t=>t.listen_id===e.listen_id))>=2?p("mp-slide-item",{directives:[{name:"show",rawName:"v-show",value:!u.dragMoving,expression:"!dragMoving"}],attrs:{"extra-class":"slide-item-primary","not-last":""},on:{click:function(n){return u.adjustToNextPlay(e,t,!0)}}},[u._v("下一个播放")]):u._e(),p("mp-slide-item",{directives:[{name:"show",rawName:"v-show",value:!u.dragMoving,expression:"!dragMoving"}],on:{click:n=>u.onClickRemoveFromList(n,e.listen_id,t)}},[u._v("Delete")])]},proxy:!0}],null,!0)},[p("Intersect",{attrs:{threshold:[0]},on:{enter:e=>u.onListItemExpose(e,t),leave:e=>u.onListItemLeave(e,t)}},[p("audio-list-item",{key:"audio-".concat(e.listen_id),ref:"audioItem",refInFor:!0,attrs:{info:e,"play-rate":+u.playRate,"is-playing":u.isPlaying||u.playLoading,playing:u.playingListenId===e.listen_id,"has-set-shut-down":"none"!==u.shutdownType},on:{pause:function(e){return u.pause(!1)},"change-rate":function(e){return u.onChangeRate()},"set-shutdown":u.callShutdownPanel,forward:function(e){return u.onForward(30,t)},backward:function(e){return u.onBackward(15,t)},click:function(n){return u.changePlay(e,t,!0)},"toggle-play":function(n){return u.changePlay(e,t,!0)},seeked:e=>u.onSeeked(e,t),seeking:e=>u.onSeeking(e,t)}})],1)],1)})),1)],1)],1),p("div",{directives:[{name:"show",rawName:"v-show",value:!u.loading&&!u.hasMore&&0===u.list.length,expression:"!loading && !hasMore && list.length === 0"}],staticClass:"weui-loadmore weui-loadmore_line empty"},[p("span",{staticClass:"weui-loadmore__tips"},[u._v("暂无收听历史")])]),p("div",{directives:[{name:"show",rawName:"v-show",value:u.loading,expression:"loading"}],staticClass:"weui-loadmore"},[p("div",{staticClass:"weui-loadmore__tips"},[p("i",{staticClass:"weui-loading"})])]),p("div",{directives:[{name:"show",rawName:"v-show",value:!u.loading&&!u.hasMore&&u.list.length,expression:"!loading && !hasMore && list.length"}],staticClass:"weui-loadmore weui-loadmore_line weui-loadmore_dot"},[p("span",{staticClass:"weui-loadmore__tips"})])],1)])])]:p("div",{ref:"playWrp",staticClass:"audio-panel__screen empty"},[p("div",{staticClass:"weui-loadmore"},[p("div",{staticClass:"weui-loadmore__tips"},[p("i",{staticClass:"weui-loading"})])])]),p("div",{staticClass:"audio-panel__modal-bottom-mask",on:{touchstart:function(e){e.stopPropagation(),e.preventDefault()},touchmove:function(e){e.stopPropagation(),e.preventDefault()},touchend:function(e){e.stopPropagation(),e.preventDefault()}}})],2)]),p("div",{ref:"animeCover",staticClass:"anime-cover",style:u.animeCoverStyle,attrs:{"aria-hidden":"true"},on:{animationend:function(e){u.isShowingListenLaterAnime=!1}}}),p("Teleport",{attrs:{to:"body"}},[p("Tips",{attrs:{"tips-wording":u.tipsWording},model:{value:u.tipsShow,callback:function(e){u.tipsShow=e},expression:"tipsShow"}}),p("OptionMenu",{attrs:{"active-key":u.shutdownType,"wrp-style":u.shutdownPanelPosition,options:u.shutdownOptions},on:{select:u.onSetShutdown},model:{value:u.shutdownPanelShow,callback:function(e){u.shutdownPanelShow=e},expression:"shutdownPanelShow"}})],1)],1)}),[],!1,null,"287c1f25",null,null).exports,Hd=window.Vue;function Vd(e,t){const n=document.querySelector('mp-common-claudio[listen_id="'.concat(e,'"]')),i=document.querySelector('mp-common-mpaudio[listen_id="'.concat(e,'"]'));n&&n.setAttribute("has-added-listen-later",t),i&&i.setAttribute("has-added-listen-later",t),window.musicList&&Object.keys(window.musicList).forEach((n=>{const i=window.musicList[n];i.listenId===e&&i.player&&(i.player._o.hasAddedListenLater=t)}))}if(window.localStorage&&window.localStorage.getItem){const e=4500,t="loadSec-"+window.biz+"-"+window.mid+"-"+window.idx;let n=window.localStorage.getItem(t);n&&window.write_sceen_time-parseInt(n,10)>e&&(me.report(20801,{Bizuin:window.biz,MsgId:1*window.mid,ItemIdx:1*window.idx,Url:window.msg_source_url||"",Title:window.msg_title||""}),window.localStorage.removeItem(t))}const Kd=function(){let e=window.location.href.split("?")[1];if(e){let t=e.split("&");for(let e=0;e<t.length;e++){const[n,i]=t[e].split("=");if("imageIndex"===n)return parseInt(i,10)}return""}return""}();function $d(e){return e&&e.getBoundingClientRect?e.getBoundingClientRect().top+function(){let e=0;return void 0!==window.pageXOffset?e=window.pageXOffset:void 0!==document.compatMode&&"BackCompat"!==document.compatMode?e=document.documentElement.scrollTop:void 0!==document.body&&(e=document.body.scrollTop),e}():0}function Jd(){if(""===Kd)return;const e=function(){const e=[],t=document.getElementsByTagName("img");for(let n=0,i=t.length;n<i;n++){const i=t.item(n);i.getAttribute("data-src")&&e.push(i)}return e}();if(Kd>e.length)return;const t=$d(e[Kd]);window.scroll(0,t)}function Gd(){let e=!1,t=window.performance||window.msPerformance||window.webkitPerformance;if(!(t&&t.timing&&t.timing.navigationStart))return!1;e=t.timing.navigationStart,function(){let t=window.performance&&window.performance.timing,n=window.write_sceen_time-e,i=window.first_sceen__time-e,o=window.page_endtime-e,a=(window.onload_endtime||+new Date)-e;-1!=navigator.userAgent.indexOf("MicroMessenger")&&(n=real_show_page_time-e,i=real_show_page_time-e);let r=window.logs.jsapi_ready_time?window.logs.jsapi_ready_time-e:void 0,s=window.logs.a8key_ready_time?window.logs.a8key_ready_time-e:void 0,c=t&&t.connectEnd-t.connectStart,l=t&&t.secureConnectionStart&&t.connectEnd-t.secureConnectionStart,d=t&&t.domainLookupEnd&&t.domainLookupStart&&t.domainLookupEnd-t.domainLookupStart;if(window.logs.pagetime.wtime=n,window.logs.pagetime.ftime=i,window.logs.pagetime.ptime=o,window.logs.pagetime.onload_time=a,window.logs.pagetime.jsapi_ready_time=r,window.logs.pagetime.a8key_ready_time=s,need_report_cost?pe({url:"/mp/report_cost",type:"post",data:{id_key_list:["1|1|"+o,"1|2|"+i,"1|3|"+a,"1|4|"+r,"1|5|"+s,"1|6|"+c,"1|7|"+l,"1|8|"+d].join(";")}}):Math.random()<.01&&pe({url:"/mp/report_cost",type:"post",data:{id_key_list:["#1|1|"+o,"1|2|"+i,"1|3|"+a,"1|4|"+r,"1|5|"+s,"1|6|"+c,"1|7|"+l,"1|8|"+d].join(";")}}),need_report_cost&&i>3e3){let e=new Image,t=(new Date).getTime();e.onload=function(){let e=(new Date).getTime()-t,n=(new Date).getTime(),i=new Image;i.onload=function(){let t=(new Date).getTime()-n;pe({url:"/mp/report_cost",type:"post",data:{id_key_list:["^2|1|"+e,"2|2|"+t].join(";")}})},i.src="http://ugc.qpic.cn/adapt/0/7d8963bb-aace-df23-0569-f8a4e388eacb/100?r="+Math.random()},e.src="http://ugc.qpic.cn/adapt/0/7d8963bb-aace-df23-0569-f8a4e388eacb/100?r="+Math.random()}function u(){if(-1==navigator.userAgent.indexOf("NetType/"))return!1;let e=["2G","cmwap","cmnet","uninet","uniwap","ctwap","ctnet"];for(let t=0,n=e.length;t<n;++t)if(-1!=navigator.userAgent.indexOf(e[t]))return!0;return!1}Math.random()>.2||a<0||n<0||i<0||o<0||(r&&ue.setAvg(27822,15,r),s&&ue.setAvg(27822,17,s),o>=15e3?ue.setAvg(27822,29,o):(ue.setAvg(27822,1,o).setAvg(27822,3,a).setAvg(27822,5,i),window.isWeixinCached&&ue.setAvg(27822,19,o),u()?(ue.setAvg(27822,9,o),window.isWeixinCached&&ue.setAvg(27822,23,o)):"wifi"==networkType?(ue.setAvg(27822,7,o),window.isWeixinCached&&ue.setAvg(27822,21,o)):"2g/3g"==networkType?(ue.setAvg(27822,11,o),window.isWeixinCached&&ue.setAvg(27822,25,o)):"4g"==networkType?(ue.setAvg(27822,14,o),window.isWeixinCached&&ue.setAvg(27822,26,o)):(ue.setAvg(27822,13,o),window.isWeixinCached&&ue.setAvg(27822,28,o)),window.moon&&moon.clearSample&&(ue.setAvg(27822,71,o),u()?ue.setAvg(27822,73,o):"wifi"==networkType?ue.setAvg(27822,75,o):"2g/3g"==networkType?ue.setAvg(27822,77,o):"4g"==networkType?ue.setAvg(27822,78,o):ue.setAvg(27822,79,o)),c&&ue.setAvg(27822,65,c),l&&ue.setAvg(27822,67,l),d&&ue.setAvg(27822,69,d)))}(),window.logs.jsapi_ready_fail&&ue.setSum(24729,55,window.logs.jsapi_ready_fail),function(){const e=document.getElementById("page-content");if(!e||Math.random()>.1)return;const n=function(){const i=document.getElementById("js_content_end"),o=window.pageYOffset||document.documentElement.scrollTop,a=i.offsetTop;if(o+Oe.getInnerHeight()>=a){let i,o,a=e.getElementsByTagName("img"),r={},s=[],c=0,l=0,d=0;for(let e=0,t=a.length;e<t;++e){let t=a[e];i=t.getAttribute("data-src")||t.getAttribute("src"),o=t.getAttribute("src"),i&&(i.isCDN()?l++:d++,c++,r[o]={})}if(s.push("1="+1e3*c),s.push("2="+1e3*l),s.push("3="+1e3*d),t.getEntries){let e=t.getEntries(),n=window.logs&&window.logs.img&&window.logs.img.download;if(!n)return;let i=[0,0,0],o=[0,0,0];c=l=0;for(let t=0,s=e.length;t<s;++t){let n=e[t],a=n.name;a&&"img"==n.initiatorType&&r[a]&&(a.isCDN()&&(o[0]+=n.duration,l++),i[0]+=n.duration,c++,r[a]={startTime:n.startTime,responseEnd:n.responseEnd})}i[0]>0&&c>0&&(i[2]=i[0]/c),o[0]>0&&l>0&&(o[2]=o[0]/l);for(let t in n)if(n.hasOwnProperty(t)){let e=n[t],a=0,s=0,c=0,l=0;for(let t=0,n=e.length;t<n;++t){let n=e[t];if(r[n]&&r[n].startTime&&r[n].responseEnd){let e=r[n].startTime,t=r[n].responseEnd;a=Math.max(a,t),s=s?Math.min(s,e):e,n.isCDN()&&(c=Math.max(a,t),l=s?Math.min(s,e):e)}}i[1]+=Math.round(a-s),o[1]+=Math.round(c-l)}let a=4,d=7;for(let t=0;t<3;t++)i[t]=Math.round(i[t]),o[t]=Math.round(o[t]),i[t]>0&&(s.push(a+t+"="+i[t]),"wifi"==networkType?s.push(a+t+6+"="+i[t]):"2g/3g"!=networkType&&"4g"!=networkType||s.push(a+t+12+"="+i[t])),o[t]>0&&(s.push(d+t+"="+o[t]),"wifi"==networkType?s.push(d+t+6+"="+o[t]):"2g/3g"!=networkType&&"4g"!=networkType||s.push(d+t+12+"="+o[t]))}De.off(window,"scroll",n,!1)}};De.on(window,"scroll",n,!1)}(),function(){if(Math.random()>.001)return;const e=document.createElement("iframe"),t=Math.ceil(10*Math.random())-1,n=uin+mid+idx+Math.ceil(1e3*Math.random())+(new Date).getTime();e.style.display="none",e.id="js_ajax",e.setAttribute("data-time",t),e.src="/mp/iframetest?action=page&traceid="+n+"&devicetype="+devicetype+"&timeout="+[600,800,1e3,1200,1500,2e3,3e3,5e3,1e4,18e3][t];document.getElementById("js_article").appendChild(e)}()}""!==Kd&&"scrollRestoration"in history&&(history.scrollRestoration="manual"),"loading"!==document.readyState?Jd():window.addEventListener("DOMContentLoaded",(function(){Jd()})),De.on(window,"load",(function(){if(""==networkType&&window.isInWeixinApp()){let e={"network_type:fail":"fail","network_type:edge":"2g/3g","network_type:wwan":"2g/3g","network_type:wifi":"wifi"};JSAPI.invoke("getNetworkType",{},(function(t){networkType=e[t.err_msg],"network_type:edge"!=t.err_msg&&"network_type:wwan"!=t.err_msg||(t.detailtype&&"4g"==t.detailtype||t.subtype&&"4g"==t.subtype)&&(networkType="4g"),Gd()}))}else Gd()}),!1),window.page_endtime=+new Date;const Yd="https://mp.weixin.qq.com/s/bpYquVzmjFzY_IrmCsxniQ",Xd=ke.isWp||ke.isIOS||ke.isAndroid;const Qd=pt({components:{[w.name]:w},data:()=>({isNavShow:!0}),mounted(){document.addEventListener("visibilitychange",(()=>{var e;!this.isNavShow&&!document.hidden&&(null==(e=this.secControl)?void 0:e.ad_violation_middle_page)>0&&(this.isNavShow=!0,n.hide(),n.show({alpha:.6}))}))},computed:{...p({secControl:e=>e.extRes.sec_control})},watch:{secControl:{handler(e){(null==e?void 0:e.ad_violation_middle_page)>0&&this.$nextTick((()=>{Xd?this.show():(document.body.parentNode.style.overflow="hidden",window.weui.dialog({content:"当前内容可能存在未经审核的第三方商业营销信息，请确认是否继续访问。",buttons:[{label:"继续访问",type:"default",onClick:()=>{this.report(1),document.body.parentNode.style.overflow="auto"}},{label:"Cancel",type:"primary",onClick:()=>{this.closePage()}}],isAndroid:ke.isAndroid}))}))},immediate:!0}},methods:{show(){this.$refs.bottomModal.show()},hide(){this.report(1),this.$refs.bottomModal.hide(),this.isNavShow&&n.hide()},closePage(){this.report(2),ke.isWechat?xe.invoke("closeWindow",(e=>{-1===e.err_msg.indexOf("ok")&&(window.close(),window.open("about:blank","_top").close())})):(window.close(),window.open("about:blank","_top").close())},onTermClick(e){e.preventDefault(),"A"===e.target.tagName&&(ke.isWechat?xe.invoke("openUrlWithExtraWebview",{url:Yd,openType:1},(e=>{-1===e.err_msg.indexOf("ok")?location.href=Yd:this.isNavShow=!1})):location.href=Yd)},report(e){me.report(30608,{action:e,scene:1,url:location.href,mid:1*window.mid||0,idx:1*window.idx||0,bizuin:window.biz&&1*window.atob(window.biz)||0})}}},(function(){var e=this,t=e._self._c;return t("mp-bottom-modal",{ref:"bottomModal",attrs:{"auto-height":"","has-header":!1,"hide-when-mask-click":!1},scopedSlots:e._u([{key:"footer",fn:function(){return[t("div",{staticClass:"weui-half-screen-dialog__btn-area"},[t("a",{staticClass:"weui-btn weui-btn_default",attrs:{href:"javascript:","wah-hotarea":"click"},on:{click:e.hide}},[e._v("继续访问")]),t("a",{staticClass:"weui-btn weui-btn_primary",attrs:{href:"javascript:","wah-hotarea":"click"},on:{click:e.closePage}},[e._v("Cancel")])]),t("div",{staticClass:"weui-half-screen-dialog__attachment-area",on:{click:e.onTermClick}},[t("a",{staticClass:"weui-link",attrs:{href:"javacript:;"}},[e._v("微信公众平台广告规范指引")])])]},proxy:!0}])},[t("p",{staticClass:"ad_control-tips"},[e._v("当前内容可能存在未经审核的第三方商业营销信息，请确认是否继续访问。")])])}),[],!1,null,"d1299f68",null,null).exports;let Zd,eu="";const tu=(ke.isAndroid||ke.isIOS)&&ke.isWechat&&!ke.isWxWork;function nu(){try{if(!window.ad_keywords)return;const{adKeywordsList:e,posIdxList:t}=et(window.ad_keywords),{maxRenderNum:n,groupId:i,msgKeyWords:o}=tt(window.frontend_exp_list,e);if(!tu||0===e.length||-1===i)return;const a=document.getElementById("js_content"),r=nt(a,{ignorePreloadNode:!0,ignoreNotWriteableChildren:!0}),s=it(a);Zd=i,eu=o;let c=n-document.querySelectorAll(".".concat(ot)).length;const d=at(e,{groupId:i,msgKeyWords:o});for(const l of t){if(0===c)break;const t=e.find((e=>e.idx_info.idx_range_list.includes(l)));rt({adKeywordItem:t,posObj:l},r,s)&&c--}document.querySelectorAll(".".concat(ot)).forEach((e=>{var t;(null==(t=e._adinfo)?void 0:t.data)&&(d.observe(e),function(e,t){e.addEventListener("click",(e=>{e.stopPropagation(),Qe({keyword:t.keyword,eventType:2,msgKeyWords:eu,groupId:Zd}),l.commit("mp-adv-keyword/setAdKeywordItem",t),l.commit("mp-adv-keyword/setReportData",{groupId:Zd,msgKeyWords:eu}),l.commit("mp-adv-keyword/setShow",!0)}),!0)}(e,e._adinfo.data))})),Qe({keyword:"",eventType:0,groupId:Zd,msgKeyWords:eu})}catch(cu){console.error("initAdvKeywords",cu)}}const iu=window.Vue;Q(l);const ou=!!window.is_login;on(0),Z(l),(window.user_uin||Wt())&&qt(l,eo),window.is_login||!document.getElementById("js_profile_card")||ke.isWxWork||Wt()&&document.getElementById("js_profile_card_modal")||new Ia({render:e=>e(Sa)}).$mount("#js_profile_card");try{he.os.ios&&he.os.getNumVersion()>=16&&(ue.setSum(110809,78,1),he.isLockdownMode()&&ue.setSum(110809,79,1)),window.customElements?ue.setSum(110809,70,1):ue.setSum(110809,71,1),document.head.createShadowRoot||document.head.attachShadow?ue.setSum(110809,72,1):ue.setSum(110809,73,1)}catch(lu){console.log(lu)}!function(){const e=112287,t=document.getElementById("js_content"),n=document.getElementsByTagName("tbody");if(t.innerHTML.length>1048576&&(ue.setSum(e,44,1),t.innerText.length<5e3&&t.scrollHeight<1e4)){ue.setSum(e,45,1);const t={Url:location.href,Reason:3,Title:window.msg_title,Createtime:window.create_time,SendTime:window.svr_time};if(me.report(31768,t),0===n.length){ue.setSum(e,46,1);const t={Url:location.href,Reason:4,Title:window.msg_title,Createtime:window.create_time,SendTime:window.svr_time};me.report(31768,t)}}}(),function(){const e=112287,t=document.getElementById("js_content").innerHTML;let n="mpEditor";if(t){t.match(/powered-by="(\S*)"/)?n=t.match(/powered-by="(\S*)"/)[1]:t.match(/data-tools="(\S*)"/)?n=t.match(/data-tools="(\S*)"/)[1]:0==t.indexOf("西瓜插件")?n="西瓜插件":t.match(/[P|p]owered by "(\S*)"/)?n=t.match(/[P|p]owered by "(\S*)"/)[1]:t.includes("_mbEditor")&&(n="美编助手");.5<Math.random()<.6&&window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("type: ".concat(n," | url: ").concat(location.href),"type: ".concat(n),{mid:"mmbizwap:editor_report",view:"wap_business"})}t&&(t.match(/powered-by="(\S*)"/)||t.match(/data-tools="(\S*)"/)||0==t.indexOf("西瓜插件")||t.match(/[P|p]owered by "(\S*)"/)||t.includes("_mbEditor")?ue.setSum(e,47,1):ue.setSum(e,48,1))}(),Xe.setGvar({payType:0,pageType:0,albumId:window.appmsg_album_info.id||""}),iu.config.errorHandler=(e,t,n)=>{e._info=n,window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.onError(e),console.error("Vue errorHandler",n,e)},console.info("[图文信息] 三元组:",window.biz,window.mid,window.idx),console.info("[用户信息] 设备信息: 是否安卓",he.os.android,"是否IOS",he.os.ios,"是否秒开场景",window.__second_open__,"系统版本",he.os.version,"用户uin",window.user_uin,"是否小程序内打开",ke.isInMiniProgram),window.__immersiveListMode&&xe.invoke("disableBounceScroll",{place:["top","bottom"]}),ee.initHtmlMinHeight(),window.__second_open__||window.ext_complete||de.setExtLoadDom(),Pe.on("ext-complete",(()=>{window.requestAnimationFrame(de.removeExtLoadDom)})),Pe.on("interact-ext-complete",(()=>{window.requestAnimationFrame(de.removeExtLoadDom)}));let au=-1,ru=!1;if(window.logs.pagetime.jsapi_ready_time=+new Date,window.logs.idkeys={},fe.log("[Appmsg] start run index.js init"),function(){const e=(new Date).getHours(),t=function(e,t){t=t||"",window.isSg?(t=["uin:sougou","resp:".concat(t)].join("|"),ue.setLogs({id:24729,key:e,value:1,log:t})):(t=["uin:".concat(window.user_uin),"resp:".concat(t)].join("|"),ue.setLogs({id:24729,key:e,value:1,log:t}))},n=e>=11&&e<=17&&Math.random()<1;window.__report=t,window.__commonVideoReport=function(e,i){n&&t(e,i)},window.__addIdKeyReport=function(e,t,n){const i=e+"_"+t;n=n||1,window.logs.idkeys[i]||(window.logs.idkeys[i]={val:0}),window.logs.idkeys[i].val+=n}}(),Oe.initWebCompt(["wxOpen"],(e=>{window.__is_support_wxOpen=e.err_msg&&e.err_msg.indexOf(":ok")>-1,(document.getElementsByTagName("mpsubscribe")&&document.getElementsByTagName("mpsubscribe").length||document.getElementsByTagName("mp-common-subscribe")&&document.getElementsByTagName("mp-common-subscribe").length)&&Ar()})),function(){if(setTimeout((()=>{let e=document.getElementsByClassName("wx-edui-video_source_link");e=Array.prototype.slice.call(e),e.forEach((e=>{e&&e.addEventListener("click",(()=>{const t=e.dataset.hitUsername,n=e.dataset.hitBiz;Se.goProfile({biz:n},{username:t})}))}))}),500),function(){window.is_teenager?ue.setSum(286024,0,1):Us()}(),ls.init(),window.is_new_msg&&-1!=navigator.userAgent.indexOf("MicroMessenger")){window.title&&(window.title=window.title.replace(/&#39;/g,"'").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")),window.msg_title&&(window.msg_title=window.msg_title.replace(/&#39;/g,"'").replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")),hd_head_img||a.jsmonitor({id:115849,key:26,value:1}),ou&&!window.show_comment_bar&&le(!1);const e=document.querySelectorAll("mp-common-product, mp-common-videosnap"),t={userName:window.user_name,bizNickName:window.nickname,bizNickNameBackup:window.title,cover:"",title:window.msg_title,headImg:window.hd_head_img,roundHeadImg:window.round_head_img,digest:window.msg_desc,reportData:{BizUin:window.biz,AppMsgID:1*window.mid,ItemIndex:1*window.idx,Scene:1*window.source,SubScene:1*window.subscene,EnterId:1*window.enterid,SessionId:window.sessionid,ItemShowType:1*window.item_show_type},hasFinderElement:e.length>0?1:0,canReadArticle:!window.tempkey&&window.tts_is_show&&Jt(document.querySelector("#js_content"))>300};if(ke.isAndroid){t.cover="",ce.init(t);const e=window.cdn_url_1_1||window.cdn_url_235_1||"",n=new Image;e&&(n.src=e,n.onload=()=>{n.width<2048&&n.height<2048&&(t.cover=e,ce.init(t)),window.topbarInited=!0},n.onerror=()=>{window.topbarInited=!0})}else t.cover=window.cdn_url_1_1||window.cdn_url_235_1||window.msg_cdn_url,ce.init(t);De.on(window,"scroll",(()=>{ru||ke.isAndroid&&!window.topbarInited||(ut(0),ru=!0)})),xe.invoke("createWebViewForFastLoad",{scene:1},(e=>{console.log(e)}))}let e=document.getElementsByTagName("body");if(!e||!e[0])return!1;e=e[0];!function(){const e=[],t=document.getElementById("js_content").getElementsByTagName("a");for(let r=0;r<t.length;r++)null!==t[r].getAttribute("data-itemshowtype")&&e.push(t[r]);const n=[];Array.prototype.map.call(document.getElementById("js_content").getElementsByClassName("h5_image_link"),(e=>{e.parentNode.getAttribute("href")&&e.parentNode.getAttribute("href").length>0&&n.push(e)}));const i=[];Array.prototype.map.call(document.getElementById("js_content").getElementsByClassName("weapp_image_link"),(e=>{i.push(e)}));const o=window.innerHeight||document.documentElement.clientHeight;function a(){!function(){if(e.length){const t=document.documentElement.scrollTop||document.body.scrollTop;for(let n=0;n<e.length;n++)if(1!=e[n].getAttribute("hasload")){const i=e[n].getBoundingClientRect();(i.top<o+t&&i.top>t||i.top+i.height>t&&i.top+i.height<o+t)&&e[n].getAttribute("href").length>0&&(e[n].setAttribute("hasload",1),xe.invoke("downloadPageDataForFastLoad",{itemList:[{item_show_type:e[n].getAttribute("data-itemshowtype"),url:e[n].getAttribute("href")}]},(e=>{console.log(e)})),e.splice(n,1),n--)}}}(),function(){for(let e=0;e<n.length;e++){const t=n[e],i=t.getBoundingClientRect();(i.top<=0&&i.top+i.height>=0||i.top>0&&i.top<o)&&(n.splice(e,1),e--,se.report([1,se.getRedirectType(t.parentNode.getAttribute("href")),"",window.img_popup?1:0,window.source,se.getUrlData(t.parentNode.getAttribute("href"))]))}for(let e=0;e<i.length;e++){const t=i[e],n=t.getBoundingClientRect();(n.top<=0&&n.top+n.height>=0||n.top>0&&n.top<o)&&(i.splice(e,1),e--,se.report([1,1,"",window.img_popup?1:0,window.source,t.getAttribute("data-miniprogram-appid")]))}}()}De.on(window,"scroll",a),a()}();let t=null;(()=>{const e=document.querySelector("#js_ting_heard");if(e){const n=function(){let e=1;const t=";".concat(document.cookie).split(";").map((e=>e.trim().split("="))).reduce(((e,[t,n])=>("mp-exp__audio-panel"===t&&(e=+n),e)),void 0);return void 0!==t&&(e=t),e}();n&&(ue.setSum(293511,18,1),2===n&&ue.setSum(293511,23,1),3===n&&ue.setSum(293511,24,1),t=function(e="#audio_panel_area",t=1){const n=new Hd({store:l,version:t,...Ud}).$mount(e);return n.$on("add-to-listen-later",(e=>Vd(e,1))),n.$on("remove-from-listen-later",(e=>Vd(e,0))),n.$on("list-base64-change",(e=>{window.musicList&&Object.keys(window.musicList).forEach((t=>{const n=window.musicList[t];n.listBase64=e,n.player&&(n.player._o.listBase64=e)}))})),n}("#audio_panel_area",n));let i=!0,o=!1;new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&(o||(o=!0,ce.topbarReport(4),ue.setSum(293511,4,1)))}))}),{threshold:.5}).observe(e),window.frontend_exp_list&&window.frontend_exp_list.forEach((e=>{"tts_floating"===e.key&&(i=1!=+e.value)}));const a=(e=!0)=>{if(e&&(ce.topbarReport(5),ue.setSum(293511,5,1)),t&&n){e&&me.report(32561,{BizUin:window.biz,MsgId:+window.mid,Idx:+window.idx,Scene:1*window.source,SubScene:1*window.subscene,ListenId:"",ListenType:0,Pos:0,EventType:13,EventTime:parseInt(Date.now()/1e3,10),SessionId:"".concat(window.sessionid),EnterId:+window.enterid,ExpVersion:"".concat(n||0),PlayRate:0,ListenTime:0,ShutDownType:"",ShutDownLeftTime:0,ListBase64:""});if(!1!==t.show())return;e&&ue.setSum(293511,22,1)}const o={openPlayerUI:i,itemList:[{type:2,startTime:0,duration:123,srcId:location.href,title:window.msg_title||"",webUrl:window.msg_link||location.href,author:window.nickname||window.cgiData.nick_name||"",cover:window.cdn_url_1_1||window.__appmsgCgiData.hd_head_img||"",mpInfo:{username:window.user_name||"",name:window.nickname||window.cgiData.nick_name||"",bizUin:window.biz?parseInt(window.atob(window.biz),10):0,webUrl:window.msg_link||location.href}}]};console.log("+++++++++++++++ tingReadOpt",o),xe.invoke("setTingAudioState",o,(e=>{console.log("+++++++++++++++ tingReadRes",e),-1===e.err_msg.indexOf("ok")&&(window.weui.alert("暂无法朗读，请重试"),ue.setSum(293511,6,1),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("t1t read fail","res: ".concat(JSON.stringify(e)," | url: ").concat(location.href),{mid:"mmbizwap:t1t_read_fail",view:"wap_business"}))}))};window.__hasClickedAudioPanelHandler&&e.removeEventListener("click",window.__hasClickedAudioPanelHandler),window.__hasClickedAudioPanel&&(a(),window.__hasClickedAudioPanel=!1),De.on(e,"click",(()=>a())),xe.on("onTingEntryClick",(()=>{a(!1),ue.setSum(293511,34,1),me.report(32561,{BizUin:window.biz,MsgId:+window.mid,Idx:+window.idx,ListenId:"",ListenType:0,Scene:1*window.source,SubScene:1*window.subscene,Pos:0,EventType:22,EventTime:parseInt(Date.now()/1e3,10),SessionId:"".concat(window.sessionid),EnterId:+window.enterid,ExpVersion:"".concat(n||0),PlayRate:0,ListenTime:0,ShutDownType:"",ShutDownLeftTime:0,ListBase64:""})}))}})();const n=/^http(s)?:\/\/mp\.weixin\.qq\.com\//g;try{if(top!=window&&(!top||top&&location.href&&n.test(location.href))&&!window.isSg)throw new Error("in iframe")}catch(su){const t="";ue.setLogs({id:24729,key:4,value:1,log:"biz:".concat(biz,",mid:").concat(mid,",uin:").concat(uin,",[key4]").concat(t).substring(0,1024)})}if(window.isInWeixinApp()&&/#rd$/.test(location.href)&&!window.isWeixinCached&&!window.__second_open__&&!ke.isWxWork){const e=-1!=location.href.indexOf("?")?"&":"?";location.replace(location.href.replace(/#rd$/,e+"rd2werd=1#wechat_redirect"))}const i=!ke.isWp&&-1==navigator.userAgent.indexOf("MicroMessenger"),s=ke.isMpapp&&ke.cpVersion("2.25.0",1,!0,"mpapp");if(window.__review_image__=!i||s||/wxwork\/([\d.]+)/i.test(navigator.userAgent)?new Ge({isHttpsRes:is_https_res}):null,function(){const e=document.getElementById("js_content");let t=!1;const n=e.getElementsByTagName("img");for(let i=0,o=n.length;i<o;i++){const e=n[i].getAttribute("data-src");if(e&&e.canHevc()){t=!0;break}}if(!t){const n=e.querySelectorAll("[data-lazy-bgimg]");for(let e=0,i=n.length;e<i;e++){const i=n[e].getAttribute("data-lazy-bgimg");if(i&&i.canHevc()){t=!0;break}}}t?ht((e=>{_t((t=>{$a(e,t)}))})):_t((e=>{$a(!1,e)}))}(),window.__review_image__){const e=document.getElementById("js_cover");window.__review_image__.add({container:document.getElementById("js_content"),imgs:e?[e]:[]})}Ua(),new Xo({store:l,render:e=>e(Yo)}).$mount("#content_bottom_area"),new ka({store:l,render:e=>e(ba)}).$mount("#page_bottom_area"),new iu({store:l,render:e=>e(Qd)}).$mount("#js_ad_control"),function(){const e=document.getElementById("profileBt"),t=document.getElementById("copyright_info"),n=[];if(e){let t="57";"28"==window.source&&(t="96"),"31"===window.source&&(t="103"),"30"===window.source&&(t="102"),"29"==window.source&&(t="39"),"15"==window.source&&(t="121"),n.push({dom:e,username:user_name,profileReportInfo:window.profileReportInfo||"",scene:t})}t&&source_encode_biz&&n.push({dom:t,source_encode_biz:source_encode_biz,scene:"161"});for(let i=0,o=n.length;i<o;i++)!function(e){De.on(e.dom,"click",(t=>{if("copyright_info"==e.dom.id&&source_encode_biz)Ci.card_click_report({scene:"0"}),Se.goProfile({biz:e.source_encode_biz,scene:e.scene},{username:source_username,scene:e.scene+""});else{if(fe.log("[Appmsg] profile_click_before_loadprofile: username:"+e.username+", scene:"+e.scene),Ie.profileReport({hotspotjson:JSON.stringify({hotspotinfolist:window.hotspotInfoList})}),profileReportInfo){const e=String(profileReportInfo).split("_");3==e.length&&pe({url:"/mp/ad_biz_info?action=report&__biz="+window.biz+"&report_type=2&aid="+e[1]+"&tid="+e[2],type:"GET",dataType:"json",async:!0,success(e){}})}ke.isWxWork&&(ke.isIOS||ke.isAndroid)?Ee():1==isprofileblock?xe.invoke("openUrlWithExtraWebview",{url:"https://mp.weixin.qq.com/mp/profileblock?__biz="+window.biz+"#wechat_redirect",openType:1},(e=>{-1==e.err_msg.indexOf("ok")&&(location.href="https://mp.weixin.qq.com/mp/profileblock?__biz="+window.biz+"#wechat_redirect")})):xe.invoke("profile",{username:e.username,profileReportInfo:e.profileReportInfo||"",scene:e.scene+"",bizuin:window.biz&&1*window.atob(window.biz)||0},(t=>{window.__addIdKeyReport("28307","1"),fe.log("[Appmsg] profile_click_after_loadprofile: username:"+e.username+", scene:"+e.scene+", profileReportInfo:"+e.profileReportInfo+", res.err_msg:"+t.err_msg)}))}t.preventDefault()})),ke.isWp&&e.dom.setAttribute("href","weixin://profile/"+e.username)}(n[i])}(),function(){function e(){const e=function(){if("hidden"in document)return"hidden";const e=["webkit","moz","ms","o"];for(let t=0;t<e.length;t++)return e[t]+"Hidden";return null}();return!!e&&document[e]}function t(t){if(e())for(let e=0;e<window.originalVideoAdFrames.length;e++)window.originalVideoAdFrames[e].contentWindow.postMessage({action:"pauseAd",value:""},"*");else window.originalVideoAdCurrentFrame&&window.originalVideoAdCurrentFrame.contentWindow.postMessage({action:"playAd"},"*")}document.webkitVisibilityState?document.addEventListener("webkitvisibilitychange",t,!1):document.msVisibilityState?document.addEventListener("msvisibilitychange",t,!1):document.visibilityState&&document.addEventListener("visibilitychange",t,!1)}();try{const e=document.getElementById("js_author_name");if(e){let t="";De.on(e,"click",(n=>!!be.hasClass(e,"rich_media_meta_link")&&(window.is_temp_url?(window.weui.alert("Unable to do this in preview"),!1):!zt("js_author_name")&&(!!e.getAttribute("data-rewardsn")&&(1==e.getAttribute("data-canreward")&&(t="https://mp.weixin.qq.com/mp/author?action=show&author_id="+author_id+"&rewardsn="+e.getAttribute("data-rewardsn")+"&timestamp="+e.getAttribute("data-timestamp")+"&__biz="+window.biz+"&appmsgid="+window.appmsgid+"&idx="+window.idx+"&scene=142&rscene=129&from_scene="+window.source+"&from_subscene="+window.subscene+"&from_enterid="+window.enterid+"&from_sessionid="+window.sessionid+"&is_fans="+window.isFans+"&is_paidarticle="+window.isPaySubscribe+"&author_from_scene=0#wechat_redirect",!ke.isInMiniProgram&&void(-1!=navigator.userAgent.indexOf("MicroMessenger")&&(ke.isIOS||ke.isAndroid||ke.isWp)?(window.__addIdKeyReport("110809","1"),xe.invoke("openUrlWithExtraWebview",{url:t,openType:1},(e=>{-1==e.err_msg.indexOf("ok")&&(location.href=t)}))):window.open(t))))))))}}catch(su){}new te({container:document.getElementById("js_content"),changeHref(e,t){if(e=e.trim(),1===window.ban_jump_link.block_atag)return ban_jump_link.atag_intcp_url;if(!e||0!=e.indexOf("http://mp.weixin.qq.com/")&&0!=e.indexOf("https://mp.weixin.qq.com/")){if(18==ban_scene)return"/mp/ban?action=check&__biz="+biz+"&mid="+mid+"&idx="+idx+"&scene="+ban_scene+"#wechat_redirect";if(0!=e.indexOf("http://mp.weixinbridge.com/mp/wapredirect")&&0!=e.indexOf("https://mp.weixinbridge.com/mp/wapredirect")&&0!=e.indexOf("https://support.weixin.qq.com/cgi-bin/mmsupport-bin/showredpacket"))return"https://mp.weixinbridge.com/mp/wapredirect?url="+encodeURIComponent(e)+"&action=appmsg_redirect&uin="+uin+"&biz="+biz+"&mid="+mid+"&idx="+idx+"&type="+t+"&scene=0"}else{let t="&";-1==(e=(e=(e=e.replace(/#rd\s*$/,"")).replace(/#wechat_redirect\s*$/,"")).replace(/[\?&]scene=21/,"")).indexOf("?")&&(t="?"),e+=t+"scene=21#wechat_redirect"}return e}}),function(){if(!document.getElementsByClassName)return;let e=document.getElementsByClassName("js_product_section"),t=document.getElementsByClassName("js_product_a"),n=[];function i(e){let t=window.pageYOffset||document.documentElement.scrollTop;for(let i=0;i<n.length;++i){let e=n[i];if(!e.isReport){let n=e.offsetTop;t<=n&&t+Oe.getInnerHeight()>=n&&(e.isReport=!0,(new Image).src="/mp/appmsgreport?action=appmsg_recom&type=1&__biz="+biz+"&ascene="+(window.ascene||-1)+"&mid="+mid+"&idx="+idx+"&sn="+sn+"&product_id="+e.product_id+"&order="+e.order+"&r="+Math.random())}}}for(let o=0;o<e.length;++o){let t=e[o];t.dataset&&t.dataset.product_id&&t.dataset.order&&n.push({dom:t,offsetTop:t.offsetTop,product_id:t.dataset.product_id||"",order:t.dataset.order||"",isReport:!1})}n.length>0&&(De.on(window,"scroll",i),i());for(let o=0;o<t.length;++o)!function(e){De.on(e,"click",(function(t){let n=e.dataset||{};return(new Image).src="/mp/appmsgreport?action=appmsg_recom&type=2&__biz="+biz+"&ascene="+(window.ascene||-1)+"&mid="+mid+"&idx="+idx+"&sn="+sn+"&product_id="+(n.product_id||"")+"&order="+(n.order||"")+"&r="+Math.random(),!!n.href&&(setTimeout((function(){location.href="https://mp.weixinbridge.com/mp/wapredirect?url="+encodeURIComponent(n.href)+"&action=appmsg_redirect&uin="+uin+"&biz="+biz+"&mid="+mid+"&idx="+idx+"&scene=0"}),300),!1)}),!0)}(t[o])}(),window.originalVideoAdFrames=[],window.originalVideoAdCurrentFrame=null,window.originalVideoAdFramesUnsetList=[],window.addEventListener("message",(e=>{let t="";const n=document.getElementsByTagName("iframe");if(e.data&&"originalVideoAdNeedData"==e.data.action&&e.data.vid)if(window.originalVideoAdFramesAdData){window.originalVideoAdFramesAdData&&window.originalVideoAdFramesAdData[e.data.vid]&&(t=window.originalVideoAdFramesAdData[e.data.vid]);for(let i=0;i<n.length;i++)n[i].dataset&&n[i].dataset.mpvid==e.data.vid&&n[i].contentWindow.postMessage({action:"receiveOriginalVideoData",vid:e.data.vid,adData:t},"*")}else console.log(e.data.vid," has no ad data yet"),window.originalVideoAdFramesUnsetList.push(e.data.vid)})),Ye(),window.fromWeixinCached||Ma();ne.getAdData(window.reportVid);let c=[];voiceList&&voiceList.voice_in_appmsg&&voiceList.voice_in_appmsg.length>0&&(c=voiceList.voice_in_appmsg);dr(c,t),function(){try{new Za}catch(lu){console.error("initMusic err",lu)}}(),nu(),lt(),ie(),(()=>{const e=document.querySelectorAll(fr.oldTagName);for(let n=0;n<e.length;n++){const t=e[n],i=document.createElement("mp-common-search"),o=t.getAttribute("data-keywords");t.parentNode.appendChild(i),t.parentNode.removeChild(t),i.setAttribute("data-nickname",window.nickname),i.setAttribute("data-headImg",window.round_head_img),i.setAttribute("data-keywords",o)}const t=document.querySelectorAll(fr.tagName);if(!(t.length<=0))for(let n=0,i=t.length;n<i;n++){const e=t[n];e.classList.add("js_wx_tap_highlight");let i=[];try{i=JSON.parse(window.decodeURIComponent(e.getAttribute("data-keywords")))}catch(su){ue.setSum(110809,50,1)}if(i.length){const t={nickname:window.nickname,avatar:window.round_head_img,keywords:i};fr.keywords=i;const n=e.parentNode.querySelector('[data-preloadingid="mp-common-search"]');n&&n.parentNode.removeChild(n),gr({dom:e,keywords:t.keywords})}}})(),(()=>{const e=document.querySelectorAll(pr.oldTagName);for(const i of e){const e=document.createElement(pr.tagName);i.parentNode.appendChild(e),i.parentNode.removeChild(i);const t=["pluginname","id","poiid","districtid","name","address","img","longitude","latitude","provice","city","hasreport","type"];for(const n of t){const t="data-".concat(n);e.setAttribute(t,i.getAttribute(t))}}const t=document.querySelectorAll(pr.tagName);for(let i=0,o=t.length;i<o;i++){const e=t[i];e.classList.add("js_wx_tap_highlight");const n={id:decodeURIComponent(e.getAttribute("data-id")||""),name:decodeURIComponent(e.getAttribute("data-name")||""),address:decodeURIComponent(e.getAttribute("data-address")||""),img:decodeURIComponent(e.getAttribute("data-img")||""),longitude:decodeURIComponent(e.getAttribute("data-longitude")||""),latitude:decodeURIComponent(e.getAttribute("data-latitude")||""),type:decodeURIComponent(e.getAttribute("data-type")||"")},o=e.parentNode.querySelector('[data-preloadingid="'+n.id+'"]');o&&o.parentNode.removeChild(o),pr.poiDom.push(e),hr({poiInfo:n,dom:e})}const n=document.getElementsByClassName("js_poi_entry");for(let i=0;i<n.length;i++)(e=>{const t=n[e];be.removeClass(t,"ct_geography_loc_tip"),be.addClass(t,"wx_poi_link"),be.addClass(t,"js_wx_tap_highlight"),be.addClass(t,"wx_tap_link"),pr.poiDom.push(t),De.on(t,"click",(e=>{e.stopPropagation(),e.preventDefault();const n={id:decodeURIComponent(t.getAttribute("data-id")||""),name:decodeURIComponent(t.getAttribute("data-name")||""),address:decodeURIComponent(t.getAttribute("data-address")||""),img:decodeURIComponent(t.getAttribute("data-img")||""),longitude:decodeURIComponent(t.getAttribute("data-longitude")||""),latitude:decodeURIComponent(t.getAttribute("data-latitude")||""),type:decodeURIComponent(t.getAttribute("data-type")||"")};return n.longitude&&n.latitude&&n.name&&n.address&&(me.report(19937,Object.assign({},pr.commonReportData,{type:1,actiontype:2})),ue.setSum(110809,57,1),mr(n)),!1}),!0)})(i);_r(),De.on(window,"scroll",_r)})(),Ba.initCpslink(),Oi.init(),1===window.show_msg_voice&&(Ja(),console.log("load voicemsg"));!window.__appmsgCgiData||1!=window.__appmsgCgiData.wxa_product&&1!=window.__appmsgCgiData.wxa_cps||yr();oe.init(),document.getElementsByTagName("mp-qa").length&&gi.renderQaCard({mid:window.mid,idx:window.idx,isLogin:!!window.is_login,userUin:window.user_uin,biz:window.biz,itemShowType:window.item_show_type,sessionId:window.sessionid,enterId:window.enterid,scene:window.source,subScene:window.subscene});const d=document.getElementsByTagName("mp-common-videosnap");(document.getElementsByTagName("mpvideosnap")&&document.getElementsByTagName("mpvideosnap").length||d&&d.length)&&$t();const u=document.getElementsByTagName("mp-common-profile");(document.getElementsByTagName("mpprofile")&&document.getElementsByTagName("mpprofile").length||u&&u.length)&&qr();document.getElementsByTagName("mp-common-sticker")&&document.getElementsByTagName("mp-common-sticker").length&&$r();if(function(){Yr&&Yr.length&&rs()}(),document.getElementsByTagName("mp-wxaproduct").length){const e=window.__appmsgCgiData.minishopCardData?JSON.parse(decodeURIComponent(window.__appmsgCgiData.minishopCardData)):"";_n({biz:window.biz,mid:window.mid,idx:window.idx,source:1*window.source,subscene:1*window.subscene,enterid:1*window.enterid,minishopCards:e})}function p(){const e=window.performance||window.msPerformance||window.webkitPerformance;if(e.timing){const t=e.timing;fe.log("[Appmsg] dns:"+(t.domainLookupEnd-t.domainLookupStart)+"^^^ ssl:"+(0==t.secureConnectionStart?0:t.connectEnd-t.secureConnectionStart)+"^^^ tcp:"+(t.connectEnd-t.connectStart)+"^^^ request:"+(t.responseStart-t.requestStart)+"^^^ getPackageTime:"+(t.responseEnd-t.responseStart)+"^^^ domCententLoaded:"+(t.domContentLoadedEventStart-t.domLoading)+"^^^ domComplete:"+(t.domComplete-t.domLoading)+"^^^ firstViewTime:"+(real_show_page_time-t.navigationStart)+"^^^ interactiveTime:"+(window.page_endtime-t.navigationStart)),window.navigator.userAgent,setTimeout((()=>{t.loadEventEnd&&fe.log("[Appmsg] onload:"+(t.loadEventEnd-t.loadEventStart))}),100)}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),""==document.getElementById("js_content").innerHTML.trim()&&ue.setSum(24729,94,1);Math.random()<.001&&document.getElementById("js_read_area3")&&document.getElementById("js_read_area3").innerText&&document.getElementById("js_read_area3").innerText.indexOf("Pageview")>-1&&ue.setSum(24729,95,1),window.__wxjs_is_wkwebview&&ue.setSum(28307,67,1)}xe.invoke("getNetworkType",{},(function(e){networkType=Pr[e.err_msg],"network_type:edge"!=e.err_msg&&"network_type:wwan"!=e.err_msg||(e.detailtype&&"4g"==e.detailtype||e.subtype&&"4g"==e.subtype)&&(networkType="4g"),Er()})),void De.on(window,"load",Er,!1),new yi({biz:window.biz,isPaySubscribe:window.isPaySubscribe,container:document.getElementById("js_content"),logid:18504,baseData:["",window.biz,window.mid,window.idx,window.location.href,window.msg_title]}),setTimeout((()=>{De.tap(document.getElementById("copyright_logo"),(()=>{const e="http://kf.qq.com/touch/sappfaq/150211YfyMVj150326iquI3e.html";window.__second_open__?xe.invoke("openUrlWithExtraWebview",{url:e,openType:1},(t=>{-1==t.err_msg.indexOf("ok")&&(location.href=e)})):location.href=e})),rn(),ae.init({dom:document.getElementById("js_report_article3"),title:window.msg_title.htmlDecode(),link:window.msg_link}),function(){if(i&&!window.cps_article_data){document.title=window.msg_title.htmlDecode(),be.addClass(e,"not_in_mm");const t=document.getElementById("js_pc_qr_code_img");if(t){let e=10000004;const n=document.referrer;if(0==n.indexOf("http://weixin.sogou.com")?e=10000001:0==n.indexOf("https://wx.qq.com")&&(e=10000003),window.isSg)t.setAttribute("src",sg_qr_code.htmlDecode());else{t.setAttribute("src","/mp/qrcode?scene="+e+"&size=102&__biz="+biz+"&mid="+mid+"&idx="+idx+"&sn="+sn+"&send_time="+send_time);(new Image).src="/mp/report?action=pcclick&__biz="+biz+"&uin="+uin+"&scene="+e+"&r="+Math.random()}document.getElementById("js_pc_qr_code").style.display="block"}}else{const e=document.getElementById("js_report_article3");e&&(e.style.display="")}}();const t=document.getElementsByTagName("map");for(let e=0,i=t.length;e<i;++e)t[e].parentNode.removeChild(t[e]);if(Ci.card_pv_report(),Math.random()<.01)try{const e="https://js.aq.qq.com/js/aq_common.js",t=document.createElement("script");t.src=e;document.getElementsByTagName("head")[0].appendChild(t)}catch(su){}const n=document.getElementById("js_close_temp");De.on(n,"click",(()=>{n.parentNode.parentNode.removeChild(n.parentNode),be.removeClass(document.getElementById("js_article"),"preview_appmsg")}))}),1e3),function(){if(!he.os.ios||!("onorientationchange"in window))return;const e=[],t="onorientationchange"in window?"orientationchange":"resize";let n=!1;const i=function(){return 90===Math.abs(window.orientation)?1:2};1!==i()||n||(Xe.report110809(63),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("horizontal screen report","biz: ".concat("function"==typeof window.atob&&window.biz?window.atob(window.biz):window.biz," | mid: ").concat(window.mid," | idx: ").concat(window.idx," | url: ").concat(location.href),{mid:"mmbizwap:horizontal_screen",view:"wap_business"}),n=!0),e.push({ori:i(),scroll:window.pageYOffset||document.documentElement.scrollTop,istouchmove:!1});const o=(new Date).getHours();De.on(window,t,(()=>{const t=e.length-2,a=i();if(au=+new Date,t>=0){const n=e[t];e[e.length-1].istouchmove||(o>=11&&o<=17&&window.__report(63),setTimeout((()=>{window.scrollTo(0,n.scroll)}),100))}e.push({ori:a,scroll:window.pageYOffset||document.documentElement.scrollTop,istouchmove:!1}),1!==a||n||(Xe.report110809(63),window.WX_BJ_REPORT&&window.WX_BJ_REPORT.BadJs&&window.WX_BJ_REPORT.BadJs.report("horizontal screen report","biz: ".concat("function"==typeof window.atob&&window.biz?window.atob(window.biz):window.biz," | mid: ").concat(window.mid," | idx: ").concat(window.idx," | url: ").concat(location.href),{mid:"mmbizwap:horizontal_screen",view:"wap_business"}),n=!0)})),De.on(window,"scroll",(()=>{const t=e.length-1,n=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,o=Date.now();if(-1!=au){if(console.log("[横屏滚动检测]",o-au),o-au<500)return void(au=-1)}else au=-1;e[t].ori==i()&&(e[t].scroll=n,e[t].istouchmove=!0)}))}(),fe.log("[Appmsg] href:"+location.href+"^^^ ua:"+window.navigator.userAgent),window.addEventListener?window.addEventListener("load",p,!1):window.attachEvent&&window.attachEvent("onload",p);void(window.addEventListener&&document.getElementsByTagName("body")[0].addEventListener("copy",(()=>{ue.setSum(28307,18,1),ke.isIOS&&ue.setSum(28307,19,1),ke.isAndroid&&ue.setSum(28307,20,1)}),!1)),window.__observer&&window.__observer_data&&Hs();"undefined"!=typeof isSg&&function(){if(document.getElementById("js_report_article3")&&(document.getElementById("js_report_article3").style.display="none"),document.getElementById("js_content_end")&&(document.getElementById("js_content_end").style.display="none"),function(){const e=document.createElement("div");e&&(e.innerHTML=je.tmpl(ur,{}),document.body.appendChild(e))}(),new o.Emotion({emotionPanel:r("#js_emotion_panel"),inputArea:r("#js_cmt_input"),emotionPanelArrowWrp:r("#js_emotion_panel_arrow_wrp"),emotionSwitcher:r("#js_emotion_switch"),emotionSlideWrapper:r("#js_slide_wrapper"),emotionNavBar:r("#js_navbar"),submitBtn:r("#js_cmt_submit")}),navigator.userAgent.toLowerCase().match(/ios/)){const t=navigator.userAgent.toLowerCase().match(/(?:sogousearch\/ios\/)(.*)/);if(t&&t[1]){const n=t[1].replace(/\./g,"");parseInt(n)>422&&e("ios")}}else e("android");function e(e){const t=document.getElementById("js_cover"),n=[];t&&n.push(t);const i=document.getElementById("js_content");if(i){const e=i.getElementsByTagName("img")||[];for(let t=0,i=e.length;t<i;t++)n.push(e.item(t))}const o=[];for(let a=0,r=n.length;a<r;a++){const t=n[a],i=t.getAttribute("data-src")||t.getAttribute("src");i&&(o.push(i),function(n){De.on(t,"click",(function(t){return"ios"==e?window.JSInvoker&&window.JSInvoker.openImageList&&window.JSInvoker.openImageList(JSON.stringify({index:n,array:o})):window.JSInvoker&&window.JSInvoker.weixin_openImageList&&window.JSInvoker.weixin_openImageList(JSON.stringify({index:n,array:o})),!1}))}(a))}}window.onerror=function(e){ue.setLogs({id:24729,key:86,value:1,log:e})}}();setTimeout((()=>{const e=function(){ue.setLogs({id:28307,key:49,value:1,log:"[28307_49_appmsg_fe_filter]"+encodeURIComponent(location.href)})},t=(window.appmsg_fe_filter||"").split(","),n=function(t,n){try{if(!t)return;if(t.querySelectorAll){const i=t.querySelectorAll("*["+n+"]");if(i&&i.length>0){e();for(let e=0;e<i.length;++e)i[e]&&i[e].removeAttribute&&i[e].removeAttribute(n)}return}const i=t.childNodes;if(t.hasAttribute&&t.hasAttribute(n)&&e(),t.removeAttribute&&t.removeAttribute(n),i&&i.length)for(let e=0;e<i.length;++e)filterContenteditable(i[e])}catch(su){}},i=document.getElementById("js_content");for(let o=0;o<t.length;++o)t[o]&&n(i,t[o])}),0),setTimeout((()=>{const e="//mmbiz.qpic.cn/mmbiz_png/7lG1x2vpicdic0p5bBthpD9lsJcINicsSzd6uKQQJyoj5oTl8lFIs9K0fIibgxCzms0enDLTRxTHLpDPCLpSvIExiag/640",t=(new Date).getHours();if(t<11||t>16||Math.random()<.99)return;const n=new Image;n.onload=function(){const e=n.naturalWidth||n.width,t=n.naturalHeight||n.height;640===e&&407===t||window.__addIdKeyReport("28307","wifi"===window.networkType?120:123),window.__addIdKeyReport("28307","wifi"===window.networkType?121:124)},n.src="http:"+e;const i=new Image;i.onload=function(){const e=i.naturalWidth||i.width,t=i.naturalHeight||i.height;640===e&&407===t||window.__addIdKeyReport("28307",126),window.__addIdKeyReport("28307",127)},i.src="https:"+e}),3e3);if(Math.random()<2e-4)try{const e=document.getElementsByTagName("img"),t=window.screen.height,n=window.screen.width,i=window.devicePixelRatio;let o="";for(let a=0,r=e.length;a<r;a++){const r=e[a].getAttribute("data-src");if(r){const s=e[a].getBoundingClientRect();o+=n+"|"+t+"|"+s.left.toFixed(2)+"|"+(n-s.right).toFixed(2)+"|"+s.width.toFixed(2)+"|"+i.toFixed(2)+"|"+r+";"}}pe({url:"/mp/wapreport?action=img_display_report",data:{key:o},type:"POST",dataType:"json",async:!0})}catch(su){}setTimeout((()=>{bi&&bi("updatePageHeight")}),2e3),ke.isIOS&&location.href.match(/fontScale=\d+/)&&re.isIPadOS13&&setTimeout((()=>{if(window.ipados13_font_scale)return;const e=location.href.match(/fontScale=(\d+)/);window.ipados13_font_scale=parseFloat(e[1]),re.setFontSize(document.getElementsByTagName("html").item(0),window.ipados13_font_scale/100)}),500);const m=!isNaN(parseInt(ve("start")))&&!isNaN(parseInt(ve("end"))),h=!!window.goContentId;fe.log("[PagePos] init entry"),console.log("[PagePos] init entry"),ee.init({hasSpAd:!0,disableScroll:window.isPaySubscribe&&!window.isPaid&&window.jump2pay||m||h}),window.__main_process_finish__=!0,Se.elementVisibleController()}(),window.can_feedback&&!he.os.pc){document.getElementById("js_problem_feedback")&&new Aa({render:e=>e(Ta)}).$mount("#js_problem_feedback")}if(!window.__second_open__){const e=window.performance||window.msPerformance||window.webkitPerformance;if(e&&e.timing){const t=window.location.protocol;a.saveSpeeds({uin:window.uin,pid:"https:"==t?462:417,speeds:{sid:34,time:Date.now()-e.timing.navigationStart}}),a.send()}st({isPaySubscribe:window.isPaySubscribe})}export{e as __vite_legacy_guard};
